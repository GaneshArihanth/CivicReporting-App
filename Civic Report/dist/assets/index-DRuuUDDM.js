const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ComplaintsMap-DoU8CrKq.js","assets/vendor-BvpsvYBk.js","assets/leaflet-Bd0cCGXt.js","assets/recharts-BDxj_m0B.js","assets/exceljs.min-CATl1nQT.js","assets/exceljs-BbeRNpxW.js","assets/index-D7IyB7uP.js"])))=>i.map(i=>d[i]);
var MB=Object.defineProperty;var J_=t=>{throw TypeError(t)};var OB=(t,e,n)=>e in t?MB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var oe=(t,e,n)=>OB(t,typeof e!="symbol"?e+"":e,n),j0=(t,e,n)=>e.has(t)||J_("Cannot "+n);var H=(t,e,n)=>(j0(t,e,"read from private field"),n?n.call(t):e.get(t)),ce=(t,e,n)=>e.has(t)?J_("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),G=(t,e,n,r)=>(j0(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),ke=(t,e,n)=>(j0(t,e,"access private method"),n);var rf=(t,e,n,r)=>({set _(s){G(t,e,s,n)},get _(){return H(t,e,r)}});import{e as LB,g as wh,r as p,f as Ft,j as d,L as Wn,u as ts,P as ne,R as FB,D as b2,h as v2,i as gp,k as x2,l as jB,s as Zn,_ as B,m as ft,n as Yn,o as He,p as Kc,q as ib,t as Ec,v as En,w as bn,I as C2,C as E2,G as VB,x as wm,y as d1,z as bh,M as I2,S as BB,A as ro,B as UB,E as HB,F as _2,H as Ws,J as ct,K as $B,N as Bn,O as vo,Q as xo,T as zB,U as GB,V as WB,W as Bd,X as A2,Y as KB,Z as vh,$ as qB,a0 as X_,a1 as bm,a2 as S2,a3 as QB,b as T2,a4 as Ic,a5 as P2,a6 as YB,a7 as JB,a8 as Tn,a9 as XB,aa as k2,ab as R2,ac as ZB,ad as e5,ae as t5,af as n5,ag as r5,ah as We,ai as wt,d as bg,aj as s5,ak as o5,al as yp,am as wp,an as N2,ao as D2,ap as Bt,aq as Z_,ar as eA,as as tA,at as vg,au as ns,av as nA,aw as ab,ax as lb,ay as M2,az as i5,aA as rA,aB as a5,aC as l5,aD as c5,aE as u5,aF as d5,aG as Tf,aH as h5,aI as f5}from"./vendor-BvpsvYBk.js";import{R as xg,P as m5,a as p5,C as g5,T as Cg,L as V0,B as y5,b as B0,X as U0,Y as H0,c as w5,d as b5,e as v5,f as x5,A as Eg}from"./recharts-BDxj_m0B.js";import{L as is}from"./leaflet-Bd0cCGXt.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var Ig={},sA;function C5(){if(sA)return Ig;sA=1;var t=LB();return Ig.createRoot=t.createRoot,Ig.hydrateRoot=t.hydrateRoot,Ig}var E5=C5();const I5=wh(E5);function O2(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=O2(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function ui(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=O2(t))&&(r&&(r+=" "),r+=e);return r}const qf=t=>typeof t=="number"&&!isNaN(t),_c=t=>typeof t=="string",Nr=t=>typeof t=="function",ny=t=>_c(t)||Nr(t)?t:null,$0=t=>p.isValidElement(t)||_c(t)||Nr(t)||qf(t);function _5(t,e,n){n===void 0&&(n=300);const{scrollHeight:r,style:s}=t;requestAnimationFrame(()=>{s.minHeight="initial",s.height=r+"px",s.transition=`all ${n}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(e,n)})})}function cb(t){let{enter:e,exit:n,appendPosition:r=!1,collapse:s=!0,collapseDuration:o=300}=t;return function(i){let{children:a,position:l,preventExitTransition:c,done:u,nodeRef:h,isIn:f}=i;const g=r?`${e}--${l}`:e,y=r?`${n}--${l}`:n,w=p.useRef(0);return p.useLayoutEffect(()=>{const v=h.current,C=g.split(" "),x=A=>{A.target===h.current&&(v.dispatchEvent(new Event("d")),v.removeEventListener("animationend",x),v.removeEventListener("animationcancel",x),w.current===0&&A.type!=="animationcancel"&&v.classList.remove(...C))};v.classList.add(...C),v.addEventListener("animationend",x),v.addEventListener("animationcancel",x)},[]),p.useEffect(()=>{const v=h.current,C=()=>{v.removeEventListener("animationend",C),s?_5(v,u,o):u()};f||(c?C():(w.current=1,v.className+=` ${y}`,v.addEventListener("animationend",C)))},[f]),Ft.createElement(Ft.Fragment,null,a)}}function oA(t,e){return t!=null?{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:e}:{}}const bs={list:new Map,emitQueue:new Map,on(t,e){return this.list.has(t)||this.list.set(t,[]),this.list.get(t).push(e),this},off(t,e){if(e){const n=this.list.get(t).filter(r=>r!==e);return this.list.set(t,n),this}return this.list.delete(t),this},cancelEmit(t){const e=this.emitQueue.get(t);return e&&(e.forEach(clearTimeout),this.emitQueue.delete(t)),this},emit(t){this.list.has(t)&&this.list.get(t).forEach(e=>{const n=setTimeout(()=>{e(...[].slice.call(arguments,1))},0);this.emitQueue.has(t)||this.emitQueue.set(t,[]),this.emitQueue.get(t).push(n)})}},_g=t=>{let{theme:e,type:n,...r}=t;return Ft.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${n})`,...r})},z0={info:function(t){return Ft.createElement(_g,{...t},Ft.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return Ft.createElement(_g,{...t},Ft.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return Ft.createElement(_g,{...t},Ft.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return Ft.createElement(_g,{...t},Ft.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Ft.createElement("div",{className:"Toastify__spinner"})}};function A5(t){const[,e]=p.useReducer(g=>g+1,0),[n,r]=p.useState([]),s=p.useRef(null),o=p.useRef(new Map).current,i=g=>n.indexOf(g)!==-1,a=p.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:t,containerId:null,isToastActive:i,getToast:g=>o.get(g)}).current;function l(g){let{containerId:y}=g;const{limit:w}=a.props;!w||y&&a.containerId!==y||(a.count-=a.queue.length,a.queue=[])}function c(g){r(y=>g==null?[]:y.filter(w=>w!==g))}function u(){const{toastContent:g,toastProps:y,staleId:w}=a.queue.shift();f(g,y,w)}function h(g,y){let{delay:w,staleId:v,...C}=y;if(!$0(g)||(function(D){return!s.current||a.props.enableMultiContainer&&D.containerId!==a.props.containerId||o.has(D.toastId)&&D.updateId==null})(C))return;const{toastId:x,updateId:A,data:N}=C,{props:M}=a,k=()=>c(x),E=A==null;E&&a.count++;const b={...M,style:M.toastStyle,key:a.toastKey++,...Object.fromEntries(Object.entries(C).filter(D=>{let[T,j]=D;return j!=null})),toastId:x,updateId:A,data:N,closeToast:k,isIn:!1,className:ny(C.className||M.toastClassName),bodyClassName:ny(C.bodyClassName||M.bodyClassName),progressClassName:ny(C.progressClassName||M.progressClassName),autoClose:!C.isLoading&&(I=C.autoClose,P=M.autoClose,I===!1||qf(I)&&I>0?I:P),deleteToast(){const D=oA(o.get(x),"removed");o.delete(x),bs.emit(4,D);const T=a.queue.length;if(a.count=x==null?a.count-a.displayedToast:a.count-1,a.count<0&&(a.count=0),T>0){const j=x==null?a.props.limit:1;if(T===1||j===1)a.displayedToast++,u();else{const R=j>T?T:j;a.displayedToast=R;for(let V=0;V<R;V++)u()}}else e()}};var I,P;b.iconOut=(function(D){let{theme:T,type:j,isLoading:R,icon:V}=D,U=null;const F={theme:T,type:j};return V===!1||(Nr(V)?U=V(F):p.isValidElement(V)?U=p.cloneElement(V,F):_c(V)||qf(V)?U=V:R?U=z0.spinner():($=>$ in z0)(j)&&(U=z0[j](F))),U})(b),Nr(C.onOpen)&&(b.onOpen=C.onOpen),Nr(C.onClose)&&(b.onClose=C.onClose),b.closeButton=M.closeButton,C.closeButton===!1||$0(C.closeButton)?b.closeButton=C.closeButton:C.closeButton===!0&&(b.closeButton=!$0(M.closeButton)||M.closeButton);let S=g;p.isValidElement(g)&&!_c(g.type)?S=p.cloneElement(g,{closeToast:k,toastProps:b,data:N}):Nr(g)&&(S=g({closeToast:k,toastProps:b,data:N})),M.limit&&M.limit>0&&a.count>M.limit&&E?a.queue.push({toastContent:S,toastProps:b,staleId:v}):qf(w)?setTimeout(()=>{f(S,b,v)},w):f(S,b,v)}function f(g,y,w){const{toastId:v}=y;w&&o.delete(w);const C={content:g,props:y};o.set(v,C),r(x=>[...x,v].filter(A=>A!==w)),bs.emit(4,oA(C,C.props.updateId==null?"added":"updated"))}return p.useEffect(()=>(a.containerId=t.containerId,bs.cancelEmit(3).on(0,h).on(1,g=>s.current&&c(g)).on(5,l).emit(2,a),()=>{o.clear(),bs.emit(3,a)}),[]),p.useEffect(()=>{a.props=t,a.isToastActive=i,a.displayedToast=n.length}),{getToastToRender:function(g){const y=new Map,w=Array.from(o.values());return t.newestOnTop&&w.reverse(),w.forEach(v=>{const{position:C}=v.props;y.has(C)||y.set(C,[]),y.get(C).push(v)}),Array.from(y,v=>g(v[0],v[1]))},containerRef:s,isToastActive:i}}function iA(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}function aA(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientY:t.clientY}function S5(t){const[e,n]=p.useState(!1),[r,s]=p.useState(!1),o=p.useRef(null),i=p.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,a=p.useRef(t),{autoClose:l,pauseOnHover:c,closeToast:u,onClick:h,closeOnClick:f}=t;function g(N){if(t.draggable){N.nativeEvent.type==="touchstart"&&N.nativeEvent.preventDefault(),i.didMove=!1,document.addEventListener("mousemove",C),document.addEventListener("mouseup",x),document.addEventListener("touchmove",C),document.addEventListener("touchend",x);const M=o.current;i.canCloseOnClick=!0,i.canDrag=!0,i.boundingRect=M.getBoundingClientRect(),M.style.transition="",i.x=iA(N.nativeEvent),i.y=aA(N.nativeEvent),t.draggableDirection==="x"?(i.start=i.x,i.removalDistance=M.offsetWidth*(t.draggablePercent/100)):(i.start=i.y,i.removalDistance=M.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent/100))}}function y(N){if(i.boundingRect){const{top:M,bottom:k,left:E,right:b}=i.boundingRect;N.nativeEvent.type!=="touchend"&&t.pauseOnHover&&i.x>=E&&i.x<=b&&i.y>=M&&i.y<=k?v():w()}}function w(){n(!0)}function v(){n(!1)}function C(N){const M=o.current;i.canDrag&&M&&(i.didMove=!0,e&&v(),i.x=iA(N),i.y=aA(N),i.delta=t.draggableDirection==="x"?i.x-i.start:i.y-i.start,i.start!==i.x&&(i.canCloseOnClick=!1),M.style.transform=`translate${t.draggableDirection}(${i.delta}px)`,M.style.opacity=""+(1-Math.abs(i.delta/i.removalDistance)))}function x(){document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",x),document.removeEventListener("touchmove",C),document.removeEventListener("touchend",x);const N=o.current;if(i.canDrag&&i.didMove&&N){if(i.canDrag=!1,Math.abs(i.delta)>i.removalDistance)return s(!0),void t.closeToast();N.style.transition="transform 0.2s, opacity 0.2s",N.style.transform=`translate${t.draggableDirection}(0)`,N.style.opacity="1"}}p.useEffect(()=>{a.current=t}),p.useEffect(()=>(o.current&&o.current.addEventListener("d",w,{once:!0}),Nr(t.onOpen)&&t.onOpen(p.isValidElement(t.children)&&t.children.props),()=>{const N=a.current;Nr(N.onClose)&&N.onClose(p.isValidElement(N.children)&&N.children.props)}),[]),p.useEffect(()=>(t.pauseOnFocusLoss&&(document.hasFocus()||v(),window.addEventListener("focus",w),window.addEventListener("blur",v)),()=>{t.pauseOnFocusLoss&&(window.removeEventListener("focus",w),window.removeEventListener("blur",v))}),[t.pauseOnFocusLoss]);const A={onMouseDown:g,onTouchStart:g,onMouseUp:y,onTouchEnd:y};return l&&c&&(A.onMouseEnter=v,A.onMouseLeave=w),f&&(A.onClick=N=>{h&&h(N),i.canCloseOnClick&&u()}),{playToast:w,pauseToast:v,isRunning:e,preventExitTransition:r,toastRef:o,eventHandlers:A}}function L2(t){let{closeToast:e,theme:n,ariaLabel:r="close"}=t;return Ft.createElement("button",{className:`Toastify__close-button Toastify__close-button--${n}`,type:"button",onClick:s=>{s.stopPropagation(),e(s)},"aria-label":r},Ft.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Ft.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function T5(t){let{delay:e,isRunning:n,closeToast:r,type:s="default",hide:o,className:i,style:a,controlledProgress:l,progress:c,rtl:u,isIn:h,theme:f}=t;const g=o||l&&c===0,y={...a,animationDuration:`${e}ms`,animationPlayState:n?"running":"paused",opacity:g?0:1};l&&(y.transform=`scaleX(${c})`);const w=ui("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${f}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":u}),v=Nr(i)?i({rtl:u,type:s,defaultClassName:w}):ui(w,i);return Ft.createElement("div",{role:"progressbar","aria-hidden":g?"true":"false","aria-label":"notification timer",className:v,style:y,[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{h&&r()}})}const P5=t=>{const{isRunning:e,preventExitTransition:n,toastRef:r,eventHandlers:s}=S5(t),{closeButton:o,children:i,autoClose:a,onClick:l,type:c,hideProgressBar:u,closeToast:h,transition:f,position:g,className:y,style:w,bodyClassName:v,bodyStyle:C,progressClassName:x,progressStyle:A,updateId:N,role:M,progress:k,rtl:E,toastId:b,deleteToast:I,isIn:P,isLoading:S,iconOut:D,closeOnClick:T,theme:j}=t,R=ui("Toastify__toast",`Toastify__toast-theme--${j}`,`Toastify__toast--${c}`,{"Toastify__toast--rtl":E},{"Toastify__toast--close-on-click":T}),V=Nr(y)?y({rtl:E,position:g,type:c,defaultClassName:R}):ui(R,y),U=!!k||!a,F={closeToast:h,type:c,theme:j};let $=null;return o===!1||($=Nr(o)?o(F):p.isValidElement(o)?p.cloneElement(o,F):L2(F)),Ft.createElement(f,{isIn:P,done:I,position:g,preventExitTransition:n,nodeRef:r},Ft.createElement("div",{id:b,onClick:l,className:V,...s,style:w,ref:r},Ft.createElement("div",{...P&&{role:M},className:Nr(v)?v({type:c}):ui("Toastify__toast-body",v),style:C},D!=null&&Ft.createElement("div",{className:ui("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!S})},D),Ft.createElement("div",null,i)),$,Ft.createElement(T5,{...N&&!U?{key:`pb-${N}`}:{},rtl:E,theme:j,delay:a,isRunning:e,isIn:P,closeToast:h,hide:u,type:c,style:A,className:x,controlledProgress:U,progress:k||0})))},ub=function(t,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}},k5=cb(ub("bounce",!0));cb(ub("slide",!0));cb(ub("zoom"));cb(ub("flip"));const Vy=p.forwardRef((t,e)=>{const{getToastToRender:n,containerRef:r,isToastActive:s}=A5(t),{className:o,style:i,rtl:a,containerId:l}=t;function c(u){const h=ui("Toastify__toast-container",`Toastify__toast-container--${u}`,{"Toastify__toast-container--rtl":a});return Nr(o)?o({position:u,rtl:a,defaultClassName:h}):ui(h,ny(o))}return p.useEffect(()=>{e&&(e.current=r.current)},[]),Ft.createElement("div",{ref:r,className:"Toastify",id:l},n((u,h)=>{const f=h.length?{...i}:{...i,pointerEvents:"none"};return Ft.createElement("div",{className:c(u),style:f,key:`container-${u}`},h.map((g,y)=>{let{content:w,props:v}=g;return Ft.createElement(P5,{...v,isIn:s(v.toastId),style:{...v.style,"--nth":y+1,"--len":h.length},key:`toast-${v.key}`},w)}))}))});Vy.displayName="ToastContainer",Vy.defaultProps={position:"top-right",transition:k5,autoClose:5e3,closeButton:L2,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let G0,Cl=new Map,Pf=[],R5=1;function F2(){return""+R5++}function N5(t){return t&&(_c(t.toastId)||qf(t.toastId))?t.toastId:F2()}function Qf(t,e){return Cl.size>0?bs.emit(0,t,e):Pf.push({content:t,options:e}),e.toastId}function By(t,e){return{...e,type:e&&e.type||t,toastId:N5(e)}}function Ag(t){return(e,n)=>Qf(e,By(t,n))}function ge(t,e){return Qf(t,By("default",e))}ge.loading=(t,e)=>Qf(t,By("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),ge.promise=function(t,e,n){let r,{pending:s,error:o,success:i}=e;s&&(r=_c(s)?ge.loading(s,n):ge.loading(s.render,{...n,...s}));const a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,h,f)=>{if(h==null)return void ge.dismiss(r);const g={type:u,...a,...n,data:f},y=_c(h)?{render:h}:h;return r?ge.update(r,{...g,...y}):ge(y.render,{...g,...y}),f},c=Nr(t)?t():t;return c.then(u=>l("success",i,u)).catch(u=>l("error",o,u)),c},ge.success=Ag("success"),ge.info=Ag("info"),ge.error=Ag("error"),ge.warning=Ag("warning"),ge.warn=ge.warning,ge.dark=(t,e)=>Qf(t,By("default",{theme:"dark",...e})),ge.dismiss=t=>{Cl.size>0?bs.emit(1,t):Pf=Pf.filter(e=>t!=null&&e.options.toastId!==t)},ge.clearWaitingQueue=function(t){return t===void 0&&(t={}),bs.emit(5,t)},ge.isActive=t=>{let e=!1;return Cl.forEach(n=>{n.isToastActive&&n.isToastActive(t)&&(e=!0)}),e},ge.update=function(t,e){e===void 0&&(e={}),setTimeout(()=>{const n=(function(r,s){let{containerId:o}=s;const i=Cl.get(o||G0);return i&&i.getToast(r)})(t,e);if(n){const{props:r,content:s}=n,o={delay:100,...r,...e,toastId:e.toastId||t,updateId:F2()};o.toastId!==t&&(o.staleId=t);const i=o.render||s;delete o.render,Qf(i,o)}},0)},ge.done=t=>{ge.update(t,{progress:1})},ge.onChange=t=>(bs.on(4,t),()=>{bs.off(4,t)}),ge.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},ge.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},bs.on(2,t=>{G0=t.containerId||t,Cl.set(G0,t),Pf.forEach(e=>{bs.emit(0,e.content,e.options)}),Pf=[]}).on(3,t=>{Cl.delete(t.containerId||t),Cl.size===0&&bs.off(0).off(1).off(5)});const D5=()=>{};var lA={};const j2=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},M5=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[n++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=t[n++],i=t[n++],a=t[n++],l=((s&7)<<18|(o&63)<<12|(i&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const o=t[n++],i=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|i&63)}}return e.join("")},V2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const o=t[s],i=s+1<t.length,a=i?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=o>>2,h=(o&3)<<4|a>>4;let f=(a&15)<<2|c>>6,g=c&63;l||(g=64,i||(f=64)),r.push(n[u],n[h],n[f],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(j2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):M5(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const o=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,o==null||a==null||c==null||h==null)throw new O5;const f=o<<2|a>>4;if(r.push(f),c!==64){const g=a<<4&240|c>>2;if(r.push(g),h!==64){const y=c<<6&192|h;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class O5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const L5=function(t){const e=j2(t);return V2.encodeByteArray(e,!0)},Uy=function(t){return L5(t).replace(/\./g,"")},B2=function(t){try{return V2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function U2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const F5=()=>U2().__FIREBASE_DEFAULTS__,j5=()=>{if(typeof process>"u"||typeof lA>"u")return;const t=lA.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},V5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&B2(t[1]);return e&&JSON.parse(e)},hb=()=>{try{return D5()||F5()||j5()||V5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},H2=t=>hb()?.emulatorHosts?.[t],B5=t=>{const e=H2(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},$2=()=>hb()?.config,z2=t=>hb()?.[`_${t}`];class U5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}function Ja(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function h1(t){return(await fetch(t,{credentials:"include"})).ok}function H5(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Uy(JSON.stringify(n)),Uy(JSON.stringify(i)),""].join(".")}const Yf={};function $5(){const t={prod:[],emulator:[]};for(const e of Object.keys(Yf))Yf[e]?t.emulator.push(e):t.prod.push(e);return t}function z5(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let cA=!1;function G2(t,e){if(typeof window>"u"||typeof document>"u"||!Ja(window.location.host)||Yf[t]===e||Yf[t]||cA)return;Yf[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",o=$5().prod.length>0;function i(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{cA=!0,i()},f}function u(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=z5(r),g=n("text"),y=document.getElementById(g)||document.createElement("span"),w=n("learnmore"),v=document.getElementById(w)||document.createElement("a"),C=n("preprendIcon"),x=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const A=f.element;a(A),u(v,w);const N=c();l(x,C),A.append(x,y,v,N),document.body.appendChild(A)}o?(y.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function Rn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function G5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rn())}function W2(){const t=hb()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function W5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function K5(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function q5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Q5(){const t=Rn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function K2(){return!W2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function q2(){return!W2()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Q2(){try{return typeof indexedDB=="object"}catch{return!1}}function Y5(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(n){e(n)}})}const J5="FirebaseError";class Uo extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=J5,Object.setPrototypeOf(this,Uo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,bp.prototype.create)}}class bp{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,o=this.errors[e],i=o?X5(o,r):"Error",a=`${this.serviceName}: ${i} (${s}).`;return new Uo(s,a,r)}}function X5(t,e){return t.replace(Z5,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Z5=/\{\$([^}]+)}/g;function e3(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function vi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const o=t[s],i=e[s];if(uA(o)&&uA(i)){if(!vi(o,i))return!1}else if(o!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function uA(t){return t!==null&&typeof t=="object"}function vp(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function kf(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,o]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function Rf(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function t3(t,e){const n=new n3(t,e);return n.subscribe.bind(n)}class n3{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");r3(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=W0),s.error===void 0&&(s.error=W0),s.complete===void 0&&(s.complete=W0);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function r3(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function W0(){}function jt(t){return t&&t._delegate?t._delegate:t}class Fa{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const El="[DEFAULT]";class s3{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new U5;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(i3(e))try{this.getOrInitializeService({instanceIdentifier:El})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=El){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=El){return this.instances.has(e)}getOptions(e=El){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&i.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:o3(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=El){return this.component?this.component.multipleInstances?e:El:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function o3(t){return t===El?void 0:t}function i3(t){return t.instantiationMode==="EAGER"}class a3{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new s3(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var bt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(bt||(bt={}));const l3={debug:bt.DEBUG,verbose:bt.VERBOSE,info:bt.INFO,warn:bt.WARN,error:bt.ERROR,silent:bt.SILENT},c3=bt.INFO,u3={[bt.DEBUG]:"log",[bt.VERBOSE]:"log",[bt.INFO]:"info",[bt.WARN]:"warn",[bt.ERROR]:"error"},d3=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=u3[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class f1{constructor(e){this.name=e,this._logLevel=c3,this._logHandler=d3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in bt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?l3[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,bt.DEBUG,...e),this._logHandler(this,bt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,bt.VERBOSE,...e),this._logHandler(this,bt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,bt.INFO,...e),this._logHandler(this,bt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,bt.WARN,...e),this._logHandler(this,bt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,bt.ERROR,...e),this._logHandler(this,bt.ERROR,...e)}}const h3=(t,e)=>e.some(n=>t instanceof n);let dA,hA;function f3(){return dA||(dA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function m3(){return hA||(hA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Y2=new WeakMap,ix=new WeakMap,J2=new WeakMap,K0=new WeakMap,m1=new WeakMap;function p3(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{n(ka(t.result)),s()},i=()=>{r(t.error),s()};t.addEventListener("success",o),t.addEventListener("error",i)});return e.then(n=>{n instanceof IDBCursor&&Y2.set(n,t)}).catch(()=>{}),m1.set(e,t),e}function g3(t){if(ix.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{n(),s()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)});ix.set(t,e)}let ax={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ix.get(t);if(e==="objectStoreNames")return t.objectStoreNames||J2.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ka(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function y3(t){ax=t(ax)}function w3(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(q0(this),e,...n);return J2.set(r,e.sort?e.sort():[e]),ka(r)}:m3().includes(t)?function(...e){return t.apply(q0(this),e),ka(Y2.get(this))}:function(...e){return ka(t.apply(q0(this),e))}}function b3(t){return typeof t=="function"?w3(t):(t instanceof IDBTransaction&&g3(t),h3(t,f3())?new Proxy(t,ax):t)}function ka(t){if(t instanceof IDBRequest)return p3(t);if(K0.has(t))return K0.get(t);const e=b3(t);return e!==t&&(K0.set(t,e),m1.set(e,t)),e}const q0=t=>m1.get(t);function v3(t,e,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const i=indexedDB.open(t,e),a=ka(i);return r&&i.addEventListener("upgradeneeded",l=>{r(ka(i.result),l.oldVersion,l.newVersion,ka(i.transaction),l)}),n&&i.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const x3=["get","getKey","getAll","getAllKeys","count"],C3=["put","add","delete","clear"],Q0=new Map;function fA(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Q0.get(e))return Q0.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=C3.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||x3.includes(n)))return;const o=async function(i,...a){const l=this.transaction(i,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return Q0.set(e,o),o}y3(t=>({...t,get:(e,n,r)=>fA(e,n)||t.get(e,n,r),has:(e,n)=>!!fA(e,n)||t.has(e,n)}));class E3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(I3(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function I3(t){return t.getComponent()?.type==="VERSION"}const lx="@firebase/app",mA="0.14.6";const xi=new f1("@firebase/app"),_3="@firebase/app-compat",A3="@firebase/analytics-compat",S3="@firebase/analytics",T3="@firebase/app-check-compat",P3="@firebase/app-check",k3="@firebase/auth",R3="@firebase/auth-compat",N3="@firebase/database",D3="@firebase/data-connect",M3="@firebase/database-compat",O3="@firebase/functions",L3="@firebase/functions-compat",F3="@firebase/installations",j3="@firebase/installations-compat",V3="@firebase/messaging",B3="@firebase/messaging-compat",U3="@firebase/performance",H3="@firebase/performance-compat",$3="@firebase/remote-config",z3="@firebase/remote-config-compat",G3="@firebase/storage",W3="@firebase/storage-compat",K3="@firebase/firestore",q3="@firebase/ai",Q3="@firebase/firestore-compat",Y3="firebase",J3="12.6.0";const cx="[DEFAULT]",X3={[lx]:"fire-core",[_3]:"fire-core-compat",[S3]:"fire-analytics",[A3]:"fire-analytics-compat",[P3]:"fire-app-check",[T3]:"fire-app-check-compat",[k3]:"fire-auth",[R3]:"fire-auth-compat",[N3]:"fire-rtdb",[D3]:"fire-data-connect",[M3]:"fire-rtdb-compat",[O3]:"fire-fn",[L3]:"fire-fn-compat",[F3]:"fire-iid",[j3]:"fire-iid-compat",[V3]:"fire-fcm",[B3]:"fire-fcm-compat",[U3]:"fire-perf",[H3]:"fire-perf-compat",[$3]:"fire-rc",[z3]:"fire-rc-compat",[G3]:"fire-gcs",[W3]:"fire-gcs-compat",[K3]:"fire-fst",[Q3]:"fire-fst-compat",[q3]:"fire-vertex","fire-js":"fire-js",[Y3]:"fire-js-all"};const vm=new Map,Z3=new Map,ux=new Map;function pA(t,e){try{t.container.addComponent(e)}catch(n){xi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ac(t){const e=t.name;if(ux.has(e))return xi.debug(`There were multiple attempts to register component ${e}.`),!1;ux.set(e,t);for(const n of vm.values())pA(n,t);for(const n of Z3.values())pA(n,t);return!0}function fb(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Qr(t){return t==null?!1:t.settings!==void 0}const eU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ra=new bp("app","Firebase",eU);class tU{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Fa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ra.create("app-deleted",{appName:this._name})}}const qc=J3;function X2(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:cx,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Ra.create("bad-app-name",{appName:String(s)});if(n||(n=$2()),!n)throw Ra.create("no-options");const o=vm.get(s);if(o){if(vi(n,o.options)&&vi(r,o.config))return o;throw Ra.create("duplicate-app",{appName:s})}const i=new a3(s);for(const l of ux.values())i.addComponent(l);const a=new tU(n,r,i);return vm.set(s,a),a}function Z2(t=cx){const e=vm.get(t);if(!e&&t===cx&&$2())return X2();if(!e)throw Ra.create("no-app",{appName:t});return e}function nU(){return Array.from(vm.values())}function Ao(t,e,n){let r=X3[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const i=[`Unable to register library "${r}" with version "${e}":`];s&&i.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&i.push("and"),o&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xi.warn(i.join(" "));return}Ac(new Fa(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const rU="firebase-heartbeat-database",sU=1,xm="firebase-heartbeat-store";let Y0=null;function eN(){return Y0||(Y0=v3(rU,sU,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(xm)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ra.create("idb-open",{originalErrorMessage:t.message})})),Y0}async function oU(t){try{const n=(await eN()).transaction(xm),r=await n.objectStore(xm).get(tN(t));return await n.done,r}catch(e){if(e instanceof Uo)xi.warn(e.message);else{const n=Ra.create("idb-get",{originalErrorMessage:e?.message});xi.warn(n.message)}}}async function gA(t,e){try{const r=(await eN()).transaction(xm,"readwrite");await r.objectStore(xm).put(e,tN(t)),await r.done}catch(n){if(n instanceof Uo)xi.warn(n.message);else{const r=Ra.create("idb-set",{originalErrorMessage:n?.message});xi.warn(r.message)}}}function tN(t){return`${t.name}!${t.options.appId}`}const iU=1024,aU=30;class lU{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new uU(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=yA();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>aU){const s=dU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){xi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=yA(),{heartbeatsToSend:n,unsentEntries:r}=cU(this._heartbeatsCache.heartbeats),s=Uy(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return xi.warn(e),""}}}function yA(){return new Date().toISOString().substring(0,10)}function cU(t,e=iU){const n=[];let r=t.slice();for(const s of t){const o=n.find(i=>i.agent===s.agent);if(o){if(o.dates.push(s.date),wA(n)>e){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),wA(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class uU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Q2()?Y5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await oU(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function wA(t){return Uy(JSON.stringify({version:2,heartbeats:t})).length}function dU(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function hU(t){Ac(new Fa("platform-logger",e=>new E3(e),"PRIVATE")),Ac(new Fa("heartbeat",e=>new lU(e),"PRIVATE")),Ao(lx,mA,t),Ao(lx,mA,"esm2020"),Ao("fire-js","")}hU("");var fU="firebase",mU="12.6.0";Ao(fU,mU,"app");var bA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Na,nN;(function(){var t;function e(E,b){function I(){}I.prototype=b.prototype,E.F=b.prototype,E.prototype=new I,E.prototype.constructor=E,E.D=function(P,S,D){for(var T=Array(arguments.length-2),j=2;j<arguments.length;j++)T[j-2]=arguments[j];return b.prototype[S].apply(P,T)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,b,I){I||(I=0);const P=Array(16);if(typeof b=="string")for(var S=0;S<16;++S)P[S]=b.charCodeAt(I++)|b.charCodeAt(I++)<<8|b.charCodeAt(I++)<<16|b.charCodeAt(I++)<<24;else for(S=0;S<16;++S)P[S]=b[I++]|b[I++]<<8|b[I++]<<16|b[I++]<<24;b=E.g[0],I=E.g[1],S=E.g[2];let D=E.g[3],T;T=b+(D^I&(S^D))+P[0]+3614090360&4294967295,b=I+(T<<7&4294967295|T>>>25),T=D+(S^b&(I^S))+P[1]+3905402710&4294967295,D=b+(T<<12&4294967295|T>>>20),T=S+(I^D&(b^I))+P[2]+606105819&4294967295,S=D+(T<<17&4294967295|T>>>15),T=I+(b^S&(D^b))+P[3]+3250441966&4294967295,I=S+(T<<22&4294967295|T>>>10),T=b+(D^I&(S^D))+P[4]+4118548399&4294967295,b=I+(T<<7&4294967295|T>>>25),T=D+(S^b&(I^S))+P[5]+1200080426&4294967295,D=b+(T<<12&4294967295|T>>>20),T=S+(I^D&(b^I))+P[6]+2821735955&4294967295,S=D+(T<<17&4294967295|T>>>15),T=I+(b^S&(D^b))+P[7]+4249261313&4294967295,I=S+(T<<22&4294967295|T>>>10),T=b+(D^I&(S^D))+P[8]+1770035416&4294967295,b=I+(T<<7&4294967295|T>>>25),T=D+(S^b&(I^S))+P[9]+2336552879&4294967295,D=b+(T<<12&4294967295|T>>>20),T=S+(I^D&(b^I))+P[10]+4294925233&4294967295,S=D+(T<<17&4294967295|T>>>15),T=I+(b^S&(D^b))+P[11]+2304563134&4294967295,I=S+(T<<22&4294967295|T>>>10),T=b+(D^I&(S^D))+P[12]+1804603682&4294967295,b=I+(T<<7&4294967295|T>>>25),T=D+(S^b&(I^S))+P[13]+4254626195&4294967295,D=b+(T<<12&4294967295|T>>>20),T=S+(I^D&(b^I))+P[14]+2792965006&4294967295,S=D+(T<<17&4294967295|T>>>15),T=I+(b^S&(D^b))+P[15]+1236535329&4294967295,I=S+(T<<22&4294967295|T>>>10),T=b+(S^D&(I^S))+P[1]+4129170786&4294967295,b=I+(T<<5&4294967295|T>>>27),T=D+(I^S&(b^I))+P[6]+3225465664&4294967295,D=b+(T<<9&4294967295|T>>>23),T=S+(b^I&(D^b))+P[11]+643717713&4294967295,S=D+(T<<14&4294967295|T>>>18),T=I+(D^b&(S^D))+P[0]+3921069994&4294967295,I=S+(T<<20&4294967295|T>>>12),T=b+(S^D&(I^S))+P[5]+3593408605&4294967295,b=I+(T<<5&4294967295|T>>>27),T=D+(I^S&(b^I))+P[10]+38016083&4294967295,D=b+(T<<9&4294967295|T>>>23),T=S+(b^I&(D^b))+P[15]+3634488961&4294967295,S=D+(T<<14&4294967295|T>>>18),T=I+(D^b&(S^D))+P[4]+3889429448&4294967295,I=S+(T<<20&4294967295|T>>>12),T=b+(S^D&(I^S))+P[9]+568446438&4294967295,b=I+(T<<5&4294967295|T>>>27),T=D+(I^S&(b^I))+P[14]+3275163606&4294967295,D=b+(T<<9&4294967295|T>>>23),T=S+(b^I&(D^b))+P[3]+4107603335&4294967295,S=D+(T<<14&4294967295|T>>>18),T=I+(D^b&(S^D))+P[8]+1163531501&4294967295,I=S+(T<<20&4294967295|T>>>12),T=b+(S^D&(I^S))+P[13]+2850285829&4294967295,b=I+(T<<5&4294967295|T>>>27),T=D+(I^S&(b^I))+P[2]+4243563512&4294967295,D=b+(T<<9&4294967295|T>>>23),T=S+(b^I&(D^b))+P[7]+1735328473&4294967295,S=D+(T<<14&4294967295|T>>>18),T=I+(D^b&(S^D))+P[12]+2368359562&4294967295,I=S+(T<<20&4294967295|T>>>12),T=b+(I^S^D)+P[5]+4294588738&4294967295,b=I+(T<<4&4294967295|T>>>28),T=D+(b^I^S)+P[8]+2272392833&4294967295,D=b+(T<<11&4294967295|T>>>21),T=S+(D^b^I)+P[11]+1839030562&4294967295,S=D+(T<<16&4294967295|T>>>16),T=I+(S^D^b)+P[14]+4259657740&4294967295,I=S+(T<<23&4294967295|T>>>9),T=b+(I^S^D)+P[1]+2763975236&4294967295,b=I+(T<<4&4294967295|T>>>28),T=D+(b^I^S)+P[4]+1272893353&4294967295,D=b+(T<<11&4294967295|T>>>21),T=S+(D^b^I)+P[7]+4139469664&4294967295,S=D+(T<<16&4294967295|T>>>16),T=I+(S^D^b)+P[10]+3200236656&4294967295,I=S+(T<<23&4294967295|T>>>9),T=b+(I^S^D)+P[13]+681279174&4294967295,b=I+(T<<4&4294967295|T>>>28),T=D+(b^I^S)+P[0]+3936430074&4294967295,D=b+(T<<11&4294967295|T>>>21),T=S+(D^b^I)+P[3]+3572445317&4294967295,S=D+(T<<16&4294967295|T>>>16),T=I+(S^D^b)+P[6]+76029189&4294967295,I=S+(T<<23&4294967295|T>>>9),T=b+(I^S^D)+P[9]+3654602809&4294967295,b=I+(T<<4&4294967295|T>>>28),T=D+(b^I^S)+P[12]+3873151461&4294967295,D=b+(T<<11&4294967295|T>>>21),T=S+(D^b^I)+P[15]+530742520&4294967295,S=D+(T<<16&4294967295|T>>>16),T=I+(S^D^b)+P[2]+3299628645&4294967295,I=S+(T<<23&4294967295|T>>>9),T=b+(S^(I|~D))+P[0]+4096336452&4294967295,b=I+(T<<6&4294967295|T>>>26),T=D+(I^(b|~S))+P[7]+1126891415&4294967295,D=b+(T<<10&4294967295|T>>>22),T=S+(b^(D|~I))+P[14]+2878612391&4294967295,S=D+(T<<15&4294967295|T>>>17),T=I+(D^(S|~b))+P[5]+4237533241&4294967295,I=S+(T<<21&4294967295|T>>>11),T=b+(S^(I|~D))+P[12]+1700485571&4294967295,b=I+(T<<6&4294967295|T>>>26),T=D+(I^(b|~S))+P[3]+2399980690&4294967295,D=b+(T<<10&4294967295|T>>>22),T=S+(b^(D|~I))+P[10]+4293915773&4294967295,S=D+(T<<15&4294967295|T>>>17),T=I+(D^(S|~b))+P[1]+2240044497&4294967295,I=S+(T<<21&4294967295|T>>>11),T=b+(S^(I|~D))+P[8]+1873313359&4294967295,b=I+(T<<6&4294967295|T>>>26),T=D+(I^(b|~S))+P[15]+4264355552&4294967295,D=b+(T<<10&4294967295|T>>>22),T=S+(b^(D|~I))+P[6]+2734768916&4294967295,S=D+(T<<15&4294967295|T>>>17),T=I+(D^(S|~b))+P[13]+1309151649&4294967295,I=S+(T<<21&4294967295|T>>>11),T=b+(S^(I|~D))+P[4]+4149444226&4294967295,b=I+(T<<6&4294967295|T>>>26),T=D+(I^(b|~S))+P[11]+3174756917&4294967295,D=b+(T<<10&4294967295|T>>>22),T=S+(b^(D|~I))+P[2]+718787259&4294967295,S=D+(T<<15&4294967295|T>>>17),T=I+(D^(S|~b))+P[9]+3951481745&4294967295,E.g[0]=E.g[0]+b&4294967295,E.g[1]=E.g[1]+(S+(T<<21&4294967295|T>>>11))&4294967295,E.g[2]=E.g[2]+S&4294967295,E.g[3]=E.g[3]+D&4294967295}r.prototype.v=function(E,b){b===void 0&&(b=E.length);const I=b-this.blockSize,P=this.C;let S=this.h,D=0;for(;D<b;){if(S==0)for(;D<=I;)s(this,E,D),D+=this.blockSize;if(typeof E=="string"){for(;D<b;)if(P[S++]=E.charCodeAt(D++),S==this.blockSize){s(this,P),S=0;break}}else for(;D<b;)if(P[S++]=E[D++],S==this.blockSize){s(this,P),S=0;break}}this.h=S,this.o+=b},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var b=1;b<E.length-8;++b)E[b]=0;b=this.o*8;for(var I=E.length-8;I<E.length;++I)E[I]=b&255,b/=256;for(this.v(E),E=Array(16),b=0,I=0;I<4;++I)for(let P=0;P<32;P+=8)E[b++]=this.g[I]>>>P&255;return E};function o(E,b){var I=a;return Object.prototype.hasOwnProperty.call(I,E)?I[E]:I[E]=b(E)}function i(E,b){this.h=b;const I=[];let P=!0;for(let S=E.length-1;S>=0;S--){const D=E[S]|0;P&&D==b||(I[S]=D,P=!1)}this.g=I}var a={};function l(E){return-128<=E&&E<128?o(E,function(b){return new i([b|0],b<0?-1:0)}):new i([E|0],E<0?-1:0)}function c(E){if(isNaN(E)||!isFinite(E))return h;if(E<0)return v(c(-E));const b=[];let I=1;for(let P=0;E>=I;P++)b[P]=E/I|0,I*=4294967296;return new i(b,0)}function u(E,b){if(E.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(E.charAt(0)=="-")return v(u(E.substring(1),b));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=c(Math.pow(b,8));let P=h;for(let D=0;D<E.length;D+=8){var S=Math.min(8,E.length-D);const T=parseInt(E.substring(D,D+S),b);S<8?(S=c(Math.pow(b,S)),P=P.j(S).add(c(T))):(P=P.j(I),P=P.add(c(T)))}return P}var h=l(0),f=l(1),g=l(16777216);t=i.prototype,t.m=function(){if(w(this))return-v(this).m();let E=0,b=1;for(let I=0;I<this.g.length;I++){const P=this.i(I);E+=(P>=0?P:4294967296+P)*b,b*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(y(this))return"0";if(w(this))return"-"+v(this).toString(E);const b=c(Math.pow(E,6));var I=this;let P="";for(;;){const S=N(I,b).g;I=C(I,S.j(b));let D=((I.g.length>0?I.g[0]:I.h)>>>0).toString(E);if(I=S,y(I))return D+P;for(;D.length<6;)D="0"+D;P=D+P}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function y(E){if(E.h!=0)return!1;for(let b=0;b<E.g.length;b++)if(E.g[b]!=0)return!1;return!0}function w(E){return E.h==-1}t.l=function(E){return E=C(this,E),w(E)?-1:y(E)?0:1};function v(E){const b=E.g.length,I=[];for(let P=0;P<b;P++)I[P]=~E.g[P];return new i(I,~E.h).add(f)}t.abs=function(){return w(this)?v(this):this},t.add=function(E){const b=Math.max(this.g.length,E.g.length),I=[];let P=0;for(let S=0;S<=b;S++){let D=P+(this.i(S)&65535)+(E.i(S)&65535),T=(D>>>16)+(this.i(S)>>>16)+(E.i(S)>>>16);P=T>>>16,D&=65535,T&=65535,I[S]=T<<16|D}return new i(I,I[I.length-1]&-2147483648?-1:0)};function C(E,b){return E.add(v(b))}t.j=function(E){if(y(this)||y(E))return h;if(w(this))return w(E)?v(this).j(v(E)):v(v(this).j(E));if(w(E))return v(this.j(v(E)));if(this.l(g)<0&&E.l(g)<0)return c(this.m()*E.m());const b=this.g.length+E.g.length,I=[];for(var P=0;P<2*b;P++)I[P]=0;for(P=0;P<this.g.length;P++)for(let S=0;S<E.g.length;S++){const D=this.i(P)>>>16,T=this.i(P)&65535,j=E.i(S)>>>16,R=E.i(S)&65535;I[2*P+2*S]+=T*R,x(I,2*P+2*S),I[2*P+2*S+1]+=D*R,x(I,2*P+2*S+1),I[2*P+2*S+1]+=T*j,x(I,2*P+2*S+1),I[2*P+2*S+2]+=D*j,x(I,2*P+2*S+2)}for(E=0;E<b;E++)I[E]=I[2*E+1]<<16|I[2*E];for(E=b;E<2*b;E++)I[E]=0;return new i(I,0)};function x(E,b){for(;(E[b]&65535)!=E[b];)E[b+1]+=E[b]>>>16,E[b]&=65535,b++}function A(E,b){this.g=E,this.h=b}function N(E,b){if(y(b))throw Error("division by zero");if(y(E))return new A(h,h);if(w(E))return b=N(v(E),b),new A(v(b.g),v(b.h));if(w(b))return b=N(E,v(b)),new A(v(b.g),b.h);if(E.g.length>30){if(w(E)||w(b))throw Error("slowDivide_ only works with positive integers.");for(var I=f,P=b;P.l(E)<=0;)I=M(I),P=M(P);var S=k(I,1),D=k(P,1);for(P=k(P,2),I=k(I,2);!y(P);){var T=D.add(P);T.l(E)<=0&&(S=S.add(I),D=T),P=k(P,1),I=k(I,1)}return b=C(E,S.j(b)),new A(S,b)}for(S=h;E.l(b)>=0;){for(I=Math.max(1,Math.floor(E.m()/b.m())),P=Math.ceil(Math.log(I)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),D=c(I),T=D.j(b);w(T)||T.l(E)>0;)I-=P,D=c(I),T=D.j(b);y(D)&&(D=f),S=S.add(D),E=C(E,T)}return new A(S,E)}t.B=function(E){return N(this,E).h},t.and=function(E){const b=Math.max(this.g.length,E.g.length),I=[];for(let P=0;P<b;P++)I[P]=this.i(P)&E.i(P);return new i(I,this.h&E.h)},t.or=function(E){const b=Math.max(this.g.length,E.g.length),I=[];for(let P=0;P<b;P++)I[P]=this.i(P)|E.i(P);return new i(I,this.h|E.h)},t.xor=function(E){const b=Math.max(this.g.length,E.g.length),I=[];for(let P=0;P<b;P++)I[P]=this.i(P)^E.i(P);return new i(I,this.h^E.h)};function M(E){const b=E.g.length+1,I=[];for(let P=0;P<b;P++)I[P]=E.i(P)<<1|E.i(P-1)>>>31;return new i(I,E.h)}function k(E,b){const I=b>>5;b%=32;const P=E.g.length-I,S=[];for(let D=0;D<P;D++)S[D]=b>0?E.i(D+I)>>>b|E.i(D+I+1)<<32-b:E.i(D+I);return new i(S,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,nN=r,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.B,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=u,Na=i}).apply(typeof bA<"u"?bA:typeof self<"u"?self:typeof window<"u"?window:{});var Sg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var rN,Nf,sN,ry,dx,oN,iN,aN;(function(){var t,e=Object.defineProperty;function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sg=="object"&&Sg];for(var _=0;_<m.length;++_){var O=m[_];if(O&&O.Math==Math)return O}throw Error("Cannot find global object")}var r=n(this);function s(m,_){if(_)e:{var O=r;m=m.split(".");for(var z=0;z<m.length-1;z++){var se=m[z];if(!(se in O))break e;O=O[se]}m=m[m.length-1],z=O[m],_=_(z),_!=z&&_!=null&&e(O,m,{configurable:!0,writable:!0,value:_})}}s("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(m){return m||function(_){var O=[],z;for(z in _)Object.prototype.hasOwnProperty.call(_,z)&&O.push([z,_[z]]);return O}});var o=o||{},i=this||self;function a(m){var _=typeof m;return _=="object"&&m!=null||_=="function"}function l(m,_,O){return m.call.apply(m.bind,arguments)}function c(m,_,O){return c=l,c.apply(null,arguments)}function u(m,_){var O=Array.prototype.slice.call(arguments,1);return function(){var z=O.slice();return z.push.apply(z,arguments),m.apply(this,z)}}function h(m,_){function O(){}O.prototype=_.prototype,m.Z=_.prototype,m.prototype=new O,m.prototype.constructor=m,m.Ob=function(z,se,ae){for(var Te=Array(arguments.length-2),st=2;st<arguments.length;st++)Te[st-2]=arguments[st];return _.prototype[se].apply(z,Te)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function g(m){const _=m.length;if(_>0){const O=Array(_);for(let z=0;z<_;z++)O[z]=m[z];return O}return[]}function y(m,_){for(let z=1;z<arguments.length;z++){const se=arguments[z];var O=typeof se;if(O=O!="object"?O:se?Array.isArray(se)?"array":O:"null",O=="array"||O=="object"&&typeof se.length=="number"){O=m.length||0;const ae=se.length||0;m.length=O+ae;for(let Te=0;Te<ae;Te++)m[O+Te]=se[Te]}else m.push(se)}}class w{constructor(_,O){this.i=_,this.j=O,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function v(m){i.setTimeout(()=>{throw m},0)}function C(){var m=E;let _=null;return m.g&&(_=m.g,m.g=m.g.next,m.g||(m.h=null),_.next=null),_}class x{constructor(){this.h=this.g=null}add(_,O){const z=A.get();z.set(_,O),this.h?this.h.next=z:this.g=z,this.h=z}}var A=new w(()=>new N,m=>m.reset());class N{constructor(){this.next=this.g=this.h=null}set(_,O){this.h=_,this.g=O,this.next=null}reset(){this.next=this.g=this.h=null}}let M,k=!1,E=new x,b=()=>{const m=Promise.resolve(void 0);M=()=>{m.then(I)}};function I(){for(var m;m=C();){try{m.h.call(m.g)}catch(O){v(O)}var _=A;_.j(m),_.h<100&&(_.h++,m.next=_.g,_.g=m)}k=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(m,_){this.type=m,this.g=this.target=_,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!i.addEventListener||!Object.defineProperty)return!1;var m=!1,_=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const O=()=>{};i.addEventListener("test",O,_),i.removeEventListener("test",O,_)}catch{}return m})();function T(m){return/^[\s\xa0]*$/.test(m)}function j(m,_){S.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,_)}h(j,S),j.prototype.init=function(m,_){const O=this.type=m.type,z=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=_,_=m.relatedTarget,_||(O=="mouseover"?_=m.fromElement:O=="mouseout"&&(_=m.toElement)),this.relatedTarget=_,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&j.Z.h.call(this)},j.prototype.h=function(){j.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var R="closure_listenable_"+(Math.random()*1e6|0),V=0;function U(m,_,O,z,se){this.listener=m,this.proxy=null,this.src=_,this.type=O,this.capture=!!z,this.ha=se,this.key=++V,this.da=this.fa=!1}function F(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function $(m,_,O){for(const z in m)_.call(O,m[z],z,m)}function W(m,_){for(const O in m)_.call(void 0,m[O],O,m)}function Z(m){const _={};for(const O in m)_[O]=m[O];return _}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function le(m,_){let O,z;for(let se=1;se<arguments.length;se++){z=arguments[se];for(O in z)m[O]=z[O];for(let ae=0;ae<Y.length;ae++)O=Y[ae],Object.prototype.hasOwnProperty.call(z,O)&&(m[O]=z[O])}}function fe(m){this.src=m,this.g={},this.h=0}fe.prototype.add=function(m,_,O,z,se){const ae=m.toString();m=this.g[ae],m||(m=this.g[ae]=[],this.h++);const Te=Me(m,_,z,se);return Te>-1?(_=m[Te],O||(_.fa=!1)):(_=new U(_,this.src,ae,!!z,se),_.fa=O,m.push(_)),_};function we(m,_){const O=_.type;if(O in m.g){var z=m.g[O],se=Array.prototype.indexOf.call(z,_,void 0),ae;(ae=se>=0)&&Array.prototype.splice.call(z,se,1),ae&&(F(_),m.g[O].length==0&&(delete m.g[O],m.h--))}}function Me(m,_,O,z){for(let se=0;se<m.length;++se){const ae=m[se];if(!ae.da&&ae.listener==_&&ae.capture==!!O&&ae.ha==z)return se}return-1}var Ee="closure_lm_"+(Math.random()*1e6|0),X={};function ue(m,_,O,z,se){if(Array.isArray(_)){for(let ae=0;ae<_.length;ae++)ue(m,_[ae],O,z,se);return null}return O=ye(O),m&&m[R]?m.J(_,O,a(z)?!!z.capture:!1,se):re(m,_,O,!1,z,se)}function re(m,_,O,z,se,ae){if(!_)throw Error("Invalid event type");const Te=a(se)?!!se.capture:!!se;let st=ee(m);if(st||(m[Ee]=st=new fe(m)),O=st.add(_,O,z,Te,ae),O.proxy)return O;if(z=ie(),O.proxy=z,z.src=m,z.listener=O,m.addEventListener)D||(se=Te),se===void 0&&(se=!1),m.addEventListener(_.toString(),z,se);else if(m.attachEvent)m.attachEvent(me(_.toString()),z);else if(m.addListener&&m.removeListener)m.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return O}function ie(){function m(O){return _.call(m.src,m.listener,O)}const _=Q;return m}function Ce(m,_,O,z,se){if(Array.isArray(_))for(var ae=0;ae<_.length;ae++)Ce(m,_[ae],O,z,se);else z=a(z)?!!z.capture:!!z,O=ye(O),m&&m[R]?(m=m.i,ae=String(_).toString(),ae in m.g&&(_=m.g[ae],O=Me(_,O,z,se),O>-1&&(F(_[O]),Array.prototype.splice.call(_,O,1),_.length==0&&(delete m.g[ae],m.h--)))):m&&(m=ee(m))&&(_=m.g[_.toString()],m=-1,_&&(m=Me(_,O,z,se)),(O=m>-1?_[m]:null)&&K(O))}function K(m){if(typeof m!="number"&&m&&!m.da){var _=m.src;if(_&&_[R])we(_.i,m);else{var O=m.type,z=m.proxy;_.removeEventListener?_.removeEventListener(O,z,m.capture):_.detachEvent?_.detachEvent(me(O),z):_.addListener&&_.removeListener&&_.removeListener(z),(O=ee(_))?(we(O,m),O.h==0&&(O.src=null,_[Ee]=null)):F(m)}}}function me(m){return m in X?X[m]:X[m]="on"+m}function Q(m,_){if(m.da)m=!0;else{_=new j(_,this);const O=m.listener,z=m.ha||m.src;m.fa&&K(m),m=O.call(z,_)}return m}function ee(m){return m=m[Ee],m instanceof fe?m:null}var de="__closure_events_fn_"+(Math.random()*1e9>>>0);function ye(m){return typeof m=="function"?m:(m[de]||(m[de]=function(_){return m.handleEvent(_)}),m[de])}function pe(){P.call(this),this.i=new fe(this),this.M=this,this.G=null}h(pe,P),pe.prototype[R]=!0,pe.prototype.removeEventListener=function(m,_,O,z){Ce(this,m,_,O,z)};function _e(m,_){var O,z=m.G;if(z)for(O=[];z;z=z.G)O.push(z);if(m=m.M,z=_.type||_,typeof _=="string")_=new S(_,m);else if(_ instanceof S)_.target=_.target||m;else{var se=_;_=new S(z,m),le(_,se)}se=!0;let ae,Te;if(O)for(Te=O.length-1;Te>=0;Te--)ae=_.g=O[Te],se=qe(ae,z,!0,_)&&se;if(ae=_.g=m,se=qe(ae,z,!0,_)&&se,se=qe(ae,z,!1,_)&&se,O)for(Te=0;Te<O.length;Te++)ae=_.g=O[Te],se=qe(ae,z,!1,_)&&se}pe.prototype.N=function(){if(pe.Z.N.call(this),this.i){var m=this.i;for(const _ in m.g){const O=m.g[_];for(let z=0;z<O.length;z++)F(O[z]);delete m.g[_],m.h--}}this.G=null},pe.prototype.J=function(m,_,O,z){return this.i.add(String(m),_,!1,O,z)},pe.prototype.K=function(m,_,O,z){return this.i.add(String(m),_,!0,O,z)};function qe(m,_,O,z){if(_=m.i.g[String(_)],!_)return!0;_=_.concat();let se=!0;for(let ae=0;ae<_.length;++ae){const Te=_[ae];if(Te&&!Te.da&&Te.capture==O){const st=Te.listener,An=Te.ha||Te.src;Te.fa&&we(m.i,Te),se=st.call(An,z)!==!1&&se}}return se&&!z.defaultPrevented}function Ie(m,_){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=c(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:i.setTimeout(m,_||0)}function be(m){m.g=Ie(()=>{m.g=null,m.i&&(m.i=!1,be(m))},m.l);const _=m.h;m.h=null,m.m.apply(null,_)}class Se extends P{constructor(_,O){super(),this.m=_,this.l=O,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:be(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function De(m){P.call(this),this.h=m,this.g={}}h(De,P);var Ye=[];function gt(m){$(m.g,function(_,O){this.g.hasOwnProperty(O)&&K(_)},m),m.g={}}De.prototype.N=function(){De.Z.N.call(this),gt(this)},De.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var un=i.JSON.stringify,Tt=i.JSON.parse,_s=class{stringify(m){return i.JSON.stringify(m,void 0)}parse(m){return i.JSON.parse(m,void 0)}};function ll(){}function _n(){}var nn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function As(){S.call(this,"d")}h(As,S);function Ss(){S.call(this,"c")}h(Ss,S);var Ts={},Uh=null;function $o(){return Uh=Uh||new pe}Ts.Ia="serverreachability";function Hh(m){S.call(this,Ts.Ia,m)}h(Hh,S);function Oi(m){const _=$o();_e(_,new Hh(_))}Ts.STAT_EVENT="statevent";function vn(m,_){S.call(this,Ts.STAT_EVENT,m),this.stat=_}h(vn,S);function yt(m){const _=$o();_e(_,new vn(_,m))}Ts.Ja="timingevent";function $h(m,_){S.call(this,Ts.Ja,m),this.size=_}h($h,S);function cl(m,_){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){m()},_)}function ul(){this.g=!0}ul.prototype.ua=function(){this.g=!1};function E0(m,_,O,z,se,ae){m.info(function(){if(m.g)if(ae){var Te="",st=ae.split("&");for(let Lt=0;Lt<st.length;Lt++){var An=st[Lt].split("=");if(An.length>1){const Mn=An[0];An=An[1];const to=Mn.split("_");Te=to.length>=2&&to[1]=="type"?Te+(Mn+"="+An+"&"):Te+(Mn+"=redacted&")}}}else Te=null;else Te=ae;return"XMLHTTP REQ ("+z+") [attempt "+se+"]: "+_+`
`+O+`
`+Te})}function zh(m,_,O,z,se,ae,Te){m.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+se+"]: "+_+`
`+O+`
`+ae+" "+Te})}function zo(m,_,O,z){m.info(function(){return"XMLHTTP TEXT ("+_+"): "+I0(m,O)+(z?" "+z:"")})}function ag(m,_){m.info(function(){return"TIMEOUT: "+_})}ul.prototype.info=function(){};function I0(m,_){if(!m.g)return _;if(!_)return null;try{const ae=JSON.parse(_);if(ae){for(m=0;m<ae.length;m++)if(Array.isArray(ae[m])){var O=ae[m];if(!(O.length<2)){var z=O[1];if(Array.isArray(z)&&!(z.length<1)){var se=z[0];if(se!="noop"&&se!="stop"&&se!="close")for(let Te=1;Te<z.length;Te++)z[Te]=""}}}}return un(ae)}catch{return _}}var dl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Gh={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},lg;function Wh(){}h(Wh,ll),Wh.prototype.g=function(){return new XMLHttpRequest},lg=new Wh;function Go(m){return encodeURIComponent(String(m))}function cg(m){var _=1;m=m.split(":");const O=[];for(;_>0&&m.length;)O.push(m.shift()),_--;return m.length&&O.push(m.join(":")),O}function Li(m,_,O,z){this.j=m,this.i=_,this.l=O,this.S=z||1,this.V=new De(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new m_}function m_(){this.i=null,this.g="",this.h=!1}var p_={},_0={};function A0(m,_,O){m.M=1,m.A=dg(eo(_)),m.u=O,m.R=!0,g_(m,null)}function g_(m,_){m.F=Date.now(),ug(m),m.B=eo(m.A);var O=m.B,z=m.S;Array.isArray(z)||(z=[String(z)]),P_(O.i,"t",z),m.C=0,O=m.j.L,m.h=new m_,m.g=K_(m.j,O?_:null,!m.u),m.P>0&&(m.O=new Se(c(m.Y,m,m.g),m.P)),_=m.V,O=m.g,z=m.ba;var se="readystatechange";Array.isArray(se)||(se&&(Ye[0]=se.toString()),se=Ye);for(let ae=0;ae<se.length;ae++){const Te=ue(O,se[ae],z||_.handleEvent,!1,_.h||_);if(!Te)break;_.g[Te.key]=Te}_=m.J?Z(m.J):{},m.u?(m.v||(m.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,_)):(m.v="GET",m.g.ea(m.B,m.v,null,_)),Oi(),E0(m.i,m.v,m.B,m.l,m.S,m.u)}Li.prototype.ba=function(m){m=m.target;const _=this.O;_&&Vi(m)==3?_.j():this.Y(m)},Li.prototype.Y=function(m){try{if(m==this.g)e:{const st=Vi(this.g),An=this.g.ya(),Lt=this.g.ca();if(!(st<3)&&(st!=3||this.g&&(this.h.h||this.g.la()||L_(this.g)))){this.K||st!=4||An==7||(An==8||Lt<=0?Oi(3):Oi(2)),S0(this);var _=this.g.ca();this.X=_;var O=yB(this);if(this.o=_==200,zh(this.i,this.v,this.B,this.l,this.S,st,_),this.o){if(this.U&&!this.L){t:{if(this.g){var z,se=this.g;if((z=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(z)){var ae=z;break t}}ae=null}if(m=ae)zo(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,T0(this,m);else{this.o=!1,this.m=3,yt(12),hl(this),Kh(this);break e}}if(this.R){m=!0;let Mn;for(;!this.K&&this.C<O.length;)if(Mn=wB(this,O),Mn==_0){st==4&&(this.m=4,yt(14),m=!1),zo(this.i,this.l,null,"[Incomplete Response]");break}else if(Mn==p_){this.m=4,yt(15),zo(this.i,this.l,O,"[Invalid Chunk]"),m=!1;break}else zo(this.i,this.l,Mn,null),T0(this,Mn);if(y_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),st!=4||O.length!=0||this.h.h||(this.m=1,yt(16),m=!1),this.o=this.o&&m,!m)zo(this.i,this.l,O,"[Invalid Chunked Response]"),hl(this),Kh(this);else if(O.length>0&&!this.W){this.W=!0;var Te=this.j;Te.g==this&&Te.aa&&!Te.P&&(Te.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),L0(Te),Te.P=!0,yt(11))}}else zo(this.i,this.l,O,null),T0(this,O);st==4&&hl(this),this.o&&!this.K&&(st==4?$_(this.j,this):(this.o=!1,ug(this)))}else NB(this.g),_==400&&O.indexOf("Unknown SID")>0?(this.m=3,yt(12)):(this.m=0,yt(13)),hl(this),Kh(this)}}}catch{}finally{}};function yB(m){if(!y_(m))return m.g.la();const _=L_(m.g);if(_==="")return"";let O="";const z=_.length,se=Vi(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return hl(m),Kh(m),"";m.h.i=new i.TextDecoder}for(let ae=0;ae<z;ae++)m.h.h=!0,O+=m.h.i.decode(_[ae],{stream:!(se&&ae==z-1)});return _.length=0,m.h.g+=O,m.C=0,m.h.g}function y_(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function wB(m,_){var O=m.C,z=_.indexOf(`
`,O);return z==-1?_0:(O=Number(_.substring(O,z)),isNaN(O)?p_:(z+=1,z+O>_.length?_0:(_=_.slice(z,z+O),m.C=z+O,_)))}Li.prototype.cancel=function(){this.K=!0,hl(this)};function ug(m){m.T=Date.now()+m.H,w_(m,m.H)}function w_(m,_){if(m.D!=null)throw Error("WatchDog timer not null");m.D=cl(c(m.aa,m),_)}function S0(m){m.D&&(i.clearTimeout(m.D),m.D=null)}Li.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(ag(this.i,this.B),this.M!=2&&(Oi(),yt(17)),hl(this),this.m=2,Kh(this)):w_(this,this.T-m)};function Kh(m){m.j.I==0||m.K||$_(m.j,m)}function hl(m){S0(m);var _=m.O;_&&typeof _.dispose=="function"&&_.dispose(),m.O=null,gt(m.V),m.g&&(_=m.g,m.g=null,_.abort(),_.dispose())}function T0(m,_){try{var O=m.j;if(O.I!=0&&(O.g==m||P0(O.h,m))){if(!m.L&&P0(O.h,m)&&O.I==3){try{var z=O.Ba.g.parse(_)}catch{z=null}if(Array.isArray(z)&&z.length==3){var se=z;if(se[0]==0){e:if(!O.v){if(O.g)if(O.g.F+3e3<m.F)gg(O),mg(O);else break e;O0(O),yt(18)}}else O.xa=se[1],0<O.xa-O.K&&se[2]<37500&&O.F&&O.A==0&&!O.C&&(O.C=cl(c(O.Va,O),6e3));x_(O.h)<=1&&O.ta&&(O.ta=void 0)}else ml(O,11)}else if((m.L||O.g==m)&&gg(O),!T(_))for(se=O.Ba.g.parse(_),_=0;_<se.length;_++){let Lt=se[_];const Mn=Lt[0];if(!(Mn<=O.K))if(O.K=Mn,Lt=Lt[1],O.I==2)if(Lt[0]=="c"){O.M=Lt[1],O.ba=Lt[2];const to=Lt[3];to!=null&&(O.ka=to,O.j.info("VER="+O.ka));const pl=Lt[4];pl!=null&&(O.za=pl,O.j.info("SVER="+O.za));const Bi=Lt[5];Bi!=null&&typeof Bi=="number"&&Bi>0&&(z=1.5*Bi,O.O=z,O.j.info("backChannelRequestTimeoutMs_="+z)),z=O;const Ui=m.g;if(Ui){const wg=Ui.g?Ui.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wg){var ae=z.h;ae.g||wg.indexOf("spdy")==-1&&wg.indexOf("quic")==-1&&wg.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(k0(ae,ae.h),ae.h=null))}if(z.G){const F0=Ui.g?Ui.g.getResponseHeader("X-HTTP-Session-Id"):null;F0&&(z.wa=F0,zt(z.J,z.G,F0))}}O.I=3,O.l&&O.l.ra(),O.aa&&(O.T=Date.now()-m.F,O.j.info("Handshake RTT: "+O.T+"ms")),z=O;var Te=m;if(z.na=W_(z,z.L?z.ba:null,z.W),Te.L){C_(z.h,Te);var st=Te,An=z.O;An&&(st.H=An),st.D&&(S0(st),ug(st)),z.g=Te}else U_(z);O.i.length>0&&pg(O)}else Lt[0]!="stop"&&Lt[0]!="close"||ml(O,7);else O.I==3&&(Lt[0]=="stop"||Lt[0]=="close"?Lt[0]=="stop"?ml(O,7):M0(O):Lt[0]!="noop"&&O.l&&O.l.qa(Lt),O.A=0)}}Oi(4)}catch{}}var bB=class{constructor(m,_){this.g=m,this.map=_}};function b_(m){this.l=m||10,i.PerformanceNavigationTiming?(m=i.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function v_(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function x_(m){return m.h?1:m.g?m.g.size:0}function P0(m,_){return m.h?m.h==_:m.g?m.g.has(_):!1}function k0(m,_){m.g?m.g.add(_):m.h=_}function C_(m,_){m.h&&m.h==_?m.h=null:m.g&&m.g.has(_)&&m.g.delete(_)}b_.prototype.cancel=function(){if(this.i=E_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function E_(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let _=m.i;for(const O of m.g.values())_=_.concat(O.G);return _}return g(m.i)}var I_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vB(m,_){if(m){m=m.split("&");for(let O=0;O<m.length;O++){const z=m[O].indexOf("=");let se,ae=null;z>=0?(se=m[O].substring(0,z),ae=m[O].substring(z+1)):se=m[O],_(se,ae?decodeURIComponent(ae.replace(/\+/g," ")):"")}}}function Fi(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;m instanceof Fi?(this.l=m.l,qh(this,m.j),this.o=m.o,this.g=m.g,Qh(this,m.u),this.h=m.h,R0(this,k_(m.i)),this.m=m.m):m&&(_=String(m).match(I_))?(this.l=!1,qh(this,_[1]||"",!0),this.o=Yh(_[2]||""),this.g=Yh(_[3]||"",!0),Qh(this,_[4]),this.h=Yh(_[5]||"",!0),R0(this,_[6]||"",!0),this.m=Yh(_[7]||"")):(this.l=!1,this.i=new Xh(null,this.l))}Fi.prototype.toString=function(){const m=[];var _=this.j;_&&m.push(Jh(_,__,!0),":");var O=this.g;return(O||_=="file")&&(m.push("//"),(_=this.o)&&m.push(Jh(_,__,!0),"@"),m.push(Go(O).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),O=this.u,O!=null&&m.push(":",String(O))),(O=this.h)&&(this.g&&O.charAt(0)!="/"&&m.push("/"),m.push(Jh(O,O.charAt(0)=="/"?EB:CB,!0))),(O=this.i.toString())&&m.push("?",O),(O=this.m)&&m.push("#",Jh(O,_B)),m.join("")},Fi.prototype.resolve=function(m){const _=eo(this);let O=!!m.j;O?qh(_,m.j):O=!!m.o,O?_.o=m.o:O=!!m.g,O?_.g=m.g:O=m.u!=null;var z=m.h;if(O)Qh(_,m.u);else if(O=!!m.h){if(z.charAt(0)!="/")if(this.g&&!this.h)z="/"+z;else{var se=_.h.lastIndexOf("/");se!=-1&&(z=_.h.slice(0,se+1)+z)}if(se=z,se==".."||se==".")z="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){z=se.lastIndexOf("/",0)==0,se=se.split("/");const ae=[];for(let Te=0;Te<se.length;){const st=se[Te++];st=="."?z&&Te==se.length&&ae.push(""):st==".."?((ae.length>1||ae.length==1&&ae[0]!="")&&ae.pop(),z&&Te==se.length&&ae.push("")):(ae.push(st),z=!0)}z=ae.join("/")}else z=se}return O?_.h=z:O=m.i.toString()!=="",O?R0(_,k_(m.i)):O=!!m.m,O&&(_.m=m.m),_};function eo(m){return new Fi(m)}function qh(m,_,O){m.j=O?Yh(_,!0):_,m.j&&(m.j=m.j.replace(/:$/,""))}function Qh(m,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);m.u=_}else m.u=null}function R0(m,_,O){_ instanceof Xh?(m.i=_,AB(m.i,m.l)):(O||(_=Jh(_,IB)),m.i=new Xh(_,m.l))}function zt(m,_,O){m.i.set(_,O)}function dg(m){return zt(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Yh(m,_){return m?_?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Jh(m,_,O){return typeof m=="string"?(m=encodeURI(m).replace(_,xB),O&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function xB(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var __=/[#\/\?@]/g,CB=/[#\?:]/g,EB=/[#\?]/g,IB=/[#\?@]/g,_B=/#/g;function Xh(m,_){this.h=this.g=null,this.i=m||null,this.j=!!_}function fl(m){m.g||(m.g=new Map,m.h=0,m.i&&vB(m.i,function(_,O){m.add(decodeURIComponent(_.replace(/\+/g," ")),O)}))}t=Xh.prototype,t.add=function(m,_){fl(this),this.i=null,m=ru(this,m);let O=this.g.get(m);return O||this.g.set(m,O=[]),O.push(_),this.h+=1,this};function A_(m,_){fl(m),_=ru(m,_),m.g.has(_)&&(m.i=null,m.h-=m.g.get(_).length,m.g.delete(_))}function S_(m,_){return fl(m),_=ru(m,_),m.g.has(_)}t.forEach=function(m,_){fl(this),this.g.forEach(function(O,z){O.forEach(function(se){m.call(_,se,z,this)},this)},this)};function T_(m,_){fl(m);let O=[];if(typeof _=="string")S_(m,_)&&(O=O.concat(m.g.get(ru(m,_))));else for(m=Array.from(m.g.values()),_=0;_<m.length;_++)O=O.concat(m[_]);return O}t.set=function(m,_){return fl(this),this.i=null,m=ru(this,m),S_(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[_]),this.h+=1,this},t.get=function(m,_){return m?(m=T_(this,m),m.length>0?String(m[0]):_):_};function P_(m,_,O){A_(m,_),O.length>0&&(m.i=null,m.g.set(ru(m,_),g(O)),m.h+=O.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],_=Array.from(this.g.keys());for(let z=0;z<_.length;z++){var O=_[z];const se=Go(O);O=T_(this,O);for(let ae=0;ae<O.length;ae++){let Te=se;O[ae]!==""&&(Te+="="+Go(O[ae])),m.push(Te)}}return this.i=m.join("&")};function k_(m){const _=new Xh;return _.i=m.i,m.g&&(_.g=new Map(m.g),_.h=m.h),_}function ru(m,_){return _=String(_),m.j&&(_=_.toLowerCase()),_}function AB(m,_){_&&!m.j&&(fl(m),m.i=null,m.g.forEach(function(O,z){const se=z.toLowerCase();z!=se&&(A_(this,z),P_(this,se,O))},m)),m.j=_}function SB(m,_){const O=new ul;if(i.Image){const z=new Image;z.onload=u(ji,O,"TestLoadImage: loaded",!0,_,z),z.onerror=u(ji,O,"TestLoadImage: error",!1,_,z),z.onabort=u(ji,O,"TestLoadImage: abort",!1,_,z),z.ontimeout=u(ji,O,"TestLoadImage: timeout",!1,_,z),i.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=m}else _(!1)}function TB(m,_){const O=new ul,z=new AbortController,se=setTimeout(()=>{z.abort(),ji(O,"TestPingServer: timeout",!1,_)},1e4);fetch(m,{signal:z.signal}).then(ae=>{clearTimeout(se),ae.ok?ji(O,"TestPingServer: ok",!0,_):ji(O,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(se),ji(O,"TestPingServer: error",!1,_)})}function ji(m,_,O,z,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),z(O)}catch{}}function PB(){this.g=new _s}function N0(m){this.i=m.Sb||null,this.h=m.ab||!1}h(N0,ll),N0.prototype.g=function(){return new hg(this.i,this.h)};function hg(m,_){pe.call(this),this.H=m,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(hg,pe),t=hg.prototype,t.open=function(m,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=_,this.readyState=1,ef(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(_.body=m),(this.H||i).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Zh(this)),this.readyState=0},t.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,ef(this)),this.g&&(this.readyState=3,ef(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof i.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;R_(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function R_(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}t.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var _=m.value?m.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!m.done}))&&(this.response=this.responseText+=_)}m.done?Zh(this):ef(this),this.readyState==3&&R_(this)}},t.Oa=function(m){this.g&&(this.response=this.responseText=m,Zh(this))},t.Na=function(m){this.g&&(this.response=m,Zh(this))},t.ga=function(){this.g&&Zh(this)};function Zh(m){m.readyState=4,m.l=null,m.j=null,m.B=null,ef(m)}t.setRequestHeader=function(m,_){this.A.append(m,_)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],_=this.h.entries();for(var O=_.next();!O.done;)O=O.value,m.push(O[0]+": "+O[1]),O=_.next();return m.join(`\r
`)};function ef(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(hg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function N_(m){let _="";return $(m,function(O,z){_+=z,_+=":",_+=O,_+=`\r
`}),_}function D0(m,_,O){e:{for(z in O){var z=!1;break e}z=!0}z||(O=N_(O),typeof m=="string"?O!=null&&Go(O):zt(m,_,O))}function rn(m){pe.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(rn,pe);var kB=/^https?$/i,RB=["POST","PUT"];t=rn.prototype,t.Fa=function(m){this.H=m},t.ea=function(m,_,O,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);_=_?_.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():lg.g(),this.g.onreadystatechange=f(c(this.Ca,this));try{this.B=!0,this.g.open(_,String(m),!0),this.B=!1}catch(ae){D_(this,ae);return}if(m=O||"",O=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var se in z)O.set(se,z[se]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const ae of z.keys())O.set(ae,z.get(ae));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(O.keys()).find(ae=>ae.toLowerCase()=="content-type"),se=i.FormData&&m instanceof i.FormData,!(Array.prototype.indexOf.call(RB,_,void 0)>=0)||z||se||O.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,Te]of O)this.g.setRequestHeader(ae,Te);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(ae){D_(this,ae)}};function D_(m,_){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=_,m.o=5,M_(m),fg(m)}function M_(m){m.A||(m.A=!0,_e(m,"complete"),_e(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,_e(this,"complete"),_e(this,"abort"),fg(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fg(this,!0)),rn.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?O_(this):this.Xa())},t.Xa=function(){O_(this)};function O_(m){if(m.h&&typeof o<"u"){if(m.v&&Vi(m)==4)setTimeout(m.Ca.bind(m),0);else if(_e(m,"readystatechange"),Vi(m)==4){m.h=!1;try{const ae=m.ca();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var O;if(!(O=_)){var z;if(z=ae===0){let Te=String(m.D).match(I_)[1]||null;!Te&&i.self&&i.self.location&&(Te=i.self.location.protocol.slice(0,-1)),z=!kB.test(Te?Te.toLowerCase():"")}O=z}if(O)_e(m,"complete"),_e(m,"success");else{m.o=6;try{var se=Vi(m)>2?m.g.statusText:""}catch{se=""}m.l=se+" ["+m.ca()+"]",M_(m)}}finally{fg(m)}}}}function fg(m,_){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const O=m.g;m.g=null,_||_e(m,"ready");try{O.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Vi(m){return m.g?m.g.readyState:0}t.ca=function(){try{return Vi(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(m){if(this.g){var _=this.g.responseText;return m&&_.indexOf(m)==0&&(_=_.substring(m.length)),Tt(_)}};function L_(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function NB(m){const _={};m=(m.g&&Vi(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<m.length;z++){if(T(m[z]))continue;var O=cg(m[z]);const se=O[0];if(O=O[1],typeof O!="string")continue;O=O.trim();const ae=_[se]||[];_[se]=ae,ae.push(O)}W(_,function(z){return z.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function tf(m,_,O){return O&&O.internalChannelParams&&O.internalChannelParams[m]||_}function F_(m){this.za=0,this.i=[],this.j=new ul,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tf("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tf("baseRetryDelayMs",5e3,m),this.Za=tf("retryDelaySeedMs",1e4,m),this.Ta=tf("forwardChannelMaxRetries",2,m),this.va=tf("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new b_(m&&m.concurrentRequestLimit),this.Ba=new PB,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=F_.prototype,t.ka=8,t.I=1,t.connect=function(m,_,O,z){yt(0),this.W=m,this.H=_||{},O&&z!==void 0&&(this.H.OSID=O,this.H.OAID=z),this.F=this.X,this.J=W_(this,null,this.W),pg(this)};function M0(m){if(j_(m),m.I==3){var _=m.V++,O=eo(m.J);if(zt(O,"SID",m.M),zt(O,"RID",_),zt(O,"TYPE","terminate"),nf(m,O),_=new Li(m,m.j,_),_.M=2,_.A=dg(eo(O)),O=!1,i.navigator&&i.navigator.sendBeacon)try{O=i.navigator.sendBeacon(_.A.toString(),"")}catch{}!O&&i.Image&&(new Image().src=_.A,O=!0),O||(_.g=K_(_.j,null),_.g.ea(_.A)),_.F=Date.now(),ug(_)}G_(m)}function mg(m){m.g&&(L0(m),m.g.cancel(),m.g=null)}function j_(m){mg(m),m.v&&(i.clearTimeout(m.v),m.v=null),gg(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&i.clearTimeout(m.m),m.m=null)}function pg(m){if(!v_(m.h)&&!m.m){m.m=!0;var _=m.Ea;M||b(),k||(M(),k=!0),E.add(_,m),m.D=0}}function DB(m,_){return x_(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=_.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=cl(c(m.Ea,m,_),z_(m,m.D)),m.D++,!0)}t.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const se=new Li(this,this.j,m);let ae=this.o;if(this.U&&(ae?(ae=Z(ae),le(ae,this.U)):ae=this.U),this.u!==null||this.R||(se.J=ae,ae=null),this.S)e:{for(var _=0,O=0;O<this.i.length;O++){t:{var z=this.i[O];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(_+=z,_>4096){_=O;break e}if(_===4096||O===this.i.length-1){_=O+1;break e}}_=1e3}else _=1e3;_=B_(this,se,_),O=eo(this.J),zt(O,"RID",m),zt(O,"CVER",22),this.G&&zt(O,"X-HTTP-Session-Id",this.G),nf(this,O),ae&&(this.R?_="headers="+Go(N_(ae))+"&"+_:this.u&&D0(O,this.u,ae)),k0(this.h,se),this.Ra&&zt(O,"TYPE","init"),this.S?(zt(O,"$req",_),zt(O,"SID","null"),se.U=!0,A0(se,O,null)):A0(se,O,_),this.I=2}}else this.I==3&&(m?V_(this,m):this.i.length==0||v_(this.h)||V_(this))};function V_(m,_){var O;_?O=_.l:O=m.V++;const z=eo(m.J);zt(z,"SID",m.M),zt(z,"RID",O),zt(z,"AID",m.K),nf(m,z),m.u&&m.o&&D0(z,m.u,m.o),O=new Li(m,m.j,O,m.D+1),m.u===null&&(O.J=m.o),_&&(m.i=_.G.concat(m.i)),_=B_(m,O,1e3),O.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),k0(m.h,O),A0(O,z,_)}function nf(m,_){m.H&&$(m.H,function(O,z){zt(_,z,O)}),m.l&&$({},function(O,z){zt(_,z,O)})}function B_(m,_,O){O=Math.min(m.i.length,O);const z=m.l?c(m.l.Ka,m.l,m):null;e:{var se=m.i;let st=-1;for(;;){const An=["count="+O];st==-1?O>0?(st=se[0].g,An.push("ofs="+st)):st=0:An.push("ofs="+st);let Lt=!0;for(let Mn=0;Mn<O;Mn++){var ae=se[Mn].g;const to=se[Mn].map;if(ae-=st,ae<0)st=Math.max(0,se[Mn].g-100),Lt=!1;else try{ae="req"+ae+"_"||"";try{var Te=to instanceof Map?to:Object.entries(to);for(const[pl,Bi]of Te){let Ui=Bi;a(Bi)&&(Ui=un(Bi)),An.push(ae+pl+"="+encodeURIComponent(Ui))}}catch(pl){throw An.push(ae+"type="+encodeURIComponent("_badmap")),pl}}catch{z&&z(to)}}if(Lt){Te=An.join("&");break e}}Te=void 0}return m=m.i.splice(0,O),_.G=m,Te}function U_(m){if(!m.g&&!m.v){m.Y=1;var _=m.Da;M||b(),k||(M(),k=!0),E.add(_,m),m.A=0}}function O0(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=cl(c(m.Da,m),z_(m,m.A)),m.A++,!0)}t.Da=function(){if(this.v=null,H_(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=cl(c(this.Wa,this),m)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,yt(10),mg(this),H_(this))};function L0(m){m.B!=null&&(i.clearTimeout(m.B),m.B=null)}function H_(m){m.g=new Li(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var _=eo(m.na);zt(_,"RID","rpc"),zt(_,"SID",m.M),zt(_,"AID",m.K),zt(_,"CI",m.F?"0":"1"),!m.F&&m.ia&&zt(_,"TO",m.ia),zt(_,"TYPE","xmlhttp"),nf(m,_),m.u&&m.o&&D0(_,m.u,m.o),m.O&&(m.g.H=m.O);var O=m.g;m=m.ba,O.M=1,O.A=dg(eo(_)),O.u=null,O.R=!0,g_(O,m)}t.Va=function(){this.C!=null&&(this.C=null,mg(this),O0(this),yt(19))};function gg(m){m.C!=null&&(i.clearTimeout(m.C),m.C=null)}function $_(m,_){var O=null;if(m.g==_){gg(m),L0(m),m.g=null;var z=2}else if(P0(m.h,_))O=_.G,C_(m.h,_),z=1;else return;if(m.I!=0){if(_.o)if(z==1){O=_.u?_.u.length:0,_=Date.now()-_.F;var se=m.D;z=$o(),_e(z,new $h(z,O)),pg(m)}else U_(m);else if(se=_.m,se==3||se==0&&_.X>0||!(z==1&&DB(m,_)||z==2&&O0(m)))switch(O&&O.length>0&&(_=m.h,_.i=_.i.concat(O)),se){case 1:ml(m,5);break;case 4:ml(m,10);break;case 3:ml(m,6);break;default:ml(m,2)}}}function z_(m,_){let O=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(O*=2),O*_}function ml(m,_){if(m.j.info("Error code "+_),_==2){var O=c(m.bb,m),z=m.Ua;const se=!z;z=new Fi(z||"//www.google.com/images/cleardot.gif"),i.location&&i.location.protocol=="http"||qh(z,"https"),dg(z),se?SB(z.toString(),O):TB(z.toString(),O)}else yt(2);m.I=0,m.l&&m.l.pa(_),G_(m),j_(m)}t.bb=function(m){m?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function G_(m){if(m.I=0,m.ja=[],m.l){const _=E_(m.h);(_.length!=0||m.i.length!=0)&&(y(m.ja,_),y(m.ja,m.i),m.h.i.length=0,g(m.i),m.i.length=0),m.l.oa()}}function W_(m,_,O){var z=O instanceof Fi?eo(O):new Fi(O);if(z.g!="")_&&(z.g=_+"."+z.g),Qh(z,z.u);else{var se=i.location;z=se.protocol,_=_?_+"."+se.hostname:se.hostname,se=+se.port;const ae=new Fi(null);z&&qh(ae,z),_&&(ae.g=_),se&&Qh(ae,se),O&&(ae.h=O),z=ae}return O=m.G,_=m.wa,O&&_&&zt(z,O,_),zt(z,"VER",m.ka),nf(m,z),z}function K_(m,_,O){if(_&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=m.Aa&&!m.ma?new rn(new N0({ab:O})):new rn(m.ma),_.Fa(m.L),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function q_(){}t=q_.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function yg(){}yg.prototype.g=function(m,_){return new Br(m,_)};function Br(m,_){pe.call(this),this.g=new F_(_),this.l=m,this.h=_&&_.messageUrlParams||null,m=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(m?m["X-WebChannel-Content-Type"]=_.messageContentType:m={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(m?m["X-WebChannel-Client-Profile"]=_.sa:m={"X-WebChannel-Client-Profile":_.sa}),this.g.U=m,(m=_&&_.Qb)&&!T(m)&&(this.g.u=m),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!T(_)&&(this.g.G=_,m=this.h,m!==null&&_ in m&&(m=this.h,_ in m&&delete m[_])),this.j=new su(this)}h(Br,pe),Br.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Br.prototype.close=function(){M0(this.g)},Br.prototype.o=function(m){var _=this.g;if(typeof m=="string"){var O={};O.__data__=m,m=O}else this.v&&(O={},O.__data__=un(m),m=O);_.i.push(new bB(_.Ya++,m)),_.I==3&&pg(_)},Br.prototype.N=function(){this.g.l=null,delete this.j,M0(this.g),delete this.g,Br.Z.N.call(this)};function Q_(m){As.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var _=m.__sm__;if(_){e:{for(const O in _){m=O;break e}m=void 0}(this.i=m)&&(m=this.i,_=_!==null&&m in _?_[m]:void 0),this.data=_}else this.data=m}h(Q_,As);function Y_(){Ss.call(this),this.status=1}h(Y_,Ss);function su(m){this.g=m}h(su,q_),su.prototype.ra=function(){_e(this.g,"a")},su.prototype.qa=function(m){_e(this.g,new Q_(m))},su.prototype.pa=function(m){_e(this.g,new Y_)},su.prototype.oa=function(){_e(this.g,"b")},yg.prototype.createWebChannel=yg.prototype.g,Br.prototype.send=Br.prototype.o,Br.prototype.open=Br.prototype.m,Br.prototype.close=Br.prototype.close,aN=function(){return new yg},iN=function(){return $o()},oN=Ts,dx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},dl.NO_ERROR=0,dl.TIMEOUT=8,dl.HTTP_ERROR=6,ry=dl,Gh.COMPLETE="complete",sN=Gh,_n.EventType=nn,nn.OPEN="a",nn.CLOSE="b",nn.ERROR="c",nn.MESSAGE="d",pe.prototype.listen=pe.prototype.J,Nf=_n,rn.prototype.listenOnce=rn.prototype.K,rn.prototype.getLastError=rn.prototype.Ha,rn.prototype.getLastErrorCode=rn.prototype.ya,rn.prototype.getStatus=rn.prototype.ca,rn.prototype.getResponseJson=rn.prototype.La,rn.prototype.getResponseText=rn.prototype.la,rn.prototype.send=rn.prototype.ea,rn.prototype.setWithCredentials=rn.prototype.Fa,rN=rn}).apply(typeof Sg<"u"?Sg:typeof self<"u"?self:typeof window<"u"?window:{});const vA="@firebase/firestore",xA="4.9.2";let ir=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ir.UNAUTHENTICATED=new ir(null),ir.GOOGLE_CREDENTIALS=new ir("google-credentials-uid"),ir.FIRST_PARTY=new ir("first-party-uid"),ir.MOCK_USER=new ir("mock-user");let xh="12.3.0";const Sc=new f1("@firebase/firestore");function xu(){return Sc.logLevel}function ve(t,...e){if(Sc.logLevel<=bt.DEBUG){const n=e.map(p1);Sc.debug(`Firestore (${xh}): ${t}`,...n)}}function mn(t,...e){if(Sc.logLevel<=bt.ERROR){const n=e.map(p1);Sc.error(`Firestore (${xh}): ${t}`,...n)}}function Cm(t,...e){if(Sc.logLevel<=bt.WARN){const n=e.map(p1);Sc.warn(`Firestore (${xh}): ${t}`,...n)}}function p1(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Fe(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,lN(t,r,n)}function lN(t,e,n){let r=`FIRESTORE (${xh}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw mn(r),new Error(r)}function Ke(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||lN(e,s,r)}function Ge(t,e){return t}const he={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ae extends Uo{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class So{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class pU{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gU{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(ir.UNAUTHENTICATED)))}shutdown(){}}class yU{constructor(e){this.t=e,this.currentUser=ir.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ke(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let o=new So;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new So,e.enqueueRetryable((()=>s(this.currentUser)))};const i=()=>{const l=o;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},a=l=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit((l=>a(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new So)}}),0),i()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ke(typeof r.accessToken=="string",31837,{l:r}),new pU(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ke(e===null||typeof e=="string",2055,{h:e}),new ir(e)}}class wU{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=ir.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class bU{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new wU(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(ir.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class CA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vU{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ke(this.o===void 0,3512);const r=o=>{o.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const i=o.token!==this.m;return this.m=o.token,ve("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>r(o)))};const s=o=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new CA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(Ke(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new CA(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function xU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class g1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=xU(40);for(let o=0;o<s.length;++o)r.length<20&&s[o]<n&&(r+=e.charAt(s[o]%62))}return r}}function et(t,e){return t<e?-1:t>e?1:0}function hx(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),o=e.charAt(r);if(s!==o)return J0(s)===J0(o)?et(s,o):J0(s)?1:-1}return et(t.length,e.length)}const CU=55296,EU=57343;function J0(t){const e=t.charCodeAt(0);return e>=CU&&e<=EU}function Ud(t,e,n){return t.length===e.length&&t.every(((r,s)=>n(r,e[s])))}function cN(t){return t+"\0"}const EA="__name__";class oo{constructor(e,n,r){n===void 0?n=0:n>e.length&&Fe(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Fe(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return oo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof oo?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const o=oo.compareSegments(e.get(s),n.get(s));if(o!==0)return o}return et(e.length,n.length)}static compareSegments(e,n){const r=oo.isNumericId(e),s=oo.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?oo.extractNumericId(e).compare(oo.extractNumericId(n)):hx(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Na.fromString(e.substring(4,e.length-2))}}class _t extends oo{construct(e,n,r){return new _t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ae(he.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((s=>s.length>0)))}return new _t(n)}static emptyPath(){return new _t([])}}const IU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zt extends oo{construct(e,n,r){return new Zt(e,n,r)}static isValidIdentifier(e){return IU.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===EA}static keyField(){return new Zt([EA])}static fromServerFormat(e){const n=[];let r="",s=0;const o=()=>{if(r.length===0)throw new Ae(he.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let i=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Ae(he.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ae(he.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(i=!i,s++):a!=="."||i?(r+=a,s++):(o(),s++)}if(o(),i)throw new Ae(he.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Zt(n)}static emptyPath(){return new Zt([])}}class Pe{constructor(e){this.path=e}static fromPath(e){return new Pe(_t.fromString(e))}static fromName(e){return new Pe(_t.fromString(e).popFirst(5))}static empty(){return new Pe(_t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&_t.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return _t.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Pe(new _t(e.slice()))}}function uN(t,e,n){if(!n)throw new Ae(he.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function _U(t,e,n,r){if(e===!0&&r===!0)throw new Ae(he.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function IA(t){if(!Pe.isDocumentKey(t))throw new Ae(he.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function _A(t){if(Pe.isDocumentKey(t))throw new Ae(he.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function dN(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function mb(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Fe(12329,{type:typeof t})}function Lr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ae(he.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=mb(t);throw new Ae(he.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function In(t,e){const n={typeString:t};return e&&(n.value=e),n}function xp(t,e){if(!dN(t))throw new Ae(he.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const i=t[r];if(s&&typeof i!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(o!==void 0&&i!==o.value){n=`Expected '${r}' field to equal '${o.value}'`;break}}if(n)throw new Ae(he.INVALID_ARGUMENT,n);return!0}const AA=-62135596800,SA=1e6;class Nt{static now(){return Nt.fromMillis(Date.now())}static fromDate(e){return Nt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*SA);return new Nt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Ae(he.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ae(he.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<AA)throw new Ae(he.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ae(he.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/SA}_compareTo(e){return this.seconds===e.seconds?et(this.nanoseconds,e.nanoseconds):et(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Nt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xp(e,Nt._jsonSchema))return new Nt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-AA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Nt._jsonSchemaVersion="firestore/timestamp/1.0",Nt._jsonSchema={type:In("string",Nt._jsonSchemaVersion),seconds:In("number"),nanoseconds:In("number")};class Qe{static fromTimestamp(e){return new Qe(e)}static min(){return new Qe(new Nt(0,0))}static max(){return new Qe(new Nt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Hd=-1;class Hy{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function fx(t){return t.fields.find((e=>e.kind===2))}function Il(t){return t.fields.filter((e=>e.kind!==2))}Hy.UNKNOWN_ID=-1;class sy{constructor(e,n){this.fieldPath=e,this.kind=n}}class Em{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Em(0,es.min())}}function hN(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Qe.fromTimestamp(r===1e9?new Nt(n+1,0):new Nt(n,r));return new es(s,Pe.empty(),e)}function fN(t){return new es(t.readTime,t.key,Hd)}class es{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new es(Qe.min(),Pe.empty(),Hd)}static max(){return new es(Qe.max(),Pe.empty(),Hd)}}function y1(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Pe.comparator(t.documentKey,e.documentKey),n!==0?n:et(t.largestBatchId,e.largestBatchId))}const mN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Xa(t){if(t.code!==he.FAILED_PRECONDITION||t.message!==mN)throw t;ve("LocalStore","Unexpectedly lost primary lease")}class te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Fe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new te(((r,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,s)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,s)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof te?n:te.resolve(n)}catch(n){return te.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):te.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):te.reject(n)}static resolve(e){return new te(((n,r)=>{n(e)}))}static reject(e){return new te(((n,r)=>{r(e)}))}static waitFor(e){return new te(((n,r)=>{let s=0,o=0,i=!1;e.forEach((a=>{++s,a.next((()=>{++o,i&&o===s&&n()}),(l=>r(l)))})),i=!0,o===s&&n()}))}static or(e){let n=te.resolve(!1);for(const r of e)n=n.next((s=>s?te.resolve(s):r()));return n}static forEach(e,n){const r=[];return e.forEach(((s,o)=>{r.push(n.call(this,s,o))})),this.waitFor(r)}static mapArray(e,n){return new te(((r,s)=>{const o=e.length,i=new Array(o);let a=0;for(let l=0;l<o;l++){const c=l;n(e[c]).next((u=>{i[c]=u,++a,a===o&&r(i)}),(u=>s(u)))}}))}static doWhile(e,n){return new te(((r,s)=>{const o=()=>{e()===!0?n().next((()=>{o()}),s):r()};o()}))}}const qr="SimpleDb";class pb{static open(e,n,r,s){try{return new pb(n,e.transaction(s,r))}catch(o){throw new Jf(n,o)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new So,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Jf(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=w1(r.target.error);this.S.reject(new Jf(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ve(qr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new SU(n)}}class Da{static delete(e){return ve(qr,"Removing database:",e),Pl(U2().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Q2())return!1;if(Da.F())return!0;const e=Rn(),n=Da.M(e),r=0<n&&n<10,s=gN(e),o=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Da.M(Rn())===12.2&&mn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ve(qr,"Opening database:",this.name),this.db=await new Promise(((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=o=>{const i=o.target.result;n(i)},s.onblocked=()=>{r(new Jf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const i=o.target.error;i.name==="VersionError"?r(new Ae(he.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):i.name==="InvalidStateError"?r(new Ae(he.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):r(new Jf(e,i))},s.onupgradeneeded=o=>{ve(qr,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const i=o.target.result;this.N.k(i,s.transaction,o.oldVersion,this.version).next((()=>{ve(qr,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const o=n==="readonly";let i=0;for(;;){++i;try{this.db=await this.L(e);const a=pb.open(this.db,e,o?"readonly":"readwrite",r),l=s(a).next((c=>(a.C(),c))).catch((c=>(a.abort(c),te.reject(c)))).toPromise();return l.catch((()=>{})),await a.D,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&i<3;if(ve(qr,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function gN(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class AU{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Pl(this.U.delete())}}class Jf extends Ae{constructor(e,n){super(he.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Za(t){return t.name==="IndexedDbTransactionError"}class SU{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ve(qr,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(ve(qr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Pl(r)}add(e){return ve(qr,"ADD",this.store.name,e,e),Pl(this.store.add(e))}get(e){return Pl(this.store.get(e)).next((n=>(n===void 0&&(n=null),ve(qr,"GET",this.store.name,e,n),n)))}delete(e){return ve(qr,"DELETE",this.store.name,e),Pl(this.store.delete(e))}count(){return ve(qr,"COUNT",this.store.name),Pl(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const o=s.getAll(r.range);return new te(((i,a)=>{o.onerror=l=>{a(l.target.error)},o.onsuccess=l=>{i(l.target.result)}}))}{const o=this.cursor(r),i=[];return this.H(o,((a,l)=>{i.push(l)})).next((()=>i))}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new te(((s,o)=>{r.onerror=i=>{o(i.target.error)},r.onsuccess=i=>{s(i.target.result)}}))}Z(e,n){ve(qr,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,((o,i,a)=>a.delete()))}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new te(((r,s)=>{n.onerror=o=>{const i=w1(o.target.error);s(i)},n.onsuccess=o=>{const i=o.target.result;i?e(i.primaryKey,i.value).next((a=>{a?i.continue():r()})):r()}}))}H(e,n){const r=[];return new te(((s,o)=>{e.onerror=i=>{o(i.target.error)},e.onsuccess=i=>{const a=i.target.result;if(!a)return void s();const l=new AU(a),c=n(a.primaryKey,a.value,l);if(c instanceof te){const u=c.catch((h=>(l.done(),te.reject(h))));r.push(u)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}})).next((()=>te.waitFor(r)))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Pl(t){return new te(((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=w1(r.target.error);n(s)}}))}let TA=!1;function w1(t){const e=Da.M(Rn());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Ae("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return TA||(TA=!0,setTimeout((()=>{throw r}),0)),r}}return t}const Xf="IndexBackfiller";class TU{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ve(Xf,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const n=await this.ne.ie();ve(Xf,`Documents written: ${n}`)}catch(n){Za(n)?ve(Xf,"Ignoring IndexedDB error during index backfill: ",n):await Xa(n)}await this.re(6e4)}))}}class PU{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(n=>this.se(n,e)))}se(e,n){const r=new Set;let s=n,o=!0;return te.doWhile((()=>o===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((i=>{if(i!==null&&!r.has(i))return ve(Xf,`Processing collection: ${i}`),this.oe(e,i,s).next((a=>{s-=a,r.add(i)}));o=!1})))).next((()=>n-s))}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next((s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next((o=>{const i=o.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this._e(s,o))).next((a=>(ve(Xf,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a)))).next((()=>i.size))}))))}_e(e,n){let r=e;return n.changes.forEach(((s,o)=>{const i=fN(o);y1(i,r)>0&&(r=i)})),new es(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}class Dr{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Dr.ce=-1;const uc=-1;function gb(t){return t==null}function Im(t){return t===0&&1/t==-1/0}function yN(t){return typeof t=="number"&&Number.isInteger(t)&&!Im(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const $y="";function ur(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=PA(e)),e=kU(t.get(n),e);return PA(e)}function kU(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const o=t.charAt(s);switch(o){case"\0":n+="";break;case $y:n+="";break;default:n+=o}}return n}function PA(t){return t+$y+""}function Co(t){const e=t.length;if(Ke(e>=2,64408,{path:t}),e===2)return Ke(t.charAt(0)===$y&&t.charAt(1)==="",56145,{path:t}),_t.emptyPath();const n=e-2,r=[];let s="";for(let o=0;o<e;){const i=t.indexOf($y,o);switch((i<0||i>n)&&Fe(50515,{path:t}),t.charAt(i+1)){case"":const a=t.substring(o,i);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(o,i),s+="\0";break;case"":s+=t.substring(o,i+1);break;default:Fe(61167,{path:t})}o=i+2}return new _t(r)}const _l="remoteDocuments",Cp="owner",ou="owner",_m="mutationQueues",RU="userId",Bs="mutations",kA="batchId",jl="userMutationsIndex",RA=["userId","batchId"];function oy(t,e){return[t,ur(e)]}function wN(t,e,n){return[t,ur(e),n]}const NU={},$d="documentMutations",zy="remoteDocumentsV14",DU=["prefixPath","collectionGroup","readTime","documentId"],iy="documentKeyIndex",MU=["prefixPath","collectionGroup","documentId"],bN="collectionGroupIndex",OU=["collectionGroup","readTime","prefixPath","documentId"],Am="remoteDocumentGlobal",mx="remoteDocumentGlobalKey",zd="targets",vN="queryTargetsIndex",LU=["canonicalId","targetId"],Gd="targetDocuments",FU=["targetId","path"],b1="documentTargetsIndex",jU=["path","targetId"],Gy="targetGlobalKey",dc="targetGlobal",Sm="collectionParents",VU=["collectionId","parent"],Wd="clientMetadata",BU="clientId",yb="bundles",UU="bundleId",wb="namedQueries",HU="name",v1="indexConfiguration",$U="indexId",px="collectionGroupIndex",zU="collectionGroup",Zf="indexState",GU=["indexId","uid"],xN="sequenceNumberIndex",WU=["uid","sequenceNumber"],em="indexEntries",KU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],CN="documentKeyIndex",qU=["indexId","uid","orderedDocumentKey"],bb="documentOverlays",QU=["userId","collectionPath","documentId"],gx="collectionPathOverlayIndex",YU=["userId","collectionPath","largestBatchId"],EN="collectionGroupOverlayIndex",JU=["userId","collectionGroup","largestBatchId"],x1="globals",XU="name",IN=[_m,Bs,$d,_l,zd,Cp,dc,Gd,Wd,Am,Sm,yb,wb],ZU=[...IN,bb],_N=[_m,Bs,$d,zy,zd,Cp,dc,Gd,Wd,Am,Sm,yb,wb,bb],AN=_N,C1=[...AN,v1,Zf,em],e6=C1,SN=[...C1,x1],t6=SN;class yx extends pN{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Dn(t,e){const n=Ge(t);return Da.O(n.le,e)}function NA(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function el(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function TN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class $t{constructor(e,n){this.comparator=e,this.root=n||Gn.EMPTY}insert(e,n){return new $t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Gn.BLACK,null,null))}remove(e){return new $t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tg(this.root,e,this.comparator,!0)}}class Tg{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gn{constructor(e,n,r,s,o){this.key=e,this.value=n,this.color=r??Gn.RED,this.left=s??Gn.EMPTY,this.right=o??Gn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,o){return new Gn(e??this.key,n??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const o=r(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,n,r),null):o===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Gn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Gn.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Fe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Fe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Fe(27949);return e+(this.isRed()?0:1)}}Gn.EMPTY=null,Gn.RED=!0,Gn.BLACK=!1;Gn.EMPTY=new class{constructor(){this.size=0}get key(){throw Fe(57766)}get value(){throw Fe(16141)}get color(){throw Fe(16727)}get left(){throw Fe(29726)}get right(){throw Fe(36894)}copy(e,n,r,s,o){return this}insert(e,n,r){return new Gn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Mt{constructor(e){this.comparator=e,this.data=new $t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new DA(this.data.getIterator())}getIteratorFrom(e){return new DA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof Mt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=r.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Mt(this.comparator);return n.data=e,n}}class DA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function iu(t){return t.hasNext()?t.getNext():void 0}class Mr{constructor(e){this.fields=e,e.sort(Zt.comparator)}static empty(){return new Mr([])}unionWith(e){let n=new Mt(Zt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Mr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ud(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}class PN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class yn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new PN("Invalid base64 string: "+o):o}})(e);return new yn(n)}static fromUint8Array(e){const n=(function(s){let o="";for(let i=0;i<s.length;++i)o+=String.fromCharCode(s[i]);return o})(e);return new yn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return et(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yn.EMPTY_BYTE_STRING=new yn("");const n6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ci(t){if(Ke(!!t,39018),typeof t=="string"){let e=0;const n=n6.exec(t);if(Ke(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qt(t.seconds),nanos:Qt(t.nanos)}}function Qt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ei(t){return typeof t=="string"?yn.fromBase64String(t):yn.fromUint8Array(t)}const kN="server_timestamp",RN="__type__",NN="__previous_value__",DN="__local_write_time__";function E1(t){return(t?.mapValue?.fields||{})[RN]?.stringValue===kN}function vb(t){const e=t.mapValue.fields[NN];return E1(e)?vb(e):e}function Tm(t){const e=Ci(t.mapValue.fields[DN].timestampValue);return new Nt(e.seconds,e.nanos)}class r6{constructor(e,n,r,s,o,i,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=o,this.forceLongPolling=i,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const Wy="(default)";class Tc{constructor(e,n){this.projectId=e,this.database=n||Wy}static empty(){return new Tc("","")}get isDefaultDatabase(){return this.database===Wy}isEqual(e){return e instanceof Tc&&e.projectId===this.projectId&&e.database===this.database}}const I1="__type__",MN="__max__",Ta={mapValue:{fields:{__type__:{stringValue:MN}}}},_1="__vector__",Kd="value",ay={nullValue:"NULL_VALUE"};function ja(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?E1(t)?4:ON(t)?9007199254740991:xb(t)?10:11:Fe(28295,{value:t})}function jo(t,e){if(t===e)return!0;const n=ja(t);if(n!==ja(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Tm(t).isEqual(Tm(e));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const i=Ci(s.timestampValue),a=Ci(o.timestampValue);return i.seconds===a.seconds&&i.nanos===a.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(s,o){return Ei(s.bytesValue).isEqual(Ei(o.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(s,o){return Qt(s.geoPointValue.latitude)===Qt(o.geoPointValue.latitude)&&Qt(s.geoPointValue.longitude)===Qt(o.geoPointValue.longitude)})(t,e);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return Qt(s.integerValue)===Qt(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const i=Qt(s.doubleValue),a=Qt(o.doubleValue);return i===a?Im(i)===Im(a):isNaN(i)&&isNaN(a)}return!1})(t,e);case 9:return Ud(t.arrayValue.values||[],e.arrayValue.values||[],jo);case 10:case 11:return(function(s,o){const i=s.mapValue.fields||{},a=o.mapValue.fields||{};if(NA(i)!==NA(a))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(a[l]===void 0||!jo(i[l],a[l])))return!1;return!0})(t,e);default:return Fe(52216,{left:t})}}function Pm(t,e){return(t.values||[]).find((n=>jo(n,e)))!==void 0}function Va(t,e){if(t===e)return 0;const n=ja(t),r=ja(e);if(n!==r)return et(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return et(t.booleanValue,e.booleanValue);case 2:return(function(o,i){const a=Qt(o.integerValue||o.doubleValue),l=Qt(i.integerValue||i.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(t,e);case 3:return MA(t.timestampValue,e.timestampValue);case 4:return MA(Tm(t),Tm(e));case 5:return hx(t.stringValue,e.stringValue);case 6:return(function(o,i){const a=Ei(o),l=Ei(i);return a.compareTo(l)})(t.bytesValue,e.bytesValue);case 7:return(function(o,i){const a=o.split("/"),l=i.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=et(a[c],l[c]);if(u!==0)return u}return et(a.length,l.length)})(t.referenceValue,e.referenceValue);case 8:return(function(o,i){const a=et(Qt(o.latitude),Qt(i.latitude));return a!==0?a:et(Qt(o.longitude),Qt(i.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return OA(t.arrayValue,e.arrayValue);case 10:return(function(o,i){const a=o.fields||{},l=i.fields||{},c=a[Kd]?.arrayValue,u=l[Kd]?.arrayValue,h=et(c?.values?.length||0,u?.values?.length||0);return h!==0?h:OA(c,u)})(t.mapValue,e.mapValue);case 11:return(function(o,i){if(o===Ta.mapValue&&i===Ta.mapValue)return 0;if(o===Ta.mapValue)return 1;if(i===Ta.mapValue)return-1;const a=o.fields||{},l=Object.keys(a),c=i.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const f=hx(l[h],u[h]);if(f!==0)return f;const g=Va(a[l[h]],c[u[h]]);if(g!==0)return g}return et(l.length,u.length)})(t.mapValue,e.mapValue);default:throw Fe(23264,{he:n})}}function MA(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return et(t,e);const n=Ci(t),r=Ci(e),s=et(n.seconds,r.seconds);return s!==0?s:et(n.nanos,r.nanos)}function OA(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const o=Va(n[s],r[s]);if(o)return o}return et(n.length,r.length)}function qd(t){return wx(t)}function wx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const r=Ci(n);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Ei(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return Pe.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let r="[",s=!0;for(const o of n.values||[])s?s=!1:r+=",",r+=wx(o);return r+"]"})(t.arrayValue):"mapValue"in t?(function(n){const r=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const i of r)o?o=!1:s+=",",s+=`${i}:${wx(n.fields[i])}`;return s+"}"})(t.mapValue):Fe(61005,{value:t})}function ly(t){switch(ja(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=vb(t);return e?16+ly(e):16;case 5:return 2*t.stringValue.length;case 6:return Ei(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,o)=>s+ly(o)),0)})(t.arrayValue);case 10:case 11:return(function(r){let s=0;return el(r.fields,((o,i)=>{s+=o.length+ly(i)})),s})(t.mapValue);default:throw Fe(13486,{value:t})}}function km(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function bx(t){return!!t&&"integerValue"in t}function Rm(t){return!!t&&"arrayValue"in t}function LA(t){return!!t&&"nullValue"in t}function FA(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function cy(t){return!!t&&"mapValue"in t}function xb(t){return(t?.mapValue?.fields||{})[I1]?.stringValue===_1}function tm(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return el(t.mapValue.fields,((n,r)=>e.mapValue.fields[n]=tm(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=tm(t.arrayValue.values[n]);return e}return{...t}}function ON(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===MN}const LN={mapValue:{fields:{[I1]:{stringValue:_1},[Kd]:{arrayValue:{}}}}};function s6(t){return"nullValue"in t?ay:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?km(Tc.empty(),Pe.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?xb(t)?LN:{mapValue:{}}:Fe(35942,{value:t})}function o6(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?km(Tc.empty(),Pe.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?LN:"mapValue"in t?xb(t)?{mapValue:{}}:Ta:Fe(61959,{value:t})}function jA(t,e){const n=Va(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function VA(t,e){const n=Va(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class lr{constructor(e){this.value=e}static empty(){return new lr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!cy(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=tm(n)}setAll(e){let n=Zt.emptyPath(),r={},s=[];e.forEach(((i,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}i?r[a.lastSegment()]=tm(i):s.push(a.lastSegment())}));const o=this.getFieldsMap(n);this.applyChanges(o,r,s)}delete(e){const n=this.field(e.popLast());cy(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return jo(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];cy(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){el(n,((s,o)=>e[s]=o));for(const s of r)delete e[s]}clone(){return new lr(tm(this.value))}}function FN(t){const e=[];return el(t.fields,((n,r)=>{const s=new Zt([n]);if(cy(r)){const o=FN(r.mapValue).fields;if(o.length===0)e.push(s);else for(const i of o)e.push(s.child(i))}else e.push(s)})),new Mr(e)}class an{constructor(e,n,r,s,o,i,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=o,this.data=i,this.documentState=a}static newInvalidDocument(e){return new an(e,0,Qe.min(),Qe.min(),Qe.min(),lr.empty(),0)}static newFoundDocument(e,n,r,s){return new an(e,1,n,Qe.min(),r,s,0)}static newNoDocument(e,n){return new an(e,2,n,Qe.min(),Qe.min(),lr.empty(),0)}static newUnknownDocument(e,n){return new an(e,3,n,Qe.min(),Qe.min(),lr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=lr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=lr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof an&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new an(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Qd{constructor(e,n){this.position=e,this.inclusive=n}}function BA(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const o=e[s],i=t.position[s];if(o.field.isKeyField()?r=Pe.comparator(Pe.fromName(i.referenceValue),n.key):r=Va(i,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function UA(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!jo(t.position[n],e.position[n]))return!1;return!0}class Nm{constructor(e,n="asc"){this.field=e,this.dir=n}}function i6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class jN{}class vt extends jN{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new a6(e,n,r):n==="array-contains"?new u6(e,r):n==="in"?new zN(e,r):n==="not-in"?new d6(e,r):n==="array-contains-any"?new h6(e,r):new vt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new l6(e,r):new c6(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Va(n,this.value)):n!==null&&ja(this.value)===ja(n)&&this.matchesComparison(Va(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Fe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Dt extends jN{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Dt(e,n)}matches(e){return Yd(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Yd(t){return t.op==="and"}function vx(t){return t.op==="or"}function A1(t){return VN(t)&&Yd(t)}function VN(t){for(const e of t.filters)if(e instanceof Dt)return!1;return!0}function xx(t){if(t instanceof vt)return t.field.canonicalString()+t.op.toString()+qd(t.value);if(A1(t))return t.filters.map((e=>xx(e))).join(",");{const e=t.filters.map((n=>xx(n))).join(",");return`${t.op}(${e})`}}function BN(t,e){return t instanceof vt?(function(r,s){return s instanceof vt&&r.op===s.op&&r.field.isEqual(s.field)&&jo(r.value,s.value)})(t,e):t instanceof Dt?(function(r,s){return s instanceof Dt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((o,i,a)=>o&&BN(i,s.filters[a])),!0):!1})(t,e):void Fe(19439)}function UN(t,e){const n=t.filters.concat(e);return Dt.create(n,t.op)}function HN(t){return t instanceof vt?(function(n){return`${n.field.canonicalString()} ${n.op} ${qd(n.value)}`})(t):t instanceof Dt?(function(n){return n.op.toString()+" {"+n.getFilters().map(HN).join(" ,")+"}"})(t):"Filter"}class a6 extends vt{constructor(e,n,r){super(e,n,r),this.key=Pe.fromName(r.referenceValue)}matches(e){const n=Pe.comparator(e.key,this.key);return this.matchesComparison(n)}}class l6 extends vt{constructor(e,n){super(e,"in",n),this.keys=$N("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class c6 extends vt{constructor(e,n){super(e,"not-in",n),this.keys=$N("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function $N(t,e){return(e.arrayValue?.values||[]).map((n=>Pe.fromName(n.referenceValue)))}class u6 extends vt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Rm(n)&&Pm(n.arrayValue,this.value)}}class zN extends vt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Pm(this.value.arrayValue,n)}}class d6 extends vt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Pm(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Pm(this.value.arrayValue,n)}}class h6 extends vt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Rm(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>Pm(this.value.arrayValue,r)))}}class f6{constructor(e,n=null,r=[],s=[],o=null,i=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=o,this.startAt=i,this.endAt=a,this.Te=null}}function Cx(t,e=null,n=[],r=[],s=null,o=null,i=null){return new f6(t,e,n,r,s,o,i)}function Pc(t){const e=Ge(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>xx(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),gb(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>qd(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>qd(r))).join(",")),e.Te=n}return e.Te}function Ep(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!i6(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!BN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!UA(t.startAt,e.startAt)&&UA(t.endAt,e.endAt)}function Ky(t){return Pe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function qy(t,e){return t.filters.filter((n=>n instanceof vt&&n.field.isEqual(e)))}function HA(t,e,n){let r=ay,s=!0;for(const o of qy(t,e)){let i=ay,a=!0;switch(o.op){case"<":case"<=":i=s6(o.value);break;case"==":case"in":case">=":i=o.value;break;case">":i=o.value,a=!1;break;case"!=":case"not-in":i=ay}jA({value:r,inclusive:s},{value:i,inclusive:a})<0&&(r=i,s=a)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const i=n.position[o];jA({value:r,inclusive:s},{value:i,inclusive:n.inclusive})<0&&(r=i,s=n.inclusive);break}}return{value:r,inclusive:s}}function $A(t,e,n){let r=Ta,s=!0;for(const o of qy(t,e)){let i=Ta,a=!0;switch(o.op){case">=":case">":i=o6(o.value),a=!1;break;case"==":case"in":case"<=":i=o.value;break;case"<":i=o.value,a=!1;break;case"!=":case"not-in":i=Ta}VA({value:r,inclusive:s},{value:i,inclusive:a})>0&&(r=i,s=a)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const i=n.position[o];VA({value:r,inclusive:s},{value:i,inclusive:n.inclusive})>0&&(r=i,s=n.inclusive);break}}return{value:r,inclusive:s}}class Ch{constructor(e,n=null,r=[],s=[],o=null,i="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=o,this.limitType=i,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function GN(t,e,n,r,s,o,i,a){return new Ch(t,e,n,r,s,o,i,a)}function Ip(t){return new Ch(t)}function zA(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function WN(t){return t.collectionGroup!==null}function nm(t){const e=Ge(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(i){let a=new Mt(Zt.comparator);return i.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(a=a.add(c.field))}))})),a})(e).forEach((o=>{n.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Nm(o,r))})),n.has(Zt.keyField().canonicalString())||e.Ie.push(new Nm(Zt.keyField(),r))}return e.Ie}function Zr(t){const e=Ge(t);return e.Ee||(e.Ee=m6(e,nm(t))),e.Ee}function m6(t,e){if(t.limitType==="F")return Cx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((s=>{const o=s.dir==="desc"?"asc":"desc";return new Nm(s.field,o)}));const n=t.endAt?new Qd(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Qd(t.startAt.position,t.startAt.inclusive):null;return Cx(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Ex(t,e){const n=t.filters.concat([e]);return new Ch(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ix(t,e,n){return new Ch(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Cb(t,e){return Ep(Zr(t),Zr(e))&&t.limitType===e.limitType}function KN(t){return`${Pc(Zr(t))}|lt:${t.limitType}`}function Cu(t){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((s=>HN(s))).join(", ")}]`),gb(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((s=>(function(i){return`${i.field.canonicalString()} (${i.dir})`})(s))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((s=>qd(s))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((s=>qd(s))).join(",")),`Target(${r})`})(Zr(t))}; limitType=${t.limitType})`}function _p(t,e){return e.isFoundDocument()&&(function(r,s){const o=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):Pe.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(t,e)&&(function(r,s){for(const o of nm(r))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(t,e)&&(function(r,s){for(const o of r.filters)if(!o.matches(s))return!1;return!0})(t,e)&&(function(r,s){return!(r.startAt&&!(function(i,a,l){const c=BA(i,a,l);return i.inclusive?c<=0:c<0})(r.startAt,nm(r),s)||r.endAt&&!(function(i,a,l){const c=BA(i,a,l);return i.inclusive?c>=0:c>0})(r.endAt,nm(r),s))})(t,e)}function qN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function QN(t){return(e,n)=>{let r=!1;for(const s of nm(t)){const o=p6(s,e,n);if(o!==0)return o;r=r||s.field.isKeyField()}return 0}}function p6(t,e,n){const r=t.field.isKeyField()?Pe.comparator(e.key,n.key):(function(o,i,a){const l=i.data.field(o),c=a.data.field(o);return l!==null&&c!==null?Va(l,c):Fe(42886)})(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Fe(19790,{direction:t.dir})}}class ki{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,o]of r)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){el(this.inner,((n,r)=>{for(const[s,o]of r)e(s,o)}))}isEmpty(){return TN(this.inner)}size(){return this.innerSize}}const g6=new $t(Pe.comparator);function Jr(){return g6}const YN=new $t(Pe.comparator);function Df(...t){let e=YN;for(const n of t)e=e.insert(n.key,n);return e}function JN(t){let e=YN;return t.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function Eo(){return rm()}function XN(){return rm()}function rm(){return new ki((t=>t.toString()),((t,e)=>t.isEqual(e)))}const y6=new $t(Pe.comparator),w6=new Mt(Pe.comparator);function lt(...t){let e=w6;for(const n of t)e=e.add(n);return e}const b6=new Mt(et);function S1(){return b6}function T1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Im(e)?"-0":e}}function ZN(t){return{integerValue:""+t}}function eD(t,e){return yN(e)?ZN(e):T1(t,e)}class Eb{constructor(){this._=void 0}}function v6(t,e,n){return t instanceof Jd?(function(s,o){const i={fields:{[RN]:{stringValue:kN},[DN]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&E1(o)&&(o=vb(o)),o&&(i.fields[NN]=o),{mapValue:i}})(n,e):t instanceof kc?nD(t,e):t instanceof Rc?rD(t,e):(function(s,o){const i=tD(s,o),a=GA(i)+GA(s.Ae);return bx(i)&&bx(s.Ae)?ZN(a):T1(s.serializer,a)})(t,e)}function x6(t,e,n){return t instanceof kc?nD(t,e):t instanceof Rc?rD(t,e):n}function tD(t,e){return t instanceof Xd?(function(r){return bx(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}class Jd extends Eb{}class kc extends Eb{constructor(e){super(),this.elements=e}}function nD(t,e){const n=sD(e);for(const r of t.elements)n.some((s=>jo(s,r)))||n.push(r);return{arrayValue:{values:n}}}class Rc extends Eb{constructor(e){super(),this.elements=e}}function rD(t,e){let n=sD(e);for(const r of t.elements)n=n.filter((s=>!jo(s,r)));return{arrayValue:{values:n}}}class Xd extends Eb{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function GA(t){return Qt(t.integerValue||t.doubleValue)}function sD(t){return Rm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Ap{constructor(e,n){this.field=e,this.transform=n}}function C6(t,e){return t.field.isEqual(e.field)&&(function(r,s){return r instanceof kc&&s instanceof kc||r instanceof Rc&&s instanceof Rc?Ud(r.elements,s.elements,jo):r instanceof Xd&&s instanceof Xd?jo(r.Ae,s.Ae):r instanceof Jd&&s instanceof Jd})(t.transform,e.transform)}class E6{constructor(e,n){this.version=e,this.transformResults=n}}class Pn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Pn}static exists(e){return new Pn(void 0,e)}static updateTime(e){return new Pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function uy(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ib{}function oD(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Sp(t.key,Pn.none()):new Eh(t.key,t.data,Pn.none());{const n=t.data,r=lr.empty();let s=new Mt(Zt.comparator);for(let o of e.fields)if(!s.has(o)){let i=n.field(o);i===null&&o.length>1&&(o=o.popLast(),i=n.field(o)),i===null?r.delete(o):r.set(o,i),s=s.add(o)}return new Ri(t.key,r,new Mr(s.toArray()),Pn.none())}}function I6(t,e,n){t instanceof Eh?(function(s,o,i){const a=s.value.clone(),l=KA(s.fieldTransforms,o,i.transformResults);a.setAll(l),o.convertToFoundDocument(i.version,a).setHasCommittedMutations()})(t,e,n):t instanceof Ri?(function(s,o,i){if(!uy(s.precondition,o))return void o.convertToUnknownDocument(i.version);const a=KA(s.fieldTransforms,o,i.transformResults),l=o.data;l.setAll(iD(s)),l.setAll(a),o.convertToFoundDocument(i.version,l).setHasCommittedMutations()})(t,e,n):(function(s,o,i){o.convertToNoDocument(i.version).setHasCommittedMutations()})(0,e,n)}function sm(t,e,n,r){return t instanceof Eh?(function(o,i,a,l){if(!uy(o.precondition,i))return a;const c=o.value.clone(),u=qA(o.fieldTransforms,l,i);return c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null})(t,e,n,r):t instanceof Ri?(function(o,i,a,l){if(!uy(o.precondition,i))return a;const c=qA(o.fieldTransforms,l,i),u=i.data;return u.setAll(iD(o)),u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((h=>h.field)))})(t,e,n,r):(function(o,i,a){return uy(o.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a})(t,e,n)}function _6(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),o=tD(r.transform,s||null);o!=null&&(n===null&&(n=lr.empty()),n.set(r.field,o))}return n||null}function WA(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ud(r,s,((o,i)=>C6(o,i)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Eh extends Ib{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ri extends Ib{constructor(e,n,r,s,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function iD(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function KA(t,e,n){const r=new Map;Ke(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const o=t[s],i=o.transform,a=e.data.field(o.field);r.set(o.field,x6(i,a,n[s]))}return r}function qA(t,e,n){const r=new Map;for(const s of t){const o=s.transform,i=n.data.field(s.field);r.set(s.field,v6(o,i,e))}return r}class Sp extends Ib{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class aD extends Ib{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class P1{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&I6(o,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=sm(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=sm(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=XN();return this.mutations.forEach((s=>{const o=e.get(s.key),i=o.overlayedDocument;let a=this.applyToLocalView(i,o.mutatedFields);a=n.has(s.key)?null:a;const l=oD(i,a);l!==null&&r.set(s.key,l),i.isValidDocument()||i.convertToNoDocument(Qe.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),lt())}isEqual(e){return this.batchId===e.batchId&&Ud(this.mutations,e.mutations,((n,r)=>WA(n,r)))&&Ud(this.baseMutations,e.baseMutations,((n,r)=>WA(n,r)))}}class k1{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ke(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return y6})();const o=e.mutations;for(let i=0;i<o.length;i++)s=s.insert(o[i].key,r[i].version);return new k1(e,n,r,s)}}class R1{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class A6{constructor(e,n){this.count=e,this.unchangedNames=n}}var xn,Et;function S6(t){switch(t){case he.OK:return Fe(64938);case he.CANCELLED:case he.UNKNOWN:case he.DEADLINE_EXCEEDED:case he.RESOURCE_EXHAUSTED:case he.INTERNAL:case he.UNAVAILABLE:case he.UNAUTHENTICATED:return!1;case he.INVALID_ARGUMENT:case he.NOT_FOUND:case he.ALREADY_EXISTS:case he.PERMISSION_DENIED:case he.FAILED_PRECONDITION:case he.ABORTED:case he.OUT_OF_RANGE:case he.UNIMPLEMENTED:case he.DATA_LOSS:return!0;default:return Fe(15467,{code:t})}}function lD(t){if(t===void 0)return mn("GRPC error has no .code"),he.UNKNOWN;switch(t){case xn.OK:return he.OK;case xn.CANCELLED:return he.CANCELLED;case xn.UNKNOWN:return he.UNKNOWN;case xn.DEADLINE_EXCEEDED:return he.DEADLINE_EXCEEDED;case xn.RESOURCE_EXHAUSTED:return he.RESOURCE_EXHAUSTED;case xn.INTERNAL:return he.INTERNAL;case xn.UNAVAILABLE:return he.UNAVAILABLE;case xn.UNAUTHENTICATED:return he.UNAUTHENTICATED;case xn.INVALID_ARGUMENT:return he.INVALID_ARGUMENT;case xn.NOT_FOUND:return he.NOT_FOUND;case xn.ALREADY_EXISTS:return he.ALREADY_EXISTS;case xn.PERMISSION_DENIED:return he.PERMISSION_DENIED;case xn.FAILED_PRECONDITION:return he.FAILED_PRECONDITION;case xn.ABORTED:return he.ABORTED;case xn.OUT_OF_RANGE:return he.OUT_OF_RANGE;case xn.UNIMPLEMENTED:return he.UNIMPLEMENTED;case xn.DATA_LOSS:return he.DATA_LOSS;default:return Fe(39323,{code:t})}}(Et=xn||(xn={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";function T6(){return new TextEncoder}const P6=new Na([4294967295,4294967295],0);function QA(t){const e=T6().encode(t),n=new nN;return n.update(e),new Uint8Array(n.digest())}function YA(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Na([n,r],0),new Na([s,o],0)]}class N1{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Mf(`Invalid padding: ${n}`);if(r<0)throw new Mf(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Mf(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Mf(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Na.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Na.fromNumber(r)));return s.compare(P6)===1&&(s=new Na([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=QA(e),[r,s]=YA(n);for(let o=0;o<this.hashCount;o++){const i=this.ye(r,s,o);if(!this.we(i))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),i=new N1(o,s,n);return r.forEach((a=>i.insert(a))),i}insert(e){if(this.ge===0)return;const n=QA(e),[r,s]=YA(n);for(let o=0;o<this.hashCount;o++){const i=this.ye(r,s,o);this.Se(i)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Mf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Tp{constructor(e,n,r,s,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Pp.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Tp(Qe.min(),s,new $t(et),Jr(),lt())}}class Pp{constructor(e,n,r,s,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Pp(r,n,lt(),lt(),lt())}}class dy{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class cD{constructor(e,n){this.targetId=e,this.Ce=n}}class uD{constructor(e,n,r=yn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class JA{constructor(){this.ve=0,this.Fe=XA(),this.Me=yn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=lt(),n=lt(),r=lt();return this.Fe.forEach(((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Fe(38017,{changeType:o})}})),new Pp(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=XA()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ke(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class k6{constructor(e){this.Ge=e,this.ze=new Map,this.je=Jr(),this.Je=Pg(),this.He=Pg(),this.Ye=new $t(et)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Fe(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,s)=>{this.rt(s)&&n(s)}))}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const o=s.target;if(Ky(o))if(r===0){const i=new Pe(o.path);this.et(n,i,an.newNoDocument(i,Qe.min()))}else Ke(r===1,20013,{expectedCount:r});else{const i=this._t(n);if(i!==r){const a=this.ut(e),l=a?this.ct(a,e,i):1;if(l!==0){this.it(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,c)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:o=0}=n;let i,a;try{i=Ei(r).toUint8Array()}catch(l){if(l instanceof PN)return Cm("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new N1(i,s,o)}catch(l){return Cm(l instanceof Mf?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach((o=>{const i=this.Ge.ht(),a=`projects/${i.projectId}/databases/${i.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(n,o,null),s++)})),s}Tt(e){const n=new Map;this.ze.forEach(((o,i)=>{const a=this.ot(i);if(a){if(o.current&&Ky(a.target)){const l=new Pe(a.target.path);this.It(l).has(i)||this.Et(i,l)||this.et(i,l,an.newNoDocument(l,e))}o.Be&&(n.set(i,o.ke()),o.qe())}}));let r=lt();this.He.forEach(((o,i)=>{let a=!0;i.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(r=r.add(o))})),this.je.forEach(((o,i)=>i.setReadTime(e)));const s=new Tp(e,n,this.Ye,this.je,r);return this.je=Jr(),this.Je=Pg(),this.He=Pg(),this.Ye=new $t(et),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new JA,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Mt(et),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Mt(et),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ve("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new JA),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Pg(){return new $t(Pe.comparator)}function XA(){return new $t(Pe.comparator)}const R6={asc:"ASCENDING",desc:"DESCENDING"},N6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},D6={and:"AND",or:"OR"};class M6{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function _x(t,e){return t.useProto3Json||gb(e)?e:{value:e}}function Zd(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dD(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function O6(t,e){return Zd(t,e.toTimestamp())}function Er(t){return Ke(!!t,49232),Qe.fromTimestamp((function(n){const r=Ci(n);return new Nt(r.seconds,r.nanos)})(t))}function D1(t,e){return Ax(t,e).canonicalString()}function Ax(t,e){const n=(function(s){return new _t(["projects",s.projectId,"databases",s.database])})(t).child("documents");return e===void 0?n:n.child(e)}function hD(t){const e=_t.fromString(t);return Ke(xD(e),10190,{key:e.toString()}),e}function Qy(t,e){return D1(t.databaseId,e.path)}function hc(t,e){const n=hD(e);if(n.get(1)!==t.databaseId.projectId)throw new Ae(he.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ae(he.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Pe(pD(n))}function fD(t,e){return D1(t.databaseId,e)}function mD(t){const e=hD(t);return e.length===4?_t.emptyPath():pD(e)}function Sx(t){return new _t(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function pD(t){return Ke(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function ZA(t,e,n){return{name:Qy(t,e),fields:n.value.mapValue.fields}}function L6(t,e,n){const r=hc(t,e.name),s=Er(e.updateTime),o=e.createTime?Er(e.createTime):Qe.min(),i=new lr({mapValue:{fields:e.fields}}),a=an.newFoundDocument(r,s,o,i);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function F6(t,e){let n;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Fe(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=(function(c,u){return c.useProto3Json?(Ke(u===void 0||typeof u=="string",58123),yn.fromBase64String(u||"")):(Ke(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),yn.fromUint8Array(u||new Uint8Array))})(t,e.targetChange.resumeToken),i=e.targetChange.cause,a=i&&(function(c){const u=c.code===void 0?he.UNKNOWN:lD(c.code);return new Ae(u,c.message||"")})(i);n=new uD(r,s,o,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=hc(t,r.document.name),o=Er(r.document.updateTime),i=r.document.createTime?Er(r.document.createTime):Qe.min(),a=new lr({mapValue:{fields:r.document.fields}}),l=an.newFoundDocument(s,o,i,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new dy(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=hc(t,r.document),o=r.readTime?Er(r.readTime):Qe.min(),i=an.newNoDocument(s,o),a=r.removedTargetIds||[];n=new dy([],a,i.key,i)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=hc(t,r.document),o=r.removedTargetIds||[];n=new dy([],o,s,null)}else{if(!("filter"in e))return Fe(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:o}=r,i=new A6(s,o),a=r.targetId;n=new cD(a,i)}}return n}function Yy(t,e){let n;if(e instanceof Eh)n={update:ZA(t,e.key,e.value)};else if(e instanceof Sp)n={delete:Qy(t,e.key)};else if(e instanceof Ri)n={update:ZA(t,e.key,e.data),updateMask:$6(e.fieldMask)};else{if(!(e instanceof aD))return Fe(16599,{Vt:e.type});n={verify:Qy(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(o,i){const a=i.transform;if(a instanceof Jd)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof kc)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Rc)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Xd)return{fieldPath:i.field.canonicalString(),increment:a.Ae};throw Fe(20930,{transform:i.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:O6(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Fe(27497)})(t,e.precondition)),n}function Tx(t,e){const n=e.currentDocument?(function(o){return o.updateTime!==void 0?Pn.updateTime(Er(o.updateTime)):o.exists!==void 0?Pn.exists(o.exists):Pn.none()})(e.currentDocument):Pn.none(),r=e.updateTransforms?e.updateTransforms.map((s=>(function(i,a){let l=null;if("setToServerValue"in a)Ke(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new Jd;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];l=new kc(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];l=new Rc(u)}else"increment"in a?l=new Xd(i,a.increment):Fe(16584,{proto:a});const c=Zt.fromServerFormat(a.fieldPath);return new Ap(c,l)})(t,s))):[];if(e.update){e.update.name;const s=hc(t,e.update.name),o=new lr({mapValue:{fields:e.update.fields}});if(e.updateMask){const i=(function(l){const c=l.fieldPaths||[];return new Mr(c.map((u=>Zt.fromServerFormat(u))))})(e.updateMask);return new Ri(s,o,i,n,r)}return new Eh(s,o,n,r)}if(e.delete){const s=hc(t,e.delete);return new Sp(s,n)}if(e.verify){const s=hc(t,e.verify);return new aD(s,n)}return Fe(1463,{proto:e})}function j6(t,e){return t&&t.length>0?(Ke(e!==void 0,14353),t.map((n=>(function(s,o){let i=s.updateTime?Er(s.updateTime):Er(o);return i.isEqual(Qe.min())&&(i=Er(o)),new E6(i,s.transformResults||[])})(n,e)))):[]}function gD(t,e){return{documents:[fD(t,e.path)]}}function yD(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=fD(t,s);const o=(function(c){if(c.length!==0)return vD(Dt.create(c,"and"))})(e.filters);o&&(n.structuredQuery.where=o);const i=(function(c){if(c.length!==0)return c.map((u=>(function(f){return{field:Eu(f.field),direction:B6(f.dir)}})(u)))})(e.orderBy);i&&(n.structuredQuery.orderBy=i);const a=_x(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:n,parent:s}}function wD(t){let e=mD(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ke(r===1,65062);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let o=[];n.where&&(o=(function(h){const f=bD(h);return f instanceof Dt&&A1(f)?f.getFilters():[f]})(n.where));let i=[];n.orderBy&&(i=(function(h){return h.map((f=>(function(y){return new Nm(Iu(y.field),(function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(f)))})(n.orderBy));let a=null;n.limit&&(a=(function(h){let f;return f=typeof h=="object"?h.value:h,gb(f)?null:f})(n.limit));let l=null;n.startAt&&(l=(function(h){const f=!!h.before,g=h.values||[];return new Qd(g,f)})(n.startAt));let c=null;return n.endAt&&(c=(function(h){const f=!h.before,g=h.values||[];return new Qd(g,f)})(n.endAt)),GN(e,s,i,o,a,"F",l,c)}function V6(t,e){const n=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Fe(28987,{purpose:s})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function bD(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Iu(n.unaryFilter.field);return vt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Iu(n.unaryFilter.field);return vt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Iu(n.unaryFilter.field);return vt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Iu(n.unaryFilter.field);return vt.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Fe(61313);default:return Fe(60726)}})(t):t.fieldFilter!==void 0?(function(n){return vt.create(Iu(n.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Fe(58110);default:return Fe(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Dt.create(n.compositeFilter.filters.map((r=>bD(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Fe(1026)}})(n.compositeFilter.op))})(t):Fe(30097,{filter:t})}function B6(t){return R6[t]}function U6(t){return N6[t]}function H6(t){return D6[t]}function Eu(t){return{fieldPath:t.canonicalString()}}function Iu(t){return Zt.fromServerFormat(t.fieldPath)}function vD(t){return t instanceof vt?(function(n){if(n.op==="=="){if(FA(n.value))return{unaryFilter:{field:Eu(n.field),op:"IS_NAN"}};if(LA(n.value))return{unaryFilter:{field:Eu(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(FA(n.value))return{unaryFilter:{field:Eu(n.field),op:"IS_NOT_NAN"}};if(LA(n.value))return{unaryFilter:{field:Eu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Eu(n.field),op:U6(n.op),value:n.value}}})(t):t instanceof Dt?(function(n){const r=n.getFilters().map((s=>vD(s)));return r.length===1?r[0]:{compositeFilter:{op:H6(n.op),filters:r}}})(t):Fe(54877,{filter:t})}function $6(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function xD(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class di{constructor(e,n,r,s,o=Qe.min(),i=Qe.min(),a=yn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new di(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new di(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class CD{constructor(e){this.yt=e}}function z6(t,e){let n;if(e.document)n=L6(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Pe.fromSegments(e.noDocument.path),s=Dc(e.noDocument.readTime);n=an.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Fe(56709);{const r=Pe.fromSegments(e.unknownDocument.path),s=Dc(e.unknownDocument.version);n=an.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime((function(s){const o=new Nt(s[0],s[1]);return Qe.fromTimestamp(o)})(e.readTime)),n}function eS(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Jy(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(o,i){return{name:Qy(o,i.key),fields:i.data.value.mapValue.fields,updateTime:Zd(o,i.version.toTimestamp()),createTime:Zd(o,i.createTime.toTimestamp())}})(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Nc(e.version)};else{if(!e.isUnknownDocument())return Fe(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Nc(e.version)}}return r}function Jy(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Nc(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Dc(t){const e=new Nt(t.seconds,t.nanoseconds);return Qe.fromTimestamp(e)}function kl(t,e){const n=(e.baseMutations||[]).map((o=>Tx(t.yt,o)));for(let o=0;o<e.mutations.length-1;++o){const i=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const a=e.mutations[o+1];i.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map((o=>Tx(t.yt,o))),s=Nt.fromMillis(e.localWriteTimeMs);return new P1(e.batchId,s,n,r)}function Of(t){const e=Dc(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Dc(t.lastLimboFreeSnapshotVersion):Qe.min();let r;return r=(function(o){return o.documents!==void 0})(t.query)?(function(o){const i=o.documents.length;return Ke(i===1,1966,{count:i}),Zr(Ip(mD(o.documents[0])))})(t.query):(function(o){return Zr(wD(o))})(t.query),new di(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,yn.fromBase64String(t.resumeToken))}function ED(t,e){const n=Nc(e.snapshotVersion),r=Nc(e.lastLimboFreeSnapshotVersion);let s;s=Ky(e.target)?gD(t.yt,e.target):yD(t.yt,e.target).ft;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Pc(e.target),readTime:n,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function ID(t){const e=wD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ix(e,e.limit,"L"):e}function X0(t,e){return new R1(e.largestBatchId,Tx(t.yt,e.overlayMutation))}function tS(t,e){const n=e.path.lastSegment();return[t,ur(e.path.popLast()),n]}function nS(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Nc(r.readTime),documentKey:ur(r.documentKey.path),largestBatchId:r.largestBatchId}}class G6{getBundleMetadata(e,n){return rS(e).get(n).next((r=>{if(r)return(function(o){return{id:o.bundleId,createTime:Dc(o.createTime),version:o.version}})(r)}))}saveBundleMetadata(e,n){return rS(e).put((function(s){return{bundleId:s.id,createTime:Nc(Er(s.createTime)),version:s.version}})(n))}getNamedQuery(e,n){return sS(e).get(n).next((r=>{if(r)return(function(o){return{name:o.name,query:ID(o.bundledQuery),readTime:Dc(o.readTime)}})(r)}))}saveNamedQuery(e,n){return sS(e).put((function(s){return{name:s.name,readTime:Nc(Er(s.readTime)),bundledQuery:s.bundledQuery}})(n))}}function rS(t){return Dn(t,yb)}function sS(t){return Dn(t,wb)}class _b{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new _b(e,r)}getOverlay(e,n){return sf(e).get(tS(this.userId,n)).next((r=>r?X0(this.serializer,r):null))}getOverlays(e,n){const r=Eo();return te.forEach(n,(s=>this.getOverlay(e,s).next((o=>{o!==null&&r.set(s,o)})))).next((()=>r))}saveOverlays(e,n,r){const s=[];return r.forEach(((o,i)=>{const a=new R1(n,i);s.push(this.St(e,a))})),te.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach((i=>s.add(ur(i.getCollectionPath()))));const o=[];return s.forEach((i=>{const a=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,r+1],!1,!0);o.push(sf(e).Z(gx,a))})),te.waitFor(o)}getOverlaysForCollection(e,n,r){const s=Eo(),o=ur(n),i=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return sf(e).J(gx,i).next((a=>{for(const l of a){const c=X0(this.serializer,l);s.set(c.getKey(),c)}return s}))}getOverlaysForCollectionGroup(e,n,r,s){const o=Eo();let i;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return sf(e).ee({index:EN,range:a},((l,c,u)=>{const h=X0(this.serializer,c);o.size()<s||h.largestBatchId===i?(o.set(h.getKey(),h),i=h.largestBatchId):u.done()})).next((()=>o))}St(e,n){return sf(e).put((function(s,o,i){const[a,l,c]=tS(o,i.mutation.key);return{userId:o,collectionPath:l,documentId:c,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:Yy(s.yt,i.mutation)}})(this.serializer,this.userId,n))}}function sf(t){return Dn(t,bb)}class W6{bt(e){return Dn(e,x1)}getSessionToken(e){return this.bt(e).get("sessionToken").next((n=>{const r=n?.value;return r?yn.fromUint8Array(r):yn.EMPTY_BYTE_STRING}))}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}class Rl{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(Qt(e.integerValue));else if("doubleValue"in e){const r=Qt(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Im(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Ci(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Ei(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?ON(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):xb(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Fe(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){const r=e.fields||{};this.Ft(n,53);const s=Kd,o=r[s].arrayValue?.values?.length||0;this.Ft(n,15),n.Mt(Qt(o)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),Pe.fromName(e).path.forEach((r=>{this.Ft(n,60),this.Ut(r,n)}))}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Rl.Kt=new Rl;const au=255;function K6(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function oS(t){const e=64-(function(r){let s=0;for(let o=0;o<8;++o){const i=K6(255&r[o]);if(s+=i,i!==8)break}return s})(t);return Math.ceil(e/8)}class q6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=oS(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=oS(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(au),this.sn(255)}_n(){this.an(au),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=(function(o){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,o,!1),new Uint8Array(i.buffer)})(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===au?(this.sn(au),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===au?(this.an(au),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class Q6{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class Y6{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class of{constructor(){this.cn=new q6,this.ln=new Q6(this.cn),this.hn=new Y6(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Nl{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Nl(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:hy(this.En),directionalValue:hy(this.dn),orderedDocumentKey:hy(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Hi(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=iS(t.En,e.En),n!==0?n:(n=iS(t.dn,e.dn),n!==0?n:Pe.comparator(t.In,e.In)))}function iS(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function hy(t){return q2()?(function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r})(t):t}function aS(t){return typeof t!="string"?t:(function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r})(t)}class lS{constructor(e){this.mn=new Mt(((n,r)=>Zt.comparator(n.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Ke(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=fx(e);if(n!==void 0&&!this.wn(n))return!1;const r=Il(e);let s=new Set,o=0,i=0;for(;o<r.length&&this.wn(r[o]);++o)s=s.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[o];if(!this.Sn(a,l)||!this.bn(this.fn[i++],l))return!1}++o}for(;o<r.length;++o){const a=r[o];if(i>=this.fn.length||!this.bn(this.fn[i++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Mt(Zt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new sy(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new sy(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new sy(r.field,r.dir==="asc"?0:1)));return new Hy(Hy.UNKNOWN_ID,this.collectionId,n,Em.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}function _D(t){if(Ke(t instanceof vt||t instanceof Dt,20012),t instanceof vt){if(t instanceof zN){const n=t.value.arrayValue?.values?.map((r=>vt.create(t.field,"==",r)))||[];return Dt.create(n,"or")}return t}const e=t.filters.map((n=>_D(n)));return Dt.create(e,t.op)}function J6(t){if(t.getFilters().length===0)return[];const e=Rx(_D(t));return Ke(AD(e),7391),Px(e)||kx(e)?[e]:e.getFilters()}function Px(t){return t instanceof vt}function kx(t){return t instanceof Dt&&A1(t)}function AD(t){return Px(t)||kx(t)||(function(n){if(n instanceof Dt&&vx(n)){for(const r of n.getFilters())if(!Px(r)&&!kx(r))return!1;return!0}return!1})(t)}function Rx(t){if(Ke(t instanceof vt||t instanceof Dt,34018),t instanceof vt)return t;if(t.filters.length===1)return Rx(t.filters[0]);const e=t.filters.map((r=>Rx(r)));let n=Dt.create(e,t.op);return n=Xy(n),AD(n)?n:(Ke(n instanceof Dt,64498),Ke(Yd(n),40251),Ke(n.filters.length>1,57927),n.filters.reduce(((r,s)=>M1(r,s))))}function M1(t,e){let n;return Ke(t instanceof vt||t instanceof Dt,38388),Ke(e instanceof vt||e instanceof Dt,25473),n=t instanceof vt?e instanceof vt?(function(s,o){return Dt.create([s,o],"and")})(t,e):cS(t,e):e instanceof vt?cS(e,t):(function(s,o){if(Ke(s.filters.length>0&&o.filters.length>0,48005),Yd(s)&&Yd(o))return UN(s,o.getFilters());const i=vx(s)?s:o,a=vx(s)?o:s,l=i.filters.map((c=>M1(c,a)));return Dt.create(l,"or")})(t,e),Xy(n)}function cS(t,e){if(Yd(e))return UN(e,t.getFilters());{const n=e.filters.map((r=>M1(t,r)));return Dt.create(n,"or")}}function Xy(t){if(Ke(t instanceof vt||t instanceof Dt,11850),t instanceof vt)return t;const e=t.getFilters();if(e.length===1)return Xy(e[0]);if(VN(t))return t;const n=e.map((s=>Xy(s))),r=[];return n.forEach((s=>{s instanceof vt?r.push(s):s instanceof Dt&&(s.op===t.op?r.push(...s.filters):r.push(s))})),r.length===1?r[0]:Dt.create(r,t.op)}class X6{constructor(){this.Cn=new O1}addToCollectionParentIndex(e,n){return this.Cn.add(n),te.resolve()}getCollectionParents(e,n){return te.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return te.resolve()}deleteFieldIndex(e,n){return te.resolve()}deleteAllFieldIndexes(e){return te.resolve()}createTargetIndexes(e,n){return te.resolve()}getDocumentsMatchingTarget(e,n){return te.resolve(null)}getIndexType(e,n){return te.resolve(0)}getFieldIndexes(e,n){return te.resolve([])}getNextCollectionGroupToUpdate(e){return te.resolve(null)}getMinOffset(e,n){return te.resolve(es.min())}getMinOffsetFromCollectionGroup(e,n){return te.resolve(es.min())}updateCollectionGroup(e,n,r){return te.resolve()}updateIndexEntries(e,n){return te.resolve()}}class O1{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Mt(_t.comparator),o=!s.has(r);return this.index[n]=s.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Mt(_t.comparator)).toArray()}}const uS="IndexedDbIndexManager",kg=new Uint8Array(0);class Z6{constructor(e,n){this.databaseId=n,this.vn=new O1,this.Fn=new ki((r=>Pc(r)),((r,s)=>Ep(r,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener((()=>{this.vn.add(n)}));const o={collectionId:r,parent:ur(s)};return dS(e).put(o)}return te.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[cN(n),""],!1,!0);return dS(e).J(s).next((o=>{for(const i of o){if(i.collectionId!==n)break;r.push(Co(i.parent))}return r}))}addFieldIndex(e,n){const r=af(e),s=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(n);delete s.indexId;const o=r.add(s);if(n.indexState){const i=cu(e);return o.next((a=>{i.put(nS(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))}))}return o.next()}deleteFieldIndex(e,n){const r=af(e),s=cu(e),o=lu(e);return r.delete(n.indexId).next((()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const n=af(e),r=lu(e),s=cu(e);return n.Z().next((()=>r.Z())).next((()=>s.Z()))}createTargetIndexes(e,n){return te.forEach(this.Mn(n),(r=>this.getIndexType(e,r).next((s=>{if(s===0||s===1){const o=new lS(r).Dn();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,n){const r=lu(e);let s=!0;const o=new Map;return te.forEach(this.Mn(n),(i=>this.xn(e,i).next((a=>{s&&(s=!!a),o.set(i,a)})))).next((()=>{if(s){let i=lt();const a=[];return te.forEach(o,((l,c)=>{ve(uS,`Using index ${(function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map((N=>`${N.fieldPath}:${N.kind}`)).join(",")}`})(l)} to execute ${Pc(n)}`);const u=(function(A,N){const M=fx(N);if(M===void 0)return null;for(const k of qy(A,M.fieldPath))switch(k.op){case"array-contains-any":return k.value.arrayValue.values||[];case"array-contains":return[k.value]}return null})(c,l),h=(function(A,N){const M=new Map;for(const k of Il(N))for(const E of qy(A,k.fieldPath))switch(E.op){case"==":case"in":M.set(k.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return M.set(k.fieldPath.canonicalString(),E.value),Array.from(M.values())}return null})(c,l),f=(function(A,N){const M=[];let k=!0;for(const E of Il(N)){const b=E.kind===0?HA(A,E.fieldPath,A.startAt):$A(A,E.fieldPath,A.startAt);M.push(b.value),k&&(k=b.inclusive)}return new Qd(M,k)})(c,l),g=(function(A,N){const M=[];let k=!0;for(const E of Il(N)){const b=E.kind===0?$A(A,E.fieldPath,A.endAt):HA(A,E.fieldPath,A.endAt);M.push(b.value),k&&(k=b.inclusive)}return new Qd(M,k)})(c,l),y=this.On(l,c,f),w=this.On(l,c,g),v=this.Nn(l,c,h),C=this.Bn(l.indexId,u,y,f.inclusive,w,g.inclusive,v);return te.forEach(C,(x=>r.Y(x,n.limit).next((A=>{A.forEach((N=>{const M=Pe.fromSegments(N.documentKey);i.has(M)||(i=i.add(M),a.push(M))}))}))))})).next((()=>a))}return te.resolve(null)}))}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=J6(Dt.create(e.filters,"and")).map((r=>Cx(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,n),n)}Bn(e,n,r,s,o,i,a){const l=(n!=null?n.length:1)*Math.max(r.length,o.length),c=l/(n!=null?n.length:1),u=[];for(let h=0;h<l;++h){const f=n?this.Ln(n[h/c]):kg,g=this.kn(e,f,r[h%c],s),y=this.qn(e,f,o[h%c],i),w=a.map((v=>this.kn(e,f,v,!0)));u.push(...this.createRange(g,y,w))}return u}kn(e,n,r,s){const o=new Nl(e,Pe.empty(),n,r);return s?o:o.An()}qn(e,n,r,s){const o=new Nl(e,Pe.empty(),n,r);return s?o.An():o}xn(e,n){const r=new lS(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next((o=>{let i=null;for(const a of o)r.yn(a)&&(!i||a.fields.length>i.fields.length)&&(i=a);return i}))}getIndexType(e,n){let r=2;const s=this.Mn(n);return te.forEach(s,(o=>this.xn(e,o).next((i=>{i?r!==0&&i.fields.length<(function(l){let c=new Mt(Zt.comparator),u=!1;for(const h of l.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?u=!0:c=c.add(f.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(u?1:0)})(o)&&(r=1):r=0})))).next((()=>(function(i){return i.limit!==null})(n)&&s.length>1&&r===2?1:r))}Qn(e,n){const r=new of;for(const s of Il(e)){const o=n.data.field(s.fieldPath);if(o==null)return null;const i=r.Pn(s.kind);Rl.Kt.Dt(o,i)}return r.un()}Ln(e){const n=new of;return Rl.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new of;return Rl.Kt.Dt(km(this.databaseId,n),r.Pn((function(o){const i=Il(o);return i.length===0?0:i[i.length-1].kind})(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new of);let o=0;for(const i of Il(e)){const a=r[o++];for(const l of s)if(this.Un(n,i.fieldPath)&&Rm(a))s=this.Kn(s,i,a);else{const c=l.Pn(i.kind);Rl.Kt.Dt(a,c)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],o=[];for(const i of r.arrayValue.values||[])for(const a of s){const l=new of;l.seed(a.un()),Rl.Kt.Dt(i,l.Pn(n.kind)),o.push(l)}return o}Un(e,n){return!!e.filters.find((r=>r instanceof vt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,n){const r=af(e),s=cu(e);return(n?r.J(px,IDBKeyRange.bound(n,n)):r.J()).next((o=>{const i=[];return te.forEach(o,(a=>s.get([a.indexId,this.uid]).next((l=>{i.push((function(u,h){const f=h?new Em(h.sequenceNumber,new es(Dc(h.readTime),new Pe(Co(h.documentKey)),h.largestBatchId)):Em.empty(),g=u.fields.map((([y,w])=>new sy(Zt.fromServerFormat(y),w)));return new Hy(u.indexId,u.collectionGroup,g,f)})(a,l))})))).next((()=>i))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((n=>n.length===0?null:(n.sort(((r,s)=>{const o=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return o!==0?o:et(r.collectionGroup,s.collectionGroup)})),n[0].collectionGroup)))}updateCollectionGroup(e,n,r){const s=af(e),o=cu(e);return this.Gn(e).next((i=>s.J(px,IDBKeyRange.bound(n,n)).next((a=>te.forEach(a,(l=>o.put(nS(l.indexId,this.uid,i,r))))))))}updateIndexEntries(e,n){const r=new Map;return te.forEach(n,((s,o)=>{const i=r.get(s.collectionGroup);return(i?te.resolve(i):this.getFieldIndexes(e,s.collectionGroup)).next((a=>(r.set(s.collectionGroup,a),te.forEach(a,(l=>this.zn(e,s,l).next((c=>{const u=this.jn(o,l);return c.isEqual(u)?te.resolve():this.Jn(e,o,l,c,u)})))))))}))}Hn(e,n,r,s){return lu(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return lu(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=lu(e);let o=new Mt(Hi);return s.ee({index:CN,range:IDBKeyRange.only([r.indexId,this.uid,hy(this.$n(r,n))])},((i,a)=>{o=o.add(new Nl(r.indexId,n,aS(a.arrayValue),aS(a.directionalValue)))})).next((()=>o))}jn(e,n){let r=new Mt(Hi);const s=this.Qn(n,e);if(s==null)return r;const o=fx(n);if(o!=null){const i=e.data.field(o.fieldPath);if(Rm(i))for(const a of i.arrayValue.values||[])r=r.add(new Nl(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new Nl(n.indexId,e.key,kg,s));return r}Jn(e,n,r,s,o){ve(uS,"Updating index entries for document '%s'",n.key);const i=[];return(function(l,c,u,h,f){const g=l.getIterator(),y=c.getIterator();let w=iu(g),v=iu(y);for(;w||v;){let C=!1,x=!1;if(w&&v){const A=u(w,v);A<0?x=!0:A>0&&(C=!0)}else w!=null?x=!0:C=!0;C?(h(v),v=iu(y)):x?(f(w),w=iu(g)):(w=iu(g),v=iu(y))}})(s,o,Hi,(a=>{i.push(this.Hn(e,n,r,a))}),(a=>{i.push(this.Yn(e,n,r,a))})),te.waitFor(i)}Gn(e){let n=1;return cu(e).ee({index:xN,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,s,o)=>{o.done(),n=s.sequenceNumber+1})).next((()=>n))}createRange(e,n,r){r=r.sort(((i,a)=>Hi(i,a))).filter(((i,a,l)=>!a||Hi(i,l[a-1])!==0));const s=[];s.push(e);for(const i of r){const a=Hi(i,e),l=Hi(i,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(i),s.push(i.An());else if(l>0)break}s.push(n);const o=[];for(let i=0;i<s.length;i+=2){if(this.Zn(s[i],s[i+1]))return[];const a=s[i].Vn(this.uid,kg,Pe.empty()),l=s[i+1].Vn(this.uid,kg,Pe.empty());o.push(IDBKeyRange.bound(a,l))}return o}Zn(e,n){return Hi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(hS)}getMinOffset(e,n){return te.mapArray(this.Mn(n),(r=>this.xn(e,r).next((s=>s||Fe(44426))))).next(hS)}}function dS(t){return Dn(t,Sm)}function lu(t){return Dn(t,em)}function af(t){return Dn(t,v1)}function cu(t){return Dn(t,Zf)}function hS(t){Ke(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;y1(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new es(e.readTime,e.documentKey,n)}const fS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},SD=41943040;class ar{static withCacheSize(e){return new ar(e,ar.DEFAULT_COLLECTION_PERCENTILE,ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}function TD(t,e,n){const r=t.store(Bs),s=t.store($d),o=[],i=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:i},((u,h,f)=>(a++,f.delete())));o.push(l.next((()=>{Ke(a===1,47070,{batchId:n.batchId})})));const c=[];for(const u of n.mutations){const h=wN(e,u.key.path,n.batchId);o.push(s.delete(h)),c.push(u.key)}return te.waitFor(o).next((()=>c))}function Zy(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Fe(14731);e=t.noDocument}return JSON.stringify(e).length}ar.DEFAULT_COLLECTION_PERCENTILE=10,ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ar.DEFAULT=new ar(SD,ar.DEFAULT_COLLECTION_PERCENTILE,ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ar.DISABLED=new ar(-1,0,0);class Ab{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){Ke(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new Ab(o,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return $i(e).ee({index:jl,range:r},((s,o,i)=>{n=!1,i.done()})).next((()=>n))}addMutationBatch(e,n,r,s){const o=_u(e),i=$i(e);return i.add({}).next((a=>{Ke(typeof a=="number",49019);const l=new P1(a,n,r,s),c=(function(g,y,w){const v=w.baseMutations.map((x=>Yy(g.yt,x))),C=w.mutations.map((x=>Yy(g.yt,x)));return{userId:y,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:v,mutations:C}})(this.serializer,this.userId,l),u=[];let h=new Mt(((f,g)=>et(f.canonicalString(),g.canonicalString())));for(const f of s){const g=wN(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),u.push(i.put(c)),u.push(o.put(g,NU))}return h.forEach((f=>{u.push(this.indexManager.addToCollectionParentIndex(e,f))})),e.addOnCommittedListener((()=>{this.Xn[a]=l.keys()})),te.waitFor(u).next((()=>l))}))}lookupMutationBatch(e,n){return $i(e).get(n).next((r=>r?(Ke(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),kl(this.serializer,r)):null))}er(e,n){return this.Xn[n]?te.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next((r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return $i(e).ee({index:jl,range:s},((i,a,l)=>{a.userId===this.userId&&(Ke(a.batchId>=r,47524,{tr:r}),o=kl(this.serializer,a)),l.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=uc;return $i(e).ee({index:jl,range:n,reverse:!0},((s,o,i)=>{r=o.batchId,i.done()})).next((()=>r))}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,uc],[this.userId,Number.POSITIVE_INFINITY]);return $i(e).J(jl,n).next((r=>r.map((s=>kl(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=oy(this.userId,n.path),s=IDBKeyRange.lowerBound(r),o=[];return _u(e).ee({range:s},((i,a,l)=>{const[c,u,h]=i,f=Co(u);if(c===this.userId&&n.path.isEqual(f))return $i(e).get(h).next((g=>{if(!g)throw Fe(61480,{nr:i,batchId:h});Ke(g.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:g.userId,batchId:h}),o.push(kl(this.serializer,g))}));l.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Mt(et);const s=[];return n.forEach((o=>{const i=oy(this.userId,o.path),a=IDBKeyRange.lowerBound(i),l=_u(e).ee({range:a},((c,u,h)=>{const[f,g,y]=c,w=Co(g);f===this.userId&&o.path.isEqual(w)?r=r.add(y):h.done()}));s.push(l)})),te.waitFor(s).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,o=oy(this.userId,r),i=IDBKeyRange.lowerBound(o);let a=new Mt(et);return _u(e).ee({range:i},((l,c,u)=>{const[h,f,g]=l,y=Co(f);h===this.userId&&r.isPrefixOf(y)?y.length===s&&(a=a.add(g)):u.done()})).next((()=>this.rr(e,a)))}rr(e,n){const r=[],s=[];return n.forEach((o=>{s.push($i(e).get(o).next((i=>{if(i===null)throw Fe(35274,{batchId:o});Ke(i.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:i.userId,batchId:o}),r.push(kl(this.serializer,i))})))})),te.waitFor(s).next((()=>r))}removeMutationBatch(e,n){return TD(e.le,this.userId,n).next((r=>(e.addOnCommittedListener((()=>{this.ir(n.batchId)})),te.forEach(r,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((n=>{if(!n)return te.resolve();const r=IDBKeyRange.lowerBound((function(i){return[i]})(this.userId)),s=[];return _u(e).ee({range:r},((o,i,a)=>{if(o[0]===this.userId){const l=Co(o[1]);s.push(l)}else a.done()})).next((()=>{Ke(s.length===0,56720,{sr:s.map((o=>o.canonicalString()))})}))}))}containsKey(e,n){return PD(e,this.userId,n)}_r(e){return kD(e).get(this.userId).next((n=>n||{userId:this.userId,lastAcknowledgedBatchId:uc,lastStreamToken:""}))}}function PD(t,e,n){const r=oy(e,n.path),s=r[1],o=IDBKeyRange.lowerBound(r);let i=!1;return _u(t).ee({range:o,X:!0},((a,l,c)=>{const[u,h,f]=a;u===e&&h===s&&(i=!0),c.done()})).next((()=>i))}function $i(t){return Dn(t,Bs)}function _u(t){return Dn(t,$d)}function kD(t){return Dn(t,_m)}class Mc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Mc(0)}static cr(){return new Mc(-1)}}class eH{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next((n=>{const r=new Mc(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next((()=>n.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((n=>Qe.fromTimestamp(new Nt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((n=>n.highestListenSequenceNumber))}setTargetsMetadata(e,n,r){return this.lr(e).next((s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s))))}addTargetData(e,n){return this.Pr(e,n).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next((()=>uu(e).delete(n.targetId))).next((()=>this.lr(e))).next((r=>(Ke(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,n,r){let s=0;const o=[];return uu(e).ee(((i,a)=>{const l=Of(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,o.push(this.removeTargetData(e,l)))})).next((()=>te.waitFor(o))).next((()=>s))}forEachTarget(e,n){return uu(e).ee(((r,s)=>{const o=Of(s);n(o)}))}lr(e){return mS(e).get(Gy).next((n=>(Ke(n!==null,2888),n)))}hr(e,n){return mS(e).put(Gy,n)}Pr(e,n){return uu(e).put(ED(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((n=>n.targetCount))}getTargetData(e,n){const r=Pc(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return uu(e).ee({range:s,index:vN},((i,a,l)=>{const c=Of(a);Ep(n,c.target)&&(o=c,l.done())})).next((()=>o))}addMatchingKeys(e,n,r){const s=[],o=oa(e);return n.forEach((i=>{const a=ur(i.path);s.push(o.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,i))})),te.waitFor(s)}removeMatchingKeys(e,n,r){const s=oa(e);return te.forEach(n,(o=>{const i=ur(o.path);return te.waitFor([s.delete([r,i]),this.referenceDelegate.removeReference(e,r,o)])}))}removeMatchingKeysForTargetId(e,n){const r=oa(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=oa(e);let o=lt();return s.ee({range:r,X:!0},((i,a,l)=>{const c=Co(i[1]),u=new Pe(c);o=o.add(u)})).next((()=>o))}containsKey(e,n){const r=ur(n.path),s=IDBKeyRange.bound([r],[cN(r)],!1,!0);let o=0;return oa(e).ee({index:b1,X:!0,range:s},(([i,a],l,c)=>{i!==0&&(o++,c.done())})).next((()=>o>0))}At(e,n){return uu(e).get(n).next((r=>r?Of(r):null))}}function uu(t){return Dn(t,zd)}function mS(t){return Dn(t,dc)}function oa(t){return Dn(t,Gd)}const pS="LruGarbageCollector",RD=1048576;function gS([t,e],[n,r]){const s=et(t,n);return s===0?et(e,r):s}class tH{constructor(e){this.Ir=e,this.buffer=new Mt(gS),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();gS(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ND{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ve(pS,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Za(n)?ve(pS,"Ignoring IndexedDB error during garbage collection: ",n):await Xa(n)}await this.Vr(3e5)}))}}class nH{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return te.resolve(Dr.ce);const r=new tH(n);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),te.resolve(fS)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fS):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,o,i,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((h=>(h>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,i=Date.now(),this.nthSequenceNumber(e,s)))).next((h=>(r=h,a=Date.now(),this.removeTargets(e,r,n)))).next((h=>(o=h,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((h=>(c=Date.now(),xu()<=bt.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${i-u}ms
	Determined least recently used ${s} in `+(a-i)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),te.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:h}))))}}function DD(t,e){return new nH(t,e)}class rH{constructor(e,n){this.db=e,this.garbageCollector=DD(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>n.next((s=>r+s))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,((r,s)=>n(s)))}addReference(e,n,r){return Rg(e,r)}removeReference(e,n,r){return Rg(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Rg(e,n)}br(e,n){return(function(s,o){let i=!1;return kD(s).te((a=>PD(s,a,o).next((l=>(l&&(i=!0),te.resolve(!l)))))).next((()=>i))})(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.Sr(e,((i,a)=>{if(a<=n){const l=this.br(e,i).next((c=>{if(!c)return o++,r.getEntry(e,i).next((()=>(r.removeEntry(i,Qe.min()),oa(e).delete((function(h){return[0,ur(h.path)]})(i)))))}));s.push(l)}})).next((()=>te.waitFor(s))).next((()=>r.apply(e))).next((()=>o))}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Rg(e,n)}Sr(e,n){const r=oa(e);let s,o=Dr.ce;return r.ee({index:b1},(([i,a],{path:l,sequenceNumber:c})=>{i===0?(o!==Dr.ce&&n(new Pe(Co(s)),o),o=c,s=l):o=Dr.ce})).next((()=>{o!==Dr.ce&&n(new Pe(Co(s)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Rg(t,e){return oa(t).put((function(r,s){return{targetId:0,path:ur(r.path),sequenceNumber:s}})(e,t.currentSequenceNumber))}class MD{constructor(){this.changes=new ki((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,an.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?te.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class sH{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return gl(e).put(r)}removeEntry(e,n,r){return gl(e).delete((function(o,i){const a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Jy(i),a[a.length-1]]})(n,r))}updateMetadata(e,n){return this.getMetadata(e).next((r=>(r.byteSize+=n,this.Dr(e,r))))}getEntry(e,n){let r=an.newInvalidDocument(n);return gl(e).ee({index:iy,range:IDBKeyRange.only(lf(n))},((s,o)=>{r=this.Cr(n,o)})).next((()=>r))}vr(e,n){let r={size:0,document:an.newInvalidDocument(n)};return gl(e).ee({index:iy,range:IDBKeyRange.only(lf(n))},((s,o)=>{r={document:this.Cr(n,o),size:Zy(o)}})).next((()=>r))}getEntries(e,n){let r=Jr();return this.Fr(e,n,((s,o)=>{const i=this.Cr(s,o);r=r.insert(s,i)})).next((()=>r))}Mr(e,n){let r=Jr(),s=new $t(Pe.comparator);return this.Fr(e,n,((o,i)=>{const a=this.Cr(o,i);r=r.insert(o,a),s=s.insert(o,Zy(i))})).next((()=>({documents:r,Or:s})))}Fr(e,n,r){if(n.isEmpty())return te.resolve();let s=new Mt(bS);n.forEach((l=>s=s.add(l)));const o=IDBKeyRange.bound(lf(s.first()),lf(s.last())),i=s.getIterator();let a=i.getNext();return gl(e).ee({index:iy,range:o},((l,c,u)=>{const h=Pe.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&bS(a,h)<0;)r(a,null),a=i.getNext();a&&a.isEqual(h)&&(r(a,c),a=i.hasNext()?i.getNext():null),a?u.j(lf(a)):u.done()})).next((()=>{for(;a;)r(a,null),a=i.hasNext()?i.getNext():null}))}getDocumentsMatchingQuery(e,n,r,s,o){const i=n.path,a=[i.popLast().toArray(),i.lastSegment(),Jy(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return gl(e).J(IDBKeyRange.bound(a,l,!0)).next((c=>{o?.incrementDocumentReadCount(c.length);let u=Jr();for(const h of c){const f=this.Cr(Pe.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(_p(n,f)||s.has(f.key))&&(u=u.insert(f.key,f))}return u}))}getAllFromCollectionGroup(e,n,r,s){let o=Jr();const i=wS(n,r),a=wS(n,es.max());return gl(e).ee({index:bN,range:IDBKeyRange.bound(i,a,!0)},((l,c,u)=>{const h=this.Cr(Pe.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);o=o.insert(h.key,h),o.size===s&&u.done()})).next((()=>o))}newChangeBuffer(e){return new oH(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((n=>n.byteSize))}getMetadata(e){return yS(e).get(mx).next((n=>(Ke(!!n,20021),n)))}Dr(e,n){return yS(e).put(mx,n)}Cr(e,n){if(n){const r=z6(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Qe.min())))return r}return an.newInvalidDocument(e)}}function OD(t){return new sH(t)}class oH extends MD{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ki((r=>r.toString()),((r,s)=>r.isEqual(s)))}applyChanges(e){const n=[];let r=0,s=new Mt(((o,i)=>et(o.canonicalString(),i.canonicalString())));return this.changes.forEach(((o,i)=>{const a=this.Br.get(o);if(n.push(this.Nr.removeEntry(e,o,a.readTime)),i.isValidDocument()){const l=eS(this.Nr.serializer,i);s=s.add(o.path.popLast());const c=Zy(l);r+=c-a.size,n.push(this.Nr.addEntry(e,o,l))}else if(r-=a.size,this.trackRemovals){const l=eS(this.Nr.serializer,i.convertToNoDocument(Qe.min()));n.push(this.Nr.addEntry(e,o,l))}})),s.forEach((o=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,o))})),n.push(this.Nr.updateMetadata(e,r)),te.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next((r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next((({documents:r,Or:s})=>(s.forEach(((o,i)=>{this.Br.set(o,{size:i,readTime:r.get(o).readTime})})),r)))}}function yS(t){return Dn(t,Am)}function gl(t){return Dn(t,zy)}function lf(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function wS(t,e){const n=e.documentKey.path.toArray();return[t,Jy(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function bS(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let o=0;o<n.length-2&&o<r.length-2;++o)if(s=et(n[o],r[o]),s)return s;return s=et(n.length,r.length),s||(s=et(n[n.length-2],r[r.length-2]),s||et(n[n.length-1],r[r.length-1]))}class iH{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class LD{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,n)))).next((s=>(r!==null&&sm(r.mutation,s,Mr.empty(),Nt.now()),s)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,lt()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=lt()){const s=Eo();return this.populateOverlays(e,s,n).next((()=>this.computeViews(e,n,s,r).next((o=>{let i=Df();return o.forEach(((a,l)=>{i=i.insert(a,l.overlayedDocument)})),i}))))}getOverlayedDocuments(e,n){const r=Eo();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,lt())))}populateOverlays(e,n,r){const s=[];return r.forEach((o=>{n.has(o)||s.push(o)})),this.documentOverlayCache.getOverlays(e,s).next((o=>{o.forEach(((i,a)=>{n.set(i,a)}))}))}computeViews(e,n,r,s){let o=Jr();const i=rm(),a=(function(){return rm()})();return n.forEach(((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Ri)?o=o.insert(c.key,c):u!==void 0?(i.set(c.key,u.mutation.getFieldMask()),sm(u.mutation,c,u.mutation.getFieldMask(),Nt.now())):i.set(c.key,Mr.empty())})),this.recalculateAndSaveOverlays(e,o).next((l=>(l.forEach(((c,u)=>i.set(c,u))),n.forEach(((c,u)=>a.set(c,new iH(u,i.get(c)??null)))),a)))}recalculateAndSaveOverlays(e,n){const r=rm();let s=new $t(((i,a)=>i-a)),o=lt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((i=>{for(const a of i)a.keys().forEach((l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||Mr.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(s.get(a.batchId)||lt()).add(l);s=s.insert(a.batchId,h)}))})).next((()=>{const i=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=XN();u.forEach((f=>{if(!o.has(f)){const g=oD(n.get(f),r.get(f));g!==null&&h.set(f,g),o=o.add(f)}})),i.push(this.documentOverlayCache.saveOverlays(e,c,h))}return te.waitFor(i)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,s){return(function(i){return Pe.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):WN(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next((o=>{const i=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-o.size):te.resolve(Eo());let a=Hd,l=o;return i.next((c=>te.forEach(c,((u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(u)?te.resolve():this.remoteDocumentCache.getEntry(e,u).next((f=>{l=l.insert(u,f)}))))).next((()=>this.populateOverlays(e,c,o))).next((()=>this.computeViews(e,l,c,lt()))).next((u=>({batchId:a,changes:JN(u)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Pe(n)).next((r=>{let s=Df();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const o=n.collectionGroup;let i=Df();return this.indexManager.getCollectionParents(e,o).next((a=>te.forEach(a,(l=>{const c=(function(h,f){return new Ch(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(n,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next((u=>{u.forEach(((h,f)=>{i=i.insert(h,f)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,n,r,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((i=>(o=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,s)))).next((i=>{o.forEach(((l,c)=>{const u=c.getKey();i.get(u)===null&&(i=i.insert(u,an.newInvalidDocument(u)))}));let a=Df();return i.forEach(((l,c)=>{const u=o.get(l);u!==void 0&&sm(u.mutation,c,Mr.empty(),Nt.now()),_p(n,c)&&(a=a.insert(l,c))})),a}))}}class aH{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return te.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(s){return{id:s.id,version:s.version,createTime:Er(s.createTime)}})(n)),te.resolve()}getNamedQuery(e,n){return te.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(s){return{name:s.name,query:ID(s.bundledQuery),readTime:Er(s.readTime)}})(n)),te.resolve()}}class lH{constructor(){this.overlays=new $t(Pe.comparator),this.qr=new Map}getOverlay(e,n){return te.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Eo();return te.forEach(n,(s=>this.getOverlay(e,s).next((o=>{o!==null&&r.set(s,o)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((s,o)=>{this.St(e,n,o)})),te.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(r)),te.resolve()}getOverlaysForCollection(e,n,r){const s=Eo(),o=n.length+1,i=new Pe(n.child("")),a=this.overlays.getIteratorFrom(i);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>r&&s.set(l.getKey(),l)}return te.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let o=new $t(((c,u)=>c-u));const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=o.get(c.largestBatchId);u===null&&(u=Eo(),o=o.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=Eo(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,u)=>a.set(c,u))),!(a.size()>=s)););return te.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const i=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(r.key,new R1(n,r));let o=this.qr.get(n);o===void 0&&(o=lt(),this.qr.set(n,o)),this.qr.set(n,o.add(r.key))}}class cH{constructor(){this.sessionToken=yn.EMPTY_BYTE_STRING}getSessionToken(e){return te.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,te.resolve()}}class L1{constructor(){this.Qr=new Mt(Fn.$r),this.Ur=new Mt(Fn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Fn(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Gr(new Fn(e,n))}zr(e,n){e.forEach((r=>this.removeReference(r,n)))}jr(e){const n=new Pe(new _t([])),r=new Fn(n,e),s=new Fn(n,e+1),o=[];return this.Ur.forEachInRange([r,s],(i=>{this.Gr(i),o.push(i.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Pe(new _t([])),r=new Fn(n,e),s=new Fn(n,e+1);let o=lt();return this.Ur.forEachInRange([r,s],(i=>{o=o.add(i.key)})),o}containsKey(e){const n=new Fn(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Fn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Pe.comparator(e.key,n.key)||et(e.Yr,n.Yr)}static Kr(e,n){return et(e.Yr,n.Yr)||Pe.comparator(e.key,n.key)}}class uH{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Mt(Fn.$r)}checkEmpty(e){return te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new P1(o,n,r,s);this.mutationQueue.push(i);for(const a of s)this.Zr=this.Zr.add(new Fn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return te.resolve(i)}lookupMutationBatch(e,n){return te.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),o=s<0?0:s;return te.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return te.resolve(this.mutationQueue.length===0?uc:this.tr-1)}getAllMutationBatches(e){return te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Fn(n,0),s=new Fn(n,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,s],(i=>{const a=this.Xr(i.Yr);o.push(a)})),te.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Mt(et);return n.forEach((s=>{const o=new Fn(s,0),i=new Fn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,i],(a=>{r=r.add(a.Yr)}))})),te.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let o=r;Pe.isDocumentKey(o)||(o=o.child(""));const i=new Fn(new Pe(o),0);let a=new Mt(et);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Yr)),!0)}),i),te.resolve(this.ti(a))}ti(e){const n=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&n.push(s)})),n}removeMutationBatch(e,n){Ke(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return te.forEach(n.mutations,(s=>{const o=new Fn(s.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,n){const r=new Fn(n,0),s=this.Zr.firstAfterOrEqual(r);return te.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,te.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class dH{constructor(e){this.ri=e,this.docs=(function(){return new $t(Pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),o=s?s.size:0,i=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:i}),this.size+=i-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return te.resolve(r?r.document.mutableCopy():an.newInvalidDocument(n))}getEntries(e,n){let r=Jr();return n.forEach((s=>{const o=this.docs.get(s);r=r.insert(s,o?o.document.mutableCopy():an.newInvalidDocument(s))})),te.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let o=Jr();const i=n.path,a=new Pe(i.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||y1(fN(u),r)<=0||(s.has(u.key)||_p(n,u))&&(o=o.insert(u.key,u.mutableCopy()))}return te.resolve(o)}getAllFromCollectionGroup(e,n,r,s){Fe(9500)}ii(e,n){return te.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new hH(this)}getSize(e){return te.resolve(this.size)}}class hH extends MD{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),te.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class fH{constructor(e){this.persistence=e,this.si=new ki((n=>Pc(n)),Ep),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.oi=0,this._i=new L1,this.targetCount=0,this.ai=Mc.ur()}forEachTarget(e,n){return this.si.forEach(((r,s)=>n(s))),te.resolve()}getLastRemoteSnapshotVersion(e){return te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return te.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),te.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),te.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Mc(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,te.resolve()}updateTargetData(e,n){return this.Pr(n),te.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,te.resolve()}removeTargets(e,n,r){let s=0;const o=[];return this.si.forEach(((i,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(i),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)})),te.waitFor(o).next((()=>s))}getTargetCount(e){return te.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return te.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),te.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,o=[];return s&&n.forEach((i=>{o.push(s.markPotentiallyOrphaned(e,i))})),te.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),te.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return te.resolve(r)}containsKey(e,n){return te.resolve(this._i.containsKey(n))}}class F1{constructor(e,n){this.ui={},this.overlays={},this.ci=new Dr(0),this.li=!1,this.li=!0,this.hi=new cH,this.referenceDelegate=e(this),this.Pi=new fH(this),this.indexManager=new X6,this.remoteDocumentCache=(function(s){return new dH(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new CD(n),this.Ii=new aH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new lH,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new uH(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ve("MemoryPersistence","Starting transaction:",e);const s=new mH(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((o=>this.referenceDelegate.di(s).next((()=>o)))).toPromise().then((o=>(s.raiseOnCommittedEvent(),o)))}Ai(e,n){return te.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,n))))}}class mH extends pN{constructor(e){super(),this.currentSequenceNumber=e}}class Sb{constructor(e){this.persistence=e,this.Ri=new L1,this.Vi=null}static mi(e){return new Sb(e)}get fi(){if(this.Vi)return this.Vi;throw Fe(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),te.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),te.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),te.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((s=>{s.forEach((o=>this.fi.add(o.toString())))})).next((()=>r.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return te.forEach(this.fi,(r=>{const s=Pe.fromPath(r);return this.gi(e,s).next((o=>{o||n.removeEntry(s,Qe.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return te.or([()=>te.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class ew{constructor(e,n){this.persistence=e,this.pi=new ki((r=>ur(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=DD(this,n)}static mi(e,n){return new ew(e,n)}Ei(){}di(e){return te.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((s=>r+s))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}pr(e,n){return te.forEach(this.pi,((r,s)=>this.br(e,r,s).next((o=>o?te.resolve():n(s)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ii(e,(i=>this.br(e,i,n).next((a=>{a||(r++,o.removeEntry(i,Qe.min()))})))).next((()=>o.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),te.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),te.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),te.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),te.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=ly(e.data.value)),n}br(e,n,r){return te.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return te.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class pH{constructor(e){this.serializer=e}k(e,n,r,s){const o=new pb("createOrUpgrade",n);r<1&&s>=1&&((function(l){l.createObjectStore(Cp)})(e),(function(l){l.createObjectStore(_m,{keyPath:RU}),l.createObjectStore(Bs,{keyPath:kA,autoIncrement:!0}).createIndex(jl,RA,{unique:!0}),l.createObjectStore($d)})(e),vS(e),(function(l){l.createObjectStore(_l)})(e));let i=te.resolve();return r<3&&s>=3&&(r!==0&&((function(l){l.deleteObjectStore(Gd),l.deleteObjectStore(zd),l.deleteObjectStore(dc)})(e),vS(e)),i=i.next((()=>(function(l){const c=l.store(dc),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Qe.min().toTimestamp(),targetCount:0};return c.put(Gy,u)})(o)))),r<4&&s>=4&&(r!==0&&(i=i.next((()=>(function(l,c){return c.store(Bs).J().next((h=>{l.deleteObjectStore(Bs),l.createObjectStore(Bs,{keyPath:kA,autoIncrement:!0}).createIndex(jl,RA,{unique:!0});const f=c.store(Bs),g=h.map((y=>f.put(y)));return te.waitFor(g)}))})(e,o)))),i=i.next((()=>{(function(l){l.createObjectStore(Wd,{keyPath:BU})})(e)}))),r<5&&s>=5&&(i=i.next((()=>this.yi(o)))),r<6&&s>=6&&(i=i.next((()=>((function(l){l.createObjectStore(Am)})(e),this.wi(o))))),r<7&&s>=7&&(i=i.next((()=>this.Si(o)))),r<8&&s>=8&&(i=i.next((()=>this.bi(e,o)))),r<9&&s>=9&&(i=i.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&s>=10&&(i=i.next((()=>this.Di(o)))),r<11&&s>=11&&(i=i.next((()=>{(function(l){l.createObjectStore(yb,{keyPath:UU})})(e),(function(l){l.createObjectStore(wb,{keyPath:HU})})(e)}))),r<12&&s>=12&&(i=i.next((()=>{(function(l){const c=l.createObjectStore(bb,{keyPath:QU});c.createIndex(gx,YU,{unique:!1}),c.createIndex(EN,JU,{unique:!1})})(e)}))),r<13&&s>=13&&(i=i.next((()=>(function(l){const c=l.createObjectStore(zy,{keyPath:DU});c.createIndex(iy,MU),c.createIndex(bN,OU)})(e))).next((()=>this.Ci(e,o))).next((()=>e.deleteObjectStore(_l)))),r<14&&s>=14&&(i=i.next((()=>this.Fi(e,o)))),r<15&&s>=15&&(i=i.next((()=>(function(l){l.createObjectStore(v1,{keyPath:$U,autoIncrement:!0}).createIndex(px,zU,{unique:!1}),l.createObjectStore(Zf,{keyPath:GU}).createIndex(xN,WU,{unique:!1}),l.createObjectStore(em,{keyPath:KU}).createIndex(CN,qU,{unique:!1})})(e)))),r<16&&s>=16&&(i=i.next((()=>{n.objectStore(Zf).clear()})).next((()=>{n.objectStore(em).clear()}))),r<17&&s>=17&&(i=i.next((()=>{(function(l){l.createObjectStore(x1,{keyPath:XU})})(e)}))),r<18&&s>=18&&q2()&&(i=i.next((()=>{n.objectStore(Zf).clear()})).next((()=>{n.objectStore(em).clear()}))),i}wi(e){let n=0;return e.store(_l).ee(((r,s)=>{n+=Zy(s)})).next((()=>{const r={byteSize:n};return e.store(Am).put(mx,r)}))}yi(e){const n=e.store(_m),r=e.store(Bs);return n.J().next((s=>te.forEach(s,(o=>{const i=IDBKeyRange.bound([o.userId,uc],[o.userId,o.lastAcknowledgedBatchId]);return r.J(jl,i).next((a=>te.forEach(a,(l=>{Ke(l.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=kl(this.serializer,l);return TD(e,o.userId,c).next((()=>{}))}))))}))))}Si(e){const n=e.store(Gd),r=e.store(_l);return e.store(dc).get(Gy).next((s=>{const o=[];return r.ee(((i,a)=>{const l=new _t(i),c=(function(h){return[0,ur(h)]})(l);o.push(n.get(c).next((u=>u?te.resolve():(h=>n.put({targetId:0,path:ur(h),sequenceNumber:s.highestListenSequenceNumber}))(l))))})).next((()=>te.waitFor(o)))}))}bi(e,n){e.createObjectStore(Sm,{keyPath:VU});const r=n.store(Sm),s=new O1,o=i=>{if(s.add(i)){const a=i.lastSegment(),l=i.popLast();return r.put({collectionId:a,parent:ur(l)})}};return n.store(_l).ee({X:!0},((i,a)=>{const l=new _t(i);return o(l.popLast())})).next((()=>n.store($d).ee({X:!0},(([i,a,l],c)=>{const u=Co(a);return o(u.popLast())}))))}Di(e){const n=e.store(zd);return n.ee(((r,s)=>{const o=Of(s),i=ED(this.serializer,o);return n.put(i)}))}Ci(e,n){const r=n.store(_l),s=[];return r.ee(((o,i)=>{const a=n.store(zy),l=(function(h){return h.document?new Pe(_t.fromString(h.document.name).popFirst(5)):h.noDocument?Pe.fromSegments(h.noDocument.path):h.unknownDocument?Pe.fromSegments(h.unknownDocument.path):Fe(36783)})(i).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:i.readTime||[0,0],unknownDocument:i.unknownDocument,noDocument:i.noDocument,document:i.document,hasCommittedMutations:!!i.hasCommittedMutations};s.push(a.put(c))})).next((()=>te.waitFor(s)))}Fi(e,n){const r=n.store(Bs),s=OD(this.serializer),o=new F1(Sb.mi,this.serializer.yt);return r.J().next((i=>{const a=new Map;return i.forEach((l=>{let c=a.get(l.userId)??lt();kl(this.serializer,l).keys().forEach((u=>c=c.add(u))),a.set(l.userId,c)})),te.forEach(a,((l,c)=>{const u=new ir(c),h=_b.wt(this.serializer,u),f=o.getIndexManager(u),g=Ab.wt(u,this.serializer,f,o.referenceDelegate);return new LD(s,g,h,f).recalculateAndSaveOverlaysForDocumentKeys(new yx(n,Dr.ce),l).next()}))}))}}function vS(t){t.createObjectStore(Gd,{keyPath:FU}).createIndex(b1,jU,{unique:!0}),t.createObjectStore(zd,{keyPath:"targetId"}).createIndex(vN,LU,{unique:!0}),t.createObjectStore(dc)}const zi="IndexedDbPersistence",Z0=18e5,ev=5e3,tv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",gH="main";class j1{constructor(e,n,r,s,o,i,a,l,c,u,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=o,this.window=i,this.document=a,this.xi=c,this.Oi=u,this.Ni=h,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=f=>Promise.resolve(),!j1.v())throw new Ae(he.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new rH(this,s),this.$i=n+gH,this.serializer=new CD(l),this.Ui=new Da(this.$i,this.Ni,new pH(this.serializer)),this.hi=new W6,this.Pi=new eH(this.referenceDelegate,this.serializer),this.remoteDocumentCache=OD(this.serializer),this.Ii=new G6,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,u===!1&&mn(zi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ae(he.FAILED_PRECONDITION,tv);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Dr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async n=>{n.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Ng(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((n=>this.isPrimary&&!n?this.Zi(e).next((()=>!1)):!!n&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Za(e))return ve(zi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ve(zi,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return cf(e).get(ou).next((n=>te.resolve(this.es(n))))}ts(e){return Ng(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Z0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(n=>{const r=Dn(n,Wd);return r.J().next((s=>{const o=this.ss(s,Z0),i=s.filter((a=>o.indexOf(a)===-1));return te.forEach(i,(a=>r.delete(a.clientId))).next((()=>i))}))})).catch((()=>[]));if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?te.resolve(!0):cf(e).get(ou).next((n=>{if(n!==null&&this.rs(n.leaseTimestampMs,ev)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new Ae(he.FAILED_PRECONDITION,tv);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ng(e).J().next((r=>this.ss(r,ev).find((s=>{if(this.clientId!==s.clientId){const o=!this.networkEnabled&&s.networkEnabled,i=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(o||i&&a)return!0}return!1}))===void 0))})).next((n=>(this.isPrimary!==n&&ve(zi,`Client ${n?"is":"is not"} eligible for a primary lease.`),n)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Cp,Wd],(e=>{const n=new yx(e,Dr.ce);return this.Zi(n).next((()=>this.ts(n)))})),this.Ui.close(),this.Ps()}ss(e,n){return e.filter((r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Ng(e).J().next((n=>this.ss(n,Z0).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Ab.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Z6(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return _b.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){ve(zi,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",o=(function(l){return l===18?t6:l===17?SN:l===16?e6:l===15?C1:l===14?AN:l===13?_N:l===12?ZU:l===11?IN:void Fe(60245)})(this.Ni);let i;return this.Ui.runTransaction(e,s,o,(a=>(i=new yx(a,this.ci?this.ci.next():Dr.ce),n==="readwrite-primary"?this.Hi(i).next((l=>!!l||this.Yi(i))).next((l=>{if(!l)throw mn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ae(he.FAILED_PRECONDITION,mN);return r(i)})).next((l=>this.Xi(i).next((()=>l)))):this.Is(i).next((()=>r(i)))))).then((a=>(i.raiseOnCommittedEvent(),a)))}Is(e){return cf(e).get(ou).next((n=>{if(n!==null&&this.rs(n.leaseTimestampMs,ev)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Ae(he.FAILED_PRECONDITION,tv)}))}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return cf(e).put(ou,n)}static v(){return Da.v()}Zi(e){const n=cf(e);return n.get(ou).next((r=>this.es(r)?(ve(zi,"Releasing primary lease."),n.delete(ou)):te.resolve()))}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(mn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;K2()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const n=this.Ki?.getItem(this._s(e))!==null;return ve(zi,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return mn(zi,"Failed to get zombied client id.",n),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){mn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function cf(t){return Dn(t,Cp)}function Ng(t){return Dn(t,Wd)}function FD(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class V1{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=lt(),s=lt();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new V1(e,n.fromCache,r,s)}}class yH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class jD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return K2()?8:gN(Rn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const o={result:null};return this.ys(e,n).next((i=>{o.result=i})).next((()=>{if(!o.result)return this.ws(e,n,s,r).next((i=>{o.result=i}))})).next((()=>{if(o.result)return;const i=new yH;return this.Ss(e,n,i).next((a=>{if(o.result=a,this.Vs)return this.bs(e,n,i,a.size)}))})).next((()=>o.result))}bs(e,n,r,s){return r.documentReadCount<this.fs?(xu()<=bt.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",Cu(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),te.resolve()):(xu()<=bt.DEBUG&&ve("QueryEngine","Query:",Cu(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(xu()<=bt.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",Cu(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zr(n))):te.resolve())}ys(e,n){if(zA(n))return te.resolve(null);let r=Zr(n);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(n.limit!==null&&s===1&&(n=Ix(n,null,"F"),r=Zr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((o=>{const i=lt(...o);return this.ps.getDocuments(e,i).next((a=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(n,a);return this.Cs(n,c,i,l.readTime)?this.ys(e,Ix(n,null,"F")):this.vs(e,c,n,l)}))))})))))}ws(e,n,r,s){return zA(n)||s.isEqual(Qe.min())?te.resolve(null):this.ps.getDocuments(e,r).next((o=>{const i=this.Ds(n,o);return this.Cs(n,i,r,s)?te.resolve(null):(xu()<=bt.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Cu(n)),this.vs(e,i,n,hN(s,Hd)).next((a=>a)))}))}Ds(e,n){let r=new Mt(QN(e));return n.forEach(((s,o)=>{_p(e,o)&&(r=r.add(o))})),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(e,n,r){return xu()<=bt.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",Cu(n)),this.ps.getDocumentsMatchingQuery(e,n,es.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((o=>(n.forEach((i=>{o=o.insert(i.key,i)})),o)))}}const B1="LocalStore",wH=3e8;class bH{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new $t(et),this.xs=new ki((o=>Pc(o)),Ep),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function VD(t,e,n,r){return new bH(t,e,n,r)}async function BD(t,e){const n=Ge(t);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next((o=>(s=o,n.Bs(e),n.mutationQueue.getAllMutationBatches(r)))).next((o=>{const i=[],a=[];let l=lt();for(const c of s){i.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of o){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:i,addedBatchIds:a})))}))}))}function vH(t,e){const n=Ge(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),o=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,u){const h=c.batch,f=h.keys();let g=te.resolve();return f.forEach((y=>{g=g.next((()=>u.getEntry(l,y))).next((w=>{const v=c.docVersions.get(y);Ke(v!==null,48541),w.version.compareTo(v)<0&&(h.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),u.addEntry(w)))}))})),g.next((()=>a.mutationQueue.removeMutationBatch(l,h)))})(n,r,e,o).next((()=>o.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let l=lt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e)))).next((()=>n.localDocuments.getDocuments(r,s)))}))}function UD(t){const e=Ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function xH(t,e){const n=Ge(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const i=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach(((u,h)=>{const f=s.get(h);if(!f)return;a.push(n.Pi.removeMatchingKeys(o,u.removedDocuments,h).next((()=>n.Pi.addMatchingKeys(o,u.addedDocuments,h))));let g=f.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(yn.EMPTY_BYTE_STRING,Qe.min()).withLastLimboFreeSnapshotVersion(Qe.min()):u.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(u.resumeToken,r)),s=s.insert(h,g),(function(w,v,C){return w.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=wH?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0})(f,g,u)&&a.push(n.Pi.updateTargetData(o,g))}));let l=Jr(),c=lt();if(e.documentUpdates.forEach((u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(o,u))})),a.push(CH(o,i,e.documentUpdates).next((u=>{l=u.ks,c=u.qs}))),!r.isEqual(Qe.min())){const u=n.Pi.getLastRemoteSnapshotVersion(o).next((h=>n.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r)));a.push(u)}return te.waitFor(a).next((()=>i.apply(o))).next((()=>n.localDocuments.getLocalViewOfDocuments(o,l,c))).next((()=>l))})).then((o=>(n.Ms=s,o)))}function CH(t,e,n){let r=lt(),s=lt();return n.forEach((o=>r=r.add(o))),e.getEntries(t,r).next((o=>{let i=Jr();return n.forEach(((a,l)=>{const c=o.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(Qe.min())?(e.removeEntry(a,l.readTime),i=i.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),i=i.insert(a,l)):ve(B1,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)})),{ks:i,qs:s}}))}function EH(t,e){const n=Ge(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=uc),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function tw(t,e){const n=Ge(t);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return n.Pi.getTargetData(r,e).next((o=>o?(s=o,te.resolve(s)):n.Pi.allocateTargetId(r).next((i=>(s=new di(e,i,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r}))}async function eh(t,e,n){const r=Ge(t),s=r.Ms.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,(i=>r.persistence.referenceDelegate.removeTarget(i,s)))}catch(i){if(!Za(i))throw i;ve(B1,`Failed to update sequence numbers for target ${e}: ${i}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function Nx(t,e,n){const r=Ge(t);let s=Qe.min(),o=lt();return r.persistence.runTransaction("Execute query","readwrite",(i=>(function(l,c,u){const h=Ge(l),f=h.xs.get(u);return f!==void 0?te.resolve(h.Ms.get(f)):h.Pi.getTargetData(c,u)})(r,i,Zr(e)).next((a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(i,a.targetId).next((l=>{o=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(i,e,n?s:Qe.min(),n?o:lt()))).next((a=>(zD(r,qN(e),a),{documents:a,Qs:o})))))}function HD(t,e){const n=Ge(t),r=Ge(n.Pi),s=n.Ms.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",(o=>r.At(o,e).next((i=>i?i.target:null))))}function $D(t,e){const n=Ge(t),r=n.Os.get(e)||Qe.min();return n.persistence.runTransaction("Get new document changes","readonly",(s=>n.Ns.getAllFromCollectionGroup(s,e,hN(r,Hd),Number.MAX_SAFE_INTEGER))).then((s=>(zD(n,e,s),s)))}function zD(t,e,n){let r=t.Os.get(e)||Qe.min();n.forEach(((s,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),t.Os.set(e,r)}const GD="firestore_clients";function xS(t,e){return`${GD}_${t}_${e}`}const WD="firestore_mutations";function CS(t,e,n){let r=`${WD}_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const KD="firestore_targets";function nv(t,e){return`${KD}_${t}_${e}`}const go="SharedClientState";class nw{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Ws(e,n,r){const s=JSON.parse(r);let o,i=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return i&&s.error&&(i=typeof s.error.message=="string"&&typeof s.error.code=="string",i&&(o=new Ae(s.error.code,s.error.message))),i?new nw(e,n,s.state,o):(mn(go,`Failed to parse mutation state for ID '${n}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class om{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ws(e,n){const r=JSON.parse(n);let s,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(s=new Ae(r.error.code,r.error.message))),o?new om(e,r.state,s):(mn(go,`Failed to parse target state for ID '${e}': ${n}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class rw{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ws(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,o=S1();for(let i=0;s&&i<r.activeTargetIds.length;++i)s=yN(r.activeTargetIds[i]),o=o.add(r.activeTargetIds[i]);return s?new rw(e,o):(mn(go,`Failed to parse client data for instance '${e}': ${n}`),null)}}class U1{constructor(e,n){this.clientId=e,this.onlineState=n}static Ws(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new U1(n.clientId,n.onlineState):(mn(go,`Failed to parse online state: ${e}`),null)}}class Dx{constructor(){this.activeTargetIds=S1()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rv{constructor(e,n,r,s,o){this.window=e,this.Mi=n,this.persistenceKey=r,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new $t(et),this.started=!1,this.Xs=[];const i=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.eo=xS(this.persistenceKey,this.Js),this.no=(function(l){return`firestore_sequence_number_${l}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Dx),this.ro=new RegExp(`^${GD}_${i}_([^_]*)$`),this.io=new RegExp(`^${WD}_${i}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${KD}_${i}_(\\d+)$`),this.oo=(function(l){return`firestore_online_state_${l}`})(this.persistenceKey),this._o=(function(l){return`firestore_bundle_loaded_v2_${l}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const s=this.getItem(xS(this.persistenceKey,r));if(s){const o=rw.Ws(r,s);o&&(this.Zs=this.Zs.insert(o.clientId,o))}}this.ao();const n=this.storage.getItem(this.oo);if(n){const r=this.uo(n);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let n=!1;return this.Zs.forEach(((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)})),n}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,n,r){this.ho(e,n,r),this.Po(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(nv(this.persistenceKey,e));if(s){const o=om.Ws(e,s);o&&(r=o.state)}}return n&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(nv(this.persistenceKey,e))}updateQueryState(e,n,r){this.Io(e,n,r)}handleUserChange(e,n,r){n.forEach((s=>{this.Po(s)})),this.currentUser=e,r.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return ve(go,"READ",e,n),n}setItem(e,n){ve(go,"SET",e,n),this.storage.setItem(e,n)}removeItem(e){ve(go,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const n=e;if(n.storageArea===this.storage){if(ve(go,"EVENT",n.key,n.newValue),n.key===this.eo)return void mn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(n.key!==null){if(this.ro.test(n.key)){if(n.newValue==null){const r=this.Ro(n.key);return this.Vo(r,null)}{const r=this.mo(n.key,n.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(n.key)){if(n.newValue!==null){const r=this.fo(n.key,n.newValue);if(r)return this.po(r)}}else if(this.so.test(n.key)){if(n.newValue!==null){const r=this.yo(n.key,n.newValue);if(r)return this.wo(r)}}else if(n.key===this.oo){if(n.newValue!==null){const r=this.uo(n.newValue);if(r)return this.co(r)}}else if(n.key===this.no){const r=(function(o){let i=Dr.ce;if(o!=null)try{const a=JSON.parse(o);Ke(typeof a=="number",30636,{So:o}),i=a}catch(a){mn(go,"Failed to read sequence number from WebStorage",a)}return i})(n.newValue);r!==Dr.ce&&this.sequenceNumberHandler(r)}else if(n.key===this._o){const r=this.bo(n.newValue);await Promise.all(r.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(n)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,n,r){const s=new nw(this.currentUser,e,n,r),o=CS(this.persistenceKey,this.currentUser,e);this.setItem(o,s.Gs())}Po(e){const n=CS(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Eo(e){const n={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(n))}Io(e,n,r){const s=nv(this.persistenceKey,e),o=new om(e,n,r);this.setItem(s,o.Gs())}Ao(e){const n=JSON.stringify(Array.from(e));this.setItem(this._o,n)}Ro(e){const n=this.ro.exec(e);return n?n[1]:null}mo(e,n){const r=this.Ro(e);return rw.Ws(r,n)}fo(e,n){const r=this.io.exec(e),s=Number(r[1]),o=r[2]!==void 0?r[2]:null;return nw.Ws(new ir(o),s,n)}yo(e,n){const r=this.so.exec(e),s=Number(r[1]);return om.Ws(s,n)}uo(e){return U1.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ve(go,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,n){const r=n?this.Zs.insert(e,n):this.Zs.remove(e),s=this.lo(this.Zs),o=this.lo(r),i=[],a=[];return o.forEach((l=>{s.has(l)||i.push(l)})),s.forEach((l=>{o.has(l)||a.push(l)})),this.syncEngine.Fo(i,a).then((()=>{this.Zs=r}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let n=S1();return e.forEach(((r,s)=>{n=n.unionWith(s.activeTargetIds)})),n}}class qD{constructor(){this.Mo=new Dx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Dx,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class IH{Oo(e){}shutdown(){}}const ES="ConnectivityMonitor";class IS{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ve(ES,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ve(ES,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Dg=null;function Mx(){return Dg===null?Dg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Dg++,"0x"+Dg.toString(16)}const sv="RestConnection",_H={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class AH{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Wy?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,o){const i=Mx(),a=this.zo(e,n.toUriEncodedString());ve(sv,`Sending RPC '${e}' ${i}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,o);const{host:c}=new URL(a),u=Ja(c);return this.Jo(e,a,l,r,u).then((h=>(ve(sv,`Received RPC '${e}' ${i}: `,h),h)),(h=>{throw Cm(sv,`RPC '${e}' ${i} failed with error: `,h,"url: ",a,"request:",r),h}))}Ho(e,n,r,s,o,i){return this.Go(e,n,r,s,o)}jo(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+xh})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((s,o)=>e[o]=s)),r&&r.headers.forEach(((s,o)=>e[o]=s))}zo(e,n){const r=_H[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}class SH{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const tr="WebChannelConnection";class TH extends AH{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,o){const i=Mx();return new Promise(((a,l)=>{const c=new rN;c.setWithCredentials(!0),c.listenOnce(sN.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case ry.NO_ERROR:const h=c.getResponseJson();ve(tr,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),a(h);break;case ry.TIMEOUT:ve(tr,`RPC '${e}' ${i} timed out`),l(new Ae(he.DEADLINE_EXCEEDED,"Request time out"));break;case ry.HTTP_ERROR:const f=c.getStatus();if(ve(tr,`RPC '${e}' ${i} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g?.error;if(y&&y.status&&y.message){const w=(function(C){const x=C.toLowerCase().replace(/_/g,"-");return Object.values(he).indexOf(x)>=0?x:he.UNKNOWN})(y.status);l(new Ae(w,y.message))}else l(new Ae(he.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Ae(he.UNAVAILABLE,"Connection failed."));break;default:Fe(9055,{l_:e,streamId:i,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{ve(tr,`RPC '${e}' ${i} completed.`)}}));const u=JSON.stringify(s);ve(tr,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)}))}T_(e,n,r){const s=Mx(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=aN(),a=iN(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const u=o.join("");ve(tr,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=i.createWebChannel(u,l);this.I_(h);let f=!1,g=!1;const y=new SH({Yo:v=>{g?ve(tr,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(f||(ve(tr,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),ve(tr,`RPC '${e}' stream ${s} sending:`,v),h.send(v))},Zo:()=>h.close()}),w=(v,C,x)=>{v.listen(C,(A=>{try{x(A)}catch(N){setTimeout((()=>{throw N}),0)}}))};return w(h,Nf.EventType.OPEN,(()=>{g||(ve(tr,`RPC '${e}' stream ${s} transport opened.`),y.o_())})),w(h,Nf.EventType.CLOSE,(()=>{g||(g=!0,ve(tr,`RPC '${e}' stream ${s} transport closed`),y.a_(),this.E_(h))})),w(h,Nf.EventType.ERROR,(v=>{g||(g=!0,Cm(tr,`RPC '${e}' stream ${s} transport errored. Name:`,v.name,"Message:",v.message),y.a_(new Ae(he.UNAVAILABLE,"The operation could not be completed")))})),w(h,Nf.EventType.MESSAGE,(v=>{if(!g){const C=v.data[0];Ke(!!C,16349);const x=C,A=x?.error||x[0]?.error;if(A){ve(tr,`RPC '${e}' stream ${s} received error:`,A);const N=A.status;let M=(function(b){const I=xn[b];if(I!==void 0)return lD(I)})(N),k=A.message;M===void 0&&(M=he.INTERNAL,k="Unknown error status: "+N+" with message "+A.message),g=!0,y.a_(new Ae(M,k)),h.close()}else ve(tr,`RPC '${e}' stream ${s} received:`,C),y.u_(C)}})),w(a,oN.STAT_EVENT,(v=>{v.stat===dx.PROXY?ve(tr,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===dx.NOPROXY&&ve(tr,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function QD(){return typeof window<"u"?window:null}function fy(){return typeof document<"u"?document:null}function Tb(t){return new M6(t,!0)}class YD{constructor(e,n,r=1e3,s=1.5,o=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&ve("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const _S="PersistentStream";class JD{constructor(e,n,r,s,o,i,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=o,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new YD(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===he.RESOURCE_EXHAUSTED?(mn(n.toString()),mn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===he.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===n&&this.G_(r,s)}),(r=>{e((()=>{const s=new Ae(he.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ve(_S,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(ve(_S,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class PH extends JD{constructor(e,n,r,s,o,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,i),this.serializer=o}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=F6(this.serializer,e),r=(function(o){if(!("targetChange"in o))return Qe.min();const i=o.targetChange;return i.targetIds&&i.targetIds.length?Qe.min():i.readTime?Er(i.readTime):Qe.min()})(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Sx(this.serializer),n.addTarget=(function(o,i){let a;const l=i.target;if(a=Ky(l)?{documents:gD(o,l)}:{query:yD(o,l).ft},a.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){a.resumeToken=dD(o,i.resumeToken);const c=_x(o,i.expectedCount);c!==null&&(a.expectedCount=c)}else if(i.snapshotVersion.compareTo(Qe.min())>0){a.readTime=Zd(o,i.snapshotVersion.toTimestamp());const c=_x(o,i.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);const r=V6(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Sx(this.serializer),n.removeTarget=e,this.q_(n)}}class kH extends JD{constructor(e,n,r,s,o,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,i),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Ke(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ke(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ke(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=j6(e.writeResults,e.commitTime),r=Er(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Sx(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>Yy(this.serializer,r)))};this.q_(n)}}class RH{}class NH extends RH{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Ae(he.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,i])=>this.connection.Go(e,Ax(n,r),s,o,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===he.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ae(he.UNKNOWN,o.toString())}))}Ho(e,n,r,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Ho(e,Ax(n,r),s,i,a,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===he.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ae(he.UNKNOWN,i.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class DH{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(mn(n),this.aa=!1):ve("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Oc="RemoteStore";class MH{constructor(e,n,r,s,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((i=>{r.enqueueAndForget((async()=>{Qc(this)&&(ve(Oc,"Restarting streams for network reachability change."),await(async function(l){const c=Ge(l);c.Ea.add(4),await kp(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Pb(c)})(this))}))})),this.Ra=new DH(r,s)}}async function Pb(t){if(Qc(t))for(const e of t.da)await e(!0)}async function kp(t){for(const e of t.da)await e(!1)}function kb(t,e){const n=Ge(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),z1(n)?$1(n):_h(n).O_()&&H1(n,e))}function th(t,e){const n=Ge(t),r=_h(n);n.Ia.delete(e),r.O_()&&XD(n,e),n.Ia.size===0&&(r.O_()?r.L_():Qc(n)&&n.Ra.set("Unknown"))}function H1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Qe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}_h(t).Y_(e)}function XD(t,e){t.Va.Ue(e),_h(t).Z_(e)}function $1(t){t.Va=new k6({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),_h(t).start(),t.Ra.ua()}function z1(t){return Qc(t)&&!_h(t).x_()&&t.Ia.size>0}function Qc(t){return Ge(t).Ea.size===0}function ZD(t){t.Va=void 0}async function OH(t){t.Ra.set("Online")}async function LH(t){t.Ia.forEach(((e,n)=>{H1(t,e)}))}async function FH(t,e){ZD(t),z1(t)?(t.Ra.ha(e),$1(t)):t.Ra.set("Unknown")}async function jH(t,e,n){if(t.Ra.set("Online"),e instanceof uD&&e.state===2&&e.cause)try{await(async function(s,o){const i=o.cause;for(const a of o.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,i),s.Ia.delete(a),s.Va.removeTarget(a))})(t,e)}catch(r){ve(Oc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await sw(t,r)}else if(e instanceof dy?t.Va.Ze(e):e instanceof cD?t.Va.st(e):t.Va.tt(e),!n.isEqual(Qe.min()))try{const r=await UD(t.localStore);n.compareTo(r)>=0&&await(function(o,i){const a=o.Va.Tt(i);return a.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=o.Ia.get(c);u&&o.Ia.set(c,u.withResumeToken(l.resumeToken,i))}})),a.targetMismatches.forEach(((l,c)=>{const u=o.Ia.get(l);if(!u)return;o.Ia.set(l,u.withResumeToken(yn.EMPTY_BYTE_STRING,u.snapshotVersion)),XD(o,l);const h=new di(u.target,l,c,u.sequenceNumber);H1(o,h)})),o.remoteSyncer.applyRemoteEvent(a)})(t,n)}catch(r){ve(Oc,"Failed to raise snapshot:",r),await sw(t,r)}}async function sw(t,e,n){if(!Za(e))throw e;t.Ea.add(1),await kp(t),t.Ra.set("Offline"),n||(n=()=>UD(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{ve(Oc,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Pb(t)}))}function eM(t,e){return e().catch((n=>sw(t,n,e)))}async function Ih(t){const e=Ge(t),n=Ba(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:uc;for(;VH(e);)try{const s=await EH(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,BH(e,s)}catch(s){await sw(e,s)}tM(e)&&nM(e)}function VH(t){return Qc(t)&&t.Ta.length<10}function BH(t,e){t.Ta.push(e);const n=Ba(t);n.O_()&&n.X_&&n.ea(e.mutations)}function tM(t){return Qc(t)&&!Ba(t).x_()&&t.Ta.length>0}function nM(t){Ba(t).start()}async function UH(t){Ba(t).ra()}async function HH(t){const e=Ba(t);for(const n of t.Ta)e.ea(n.mutations)}async function $H(t,e,n){const r=t.Ta.shift(),s=k1.from(r,e,n);await eM(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await Ih(t)}async function zH(t,e){e&&Ba(t).X_&&await(async function(r,s){if((function(i){return S6(i)&&i!==he.ABORTED})(s.code)){const o=r.Ta.shift();Ba(r).B_(),await eM(r,(()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s))),await Ih(r)}})(t,e),tM(t)&&nM(t)}async function AS(t,e){const n=Ge(t);n.asyncQueue.verifyOperationInProgress(),ve(Oc,"RemoteStore received new credentials");const r=Qc(n);n.Ea.add(3),await kp(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Pb(n)}async function Ox(t,e){const n=Ge(t);e?(n.Ea.delete(2),await Pb(n)):e||(n.Ea.add(2),await kp(n),n.Ra.set("Unknown"))}function _h(t){return t.ma||(t.ma=(function(n,r,s){const o=Ge(n);return o.sa(),new PH(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(t.datastore,t.asyncQueue,{Xo:OH.bind(null,t),t_:LH.bind(null,t),r_:FH.bind(null,t),H_:jH.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),z1(t)?$1(t):t.Ra.set("Unknown")):(await t.ma.stop(),ZD(t))}))),t.ma}function Ba(t){return t.fa||(t.fa=(function(n,r,s){const o=Ge(n);return o.sa(),new kH(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:UH.bind(null,t),r_:zH.bind(null,t),ta:HH.bind(null,t),na:$H.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await Ih(t)):(await t.fa.stop(),t.Ta.length>0&&(ve(Oc,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class G1{constructor(e,n,r,s,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=o,this.deferred=new So,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((i=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,o){const i=Date.now()+r,a=new G1(e,n,i,s,o);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ae(he.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function W1(t,e){if(mn("AsyncQueue",`${e}: ${t}`),Za(t))return new Ae(he.UNAVAILABLE,`${e}: ${t}`);throw t}class zu{static emptySet(e){return new zu(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Pe.comparator(n.key,r.key):(n,r)=>Pe.comparator(n.key,r.key),this.keyedMap=Df(),this.sortedSet=new $t(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof zu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=r.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new zu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class SS{constructor(){this.ga=new $t(Pe.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Fe(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class nh{constructor(e,n,r,s,o,i,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=o,this.fromCache=i,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,o){const i=[];return n.forEach((a=>{i.push({type:0,doc:a})})),new nh(e,n,zu.emptySet(n),i,r,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Cb(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}class GH{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class WH{constructor(){this.queries=TS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=Ge(n),o=s.queries;s.queries=TS(),o.forEach(((i,a)=>{for(const l of a.Sa)l.onError(r)}))})(this,new Ae(he.ABORTED,"Firestore shutting down"))}}function TS(){return new ki((t=>KN(t)),Cb)}async function K1(t,e){const n=Ge(t);let r=3;const s=e.query;let o=n.queries.get(s);o?!o.ba()&&e.Da()&&(r=2):(o=new GH,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await n.onListen(s,!0);break;case 1:o.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(i){const a=W1(i,`Initialization of query '${Cu(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,o),o.Sa.push(e),e.va(n.onlineState),o.wa&&e.Fa(o.wa)&&Q1(n)}async function q1(t,e){const n=Ge(t),r=e.query;let s=3;const o=n.queries.get(r);if(o){const i=o.Sa.indexOf(e);i>=0&&(o.Sa.splice(i,1),o.Sa.length===0?s=e.Da()?0:1:!o.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function KH(t,e){const n=Ge(t);let r=!1;for(const s of e){const o=s.query,i=n.queries.get(o);if(i){for(const a of i.Sa)a.Fa(s)&&(r=!0);i.wa=s}}r&&Q1(n)}function qH(t,e,n){const r=Ge(t),s=r.queries.get(e);if(s)for(const o of s.Sa)o.onError(n);r.queries.delete(e)}function Q1(t){t.Ca.forEach((e=>{e.next()}))}var Lx,PS;(PS=Lx||(Lx={})).Ma="default",PS.Cache="cache";class Y1{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new nh(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=nh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Lx.Cache}}class rM{constructor(e){this.key=e}}class sM{constructor(e){this.key=e}}class QH{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=lt(),this.mutatedKeys=lt(),this.eu=QN(e),this.tu=new zu(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new SS,s=n?n.tu:this.tu;let o=n?n.mutatedKeys:this.mutatedKeys,i=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((u,h)=>{const f=s.get(u),g=_p(this.query,h)?h:null,y=!!f&&this.mutatedKeys.has(f.key),w=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let v=!1;f&&g?f.data.isEqual(g.data)?y!==w&&(r.track({type:3,doc:g}),v=!0):this.su(f,g)||(r.track({type:2,doc:g}),v=!0,(l&&this.eu(g,l)>0||c&&this.eu(g,c)<0)&&(a=!0)):!f&&g?(r.track({type:0,doc:g}),v=!0):f&&!g&&(r.track({type:1,doc:f}),v=!0,(l||c)&&(a=!0)),v&&(g?(i=i.add(g),o=w?o.add(u):o.delete(u)):(i=i.delete(u),o=o.delete(u)))})),this.query.limit!==null)for(;i.size>this.query.limit;){const u=this.query.limitType==="F"?i.last():i.first();i=i.delete(u.key),o=o.delete(u.key),r.track({type:1,doc:u})}return{tu:i,iu:r,Cs:a,mutatedKeys:o}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const i=e.iu.ya();i.sort(((u,h)=>(function(g,y){const w=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Fe(20277,{Rt:v})}};return w(g)-w(y)})(u.type,h.type)||this.eu(u.doc,h.doc))),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,i.length!==0||c?{snapshot:new nh(this.query,e.tu,o,i,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new SS,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=lt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const n=[];return e.forEach((r=>{this.Xa.has(r)||n.push(new sM(r))})),this.Xa.forEach((r=>{e.has(r)||n.push(new rM(r))})),n}cu(e){this.Ya=e.Qs,this.Xa=lt();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return nh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ah="SyncEngine";class YH{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class JH{constructor(e){this.key=e,this.hu=!1}}class XH{constructor(e,n,r,s,o,i){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new ki((a=>KN(a)),Cb),this.Iu=new Map,this.Eu=new Set,this.du=new $t(Pe.comparator),this.Au=new Map,this.Ru=new L1,this.Vu={},this.mu=new Map,this.fu=Mc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function ZH(t,e,n=!0){const r=Rb(t);let s;const o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.lu()):s=await oM(r,e,n,!0),s}async function e8(t,e){const n=Rb(t);await oM(n,e,!0,!1)}async function oM(t,e,n,r){const s=await tw(t.localStore,Zr(e)),o=s.targetId,i=t.sharedClientState.addLocalQueryTarget(o,n);let a;return r&&(a=await J1(t,e,o,i==="current",s.resumeToken)),t.isPrimaryClient&&n&&kb(t.remoteStore,s),a}async function J1(t,e,n,r,s){t.pu=(h,f,g)=>(async function(w,v,C,x){let A=v.view.ru(C);A.Cs&&(A=await Nx(w.localStore,v.query,!1).then((({documents:E})=>v.view.ru(E,A))));const N=x&&x.targetChanges.get(v.targetId),M=x&&x.targetMismatches.get(v.targetId)!=null,k=v.view.applyChanges(A,w.isPrimaryClient,N,M);return Fx(w,v.targetId,k.au),k.snapshot})(t,h,f,g);const o=await Nx(t.localStore,e,!0),i=new QH(e,o.Qs),a=i.ru(o.documents),l=Pp.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=i.applyChanges(a,t.isPrimaryClient,l);Fx(t,n,c.au);const u=new YH(e,n,i);return t.Tu.set(e,u),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),c.snapshot}async function t8(t,e,n){const r=Ge(t),s=r.Tu.get(e),o=r.Iu.get(s.targetId);if(o.length>1)return r.Iu.set(s.targetId,o.filter((i=>!Cb(i,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await eh(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),n&&th(r.remoteStore,s.targetId),rh(r,s.targetId)})).catch(Xa)):(rh(r,s.targetId),await eh(r.localStore,s.targetId,!0))}async function n8(t,e){const n=Ge(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),th(n.remoteStore,r.targetId))}async function r8(t,e,n){const r=tE(t);try{const s=await(function(i,a){const l=Ge(i),c=Nt.now(),u=a.reduce(((g,y)=>g.add(y.key)),lt());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",(g=>{let y=Jr(),w=lt();return l.Ns.getEntries(g,u).next((v=>{y=v,y.forEach(((C,x)=>{x.isValidDocument()||(w=w.add(C))}))})).next((()=>l.localDocuments.getOverlayedDocuments(g,y))).next((v=>{h=v;const C=[];for(const x of a){const A=_6(x,h.get(x.key).overlayedDocument);A!=null&&C.push(new Ri(x.key,A,FN(A.value.mapValue),Pn.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,C,a)})).next((v=>{f=v;const C=v.applyToLocalDocumentSet(h,w);return l.documentOverlayCache.saveOverlays(g,v.batchId,C)}))})).then((()=>({batchId:f.batchId,changes:JN(h)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(i,a,l){let c=i.Vu[i.currentUser.toKey()];c||(c=new $t(et)),c=c.insert(a,l),i.Vu[i.currentUser.toKey()]=c})(r,s.batchId,n),await tl(r,s.changes),await Ih(r.remoteStore)}catch(s){const o=W1(s,"Failed to persist write");n.reject(o)}}async function iM(t,e){const n=Ge(t);try{const r=await xH(n.localStore,e);e.targetChanges.forEach(((s,o)=>{const i=n.Au.get(o);i&&(Ke(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?i.hu=!0:s.modifiedDocuments.size>0?Ke(i.hu,14607):s.removedDocuments.size>0&&(Ke(i.hu,42227),i.hu=!1))})),await tl(n,r,e)}catch(r){await Xa(r)}}function kS(t,e,n){const r=Ge(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach(((o,i)=>{const a=i.view.va(e);a.snapshot&&s.push(a.snapshot)})),(function(i,a){const l=Ge(i);l.onlineState=a;let c=!1;l.queries.forEach(((u,h)=>{for(const f of h.Sa)f.va(a)&&(c=!0)})),c&&Q1(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function s8(t,e,n){const r=Ge(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),o=s&&s.key;if(o){let i=new $t(Pe.comparator);i=i.insert(o,an.newNoDocument(o,Qe.min()));const a=lt().add(o),l=new Tp(Qe.min(),new Map,new $t(et),i,a);await iM(r,l),r.du=r.du.remove(o),r.Au.delete(e),eE(r)}else await eh(r.localStore,e,!1).then((()=>rh(r,e,n))).catch(Xa)}async function o8(t,e){const n=Ge(t),r=e.batch.batchId;try{const s=await vH(n.localStore,e);Z1(n,r,null),X1(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await tl(n,s)}catch(s){await Xa(s)}}async function i8(t,e,n){const r=Ge(t);try{const s=await(function(i,a){const l=Ge(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next((h=>(Ke(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u))).next((()=>l.localDocuments.getDocuments(c,u)))}))})(r.localStore,e);Z1(r,e,n),X1(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await tl(r,s)}catch(s){await Xa(s)}}function X1(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Z1(t,e,n){const r=Ge(t);let s=r.Vu[r.currentUser.toKey()];if(s){const o=s.get(e);o&&(n?o.reject(n):o.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function rh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((r=>{t.Ru.containsKey(r)||aM(t,r)}))}function aM(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(th(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),eE(t))}function Fx(t,e,n){for(const r of n)r instanceof rM?(t.Ru.addReference(r.key,e),a8(t,r)):r instanceof sM?(ve(Ah,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||aM(t,r.key)):Fe(19791,{wu:r})}function a8(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ve(Ah,"New document in limbo: "+n),t.Eu.add(r),eE(t))}function eE(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Pe(_t.fromString(e)),r=t.fu.next();t.Au.set(r,new JH(n)),t.du=t.du.insert(n,r),kb(t.remoteStore,new di(Zr(Ip(n.path)),r,"TargetPurposeLimboResolution",Dr.ce))}}async function tl(t,e,n){const r=Ge(t),s=[],o=[],i=[];r.Tu.isEmpty()||(r.Tu.forEach(((a,l)=>{i.push(r.pu(l,e,n).then((c=>{if((c||n)&&r.isPrimaryClient){const u=c?!c.fromCache:n?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){s.push(c);const u=V1.As(l.targetId,c);o.push(u)}})))})),await Promise.all(i),r.Pu.H_(s),await(async function(l,c){const u=Ge(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",(h=>te.forEach(c,(f=>te.forEach(f.Es,(g=>u.persistence.referenceDelegate.addReference(h,f.targetId,g))).next((()=>te.forEach(f.ds,(g=>u.persistence.referenceDelegate.removeReference(h,f.targetId,g)))))))))}catch(h){if(!Za(h))throw h;ve(B1,"Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const g=u.Ms.get(f),y=g.snapshotVersion,w=g.withLastLimboFreeSnapshotVersion(y);u.Ms=u.Ms.insert(f,w)}}})(r.localStore,o))}async function l8(t,e){const n=Ge(t);if(!n.currentUser.isEqual(e)){ve(Ah,"User change. New user:",e.toKey());const r=await BD(n.localStore,e);n.currentUser=e,(function(o,i){o.mu.forEach((a=>{a.forEach((l=>{l.reject(new Ae(he.CANCELLED,i))}))})),o.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await tl(n,r.Ls)}}function c8(t,e){const n=Ge(t),r=n.Au.get(e);if(r&&r.hu)return lt().add(r.key);{let s=lt();const o=n.Iu.get(e);if(!o)return s;for(const i of o){const a=n.Tu.get(i);s=s.unionWith(a.view.nu)}return s}}async function u8(t,e){const n=Ge(t),r=await Nx(n.localStore,e.query,!0),s=e.view.cu(r);return n.isPrimaryClient&&Fx(n,e.targetId,s.au),s}async function d8(t,e){const n=Ge(t);return $D(n.localStore,e).then((r=>tl(n,r)))}async function h8(t,e,n,r){const s=Ge(t),o=await(function(a,l){const c=Ge(a),u=Ge(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",(h=>u.er(h,l).next((f=>f?c.localDocuments.getDocuments(h,f):te.resolve(null)))))})(s.localStore,e);o!==null?(n==="pending"?await Ih(s.remoteStore):n==="acknowledged"||n==="rejected"?(Z1(s,e,r||null),X1(s,e),(function(a,l){Ge(Ge(a).mutationQueue).ir(l)})(s.localStore,e)):Fe(6720,"Unknown batchState",{Su:n}),await tl(s,o)):ve(Ah,"Cannot apply mutation batch with id: "+e)}async function f8(t,e){const n=Ge(t);if(Rb(n),tE(n),e===!0&&n.gu!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await RS(n,r.toArray());n.gu=!0,await Ox(n.remoteStore,!0);for(const o of s)kb(n.remoteStore,o)}else if(e===!1&&n.gu!==!1){const r=[];let s=Promise.resolve();n.Iu.forEach(((o,i)=>{n.sharedClientState.isLocalQueryTarget(i)?r.push(i):s=s.then((()=>(rh(n,i),eh(n.localStore,i,!0)))),th(n.remoteStore,i)})),await s,await RS(n,r),(function(i){const a=Ge(i);a.Au.forEach(((l,c)=>{th(a.remoteStore,c)})),a.Ru.Jr(),a.Au=new Map,a.du=new $t(Pe.comparator)})(n),n.gu=!1,await Ox(n.remoteStore,!1)}}async function RS(t,e,n){const r=Ge(t),s=[],o=[];for(const i of e){let a;const l=r.Iu.get(i);if(l&&l.length!==0){a=await tw(r.localStore,Zr(l[0]));for(const c of l){const u=r.Tu.get(c),h=await u8(r,u);h.snapshot&&o.push(h.snapshot)}}else{const c=await HD(r.localStore,i);a=await tw(r.localStore,c),await J1(r,lM(c),i,!1,a.resumeToken)}s.push(a)}return r.Pu.H_(o),s}function lM(t){return GN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function m8(t){return(function(n){return Ge(Ge(n).persistence).Ts()})(Ge(t).localStore)}async function p8(t,e,n,r){const s=Ge(t);if(s.gu)return void ve(Ah,"Ignoring unexpected query state notification.");const o=s.Iu.get(e);if(o&&o.length>0)switch(n){case"current":case"not-current":{const i=await $D(s.localStore,qN(o[0])),a=Tp.createSynthesizedRemoteEventForCurrentChange(e,n==="current",yn.EMPTY_BYTE_STRING);await tl(s,i,a);break}case"rejected":await eh(s.localStore,e,!0),rh(s,e,r);break;default:Fe(64155,n)}}async function g8(t,e,n){const r=Rb(t);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){ve(Ah,"Adding an already active target "+s);continue}const o=await HD(r.localStore,s),i=await tw(r.localStore,o);await J1(r,lM(o),i.targetId,!1,i.resumeToken),kb(r.remoteStore,i)}for(const s of n)r.Iu.has(s)&&await eh(r.localStore,s,!1).then((()=>{th(r.remoteStore,s),rh(r,s)})).catch(Xa)}}function Rb(t){const e=Ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=iM.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=c8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=s8.bind(null,e),e.Pu.H_=KH.bind(null,e.eventManager),e.Pu.yu=qH.bind(null,e.eventManager),e}function tE(t){const e=Ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=o8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=i8.bind(null,e),e}class Dm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Tb(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return VD(this.persistence,new jD,e.initialUser,this.serializer)}Cu(e){return new F1(Sb.mi,this.serializer)}Du(e){return new qD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Dm.provider={build:()=>new Dm};class y8 extends Dm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Ke(this.persistence.referenceDelegate instanceof ew,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ND(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?ar.withCacheSize(this.cacheSizeBytes):ar.DEFAULT;return new F1((r=>ew.mi(r,n)),this.serializer)}}class cM extends Dm{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await tE(this.xu.syncEngine),await Ih(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return VD(this.persistence,new jD,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new ND(r,e.asyncQueue,n)}Mu(e,n){const r=new PU(n,this.persistence);return new TU(e.asyncQueue,r)}Cu(e){const n=FD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ar.withCacheSize(this.cacheSizeBytes):ar.DEFAULT;return new j1(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,QD(),fy(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new qD}}class w8 extends cM{constructor(e,n){super(e,n,!1),this.xu=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xu.syncEngine;this.sharedClientState instanceof rv&&(this.sharedClientState.syncEngine={Co:h8.bind(null,n),vo:p8.bind(null,n),Fo:g8.bind(null,n),Ts:m8.bind(null,n),Do:d8.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Ji((async r=>{await f8(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const n=QD();if(!rv.v(n))throw new Ae(he.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=FD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new rv(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Mm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>kS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=l8.bind(null,this.syncEngine),await Ox(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new WH})()}createDatastore(e){const n=Tb(e.databaseInfo.databaseId),r=(function(o){return new TH(o)})(e.databaseInfo);return(function(o,i,a,l){return new NH(o,i,a,l)})(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,s,o,i,a){return new MH(r,s,o,i,a)})(this.localStore,this.datastore,e.asyncQueue,(n=>kS(this.syncEngine,n,0)),(function(){return IS.v()?new IS:new IH})())}createSyncEngine(e,n){return(function(s,o,i,a,l,c,u){const h=new XH(s,o,i,a,l,c);return u&&(h.gu=!0),h})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=Ge(n);ve(Oc,"RemoteStore shutting down."),r.Ea.add(5),await kp(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Mm.provider={build:()=>new Mm};class nE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):mn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Ua="FirestoreClient";class b8{constructor(e,n,r,s,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=ir.UNAUTHENTICATED,this.clientId=g1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async i=>{ve(Ua,"Received user=",i.uid),await this.authCredentialListener(i),this.user=i})),this.appCheckCredentials.start(r,(i=>(ve(Ua,"Received new app check token=",i),this.appCheckCredentialListener(i,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new So;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=W1(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function ov(t,e){t.asyncQueue.verifyOperationInProgress(),ve(Ua,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async s=>{r.isEqual(s)||(await BD(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function NS(t,e){t.asyncQueue.verifyOperationInProgress();const n=await v8(t);ve(Ua,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((r=>AS(e.remoteStore,r))),t.setAppCheckTokenChangeListener(((r,s)=>AS(e.remoteStore,s))),t._onlineComponents=e}async function v8(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ve(Ua,"Using user provided OfflineComponentProvider");try{await ov(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(s){return s.name==="FirebaseError"?s.code===he.FAILED_PRECONDITION||s.code===he.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(n))throw n;Cm("Error using user provided cache. Falling back to memory cache: "+n),await ov(t,new Dm)}}else ve(Ua,"Using default OfflineComponentProvider"),await ov(t,new y8(void 0));return t._offlineComponents}async function uM(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ve(Ua,"Using user provided OnlineComponentProvider"),await NS(t,t._uninitializedComponentsProvider._online)):(ve(Ua,"Using default OnlineComponentProvider"),await NS(t,new Mm))),t._onlineComponents}function x8(t){return uM(t).then((e=>e.syncEngine))}async function ow(t){const e=await uM(t),n=e.eventManager;return n.onListen=ZH.bind(null,e.syncEngine),n.onUnlisten=t8.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=e8.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=n8.bind(null,e.syncEngine),n}function C8(t,e,n={}){const r=new So;return t.asyncQueue.enqueueAndForget((async()=>(function(o,i,a,l,c){const u=new nE({next:f=>{u.Nu(),i.enqueueAndForget((()=>q1(o,h)));const g=f.docs.has(a);!g&&f.fromCache?c.reject(new Ae(he.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&l&&l.source==="server"?c.reject(new Ae(he.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new Y1(Ip(a.path),u,{includeMetadataChanges:!0,qa:!0});return K1(o,h)})(await ow(t),t.asyncQueue,e,n,r))),r.promise}function E8(t,e,n={}){const r=new So;return t.asyncQueue.enqueueAndForget((async()=>(function(o,i,a,l,c){const u=new nE({next:f=>{u.Nu(),i.enqueueAndForget((()=>q1(o,h))),f.fromCache&&l.source==="server"?c.reject(new Ae(he.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new Y1(a,u,{includeMetadataChanges:!0,qa:!0});return K1(o,h)})(await ow(t),t.asyncQueue,e,n,r))),r.promise}function dM(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const DS=new Map;const I8="firestore.googleapis.com",MS=!0;class OS{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ae(he.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=I8,this.ssl=MS}else this.host=e.host,this.ssl=e.ssl??MS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=SD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<RD)throw new Ae(he.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_U("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dM(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ae(he.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ae(he.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ae(he.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rE{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new OS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ae(he.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ae(he.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new OS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new gU;switch(r.type){case"firstParty":return new bU(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ae(he.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=DS.get(n);r&&(ve("ComponentProvider","Removing Datastore"),DS.delete(n),r.terminate())})(this),Promise.resolve()}}class nl{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new nl(this.firestore,e,this._query)}}class ln{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ma(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ln(this.firestore,e,this._key)}toJSON(){return{type:ln._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(xp(n,ln._jsonSchema))return new ln(e,r||null,new Pe(_t.fromString(n.referencePath)))}}ln._jsonSchemaVersion="firestore/documentReference/1.0",ln._jsonSchema={type:In("string",ln._jsonSchemaVersion),referencePath:In("string")};class Ma extends nl{constructor(e,n,r){super(e,n,Ip(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ln(this.firestore,null,new Pe(e))}withConverter(e){return new Ma(this.firestore,e,this._path)}}function wn(t,e,...n){if(t=jt(t),uN("collection","path",e),t instanceof rE){const r=_t.fromString(e,...n);return _A(r),new Ma(t,null,r)}{if(!(t instanceof ln||t instanceof Ma))throw new Ae(he.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(_t.fromString(e,...n));return _A(r),new Ma(t.firestore,null,r)}}function tt(t,e,...n){if(t=jt(t),arguments.length===1&&(e=g1.newId()),uN("doc","path",e),t instanceof rE){const r=_t.fromString(e,...n);return IA(r),new ln(t,null,new Pe(r))}{if(!(t instanceof ln||t instanceof Ma))throw new Ae(he.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(_t.fromString(e,...n));return IA(r),new ln(t.firestore,t instanceof Ma?t.converter:null,new Pe(r))}}const LS="AsyncQueue";class FS{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new YD(this,"async_queue_retry"),this._c=()=>{const r=fy();r&&ve(LS,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=fy();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=fy();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new So;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Za(e))throw e;ve(LS,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,mn("INTERNAL UNHANDLED ERROR: ",jS(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=G1.createAndSchedule(this,e,n,r,(o=>this.hc(o)));return this.tc.push(s),s}uc(){this.nc&&Fe(47125,{Pc:jS(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function jS(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function VS(t){return(function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const o of r)if(o in s&&typeof s[o]=="function")return!0;return!1})(t,["next","error","complete"])}class Vo extends rE{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new FS,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new FS(e),this._firestoreClient=void 0,await e}}}function _8(t,e,n){n||(n=Wy);const r=fb(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),o=r.getOptions(n);if(vi(o,e))return s;throw new Ae(he.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Ae(he.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<RD)throw new Ae(he.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Ja(e.host)&&h1(e.host),r.initialize({options:e,instanceIdentifier:n})}function Rp(t){if(t._terminated)throw new Ae(he.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||A8(t),t._firestoreClient}function A8(t){const e=t._freezeSettings(),n=(function(s,o,i,a){return new r6(s,o,i,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,dM(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new b8(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(s){const o=s?._online.build();return{_offline:s?._offline.build(o),_online:o}})(t._componentsProvider))}class vs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vs(yn.fromBase64String(e))}catch(n){throw new Ae(he.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new vs(yn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:vs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xp(e,vs._jsonSchema))return vs.fromBase64String(e.bytes)}}vs._jsonSchemaVersion="firestore/bytes/1.0",vs._jsonSchema={type:In("string",vs._jsonSchemaVersion),bytes:In("string")};class Np{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Ae(he.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Yc{constructor(e){this._methodName=e}}class To{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Ae(he.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Ae(he.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return et(this._lat,e._lat)||et(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:To._jsonSchemaVersion}}static fromJSON(e){if(xp(e,To._jsonSchema))return new To(e.latitude,e.longitude)}}To._jsonSchemaVersion="firestore/geoPoint/1.0",To._jsonSchema={type:In("string",To._jsonSchemaVersion),latitude:In("number"),longitude:In("number")};class Po{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==s[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Po._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xp(e,Po._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Po(e.vectorValues);throw new Ae(he.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Po._jsonSchemaVersion="firestore/vectorValue/1.0",Po._jsonSchema={type:In("string",Po._jsonSchemaVersion),vectorValues:In("object")};const S8=/^__.*__$/;class T8{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ri(e,this.data,this.fieldMask,n,this.fieldTransforms):new Eh(e,this.data,n,this.fieldTransforms)}}class hM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ri(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function fM(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Fe(40011,{Ac:t})}}class Nb{constructor(e,n,r,s,o,i){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Nb({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return iw(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fM(this.Ac)&&S8.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class P8{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Tb(e)}Cc(e,n,r,s=!1){return new Nb({Ac:e,methodName:n,Dc:r,path:Zt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dp(t){const e=t._freezeSettings(),n=Tb(t._databaseId);return new P8(t._databaseId,!!e.ignoreUndefinedProperties,n)}function sE(t,e,n,r,s,o={}){const i=t.Cc(o.merge||o.mergeFields?2:0,e,n,s);cE("Data must be an object, but it was:",i,r);const a=yM(r,i);let l,c;if(o.merge)l=new Mr(i.fieldMask),c=i.fieldTransforms;else if(o.mergeFields){const u=[];for(const h of o.mergeFields){const f=jx(e,h,n);if(!i.contains(f))throw new Ae(he.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);bM(u,f)||u.push(f)}l=new Mr(u),c=i.fieldTransforms.filter((h=>l.covers(h.field)))}else l=null,c=i.fieldTransforms;return new T8(new lr(a),l,c)}class Db extends Yc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Db}}function mM(t,e,n){return new Nb({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class oE extends Yc{_toFieldTransform(e){return new Ap(e.path,new Jd)}isEqual(e){return e instanceof oE}}class iE extends Yc{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=mM(this,e,!0),r=this.vc.map((o=>Jc(o,n))),s=new kc(r);return new Ap(e.path,s)}isEqual(e){return e instanceof iE&&vi(this.vc,e.vc)}}class aE extends Yc{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=mM(this,e,!0),r=this.vc.map((o=>Jc(o,n))),s=new Rc(r);return new Ap(e.path,s)}isEqual(e){return e instanceof aE&&vi(this.vc,e.vc)}}class lE extends Yc{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new Xd(e.serializer,eD(e.serializer,this.Fc));return new Ap(e.path,n)}isEqual(e){return e instanceof lE&&this.Fc===e.Fc}}function pM(t,e,n,r){const s=t.Cc(1,e,n);cE("Data must be an object, but it was:",s,r);const o=[],i=lr.empty();el(r,((l,c)=>{const u=uE(e,l,n);c=jt(c);const h=s.yc(u);if(c instanceof Db)o.push(u);else{const f=Jc(c,h);f!=null&&(o.push(u),i.set(u,f))}}));const a=new Mr(o);return new hM(i,a,s.fieldTransforms)}function gM(t,e,n,r,s,o){const i=t.Cc(1,e,n),a=[jx(e,r,n)],l=[s];if(o.length%2!=0)throw new Ae(he.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<o.length;f+=2)a.push(jx(e,o[f])),l.push(o[f+1]);const c=[],u=lr.empty();for(let f=a.length-1;f>=0;--f)if(!bM(c,a[f])){const g=a[f];let y=l[f];y=jt(y);const w=i.yc(g);if(y instanceof Db)c.push(g);else{const v=Jc(y,w);v!=null&&(c.push(g),u.set(g,v))}}const h=new Mr(c);return new hM(u,h,i.fieldTransforms)}function k8(t,e,n,r=!1){return Jc(n,t.Cc(r?4:3,e))}function Jc(t,e){if(wM(t=jt(t)))return cE("Unsupported field value:",e,t),yM(t,e);if(t instanceof Yc)return(function(r,s){if(!fM(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const o=[];let i=0;for(const a of r){let l=Jc(a,s.wc(i));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),i++}return{arrayValue:{values:o}}})(t,e)}return(function(r,s){if((r=jt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return eD(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=Nt.fromDate(r);return{timestampValue:Zd(s.serializer,o)}}if(r instanceof Nt){const o=new Nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zd(s.serializer,o)}}if(r instanceof To)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof vs)return{bytesValue:dD(s.serializer,r._byteString)};if(r instanceof ln){const o=s.databaseId,i=r.firestore._databaseId;if(!i.isEqual(o))throw s.Sc(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:D1(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Po)return(function(i,a){return{mapValue:{fields:{[I1]:{stringValue:_1},[Kd]:{arrayValue:{values:i.toArray().map((c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return T1(a.serializer,c)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${mb(r)}`)})(t,e)}function yM(t,e){const n={};return TN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):el(t,((r,s)=>{const o=Jc(s,e.mc(r));o!=null&&(n[r]=o)})),{mapValue:{fields:n}}}function wM(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Nt||t instanceof To||t instanceof vs||t instanceof ln||t instanceof Yc||t instanceof Po)}function cE(t,e,n){if(!wM(n)||!dN(n)){const r=mb(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function jx(t,e,n){if((e=jt(e))instanceof Np)return e._internalPath;if(typeof e=="string")return uE(t,e);throw iw("Field path arguments must be of type string or ",t,!1,void 0,n)}const R8=new RegExp("[~\\*/\\[\\]]");function uE(t,e,n){if(e.search(R8)>=0)throw iw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Np(...e.split("."))._internalPath}catch{throw iw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function iw(t,e,n,r,s){const o=r&&!r.isEmpty(),i=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||i)&&(l+=" (found",o&&(l+=` in field ${r}`),i&&(l+=` in document ${s}`),l+=")"),new Ae(he.INVALID_ARGUMENT,a+t+l)}function bM(t,e){return t.some((n=>n.isEqual(e)))}class vM{constructor(e,n,r,s,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new ln(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new N8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Mb("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class N8 extends vM{data(){return super.data()}}function Mb(t,e){return typeof e=="string"?uE(t,e):e instanceof Np?e._internalPath:e._delegate._internalPath}function xM(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ae(he.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dE{}class CM extends dE{}function Ha(t,e,...n){let r=[];e instanceof dE&&r.push(e),r=r.concat(n),(function(o){const i=o.filter((l=>l instanceof hE)).length,a=o.filter((l=>l instanceof Ob)).length;if(i>1||i>0&&a>0)throw new Ae(he.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)t=s._apply(t);return t}class Ob extends CM{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Ob(e,n,r)}_apply(e){const n=this._parse(e);return IM(e._query,n),new nl(e.firestore,e.converter,Ex(e._query,n))}_parse(e){const n=Dp(e.firestore);return(function(o,i,a,l,c,u,h){let f;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Ae(he.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){US(h,u);const y=[];for(const w of h)y.push(BS(l,o,w));f={arrayValue:{values:y}}}else f=BS(l,o,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||US(h,u),f=k8(a,i,h,u==="in"||u==="not-in");return vt.create(c,u,f)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Oa(t,e,n){const r=e,s=Mb("where",t);return Ob._create(s,r,n)}class hE extends dE{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new hE(e,n)}_parse(e){const n=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return n.length===1?n[0]:Dt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(s,o){let i=s;const a=o.getFlattenedFilters();for(const l of a)IM(i,l),i=Ex(i,l)})(e._query,n),new nl(e.firestore,e.converter,Ex(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class fE extends CM{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new fE(e,n)}_apply(e){const n=(function(s,o,i){if(s.startAt!==null)throw new Ae(he.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Ae(he.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Nm(o,i)})(e._query,this._field,this._direction);return new nl(e.firestore,e.converter,(function(s,o){const i=s.explicitOrderBy.concat([o]);return new Ch(s.path,s.collectionGroup,i,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,n))}}function EM(t,e="asc"){const n=e,r=Mb("orderBy",t);return fE._create(r,n)}function BS(t,e,n){if(typeof(n=jt(n))=="string"){if(n==="")throw new Ae(he.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!WN(e)&&n.indexOf("/")!==-1)throw new Ae(he.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(_t.fromString(n));if(!Pe.isDocumentKey(r))throw new Ae(he.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return km(t,new Pe(r))}if(n instanceof ln)return km(t,n._key);throw new Ae(he.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mb(n)}.`)}function US(t,e){if(!Array.isArray(t)||t.length===0)throw new Ae(he.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function IM(t,e){const n=(function(s,o){for(const i of s)for(const a of i.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null})(t.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Ae(he.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ae(he.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class D8{convertValue(e,n="none"){switch(ja(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ei(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Fe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return el(e,((s,o)=>{r[s]=this.convertValue(o,n)})),r}convertVectorValue(e){const n=e.fields?.[Kd].arrayValue?.values?.map((r=>Qt(r.doubleValue)));return new Po(n)}convertGeoPoint(e){return new To(Qt(e.latitude),Qt(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=vb(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Tm(e));default:return null}}convertTimestamp(e){const n=Ci(e);return new Nt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=_t.fromString(e);Ke(xD(r),9688,{name:e});const s=new Tc(r.get(1),r.get(3)),o=new Pe(r.popFirst(5));return s.isEqual(n)||mn(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}function mE(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Lf{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fc extends vM{constructor(e,n,r,s,o,i){super(e,n,r,s,i),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new my(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Mb("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(he.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=fc._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}fc._jsonSchemaVersion="firestore/documentSnapshot/1.0",fc._jsonSchema={type:In("string",fc._jsonSchemaVersion),bundleSource:In("string","DocumentSnapshot"),bundleName:In("string"),bundle:In("string")};class my extends fc{data(e={}){return super.data(e)}}class mc{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Lf(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new my(this._firestore,this._userDataWriter,r.key,r,new Lf(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Ae(he.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map((a=>{const l=new my(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Lf(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}}))}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((a=>o||a.type!==3)).map((a=>{const l=new my(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Lf(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=i.indexOf(a.doc.key),i=i.delete(a.doc.key)),a.type!==1&&(i=i.add(a.doc),u=i.indexOf(a.doc.key)),{type:M8(a.type),doc:l,oldIndex:c,newIndex:u}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(he.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=mc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=g1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach((o=>{o._document!==null&&(n.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function M8(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Fe(61501,{type:t})}}function Nn(t){t=Lr(t,ln);const e=Lr(t.firestore,Vo);return C8(Rp(e),t._key).then((n=>_M(e,t,n)))}mc._jsonSchemaVersion="firestore/querySnapshot/1.0",mc._jsonSchema={type:In("string",mc._jsonSchemaVersion),bundleSource:In("string","QuerySnapshot"),bundleName:In("string"),bundle:In("string")};class pE extends D8{constructor(e){super(),this.firestore=e}convertBytes(e){return new vs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ln(this.firestore,null,n)}}function Mp(t){t=Lr(t,nl);const e=Lr(t.firestore,Vo),n=Rp(e),r=new pE(e);return xM(t._query),E8(n,t._query).then((s=>new mc(e,r,t,s)))}function Xn(t,e,n){t=Lr(t,ln);const r=Lr(t.firestore,Vo),s=mE(t.converter,e,n);return Op(r,[sE(Dp(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Pn.none())])}function Ii(t,e,n,...r){t=Lr(t,ln);const s=Lr(t.firestore,Vo),o=Dp(s);let i;return i=typeof(e=jt(e))=="string"||e instanceof Np?gM(o,"updateDoc",t._key,e,n,r):pM(o,"updateDoc",t._key,e),Op(s,[i.toMutation(t._key,Pn.exists(!0))])}function gE(t){return Op(Lr(t.firestore,Vo),[new Sp(t._key,Pn.none())])}function Lb(t,e){const n=Lr(t.firestore,Vo),r=tt(t),s=mE(t.converter,e);return Op(n,[sE(Dp(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Pn.exists(!1))]).then((()=>r))}function Ir(t,...e){t=jt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||VS(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(VS(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let o,i,a;if(t instanceof ln)i=Lr(t.firestore,Vo),a=Ip(t._key.path),o={next:l=>{e[r]&&e[r](_M(i,t,l))},error:e[r+1],complete:e[r+2]};else{const l=Lr(t,nl);i=Lr(l.firestore,Vo),a=l._query;const c=new pE(i);o={next:u=>{e[r]&&e[r](new mc(i,c,l,u))},error:e[r+1],complete:e[r+2]},xM(t._query)}return(function(c,u,h,f){const g=new nE(f),y=new Y1(u,g,h);return c.asyncQueue.enqueueAndForget((async()=>K1(await ow(c),y))),()=>{g.Nu(),c.asyncQueue.enqueueAndForget((async()=>q1(await ow(c),y)))}})(Rp(i),a,s,o)}function Op(t,e){return(function(r,s){const o=new So;return r.asyncQueue.enqueueAndForget((async()=>r8(await x8(r),s,o))),o.promise})(Rp(t),e)}function _M(t,e,n){const r=n.docs.get(e._key),s=new pE(t);return new fc(t,s,e._key,r,new Lf(n.hasPendingWrites,n.fromCache),e.converter)}class O8{constructor(e){let n;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=V8(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function L8(t){return new O8(t)}class F8{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Mm.provider,this._offlineComponentProvider={build:n=>new cM(n,e?.cacheSizeBytes,this.forceOwnership)}}}class j8{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Mm.provider,this._offlineComponentProvider={build:n=>new w8(n,e?.cacheSizeBytes)}}}function V8(t){return new F8(t?.forceOwnership)}function B8(){return new j8}class U8{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Dp(e)}set(e,n,r){this._verifyNotCommitted();const s=iv(e,this._firestore),o=mE(s.converter,n,r),i=sE(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,r);return this._mutations.push(i.toMutation(s._key,Pn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const o=iv(e,this._firestore);let i;return i=typeof(n=jt(n))=="string"||n instanceof Np?gM(this._dataReader,"WriteBatch.update",o._key,n,r,s):pM(this._dataReader,"WriteBatch.update",o._key,n),this._mutations.push(i.toMutation(o._key,Pn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=iv(e,this._firestore);return this._mutations=this._mutations.concat(new Sp(n._key,Pn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ae(he.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function iv(t,e){if((t=jt(t)).firestore!==e)throw new Ae(he.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function qs(){return new oE("serverTimestamp")}function HS(...t){return new iE("arrayUnion",t)}function $S(...t){return new aE("arrayRemove",t)}function Fb(t){return new lE("increment",t)}function AM(t){return Rp(t=Lr(t,Vo)),new U8(t,(e=>Op(t,e)))}(function(e,n=!0){(function(s){xh=s})(qc),Ac(new Fa("firestore",((r,{instanceIdentifier:s,options:o})=>{const i=r.getProvider("app").getImmediate(),a=new Vo(new yU(r.getProvider("auth-internal")),new vU(i,r.getProvider("app-check-internal")),(function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ae(he.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tc(c.options.projectId,u)})(i,s),i);return o={useFetchStreams:n,...o},a._setSettings(o),a}),"PUBLIC").setMultipleInstances(!0)),Ao(vA,xA,e),Ao(vA,xA,"esm2020")})();function SM(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const H8=SM,TM=new bp("auth","Firebase",SM());const aw=new f1("@firebase/auth");function $8(t,...e){aw.logLevel<=bt.WARN&&aw.warn(`Auth (${qc}): ${t}`,...e)}function py(t,...e){aw.logLevel<=bt.ERROR&&aw.error(`Auth (${qc}): ${t}`,...e)}function Qs(t,...e){throw yE(t,...e)}function ko(t,...e){return yE(t,...e)}function PM(t,e,n){const r={...H8(),[e]:n};return new bp("auth","Firebase",r).create(e,{appName:t.name})}function gi(t){return PM(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yE(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return TM.create(t,...e)}function Xe(t,e,...n){if(!t)throw yE(e,...n)}function hi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw py(e),new Error(e)}function _i(t,e){t||hi(e)}function Vx(){return typeof self<"u"&&self.location?.href||""}function z8(){return zS()==="http:"||zS()==="https:"}function zS(){return typeof self<"u"&&self.location?.protocol||null}function G8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(z8()||K5()||"connection"in navigator)?navigator.onLine:!0}function W8(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class Lp{constructor(e,n){this.shortDelay=e,this.longDelay=n,_i(n>e,"Short delay should be less than long delay!"),this.isMobile=G5()||q5()}get(){return G8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function wE(t,e){_i(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class kM{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;hi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;hi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;hi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const K8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const q8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Q8=new Lp(3e4,6e4);function rl(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ni(t,e,n,r,s={}){return RM(t,s,async()=>{let o={},i={};r&&(e==="GET"?i=r:o={body:JSON.stringify(r)});const a=vp({key:t.config.apiKey,...i}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...o};return W5()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&Ja(t.emulatorConfig.host)&&(c.credentials="include"),kM.fetch()(await NM(t,t.config.apiHost,n,a),c)})}async function RM(t,e,n){t._canInitEmulator=!1;const r={...K8,...e};try{const s=new J8(t),o=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const i=await o.json();if("needConfirmation"in i)throw Mg(t,"account-exists-with-different-credential",i);if(o.ok&&!("errorMessage"in i))return i;{const a=o.ok?i.errorMessage:i.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Mg(t,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw Mg(t,"email-already-in-use",i);if(l==="USER_DISABLED")throw Mg(t,"user-disabled",i);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw PM(t,u,c);Qs(t,u)}}catch(s){if(s instanceof Uo)throw s;Qs(t,"network-request-failed",{message:String(s)})}}async function Fp(t,e,n,r,s={}){const o=await Ni(t,e,n,r,s);return"mfaPendingCredential"in o&&Qs(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function NM(t,e,n,r){const s=`${e}${n}?${r}`,o=t,i=o.config.emulator?wE(t.config,s):`${t.config.apiScheme}://${s}`;return q8.includes(n)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(i).toString():i}function Y8(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class J8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(ko(this.auth,"network-request-failed")),Q8.get())})}}function Mg(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=ko(t,e,r);return s.customData._tokenResponse=n,s}function GS(t){return t!==void 0&&t.enterprise!==void 0}class X8{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Y8(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Z8(t,e){return Ni(t,"GET","/v2/recaptchaConfig",rl(t,e))}async function e9(t,e){return Ni(t,"POST","/v1/accounts:delete",e)}async function lw(t,e){return Ni(t,"POST","/v1/accounts:lookup",e)}function im(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function t9(t,e=!1){const n=jt(t),r=await n.getIdToken(e),s=bE(r);Xe(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,i=o?.sign_in_provider;return{claims:s,token:r,authTime:im(av(s.auth_time)),issuedAtTime:im(av(s.iat)),expirationTime:im(av(s.exp)),signInProvider:i||null,signInSecondFactor:o?.sign_in_second_factor||null}}function av(t){return Number(t)*1e3}function bE(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return py("JWT malformed, contained fewer than 3 sections"),null;try{const s=B2(n);return s?JSON.parse(s):(py("Failed to decode base64 JWT payload"),null)}catch(s){return py("Caught error parsing JWT payload as JSON",s?.toString()),null}}function WS(t){const e=bE(t);return Xe(e,"internal-error"),Xe(typeof e.exp<"u","internal-error"),Xe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function sh(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Uo&&n9(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function n9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class r9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Bx{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=im(this.lastLoginAt),this.creationTime=im(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function cw(t){const e=t.auth,n=await t.getIdToken(),r=await sh(t,lw(e,{idToken:n}));Xe(r?.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=s.providerUserInfo?.length?DM(s.providerUserInfo):[],i=o9(t.providerData,o),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!i?.length,c=a?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Bx(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function s9(t){const e=jt(t);await cw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function o9(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function DM(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function i9(t,e){const n=await RM(t,{},async()=>{const r=vp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=t.config,i=await NM(t,s,"/v1/token",`key=${o}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Ja(t.emulatorConfig.host)&&(l.credentials="include"),kM.fetch()(i,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function a9(t,e){return Ni(t,"POST","/v2/accounts:revokeToken",rl(t,e))}class Gu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Xe(e.idToken,"internal-error"),Xe(typeof e.idToken<"u","internal-error"),Xe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):WS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Xe(e.length!==0,"internal-error");const n=WS(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Xe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:o}=await i9(e,n);this.updateTokensAndExpiration(r,s,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:o}=n,i=new Gu;return r&&(Xe(typeof r=="string","internal-error",{appName:e}),i.refreshToken=r),s&&(Xe(typeof s=="string","internal-error",{appName:e}),i.accessToken=s),o&&(Xe(typeof o=="number","internal-error",{appName:e}),i.expirationTime=o),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Gu,this.toJSON())}_performRefresh(){return hi("not implemented")}}function Gi(t,e){Xe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class zs{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new r9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Bx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await sh(this,this.stsTokenManager.getToken(this.auth,e));return Xe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return t9(this,e)}reload(){return s9(this)}_assign(e){this!==e&&(Xe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new zs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Xe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await cw(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qr(this.auth.app))return Promise.reject(gi(this.auth));const e=await this.getIdToken();return await sh(this,e9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,o=n.phoneNumber??void 0,i=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,c=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:g,providerData:y,stsTokenManager:w}=n;Xe(h&&w,e,"internal-error");const v=Gu.fromJSON(this.name,w);Xe(typeof h=="string",e,"internal-error"),Gi(r,e.name),Gi(s,e.name),Xe(typeof f=="boolean",e,"internal-error"),Xe(typeof g=="boolean",e,"internal-error"),Gi(o,e.name),Gi(i,e.name),Gi(a,e.name),Gi(l,e.name),Gi(c,e.name),Gi(u,e.name);const C=new zs({uid:h,auth:e,email:s,emailVerified:f,displayName:r,isAnonymous:g,photoURL:i,phoneNumber:o,tenantId:a,stsTokenManager:v,createdAt:c,lastLoginAt:u});return y&&Array.isArray(y)&&(C.providerData=y.map(x=>({...x}))),l&&(C._redirectEventId=l),C}static async _fromIdTokenResponse(e,n,r=!1){const s=new Gu;s.updateFromServerResponse(n);const o=new zs({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await cw(o),o}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Xe(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?DM(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!o?.length,a=new Gu;a.updateFromIdToken(r);const l=new zs({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:i}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Bx(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!o?.length};return Object.assign(l,c),l}}const KS=new Map;function fi(t){_i(t instanceof Function,"Expected a class definition");let e=KS.get(t);return e?(_i(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,KS.set(t,e),e)}class MM{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}MM.type="NONE";const qS=MM;function gy(t,e,n){return`firebase:${t}:${e}:${n}`}class Wu{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:o}=this.auth;this.fullUserKey=gy(this.userKey,s.apiKey,o),this.fullPersistenceKey=gy("persistence",s.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await lw(this.auth,{idToken:e}).catch(()=>{});return n?zs._fromGetAccountInfoResponse(this.auth,n,e):null}return zs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Wu(fi(qS),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let o=s[0]||fi(qS);const i=gy(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(i);if(u){let h;if(typeof u=="string"){const f=await lw(e,{idToken:u}).catch(()=>{});if(!f)break;h=await zs._fromGetAccountInfoResponse(e,f,u)}else h=zs._fromJSON(e,u);c!==o&&(a=h),o=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new Wu(o,e,r):(o=l[0],a&&await o._set(i,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==o)try{await c._remove(i)}catch{}})),new Wu(o,e,r))}}function QS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(jM(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(OM(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(BM(e))return"Blackberry";if(UM(e))return"Webos";if(LM(e))return"Safari";if((e.includes("chrome/")||FM(e))&&!e.includes("edge/"))return"Chrome";if(VM(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function OM(t=Rn()){return/firefox\//i.test(t)}function LM(t=Rn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function FM(t=Rn()){return/crios\//i.test(t)}function jM(t=Rn()){return/iemobile/i.test(t)}function VM(t=Rn()){return/android/i.test(t)}function BM(t=Rn()){return/blackberry/i.test(t)}function UM(t=Rn()){return/webos/i.test(t)}function vE(t=Rn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function l9(t=Rn()){return vE(t)&&!!window.navigator?.standalone}function c9(){return Q5()&&document.documentMode===10}function HM(t=Rn()){return vE(t)||VM(t)||UM(t)||BM(t)||/windows phone/i.test(t)||jM(t)}function $M(t,e=[]){let n;switch(t){case"Browser":n=QS(Rn());break;case"Worker":n=`${QS(Rn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${qc}/${r}`}class u9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((i,a)=>{try{const l=e(o);i(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function d9(t,e={}){return Ni(t,"GET","/v2/passwordPolicy",rl(t,e))}const h9=6;class f9{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??h9,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class m9{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new YS(this),this.idTokenSubscription=new YS(this),this.beforeStateQueue=new u9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=TM,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=fi(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Wu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await lw(this,{idToken:e}),r=await zs._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Qr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(i=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(i,i))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,i=r?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===i)&&a?.user&&(r=a.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Xe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await cw(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=W8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qr(this.app))return Promise.reject(gi(this));const n=e?jt(e):null;return n&&Xe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Xe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qr(this.app)?Promise.reject(gi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qr(this.app)?Promise.reject(gi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(fi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await d9(this),n=new f9(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new bp("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await a9(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&fi(e)||this._popupRedirectResolver;Xe(n,this,"argument-error"),this.redirectPersistenceManager=await Wu.create(this,[fi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let i=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Xe(a,this,"internal-error"),a.then(()=>{i||o(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{i=!0,l()}}else{const l=e.addObserver(n);return()=>{i=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Xe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$M(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Qr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&$8(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Xc(t){return jt(t)}class YS{constructor(e){this.auth=e,this.observer=null,this.addObserver=t3(n=>this.observer=n)}get next(){return Xe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let jb={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function p9(t){jb=t}function zM(t){return jb.loadJS(t)}function g9(){return jb.recaptchaEnterpriseScript}function y9(){return jb.gapiScript}function w9(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class b9{constructor(){this.enterprise=new v9}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class v9{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const x9="recaptcha-enterprise",GM="NO_RECAPTCHA";class C9{constructor(e){this.type=x9,this.auth=Xc(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(i,a)=>{Z8(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new X8(l);return o.tenantId==null?o._agentRecaptchaConfig=c:o._tenantRecaptchaConfigs[o.tenantId]=c,i(c.siteKey)}}).catch(l=>{a(l)})})}function s(o,i,a){const l=window.grecaptcha;GS(l)?l.enterprise.ready(()=>{l.enterprise.execute(o,{action:e}).then(c=>{i(c)}).catch(()=>{i(GM)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new b9().execute("siteKey",{action:"verify"}):new Promise((o,i)=>{r(this.auth).then(a=>{if(!n&&GS(window.grecaptcha))s(a,o,i);else{if(typeof window>"u"){i(new Error("RecaptchaVerifier is only supported in browser"));return}let l=g9();l.length!==0&&(l+=a),zM(l).then(()=>{s(a,o,i)}).catch(c=>{i(c)})}}).catch(a=>{i(a)})})}}async function JS(t,e,n,r=!1,s=!1){const o=new C9(t);let i;if(s)i=GM;else try{i=await o.verify(n)}catch{i=await o.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:i}):Object.assign(a,{captchaResponse:i}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Ux(t,e,n,r,s){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await JS(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await JS(t,e,n,n==="getOobCode");return r(t,i)}else return Promise.reject(o)})}function E9(t,e){const n=fb(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),o=n.getOptions();if(vi(o,e??{}))return s;Qs(s,"already-initialized")}return n.initialize({options:e})}function I9(t,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(fi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function _9(t,e,n){const r=Xc(t);Xe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,o=WM(e),{host:i,port:a}=A9(e),l=a===null?"":`:${a}`,c={url:`${o}//${i}${l}/`},u=Object.freeze({host:i,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Xe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Xe(vi(c,r.config.emulator)&&vi(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Ja(i)?(h1(`${o}//${i}${l}`),G2("Auth",!0)):S9()}function WM(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function A9(t){const e=WM(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const o=s[1];return{host:o,port:XS(r.substr(o.length+1))}}else{const[o,i]=r.split(":");return{host:o,port:XS(i)}}}function XS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function S9(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class xE{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return hi("not implemented")}_getIdTokenResponse(e){return hi("not implemented")}_linkToIdToken(e,n){return hi("not implemented")}_getReauthenticationResolver(e){return hi("not implemented")}}async function T9(t,e){return Ni(t,"POST","/v1/accounts:signUp",e)}async function P9(t,e){return Fp(t,"POST","/v1/accounts:signInWithPassword",rl(t,e))}async function k9(t,e){return Fp(t,"POST","/v1/accounts:signInWithEmailLink",rl(t,e))}async function R9(t,e){return Fp(t,"POST","/v1/accounts:signInWithEmailLink",rl(t,e))}class Om extends xE{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Om(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Om(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ux(e,n,"signInWithPassword",P9);case"emailLink":return k9(e,{email:this._email,oobCode:this._password});default:Qs(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ux(e,r,"signUpPassword",T9);case"emailLink":return R9(e,{idToken:n,email:this._email,oobCode:this._password});default:Qs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ku(t,e){return Fp(t,"POST","/v1/accounts:signInWithIdp",rl(t,e))}const N9="http://localhost";class Lc extends xE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Lc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Qs("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...o}=n;if(!r||!s)return null;const i=new Lc(r,s);return i.idToken=o.idToken||void 0,i.accessToken=o.accessToken||void 0,i.secret=o.secret,i.nonce=o.nonce,i.pendingToken=o.pendingToken||null,i}_getIdTokenResponse(e){const n=this.buildRequest();return Ku(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ku(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ku(e,n)}buildRequest(){const e={requestUri:N9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=vp(n)}return e}}function D9(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function M9(t){const e=kf(Rf(t)).link,n=e?kf(Rf(e)).deep_link_id:null,r=kf(Rf(t)).deep_link_id;return(r?kf(Rf(r)).link:null)||r||n||e||t}class CE{constructor(e){const n=kf(Rf(e)),r=n.apiKey??null,s=n.oobCode??null,o=D9(n.mode??null);Xe(r&&s&&o,"argument-error"),this.apiKey=r,this.operation=o,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=M9(e);try{return new CE(n)}catch{return null}}}class Sh{constructor(){this.providerId=Sh.PROVIDER_ID}static credential(e,n){return Om._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=CE.parseLink(n);return Xe(r,"argument-error"),Om._fromEmailAndCode(e,r.code,r.tenantId)}}Sh.PROVIDER_ID="password";Sh.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Sh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class KM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class jp extends KM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ia extends jp{constructor(){super("facebook.com")}static credential(e){return Lc._fromParams({providerId:ia.PROVIDER_ID,signInMethod:ia.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ia.credentialFromTaggedObject(e)}static credentialFromError(e){return ia.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ia.credential(e.oauthAccessToken)}catch{return null}}}ia.FACEBOOK_SIGN_IN_METHOD="facebook.com";ia.PROVIDER_ID="facebook.com";class aa extends jp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Lc._fromParams({providerId:aa.PROVIDER_ID,signInMethod:aa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return aa.credentialFromTaggedObject(e)}static credentialFromError(e){return aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return aa.credential(n,r)}catch{return null}}}aa.GOOGLE_SIGN_IN_METHOD="google.com";aa.PROVIDER_ID="google.com";class la extends jp{constructor(){super("github.com")}static credential(e){return Lc._fromParams({providerId:la.PROVIDER_ID,signInMethod:la.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return la.credentialFromTaggedObject(e)}static credentialFromError(e){return la.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return la.credential(e.oauthAccessToken)}catch{return null}}}la.GITHUB_SIGN_IN_METHOD="github.com";la.PROVIDER_ID="github.com";class ca extends jp{constructor(){super("twitter.com")}static credential(e,n){return Lc._fromParams({providerId:ca.PROVIDER_ID,signInMethod:ca.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ca.credentialFromTaggedObject(e)}static credentialFromError(e){return ca.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ca.credential(n,r)}catch{return null}}}ca.TWITTER_SIGN_IN_METHOD="twitter.com";ca.PROVIDER_ID="twitter.com";async function O9(t,e){return Fp(t,"POST","/v1/accounts:signUp",rl(t,e))}class Fc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const o=await zs._fromIdTokenResponse(e,r,s),i=ZS(r);return new Fc({user:o,providerId:i,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=ZS(r);return new Fc({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function ZS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class uw extends Uo{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,uw.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new uw(e,n,r,s)}}function qM(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?uw._fromErrorAndOperation(t,o,e,r):o})}async function L9(t,e,n=!1){const r=await sh(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Fc._forOperation(t,"link",r)}async function F9(t,e,n=!1){const{auth:r}=t;if(Qr(r.app))return Promise.reject(gi(r));const s="reauthenticate";try{const o=await sh(t,qM(r,s,e,t),n);Xe(o.idToken,r,"internal-error");const i=bE(o.idToken);Xe(i,r,"internal-error");const{sub:a}=i;return Xe(t.uid===a,r,"user-mismatch"),Fc._forOperation(t,s,o)}catch(o){throw o?.code==="auth/user-not-found"&&Qs(r,"user-mismatch"),o}}async function QM(t,e,n=!1){if(Qr(t.app))return Promise.reject(gi(t));const r="signIn",s=await qM(t,r,e),o=await Fc._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(o.user),o}async function j9(t,e){return QM(Xc(t),e)}async function YM(t){const e=Xc(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function V9(t,e,n){if(Qr(t.app))return Promise.reject(gi(t));const r=Xc(t),i=await Ux(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",O9).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&YM(t),l}),a=await Fc._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(a.user),a}function B9(t,e,n){return Qr(t.app)?Promise.reject(gi(t)):j9(jt(t),Sh.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&YM(t),r})}async function U9(t,e){return Ni(t,"POST","/v1/accounts:update",e)}async function H9(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=jt(t),o={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},i=await sh(r,U9(r.auth,o));r.displayName=i.displayName||null,r.photoURL=i.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(i)}function JM(t,e){return jt(t).setPersistence(e)}function $9(t,e,n,r){return jt(t).onIdTokenChanged(e,n,r)}function z9(t,e,n){return jt(t).beforeAuthStateChanged(e,n)}function G9(t,e,n,r){return jt(t).onAuthStateChanged(e,n,r)}function W9(t){return jt(t).signOut()}const dw="__sak";class XM{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(dw,"1"),this.storage.removeItem(dw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const K9=1e3,q9=10;class ZM extends XM{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=HM(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((i,a,l)=>{this.notifyListeners(i,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(r);!n&&this.localCache[r]===i||this.notifyListeners(r,i)},o=this.storage.getItem(r);c9()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,q9):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},K9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}ZM.type="LOCAL";const EE=ZM;class eO extends XM{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}eO.type="SESSION";const tO=eO;function Q9(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class Vb{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Vb(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:o}=n.data,i=this.handlersMap[s];if(!i?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(i).map(async c=>c(n.origin,o)),l=await Q9(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Vb.receivers=[];function IE(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}class Y9{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,i;return new Promise((a,l)=>{const c=IE("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);i={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(u),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(f.data.response);break;default:clearTimeout(u),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function Ro(){return window}function J9(t){Ro().location.href=t}function nO(){return typeof Ro().WorkerGlobalScope<"u"&&typeof Ro().importScripts=="function"}async function X9(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Z9(){return navigator?.serviceWorker?.controller||null}function e$(){return nO()?self:null}const rO="firebaseLocalStorageDb",t$=1,hw="firebaseLocalStorage",sO="fbase_key";class Vp{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Bb(t,e){return t.transaction([hw],e?"readwrite":"readonly").objectStore(hw)}function n$(){const t=indexedDB.deleteDatabase(rO);return new Vp(t).toPromise()}function Hx(){const t=indexedDB.open(rO,t$);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(hw,{keyPath:sO})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(hw)?e(r):(r.close(),await n$(),e(await Hx()))})})}async function eT(t,e,n){const r=Bb(t,!0).put({[sO]:e,value:n});return new Vp(r).toPromise()}async function r$(t,e){const n=Bb(t,!1).get(e),r=await new Vp(n).toPromise();return r===void 0?null:r.value}function tT(t,e){const n=Bb(t,!0).delete(e);return new Vp(n).toPromise()}const s$=800,o$=3;class oO{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hx(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>o$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nO()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vb._getInstance(e$()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await X9(),!this.activeServiceWorker)return;this.sender=new Y9(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Z9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hx();return await eT(e,dw,"1"),await tT(e,dw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>eT(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>r$(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>tT(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=Bb(s,!1).getAll();return new Vp(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),s$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}oO.type="LOCAL";const i$=oO;new Lp(3e4,6e4);function a$(t,e){return e?fi(e):(Xe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class _E extends xE{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ku(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ku(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ku(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function l$(t){return QM(t.auth,new _E(t),t.bypassAuthState)}function c$(t){const{auth:e,user:n}=t;return Xe(n,e,"internal-error"),F9(n,new _E(t),t.bypassAuthState)}async function u$(t){const{auth:e,user:n}=t;return Xe(n,e,"internal-error"),L9(n,new _E(t),t.bypassAuthState)}class iO{constructor(e,n,r,s,o=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:o,error:i,type:a}=e;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return l$;case"linkViaPopup":case"linkViaRedirect":return u$;case"reauthViaPopup":case"reauthViaRedirect":return c$;default:Qs(this.auth,"internal-error")}}resolve(e){_i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const d$=new Lp(2e3,1e4);class Ru extends iO{constructor(e,n,r,s,o){super(e,n,s,o),this.provider=r,this.authWindow=null,this.pollId=null,Ru.currentPopupAction&&Ru.currentPopupAction.cancel(),Ru.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Xe(e,this.auth,"internal-error"),e}async onExecution(){_i(this.filter.length===1,"Popup operations only handle one event");const e=IE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ko(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ko(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ru.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ko(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,d$.get())};e()}}Ru.currentPopupAction=null;const h$="pendingRedirect",yy=new Map;class f$ extends iO{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=yy.get(this.auth._key());if(!e){try{const r=await m$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}yy.set(this.auth._key(),e)}return this.bypassAuthState||yy.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function m$(t,e){const n=y$(e),r=g$(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function p$(t,e){yy.set(t._key(),e)}function g$(t){return fi(t._redirectPersistence)}function y$(t){return gy(h$,t.config.apiKey,t.name)}async function w$(t,e,n=!1){if(Qr(t.app))return Promise.reject(gi(t));const r=Xc(t),s=a$(r,e),i=await new f$(r,s,n).execute();return i&&!n&&(delete i.user._redirectEventId,await r._persistUserIfCurrent(i.user),await r._setRedirectUser(null,e)),i}const b$=600*1e3;class v${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!x$(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!aO(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(ko(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=b$&&this.cachedEventUids.clear(),this.cachedEventUids.has(nT(e))}saveEventToCache(e){this.cachedEventUids.add(nT(e)),this.lastProcessedEventTime=Date.now()}}function nT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function aO({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function x$(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return aO(t);default:return!1}}async function C$(t,e={}){return Ni(t,"GET","/v1/projects",e)}const E$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,I$=/^https?/;async function _$(t){if(t.config.emulator)return;const{authorizedDomains:e}=await C$(t);for(const n of e)try{if(A$(n))return}catch{}Qs(t,"unauthorized-domain")}function A$(t){const e=Vx(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return i.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&i.hostname===r}if(!I$.test(n))return!1;if(E$.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const S$=new Lp(3e4,6e4);function rT(){const t=Ro().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function T$(t){return new Promise((e,n)=>{function r(){rT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rT(),n(ko(t,"network-request-failed"))},timeout:S$.get()})}if(Ro().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ro().gapi?.load)r();else{const s=w9("iframefcb");return Ro()[s]=()=>{gapi.load?r():n(ko(t,"network-request-failed"))},zM(`${y9()}?onload=${s}`).catch(o=>n(o))}}).catch(e=>{throw wy=null,e})}let wy=null;function P$(t){return wy=wy||T$(t),wy}const k$=new Lp(5e3,15e3),R$="__/auth/iframe",N$="emulator/auth/iframe",D$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},M$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function O$(t){const e=t.config;Xe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?wE(e,N$):`https://${t.config.authDomain}/${R$}`,r={apiKey:e.apiKey,appName:t.name,v:qc},s=M$.get(t.config.apiHost);s&&(r.eid=s);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${vp(r).slice(1)}`}async function L$(t){const e=await P$(t),n=Ro().gapi;return Xe(n,t,"internal-error"),e.open({where:document.body,url:O$(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:D$,dontclear:!0},r=>new Promise(async(s,o)=>{await r.restyle({setHideOnLeave:!1});const i=ko(t,"network-request-failed"),a=Ro().setTimeout(()=>{o(i)},k$.get());function l(){Ro().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{o(i)})}))}const F$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},j$=500,V$=600,B$="_blank",U$="http://localhost";class sT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function H$(t,e,n,r=j$,s=V$){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...F$,width:r.toString(),height:s.toString(),top:o,left:i},c=Rn().toLowerCase();n&&(a=FM(c)?B$:n),OM(c)&&(e=e||U$,l.scrollbars="yes");const u=Object.entries(l).reduce((f,[g,y])=>`${f}${g}=${y},`,"");if(l9(c)&&a!=="_self")return $$(e||"",a),new sT(null);const h=window.open(e||"",a,u);Xe(h,t,"popup-blocked");try{h.focus()}catch{}return new sT(h)}function $$(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const z$="__/auth/handler",G$="emulator/auth/handler",W$=encodeURIComponent("fac");async function oT(t,e,n,r,s,o){Xe(t.config.authDomain,t,"auth-domain-config-required"),Xe(t.config.apiKey,t,"invalid-api-key");const i={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:qc,eventId:s};if(e instanceof KM){e.setDefaultLanguage(t.languageCode),i.providerId=e.providerId||"",e3(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))i[u]=h}if(e instanceof jp){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(i.scopes=u.join(","))}t.tenantId&&(i.tid=t.tenantId);const a=i;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${W$}=${encodeURIComponent(l)}`:"";return`${K$(t)}?${vp(a).slice(1)}${c}`}function K$({config:t}){return t.emulator?wE(t,G$):`https://${t.authDomain}/${z$}`}const lv="webStorageSupport";class q${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tO,this._completeRedirectFn=w$,this._overrideRedirectResult=p$}async _openPopup(e,n,r,s){_i(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await oT(e,n,r,Vx(),s);return H$(e,o,IE())}async _openRedirect(e,n,r,s){await this._originValidation(e);const o=await oT(e,n,r,Vx(),s);return J9(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:o}=this.eventManagers[n];return s?Promise.resolve(s):(_i(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await L$(e),r=new v$(e);return n.register("authEvent",s=>(Xe(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(lv,{type:lv},s=>{const o=s?.[0]?.[lv];o!==void 0&&n(!!o),Qs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=_$(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return HM()||LM()||vE()}}const Q$=q$;var iT="@firebase/auth",aT="1.11.1";class Y${constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Xe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function J$(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function X$(t){Ac(new Fa("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:i,authDomain:a}=r.options;Xe(i&&!i.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:i,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$M(t)},c=new m9(r,s,o,l);return I9(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ac(new Fa("auth-internal",e=>{const n=Xc(e.getProvider("auth").getImmediate());return(r=>new Y$(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ao(iT,aT,J$(t)),Ao(iT,aT,"esm2020")}const Z$=300,ez=z2("authIdTokenMaxAge")||Z$;let lT=null;const tz=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>ez)return;const s=n?.token;lT!==s&&(lT=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function nz(t=Z2()){const e=fb(t,"auth");if(e.isInitialized())return e.getImmediate();const n=E9(t,{popupRedirectResolver:Q$,persistence:[i$,EE,tO]}),r=z2("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const i=tz(o.toString());z9(n,i,()=>i(n.currentUser)),$9(n,a=>i(a))}}const s=H2("auth");return s&&_9(n,`http://${s}`),n}function rz(){return document.getElementsByTagName("head")?.[0]??document}p9({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const o=ko("internal-error");o.customData=s,n(o)},r.type="text/javascript",r.charset="UTF-8",rz().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});X$("Browser");const lO="firebasestorage.googleapis.com",cO="storageBucket",sz=120*1e3,oz=600*1e3,iz=1e3;class tn extends Uo{constructor(e,n,r=0){super(cv(e),`Firebase Storage: ${n} (${cv(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,tn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return cv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Wt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Wt||(Wt={}));function cv(t){return"storage/"+t}function AE(){const t="An unknown error occurred, please check the error payload for server response.";return new tn(Wt.UNKNOWN,t)}function az(t){return new tn(Wt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function lz(t){return new tn(Wt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function cz(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new tn(Wt.UNAUTHENTICATED,t)}function uz(){return new tn(Wt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function dz(t){return new tn(Wt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function uO(){return new tn(Wt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function dO(){return new tn(Wt.CANCELED,"User canceled the upload/download.")}function hz(t){return new tn(Wt.INVALID_URL,"Invalid URL '"+t+"'.")}function fz(t){return new tn(Wt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function mz(){return new tn(Wt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+cO+"' property when initializing the app?")}function hO(){return new tn(Wt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function pz(){return new tn(Wt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function gz(){return new tn(Wt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function yz(t){return new tn(Wt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function $x(t){return new tn(Wt.INVALID_ARGUMENT,t)}function fO(){return new tn(Wt.APP_DELETED,"The Firebase app was deleted.")}function wz(t){return new tn(Wt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function am(t,e){return new tn(Wt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function uf(t){throw new tn(Wt.INTERNAL_ERROR,"Internal error: "+t)}class Xr{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Xr.makeFromUrl(e,n)}catch{return new Xr(e,"")}if(r.path==="")return r;throw fz(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function o(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const i="(/(.*))?$",a=new RegExp("^gs://"+s+i,"i"),l={bucket:1,path:3};function c(N){N.path_=decodeURIComponent(N.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",g=new RegExp(`^https?://${h}/${u}/b/${s}/o${f}`,"i"),y={bucket:1,path:3},w=n===lO?"(?:storage.googleapis.com|storage.cloud.google.com)":n,v="([^?#]*)",C=new RegExp(`^https?://${w}/${s}/${v}`,"i"),A=[{regex:a,indices:l,postModify:o},{regex:g,indices:y,postModify:c},{regex:C,indices:{bucket:1,path:2},postModify:c}];for(let N=0;N<A.length;N++){const M=A[N],k=M.regex.exec(e);if(k){const E=k[M.indices.bucket];let b=k[M.indices.path];b||(b=""),r=new Xr(E,b),M.postModify(r);break}}if(r==null)throw hz(e);return r}}class bz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function vz(t,e,n){let r=1,s=null,o=null,i=!1,a=0;function l(){return a===2}let c=!1;function u(...v){c||(c=!0,e.apply(null,v))}function h(v){s=setTimeout(()=>{s=null,t(g,l())},v)}function f(){o&&clearTimeout(o)}function g(v,...C){if(c){f();return}if(v){f(),u.call(null,v,...C);return}if(l()||i){f(),u.call(null,v,...C);return}r<64&&(r*=2);let A;a===1?(a=2,A=0):A=(r+Math.random())*1e3,h(A)}let y=!1;function w(v){y||(y=!0,f(),!c&&(s!==null?(v||(a=2),clearTimeout(s),h(0)):v||(a=1)))}return h(0),o=setTimeout(()=>{i=!0,w(!0)},n),w}function xz(t){t(!1)}function Cz(t){return t!==void 0}function Ez(t){return typeof t=="function"}function Iz(t){return typeof t=="object"&&!Array.isArray(t)}function Ub(t){return typeof t=="string"||t instanceof String}function cT(t){return SE()&&t instanceof Blob}function SE(){return typeof Blob<"u"}function uT(t,e,n,r){if(r<e)throw $x(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw $x(`Invalid value for '${t}'. Expected ${n} or less.`)}function Bp(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function mO(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var pc;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(pc||(pc={}));function pO(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||s||o}class _z{constructor(e,n,r,s,o,i,a,l,c,u,h,f=!0,g=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=o,this.additionalRetryCodes_=i,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,w)=>{this.resolve_=y,this.reject_=w,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Og(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const i=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&o.addUploadProgressListener(i),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(i),this.pendingConnection_=null;const a=o.getErrorCode()===pc.NO_ERROR,l=o.getStatus();if(!a||pO(l,this.additionalRetryCodes_)&&this.retry){const u=o.getErrorCode()===pc.ABORT;r(!1,new Og(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Og(c,o))})},n=(r,s)=>{const o=this.resolve_,i=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());Cz(l)?o(l):o()}catch(l){i(l)}else if(a!==null){const l=AE();l.serverResponse=a.getErrorText(),this.errorCallback_?i(this.errorCallback_(a,l)):i(l)}else if(s.canceled){const l=this.appDelete_?fO():dO();i(l)}else{const l=uO();i(l)}};this.canceled_?n(!1,new Og(!1,null,!0)):this.backoffId_=vz(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&xz(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Og{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Az(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Sz(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Tz(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Pz(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function kz(t,e,n,r,s,o,i=!0,a=!1){const l=mO(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return Tz(u,e),Az(u,n),Sz(u,o),Pz(u,r),new _z(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,i,a)}function Rz(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Nz(...t){const e=Rz();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(SE())return new Blob(t);throw new tn(Wt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Dz(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function Mz(t){if(typeof atob>"u")throw yz("base-64");return atob(t)}const Io={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class uv{constructor(e,n){this.data=e,this.contentType=n||null}}function Oz(t,e){switch(t){case Io.RAW:return new uv(gO(e));case Io.BASE64:case Io.BASE64URL:return new uv(yO(t,e));case Io.DATA_URL:return new uv(Fz(e),jz(e))}throw AE()}function gO(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const o=r,i=t.charCodeAt(++n);r=65536|(o&1023)<<10|i&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function Lz(t){let e;try{e=decodeURIComponent(t)}catch{throw am(Io.DATA_URL,"Malformed data URL.")}return gO(e)}function yO(t,e){switch(t){case Io.BASE64:{const s=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(s||o)throw am(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Io.BASE64URL:{const s=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(s||o)throw am(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Mz(e)}catch(s){throw s.message.includes("polyfill")?s:am(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class wO{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw am(Io.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=Vz(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function Fz(t){const e=new wO(t);return e.base64?yO(Io.BASE64,e.rest):Lz(e.rest)}function jz(t){return new wO(t).contentType}function Vz(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}class ua{constructor(e,n){let r=0,s="";cT(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(cT(this.data_)){const r=this.data_,s=Dz(r,e,n);return s===null?null:new ua(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new ua(r,!0)}}static getBlob(...e){if(SE()){const n=e.map(r=>r instanceof ua?r.data_:r);return new ua(Nz.apply(null,n))}else{const n=e.map(i=>Ub(i)?Oz(Io.RAW,i).data:i.data_);let r=0;n.forEach(i=>{r+=i.byteLength});const s=new Uint8Array(r);let o=0;return n.forEach(i=>{for(let a=0;a<i.length;a++)s[o++]=i[a]}),new ua(s,!0)}}uploadData(){return this.data_}}function bO(t){let e;try{e=JSON.parse(t)}catch{return null}return Iz(e)?e:null}function Bz(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Uz(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function vO(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function Hz(t,e){return e}class hr{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||Hz}}let Lg=null;function $z(t){return!Ub(t)||t.length<2?t:vO(t)}function xO(){if(Lg)return Lg;const t=[];t.push(new hr("bucket")),t.push(new hr("generation")),t.push(new hr("metageneration")),t.push(new hr("name","fullPath",!0));function e(o,i){return $z(i)}const n=new hr("name");n.xform=e,t.push(n);function r(o,i){return i!==void 0?Number(i):i}const s=new hr("size");return s.xform=r,t.push(s),t.push(new hr("timeCreated")),t.push(new hr("updated")),t.push(new hr("md5Hash",null,!0)),t.push(new hr("cacheControl",null,!0)),t.push(new hr("contentDisposition",null,!0)),t.push(new hr("contentEncoding",null,!0)),t.push(new hr("contentLanguage",null,!0)),t.push(new hr("contentType",null,!0)),t.push(new hr("metadata","customMetadata",!0)),Lg=t,Lg}function zz(t,e){function n(){const r=t.bucket,s=t.fullPath,o=new Xr(r,s);return e._makeStorageReference(o)}Object.defineProperty(t,"ref",{get:n})}function Gz(t,e,n){const r={};r.type="file";const s=n.length;for(let o=0;o<s;o++){const i=n[o];r[i.local]=i.xform(r,e[i.server])}return zz(r,t),r}function CO(t,e,n){const r=bO(e);return r===null?null:Gz(t,r,n)}function Wz(t,e,n,r){const s=bO(e);if(s===null||!Ub(s.downloadTokens))return null;const o=s.downloadTokens;if(o.length===0)return null;const i=encodeURIComponent;return o.split(",").map(c=>{const u=t.bucket,h=t.fullPath,f="/b/"+i(u)+"/o/"+i(h),g=Bp(f,n,r),y=mO({alt:"media",token:c});return g+y})[0]}function EO(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const o=e[s];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}class Th{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function yi(t){if(!t)throw AE()}function TE(t,e){function n(r,s){const o=CO(t,s,e);return yi(o!==null),o}return n}function Kz(t,e){function n(r,s){const o=CO(t,s,e);return yi(o!==null),Wz(o,s,t.host,t._protocol)}return n}function Up(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=uz():s=cz():n.getStatus()===402?s=lz(t.bucket):n.getStatus()===403?s=dz(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function IO(t){const e=Up(t);function n(r,s){let o=e(r,s);return r.getStatus()===404&&(o=az(t.path)),o.serverResponse=s.serverResponse,o}return n}function qz(t,e,n){const r=e.fullServerUrl(),s=Bp(r,t.host,t._protocol),o="GET",i=t.maxOperationRetryTime,a=new Th(s,o,TE(t,n),i);return a.errorHandler=IO(e),a}function Qz(t,e,n){const r=e.fullServerUrl(),s=Bp(r,t.host,t._protocol),o="GET",i=t.maxOperationRetryTime,a=new Th(s,o,Kz(t,n),i);return a.errorHandler=IO(e),a}function Yz(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function _O(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=Yz(null,e)),r}function Jz(t,e,n,r,s){const o=e.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};function a(){let A="";for(let N=0;N<2;N++)A=A+Math.random().toString().slice(2);return A}const l=a();i["Content-Type"]="multipart/related; boundary="+l;const c=_O(e,r,s),u=EO(c,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",g=ua.getBlob(h,r,f);if(g===null)throw hO();const y={name:c.fullPath},w=Bp(o,t.host,t._protocol),v="POST",C=t.maxUploadRetryTime,x=new Th(w,v,TE(t,n),C);return x.urlParams=y,x.headers=i,x.body=g.uploadData(),x.errorHandler=Up(e),x}class fw{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function PE(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{yi(!1)}return yi(!!n&&(e||["active"]).indexOf(n)!==-1),n}function Xz(t,e,n,r,s){const o=e.bucketOnlyServerUrl(),i=_O(e,r,s),a={name:i.fullPath},l=Bp(o,t.host,t._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":i.contentType,"Content-Type":"application/json; charset=utf-8"},h=EO(i,n),f=t.maxUploadRetryTime;function g(w){PE(w);let v;try{v=w.getResponseHeader("X-Goog-Upload-URL")}catch{yi(!1)}return yi(Ub(v)),v}const y=new Th(l,c,g,f);return y.urlParams=a,y.headers=u,y.body=h,y.errorHandler=Up(e),y}function Zz(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function o(c){const u=PE(c,["active","final"]);let h=null;try{h=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{yi(!1)}h||yi(!1);const f=Number(h);return yi(!isNaN(f)),new fw(f,r.size(),u==="final")}const i="POST",a=t.maxUploadRetryTime,l=new Th(n,i,o,a);return l.headers=s,l.errorHandler=Up(e),l}const dT=256*1024;function eG(t,e,n,r,s,o,i,a){const l=new fw(0,0);if(i?(l.current=i.current,l.total=i.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw pz();const c=l.total-l.current;let u=c;s>0&&(u=Math.min(u,s));const h=l.current,f=h+u;let g="";u===0?g="finalize":c===u?g="upload, finalize":g="upload";const y={"X-Goog-Upload-Command":g,"X-Goog-Upload-Offset":`${l.current}`},w=r.slice(h,f);if(w===null)throw hO();function v(N,M){const k=PE(N,["active","final"]),E=l.current+u,b=r.size();let I;return k==="final"?I=TE(e,o)(N,M):I=null,new fw(E,b,k==="final",I)}const C="POST",x=e.maxUploadRetryTime,A=new Th(n,C,v,x);return A.headers=y,A.body=w.uploadData(),A.progressCallback=a||null,A.errorHandler=Up(t),A}const Tr={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function dv(t){switch(t){case"running":case"pausing":case"canceling":return Tr.RUNNING;case"paused":return Tr.PAUSED;case"success":return Tr.SUCCESS;case"canceled":return Tr.CANCELED;case"error":return Tr.ERROR;default:return Tr.ERROR}}class tG{constructor(e,n,r){if(Ez(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const o=e;this.next=o.next,this.error=o.error,this.complete=o.complete}}}function du(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class nG{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=pc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=pc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=pc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,o){if(this.sent_)throw uf("cannot .send() more than once");if(Ja(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),o!==void 0)for(const i in o)o.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,o[i].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw uf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw uf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw uf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw uf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class rG extends nG{initXhr(){this.xhr_.responseType="text"}}function Au(){return new rG}class sG{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=xO(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(Wt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const o=this.isExponentialBackoffExpired();if(pO(s.status,[]))if(o)s=uO();else{this.sleepTime=Math.max(this.sleepTime*2,iz),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(Wt.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,o)=>{this._resolve=s,this._reject=o,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=Xz(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Au,e,n);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._uploadUrl=o,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=Zz(this._ref.storage,this._ref._location,e,this._blob),o=this._ref.storage._makeRequest(s,Au,n,r);this._request=o,o.getPromise().then(i=>{i=i,this._request=void 0,this._updateProgress(i.current),this._needToFetchStatus=!1,i.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=dT*this._chunkMultiplier,n=new fw(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,o)=>{let i;try{i=eG(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(i,Au,s,o,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){dT*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=qz(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,Au,e,n);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._metadata=o,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=Jz(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Au,e,n);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._metadata=o,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=dO(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=dv(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const o=new tG(n||void 0,r||void 0,s||void 0);return this._addObserver(o),()=>{this._removeObserver(o)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(dv(this._state)){case Tr.SUCCESS:du(this._resolve.bind(null,this.snapshot))();break;case Tr.CANCELED:case Tr.ERROR:const n=this._reject;du(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(dv(this._state)){case Tr.RUNNING:case Tr.PAUSED:e.next&&du(e.next.bind(e,this.snapshot))();break;case Tr.SUCCESS:e.complete&&du(e.complete.bind(e))();break;case Tr.CANCELED:case Tr.ERROR:e.error&&du(e.error.bind(e,this._error))();break;default:e.error&&du(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}class jc{constructor(e,n){this._service=e,n instanceof Xr?this._location=n:this._location=Xr.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new jc(e,n)}get root(){const e=new Xr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vO(this._location.path)}get storage(){return this._service}get parent(){const e=Bz(this._location.path);if(e===null)return null;const n=new Xr(this._location.bucket,e);return new jc(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw wz(e)}}function oG(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new sG(t,new ua(e),n)}function iG(t){t._throwIfRoot("getDownloadURL");const e=Qz(t.storage,t._location,xO());return t.storage.makeRequestWithTokens(e,Au).then(n=>{if(n===null)throw gz();return n})}function aG(t,e){const n=Uz(t._location.path,e),r=new Xr(t._location.bucket,n);return new jc(t.storage,r)}function lG(t){return/^[A-Za-z]+:\/\//.test(t)}function cG(t,e){return new jc(t,e)}function AO(t,e){if(t instanceof kE){const n=t;if(n._bucket==null)throw mz();const r=new jc(n,n._bucket);return e!=null?AO(r,e):r}else return e!==void 0?aG(t,e):t}function uG(t,e){if(e&&lG(e)){if(t instanceof kE)return cG(t,e);throw $x("To use ref(service, url), the first argument must be a Storage instance.")}else return AO(t,e)}function hT(t,e){const n=e?.[cO];return n==null?null:Xr.makeFromBucketSpec(n,t)}function dG(t,e,n,r={}){t.host=`${e}:${n}`;const s=Ja(e);s&&(h1(`https://${t.host}/b`),G2("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:o}=r;o&&(t._overrideAuthToken=typeof o=="string"?o:H5(o,t.app.options.projectId))}class kE{constructor(e,n,r,s,o,i=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=o,this._isUsingEmulator=i,this._bucket=null,this._host=lO,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=sz,this._maxUploadRetryTime=oz,this._requests=new Set,s!=null?this._bucket=Xr.makeFromBucketSpec(s,this._host):this._bucket=hT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xr.makeFromBucketSpec(this._url,e):this._bucket=hT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){uT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){uT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Qr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new jc(this,e)}_makeRequest(e,n,r,s,o=!0){if(this._deleted)return new bz(fO());{const i=kz(e,this._appId,r,s,n,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const fT="@firebase/storage",mT="0.14.0";const SO="storage";function hG(t,e,n){return t=jt(t),oG(t,e,n)}function fG(t){return t=jt(t),iG(t)}function mG(t,e){return t=jt(t),uG(t,e)}function pG(t=Z2(),e){t=jt(t);const r=fb(t,SO).getImmediate({identifier:e}),s=B5("storage");return s&&gG(r,...s),r}function gG(t,e,n,r={}){dG(t,e,n,r)}function yG(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new kE(n,r,s,e,qc)}function wG(){Ac(new Fa(SO,yG,"PUBLIC").setMultipleInstances(!0)),Ao(fT,mT,""),Ao(fT,mT,"esm2020")}wG();const bG={apiKey:"AIzaSyC-k_GmIXG9UkOZICBvemN8h7KB54TDm_k",authDomain:"abcd-44084.firebaseapp.com",projectId:"abcd-44084",storageBucket:"abcd-44084.appspot.com",messagingSenderId:"70367132228",appId:"1:70367132228:web:5d0214ba79f13d53b2da11",measurementId:"G-K4FDG52P0Y"},pT="mobilEASE";let df,Oe,it,gT;const vG=async()=>{try{df=nU().find(e=>e.name===pT)||X2(bG,pT),console.log("[Firebase] Initializing Firebase services..."),Oe=_8(df,{localCache:L8({tabManager:B8()})}),it=nz(df),gT=pG(df,"gs://abcd-44084.appspot.com");try{await JM(it,EE),console.log("[Firebase] Auth persistence enabled"),console.log("[Firebase] Firestore offline persistence enabled with cache settings")}catch(e){console.warn("[Firebase] Error enabling persistence:",e)}return console.log("[Firebase] Firebase services initialized successfully"),{app:df,db:Oe,auth:it,storage:gT}}catch(t){throw console.error("[Firebase] Error initializing Firebase:",t),t}};vG();const TO=Object.freeze({citizen:"citizen",official:"official"}),Es=Object.freeze({inProgress:"In-Progress",solved:"SOLVED",rejected:"REJECTED"}),pr=Object.freeze({inProgress:"#DFC900",solved:"#04B900",rejected:"#C70000"}),zx=async t=>{try{const e=wn(Oe,"users"),n=Ha(e,Oa("aadhar","==",t));return!(await Mp(n)).empty}catch(e){throw console.error("Error checking Aadhar:",e),e}},Hp=async t=>{try{if(console.log("[isOfficial] Checking if user is official:",{userId:t}),!t)return console.log("[isOfficial] No user ID provided"),!1;const e=tt(Oe,"users",t);console.log("[isOfficial] Fetching user document...");const n=await Nn(e);if(!n.exists())return console.log("[isOfficial] User document does not exist"),!1;const r=n.data()||{};console.log("[isOfficial] User data:",r);const s=r.type===TO.official||r.userType==="official";return console.log("[isOfficial] User is official:",s),s}catch(e){return console.error("[isOfficial] Error checking if user is official:",e),!1}},PO=async(t,e="audio/")=>{try{const n=getStorage(),r=mG(n,`${e}${Date.now()}_${t.name}`),s=hG(r,t);return new Promise((o,i)=>{s.on("state_changed",a=>{const l=a.bytesTransferred/a.totalBytes*100;console.log("Upload is "+l+"% done")},a=>{console.error("Error uploading file:",a),i(a)},async()=>{try{const a=await fG(s.snapshot.ref);o({url:a,path:s.snapshot.ref.fullPath,name:t.name,type:t.type,size:t.size})}catch(a){i(a)}})})}catch(n){throw console.error("Error in uploadToFirebaseStorage:",n),n}},Gx=async(t,e,n="auto")=>{const r="dr3puskd8",s="mobilease_unsigned",o="383239151459235",i=new FormData;i.append("file",t),i.append("upload_preset",s),i.append("folder",e),i.append("public_id",`${e}_${Date.now()}`),i.append("api_key",o),i.append("resource_type",n),console.log(`Uploading ${t.type} to Cloudinary:`,{cloudName:r,uploadPreset:s,file:t.name,size:t.size,type:t.type,resourceType:n});try{const a=await fetch(`https://api.cloudinary.com/v1_1/${r}/${n}/upload`,{method:"POST",body:i});if(!a.ok){const c=await a.text();console.error("Cloudinary upload error:",c);let u=`Failed to upload ${t.type.startsWith("audio/")?"audio":"file"}`;try{u=JSON.parse(c).error?.message||u}catch(h){console.error("Error parsing error response:",h)}throw new Error(u)}const l=await a.json();return console.log("Cloudinary upload successful:",{url:l.secure_url,type:l.resource_type,format:l.format}),l.secure_url}catch(a){throw console.error(`Error during ${t.type} upload:`,a),new Error(`Failed to upload ${t.type.startsWith("audio/")?"audio":"file"}: ${a.message}`)}},RE=async(t,e=null)=>{let n="",r="";try{if(e)try{const i=new File([e],`audio_${Date.now()}.wav`,{type:"audio/wav"});n=(await PO(i,"complaints/audio/")).url}catch(i){console.error("Error uploading audio:",i)}if(t.media)try{r=await Gx(t.media,"complaints/media",t.mediaType==="video"?"video":"image")}catch(i){console.error("Error uploading media:",i)}if(t.audio)try{const i=new File([t.audio],`audio_${Date.now()}.wav`,{type:"audio/wav"});n=await Gx(i,"complaints/audio","video")}catch(i){console.error("Error uploading audio:",i)}const s={reason:t.reason,description:t.description,mediaPath:r,audioPath:n,location:t.location,status:t.status||Es.pending,timestamp:new Date().toISOString(),reportedBy:t.reportedBy,likesCount:0,audioUrl:n||""},o=await Lb(wn(Oe,"complaints"),s);return console.log("Complaint created with ID:",o.id),{id:o.id,...s}}catch(s){throw console.error("Error creating complaint:",s),new Error(s.message||"Failed to create complaint")}},mw=async()=>{try{const t=wn(Oe,"complaints"),e=await Mp(t),n=[];for(const r of e.docs)try{const s=r.data();let o;if(s.timestamp?.toDate)o=s.timestamp.toDate();else if(typeof s.timestamp=="string")o=new Date(s.timestamp);else if(s.timestamp?.seconds)o=new Date(s.timestamp.seconds*1e3);else{console.warn("Invalid timestamp format in complaint:",{id:r.id,timestamp:s.timestamp});continue}if(isNaN(o.getTime())){console.warn("Invalid timestamp value in complaint:",{id:r.id,timestamp:s.timestamp,parsed:o});continue}let i="Unknown user";if(typeof s.reportedBy=="string"&&s.reportedBy.trim().length>0)try{const a=await Nn(tt(Oe,"users",s.reportedBy));a.exists()&&(i=a.data()?.name||i)}catch(a){console.warn("Error fetching user data:",a)}else s.reportedBy!=null&&console.warn("Skipping user lookup: invalid reportedBy value",{id:r.id,reportedByType:typeof s.reportedBy,reportedBy:s.reportedBy});n.push({id:r.id,...s,author:i,timestamp:o,issueType:s.issueType||"Other",status:s.status||"pending",description:s.description||"No description provided"})}catch(s){console.error("Error processing complaint:",{id:r.id,error:s.message})}return console.log(`Fetched ${n.length} valid complaints`),n}catch(t){throw console.error("Error fetching complaints:",t),t}},kO=t=>{const e=wn(Oe,"complaints");return Ir(e,async n=>{const r=[];for(const s of n.docs)try{const o=s.data();let i;if(o.timestamp?.toDate)i=o.timestamp.toDate();else if(typeof o.timestamp=="string")i=new Date(o.timestamp);else if(o.timestamp?.seconds)i=new Date(o.timestamp.seconds*1e3);else{console.warn("Invalid timestamp format in real-time update:",{id:s.id,timestamp:o.timestamp});continue}if(isNaN(i.getTime())){console.warn("Invalid timestamp value in real-time update:",{id:s.id,timestamp:o.timestamp,parsed:i});continue}let a="Unknown user";if(o.reportedBy)try{const l=await Nn(tt(Oe,"users",o.reportedBy));l.exists()&&(a=l.data()?.name||a)}catch(l){console.warn("Error fetching user data in real-time update:",l)}r.push({id:s.id,...o,author:a,timestamp:i,issueType:o.issueType||"Other",status:o.status||"pending",description:o.description||"No description provided"})}catch(o){console.error("Error processing real-time complaint update:",{id:s?.id,error:o.message})}console.log(`[Real-time] Updated with ${r.length} valid complaints`),t(r)})},RO=async(t,e)=>{try{const n=it.currentUser;if(!n)throw new Error("User not authenticated");const r=wn(Oe,"complaints",t,"comments"),s=typeof e=="string"?{author:n.uid,comment:e,timestamp:Date.now()}:{...e,author:n.uid,timestamp:e.timestamp||Date.now()};await Lb(r,s)}catch(n){throw console.error("Error adding comment:",n),new Error(n.message)}},xG=Object.freeze(Object.defineProperty({__proto__:null,addComment:RO,checkAadharExists:zx,createComplaint:RE,get db(){return Oe},fetchComplaints:mw,isOfficial:Hp,subscribeToComplaints:kO,uploadToCloudinary:Gx,uploadToFirebaseStorage:PO},Symbol.toStringTag,{value:"Module"})),NO=p.createContext();function CG({children:t}){const[e,n]=p.useState(null),[r,s]=p.useState(!1),[o,i]=p.useState(!0),[a,l]=p.useState(!1),c=p.useCallback(async()=>{try{await W9(it)}catch(f){throw console.error("Error signing out:",f),f}},[]),u=p.useCallback(async f=>{if(!f)return s(!1),!1;try{const g=await Hp(f.uid);return console.log("[AuthContext] User role check:",{uid:f.uid,isOfficial:g}),s(g),g}catch(g){return console.error("[AuthContext] Error checking user role:",g),s(!1),!1}},[]);p.useEffect(()=>{let f=!0;const y=G9(it,async w=>{f&&(console.log("[AuthContext] Auth state changed:",{uid:w?.uid,email:w?.email}),n(w),w?await u(w):s(!1),f&&(i(!1),l(!0)))});return()=>{f=!1,y()}},[u]);const h={currentUser:e,isOfficial:r,loading:o,initialized:a,signOut:c};return d.jsx(NO.Provider,{value:h,children:a?t:d.jsx("div",{className:"flex items-center justify-center min-h-screen",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-emerald-500"})})})}function $p(){return p.useContext(NO)}const EG=({children:t})=>d.jsx("div",{className:"safe-area",children:t}),DO=p.createContext(null),IG=({children:t})=>{const[e,n]=p.useState(null),[r,s]=p.useState([]),o=p.useCallback((l,c)=>{if(!l){e?.previewUrl&&URL.revokeObjectURL(e.previewUrl),n(null);return}const u=URL.createObjectURL(l);n({blob:l,mime:c||l.type,previewUrl:u})},[e]),i=p.useCallback((l,c)=>{const u=URL.createObjectURL(l);s(h=>[...h,{blob:l,mime:c||l.type,previewUrl:u}])},[]),a=p.useCallback(()=>{e?.previewUrl&&URL.revokeObjectURL(e.previewUrl),r.forEach(l=>l.previewUrl&&URL.revokeObjectURL(l.previewUrl)),n(null),s([])},[e,r]);return d.jsx(DO.Provider,{value:{pendingVideo:e,pendingPhotos:r,setVideo:o,addPhoto:i,clearAll:a},children:t})},NE=()=>{const t=p.useContext(DO);if(!t)throw new Error("useMediaCapture must be used within MediaCaptureProvider");return t};const _G=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AG=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),yT=t=>{const e=AG(t);return e.charAt(0).toUpperCase()+e.slice(1)},MO=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),SG=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var TG={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const PG=p.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:o,iconNode:i,...a},l)=>p.createElement("svg",{ref:l,...TG,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:MO("lucide",s),...!o&&!SG(a)&&{"aria-hidden":"true"},...a},[...i.map(([c,u])=>p.createElement(c,u)),...Array.isArray(o)?o:[o]]));const St=(t,e)=>{const n=p.forwardRef(({className:r,...s},o)=>p.createElement(PG,{ref:o,iconNode:e,className:MO(`lucide-${_G(yT(t))}`,`lucide-${t}`,r),...s}));return n.displayName=yT(t),n};const kG=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],RG=St("camera",kG);const NG=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],pw=St("chart-column",NG);const DG=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],MG=St("chevron-down",DG);const OG=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],OO=St("circle-alert",OG);const LG=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],wT=St("circle-check-big",LG);const FG=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],bT=St("circle-x",FG);const jG=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ff=St("clock",jG);const VG=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],gw=St("external-link",VG);const BG=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],UG=St("globe",BG);const HG=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],LO=St("house",HG);const $G=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],qu=St("layout-dashboard",$G);const zG=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],DE=St("log-out",zG);const GG=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],yw=St("map-pin",GG);const WG=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],KG=St("maximize-2",WG);const qG=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],FO=St("menu",qG);const QG=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],YG=St("mic",QG);const JG=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],XG=St("refresh-cw",JG);const ZG=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],e7=St("send",ZG);const t7=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ME=St("shield-check",t7);const n7=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],r7=St("shield",n7);const s7=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],o7=St("smartphone",s7);const i7=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],a7=St("square-pen",i7);const l7=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],c7=St("square",l7);const u7=[["path",{d:"M16.05 10.966a5 2.5 0 0 1-8.1 0",key:"m5jpwb"}],["path",{d:"m16.923 14.049 4.48 2.04a1 1 0 0 1 .001 1.831l-8.574 3.9a2 2 0 0 1-1.66 0l-8.574-3.91a1 1 0 0 1 0-1.83l4.484-2.04",key:"rbg3g8"}],["path",{d:"M16.949 14.14a5 2.5 0 1 1-9.9 0L10.063 3.5a2 2 0 0 1 3.874 0z",key:"vap8c8"}],["path",{d:"M9.194 6.57a5 2.5 0 0 0 5.61 0",key:"15hn5c"}]],d7=St("traffic-cone",u7);const h7=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],f7=St("trash-2",h7);const m7=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Wx=St("triangle-alert",m7);const p7=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],jO=St("user",p7);const g7=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],y7=St("users",g7);const w7=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],b7=St("wifi-off",w7);const v7=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],x7=St("wifi",v7);const C7=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Vc=St("x",C7);function E7(){return d.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-emerald-50 to-white",children:[d.jsxs("section",{className:"relative py-20 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:[d.jsxs("div",{className:"text-center",children:[d.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6",children:["Welcome to ",d.jsx("span",{className:"text-emerald-600",children:"Civic Mitra"})]}),d.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto mb-10",children:"Your one-stop solution for reporting and resolving local civic issues. Connect with your community and local authorities to make your neighborhood better."}),d.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4 mb-20",children:[d.jsx(Wn,{to:"/register",className:"inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-emerald-600 hover:bg-emerald-700 md:py-4 md:text-lg md:px-10 transition-colors",children:"Get Started"}),d.jsx(Wn,{to:"/about",className:"inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-emerald-700 bg-emerald-100 hover:bg-emerald-200 md:py-4 md:text-lg md:px-10 transition-colors",children:"Learn More"})]})]}),d.jsx("div",{className:"mt-16 grid gap-8 md:grid-cols-3",children:[{icon:d.jsx(yw,{className:"w-10 h-10 text-emerald-600"}),title:"Report Issues",description:"Easily report problems in your area with photos and precise location tagging."},{icon:d.jsx(Wx,{className:"w-10 h-10 text-emerald-600"}),title:"Track Progress",description:"Get real-time updates on the status of your reported issues."},{icon:d.jsx(y7,{className:"w-10 h-10 text-emerald-600"}),title:"Community Driven",description:"See what issues others in your community are reporting and support them."},{icon:d.jsx(r7,{className:"w-10 h-10 text-emerald-600"}),title:"Official Support",description:"Direct line to local authorities for quick resolution of civic issues."}].map((t,e)=>d.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:[d.jsx("div",{className:"w-12 h-12 bg-emerald-50 rounded-full flex items-center justify-center mb-4",children:t.icon}),d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t.title}),d.jsx("p",{className:"text-gray-600",children:t.description})]},e))})]}),d.jsx("section",{className:"py-16 bg-gray-50",children:d.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[d.jsx("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-12",children:"How It Works"}),d.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{number:"1",title:"Sign Up",description:"Create an account as a citizen or official."},{number:"2",title:"Report or View",description:"Report new issues or view existing ones in your area."},{number:"3",title:"Get Updates",description:"Track the progress of reported issues in real-time."}].map((t,e)=>d.jsxs("div",{className:"relative bg-white p-6 rounded-lg shadow-sm",children:[d.jsx("div",{className:"absolute -top-4 -left-4 w-10 h-10 rounded-full bg-emerald-600 text-white flex items-center justify-center font-bold text-lg",children:t.number}),d.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:t.title}),d.jsx("p",{className:"text-gray-600",children:t.description})]},e))})]})}),d.jsx("section",{className:"py-20 bg-emerald-600 text-white",children:d.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[d.jsx("h2",{className:"text-3xl font-bold mb-6",children:"Ready to make a difference?"}),d.jsx("p",{className:"text-xl mb-8 max-w-3xl mx-auto",children:"Join thousands of citizens and officials working together to improve our communities."}),d.jsx(Wn,{to:"/register",className:"inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-emerald-600 bg-white hover:bg-gray-100 md:py-4 md:text-lg md:px-10 transition-colors",children:"Sign Up Now"})]})})]})}function I7(t){if(!t)return!1;const e=t.toString().replace(/\D/g,"");return e.length===12&&/^\d+$/.test(e)}function _7(){const[t,e]=p.useState("citizen"),[n,r]=p.useState(!1),[s,o]=p.useState(""),[i,a]=p.useState(!1),[l,c]=p.useState(["Sanitation & Health","Water & Sewerage","Roads & Transport","Street Lighting","Parks & Horticulture","Town Planning","Revenue","Education","Public Works (PWD local)","Fire Services"]),u=ts(),[h,f]=p.useState({name:"",gender:"male",age:"",email:"",password:"",confirmPassword:"",aadhar:""}),[g,y]=p.useState({name:"",gender:"male",age:"",email:"",password:"",confirmPassword:"",aadhar:"",govtId:"",department:"Sanitation & Health"}),w=M=>{const{name:k,value:E}=M.target;f(b=>({...b,[k]:E}))},v=M=>{const{name:k,value:E}=M.target;y(b=>({...b,[k]:E}))},C=(M,k=!1)=>M.name.trim()?M.email.includes("@")?M.password.length<6?"Password must be at least 6 characters":M.password!==M.confirmPassword?"Passwords do not match":I7(M.aadhar)?k&&!M.govtId?"Government ID is required":"":"Invalid Aadhar number":"Valid email is required":"Name is required",x=async M=>{M.preventDefault();const k=C(h);if(k){ge.error(k);return}try{if(a(!0),await zx(h.aadhar)){ge.error("This Aadhar number is already registered"),a(!1);return}await N(h,"citizen"),ge.success("Registration successful! Welcome to Civic Mitra")}catch(E){console.error("Registration error:",E),ge.error(E.message||"Registration failed. Please try again.")}finally{a(!1)}},A=async M=>{M.preventDefault();const k=C(g,!0);if(k){ge.error(k);return}try{if(a(!0),await zx(g.aadhar)){ge.error("This Aadhar number is already registered"),a(!1);return}await N(g,"official"),ge.success("Registration submitted for review. You will be notified once approved.")}catch(E){console.error("Registration error:",E),ge.error(E.message||"Registration failed. Please try again.")}finally{a(!1)}},N=async(M,k)=>{try{const b=(await V9(it,M.email,M.password)).user;await H9(b,{displayName:M.name.trim()});const I={uid:b.uid,name:M.name.trim(),email:M.email.toLowerCase().trim(),userType:k,gender:M.gender,age:parseInt(M.age,10),aadhar:M.aadhar.replace(/\s/g,""),createdAt:new Date().toISOString(),phoneNumber:"",address:"",profilePhoto:"",...k==="official"&&{govtId:M.govtId.trim(),department:M.department,isVerified:!1,assignedComplaints:[]}};await Xn(tt(Oe,"users",b.uid),I),u(k==="official"?"/official-dashboard":"/citizen-dashboard")}catch(E){throw console.error("Registration error:",E),E}};return p.useEffect(()=>()=>ge.dismiss(),[]),d.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:d.jsx("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl",children:d.jsxs("div",{className:"p-6 sm:p-8",children:[d.jsx("div",{className:"flex justify-center mb-8",children:d.jsx("h2",{className:"text-3xl font-extrabold text-gray-900",children:"Create an account"})}),d.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[d.jsx("button",{onClick:()=>e("citizen"),className:`py-2 px-4 font-medium text-sm focus:outline-none flex-1 text-center ${t==="citizen"?"border-b-2 border-emerald-500 text-emerald-600 font-semibold":"text-gray-500 hover:text-gray-700"}`,children:"Citizen Account"}),d.jsx("button",{onClick:()=>e("official"),className:`py-2 px-4 font-medium text-sm focus:outline-none flex-1 text-center ${t==="official"?"border-b-2 border-emerald-500 text-emerald-600 font-semibold":"text-gray-500 hover:text-gray-700"}`,children:"Government Official"})]}),t==="citizen"&&d.jsxs("form",{className:"space-y-6",onSubmit:x,children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),d.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:h.name,onChange:w,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700",children:"Gender"}),d.jsxs("select",{id:"gender",name:"gender",value:h.gender,onChange:w,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md",children:[d.jsx("option",{value:"male",children:"Male"}),d.jsx("option",{value:"female",children:"Female"}),d.jsx("option",{value:"other",children:"Other"}),d.jsx("option",{value:"prefer-not-to-say",children:"Prefer not to say"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700",children:"Age"}),d.jsx("input",{id:"age",name:"age",type:"number",min:"1",max:"120",required:!0,value:h.age,onChange:w,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),d.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:h.email,onChange:w,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"aadhar",className:"block text-sm font-medium text-gray-700",children:"Aadhar Number"}),d.jsx("input",{id:"aadhar",name:"aadhar",type:"text",inputMode:"numeric",placeholder:"123456789012",value:h.aadhar,onChange:M=>{const k=M.target.value.replace(/\D/g,"").slice(0,12);f(E=>({...E,aadhar:k}))},className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"}),d.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter 12-digit Aadhar number"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),d.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,minLength:"6",value:h.password,onChange:w,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),d.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:h.confirmPassword,onChange:w,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]})]}),d.jsx("div",{children:d.jsx("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-70 disabled:cursor-not-allowed transition-colors",children:i?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Account..."]}):"Create Citizen Account"})})]}),t==="official"&&d.jsxs("form",{className:"space-y-6",onSubmit:A,children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"official-name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),d.jsx("input",{id:"official-name",name:"name",type:"text",required:!0,value:g.name,onChange:v,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"official-gender",className:"block text-sm font-medium text-gray-700",children:"Gender"}),d.jsxs("select",{id:"official-gender",name:"gender",value:g.gender,onChange:v,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md",children:[d.jsx("option",{value:"male",children:"Male"}),d.jsx("option",{value:"female",children:"Female"}),d.jsx("option",{value:"other",children:"Other"}),d.jsx("option",{value:"prefer-not-to-say",children:"Prefer not to say"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"official-age",className:"block text-sm font-medium text-gray-700",children:"Age"}),d.jsx("input",{id:"official-age",name:"age",type:"number",min:"18",max:"100",required:!0,value:g.age,onChange:v,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"official-email",className:"block text-sm font-medium text-gray-700",children:"Official Email"}),d.jsx("input",{id:"official-email",name:"email",type:"email",autoComplete:"email",required:!0,value:g.email,onChange:v,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"official-aadhar",className:"block text-sm font-medium text-gray-700",children:"Aadhar Number"}),d.jsx("input",{id:"official-aadhar",name:"aadhar",type:"text",inputMode:"numeric",placeholder:"123456789012",value:g.aadhar,onChange:M=>{const k=M.target.value.replace(/\D/g,"").slice(0,12);y(E=>({...E,aadhar:k}))},className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"}),d.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter 12-digit Aadhar number"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"govtId",className:"block text-sm font-medium text-gray-700",children:"Government ID"}),d.jsx("input",{id:"govtId",name:"govtId",type:"text",required:!0,value:g.govtId,onChange:v,placeholder:"e.g., EMP12345",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"}),d.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your official government employee ID"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700",children:"Department"}),d.jsx("select",{id:"department",name:"department",value:g.department,onChange:v,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md",children:l.map(M=>d.jsx("option",{value:M,children:M},M))})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"official-password",className:"block text-sm font-medium text-gray-700",children:"Password"}),d.jsx("input",{id:"official-password",name:"password",type:"password",autoComplete:"new-password",required:!0,minLength:"6",value:g.password,onChange:v,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"official-confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),d.jsx("input",{id:"official-confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:g.confirmPassword,onChange:v,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]})]}),d.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:d.jsxs("div",{className:"flex",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsx("svg",{className:"h-5 w-5 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),d.jsx("div",{className:"ml-3",children:d.jsx("p",{className:"text-sm text-yellow-700",children:"Your account will be reviewed by an administrator before you can access the system. You will receive an email once your account is approved."})})]})}),d.jsx("div",{children:d.jsx("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-70 disabled:cursor-not-allowed transition-colors",children:i?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):"Register as Official"})})]}),d.jsx("div",{className:"mt-6 text-center",children:d.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",d.jsxs(Wn,{to:t==="citizen"?"/citizen-login":"/official-login",className:"font-medium text-emerald-600 hover:text-emerald-500 hover:underline",children:["Sign in as ",t==="citizen"?"Citizen":"Official"]})]})})]})})})}const OE=p.createContext({});function LE(t){const e=p.useRef(null);return e.current===null&&(e.current=t()),e.current}const FE=typeof window<"u",VO=FE?p.useLayoutEffect:p.useEffect,Hb=p.createContext(null);function jE(t,e){t.indexOf(e)===-1&&t.push(e)}function VE(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Ai=(t,e,n)=>n>e?e:n<t?t:n;let BE=()=>{};const Si={},BO=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function UO(t){return typeof t=="object"&&t!==null}const HO=t=>/^0[^.\s]+$/u.test(t);function UE(t){let e;return()=>(e===void 0&&(e=t()),e)}const Cs=t=>t,A7=(t,e)=>n=>e(t(n)),zp=(...t)=>t.reduce(A7),Lm=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};class HE{constructor(){this.subscriptions=[]}add(e){return jE(this.subscriptions,e),()=>VE(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let o=0;o<s;o++){const i=this.subscriptions[o];i&&i(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const No=t=>t*1e3,xs=t=>t/1e3;function $O(t,e){return e?t*(1e3/e):0}const zO=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,S7=1e-7,T7=12;function P7(t,e,n,r,s){let o,i,a=0;do i=e+(n-e)/2,o=zO(i,r,s)-t,o>0?n=i:e=i;while(Math.abs(o)>S7&&++a<T7);return i}function Gp(t,e,n,r){if(t===e&&n===r)return Cs;const s=o=>P7(o,0,1,t,n);return o=>o===0||o===1?o:zO(s(o),e,r)}const GO=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,WO=t=>e=>1-t(1-e),KO=Gp(.33,1.53,.69,.99),$E=WO(KO),qO=GO($E),QO=t=>(t*=2)<1?.5*$E(t):.5*(2-Math.pow(2,-10*(t-1))),zE=t=>1-Math.sin(Math.acos(t)),YO=WO(zE),JO=GO(zE),k7=Gp(.42,0,1,1),R7=Gp(0,0,.58,1),XO=Gp(.42,0,.58,1),N7=t=>Array.isArray(t)&&typeof t[0]!="number",ZO=t=>Array.isArray(t)&&typeof t[0]=="number",D7={linear:Cs,easeIn:k7,easeInOut:XO,easeOut:R7,circIn:zE,circInOut:JO,circOut:YO,backIn:$E,backInOut:qO,backOut:KO,anticipate:QO},M7=t=>typeof t=="string",vT=t=>{if(ZO(t)){BE(t.length===4);const[e,n,r,s]=t;return Gp(e,n,r,s)}else if(M7(t))return D7[t];return t},Fg=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function O7(t,e){let n=new Set,r=new Set,s=!1,o=!1;const i=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(u){i.has(u)&&(c.schedule(u),t()),u(a)}const c={schedule:(u,h=!1,f=!1)=>{const y=f&&s?n:r;return h&&i.add(u),y.has(u)||y.add(u),u},cancel:u=>{r.delete(u),i.delete(u)},process:u=>{if(a=u,s){o=!0;return}s=!0,[n,r]=[r,n],n.forEach(l),n.clear(),s=!1,o&&(o=!1,c.process(u))}};return c}const L7=40;function eL(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},o=()=>n=!0,i=Fg.reduce((A,N)=>(A[N]=O7(o),A),{}),{setup:a,read:l,resolveKeyframes:c,preUpdate:u,update:h,preRender:f,render:g,postRender:y}=i,w=()=>{const A=Si.useManualTiming?s.timestamp:performance.now();n=!1,Si.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(A-s.timestamp,L7),1)),s.timestamp=A,s.isProcessing=!0,a.process(s),l.process(s),c.process(s),u.process(s),h.process(s),f.process(s),g.process(s),y.process(s),s.isProcessing=!1,n&&e&&(r=!1,t(w))},v=()=>{n=!0,r=!0,s.isProcessing||t(w)};return{schedule:Fg.reduce((A,N)=>{const M=i[N];return A[N]=(k,E=!1,b=!1)=>(n||v(),M.schedule(k,E,b)),A},{}),cancel:A=>{for(let N=0;N<Fg.length;N++)i[Fg[N]].cancel(A)},state:s,steps:i}}const{schedule:Yt,cancel:$a,state:zn,steps:hv}=eL(typeof requestAnimationFrame<"u"?requestAnimationFrame:Cs,!0);let by;function F7(){by=void 0}const Or={now:()=>(by===void 0&&Or.set(zn.isProcessing||Si.useManualTiming?zn.timestamp:performance.now()),by),set:t=>{by=t,queueMicrotask(F7)}},tL=t=>e=>typeof e=="string"&&e.startsWith(t),GE=tL("--"),j7=tL("var(--"),WE=t=>j7(t)?V7.test(t.split("/*")[0].trim()):!1,V7=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Ph={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Fm={...Ph,transform:t=>Ai(0,1,t)},jg={...Ph,default:1},lm=t=>Math.round(t*1e5)/1e5,KE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function B7(t){return t==null}const U7=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,qE=(t,e)=>n=>!!(typeof n=="string"&&U7.test(n)&&n.startsWith(t)||e&&!B7(n)&&Object.prototype.hasOwnProperty.call(n,e)),nL=(t,e,n)=>r=>{if(typeof r!="string")return r;const[s,o,i,a]=r.match(KE);return{[t]:parseFloat(s),[e]:parseFloat(o),[n]:parseFloat(i),alpha:a!==void 0?parseFloat(a):1}},H7=t=>Ai(0,255,t),fv={...Ph,transform:t=>Math.round(H7(t))},Vl={test:qE("rgb","red"),parse:nL("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+fv.transform(t)+", "+fv.transform(e)+", "+fv.transform(n)+", "+lm(Fm.transform(r))+")"};function $7(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const Kx={test:qE("#"),parse:$7,transform:Vl.transform},Wp=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Zi=Wp("deg"),Do=Wp("%"),Ze=Wp("px"),z7=Wp("vh"),G7=Wp("vw"),xT={...Do,parse:t=>Do.parse(t)/100,transform:t=>Do.transform(t*100)},Nu={test:qE("hsl","hue"),parse:nL("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Do.transform(lm(e))+", "+Do.transform(lm(n))+", "+lm(Fm.transform(r))+")"},Cn={test:t=>Vl.test(t)||Kx.test(t)||Nu.test(t),parse:t=>Vl.test(t)?Vl.parse(t):Nu.test(t)?Nu.parse(t):Kx.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Vl.transform(t):Nu.transform(t),getAnimatableNone:t=>{const e=Cn.parse(t);return e.alpha=0,Cn.transform(e)}},W7=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function K7(t){return isNaN(t)&&typeof t=="string"&&(t.match(KE)?.length||0)+(t.match(W7)?.length||0)>0}const rL="number",sL="color",q7="var",Q7="var(",CT="${}",Y7=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function jm(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},s=[];let o=0;const a=e.replace(Y7,l=>(Cn.test(l)?(r.color.push(o),s.push(sL),n.push(Cn.parse(l))):l.startsWith(Q7)?(r.var.push(o),s.push(q7),n.push(l)):(r.number.push(o),s.push(rL),n.push(parseFloat(l))),++o,CT)).split(CT);return{values:n,split:a,indexes:r,types:s}}function oL(t){return jm(t).values}function iL(t){const{split:e,types:n}=jm(t),r=e.length;return s=>{let o="";for(let i=0;i<r;i++)if(o+=e[i],s[i]!==void 0){const a=n[i];a===rL?o+=lm(s[i]):a===sL?o+=Cn.transform(s[i]):o+=s[i]}return o}}const J7=t=>typeof t=="number"?0:Cn.test(t)?Cn.getAnimatableNone(t):t;function X7(t){const e=oL(t);return iL(t)(e.map(J7))}const za={test:K7,parse:oL,createTransformer:iL,getAnimatableNone:X7};function mv(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Z7({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,o=0,i=0;if(!e)s=o=i=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;s=mv(l,a,t+1/3),o=mv(l,a,t),i=mv(l,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(o*255),blue:Math.round(i*255),alpha:r}}function ww(t,e){return n=>n>0?e:t}const en=(t,e,n)=>t+(e-t)*n,pv=(t,e,n)=>{const r=t*t,s=n*(e*e-r)+r;return s<0?0:Math.sqrt(s)},eW=[Kx,Vl,Nu],tW=t=>eW.find(e=>e.test(t));function ET(t){const e=tW(t);if(!e)return!1;let n=e.parse(t);return e===Nu&&(n=Z7(n)),n}const IT=(t,e)=>{const n=ET(t),r=ET(e);if(!n||!r)return ww(t,e);const s={...n};return o=>(s.red=pv(n.red,r.red,o),s.green=pv(n.green,r.green,o),s.blue=pv(n.blue,r.blue,o),s.alpha=en(n.alpha,r.alpha,o),Vl.transform(s))},qx=new Set(["none","hidden"]);function nW(t,e){return qx.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function rW(t,e){return n=>en(t,e,n)}function QE(t){return typeof t=="number"?rW:typeof t=="string"?WE(t)?ww:Cn.test(t)?IT:iW:Array.isArray(t)?aL:typeof t=="object"?Cn.test(t)?IT:sW:ww}function aL(t,e){const n=[...t],r=n.length,s=t.map((o,i)=>QE(o)(o,e[i]));return o=>{for(let i=0;i<r;i++)n[i]=s[i](o);return n}}function sW(t,e){const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=QE(t[s])(t[s],e[s]));return s=>{for(const o in r)n[o]=r[o](s);return n}}function oW(t,e){const n=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],i=t.indexes[o][r[o]],a=t.values[i]??0;n[s]=a,r[o]++}return n}const iW=(t,e)=>{const n=za.createTransformer(e),r=jm(t),s=jm(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?qx.has(t)&&!s.values.length||qx.has(e)&&!r.values.length?nW(t,e):zp(aL(oW(r,s),s.values),n):ww(t,e)};function lL(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?en(t,e,n):QE(t)(t,e)}const aW=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>Yt.update(e,n),stop:()=>$a(e),now:()=>zn.isProcessing?zn.timestamp:Or.now()}},cL=(t,e,n=10)=>{let r="";const s=Math.max(Math.round(e/n),2);for(let o=0;o<s;o++)r+=Math.round(t(o/(s-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},bw=2e4;function YE(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<bw;)e+=n,r=t.next(e);return e>=bw?1/0:e}function lW(t,e=100,n){const r=n({...t,keyframes:[0,e]}),s=Math.min(YE(r),bw);return{type:"keyframes",ease:o=>r.next(s*o).value/e,duration:xs(s)}}const cW=5;function uL(t,e,n){const r=Math.max(e-cW,0);return $O(n-t(r),e-r)}const sn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},gv=.001;function uW({duration:t=sn.duration,bounce:e=sn.bounce,velocity:n=sn.velocity,mass:r=sn.mass}){let s,o,i=1-e;i=Ai(sn.minDamping,sn.maxDamping,i),t=Ai(sn.minDuration,sn.maxDuration,xs(t)),i<1?(s=c=>{const u=c*i,h=u*t,f=u-n,g=Qx(c,i),y=Math.exp(-h);return gv-f/g*y},o=c=>{const h=c*i*t,f=h*n+n,g=Math.pow(i,2)*Math.pow(c,2)*t,y=Math.exp(-h),w=Qx(Math.pow(c,2),i);return(-s(c)+gv>0?-1:1)*((f-g)*y)/w}):(s=c=>{const u=Math.exp(-c*t),h=(c-n)*t+1;return-gv+u*h},o=c=>{const u=Math.exp(-c*t),h=(n-c)*(t*t);return u*h});const a=5/t,l=hW(s,o,a);if(t=No(t),isNaN(l))return{stiffness:sn.stiffness,damping:sn.damping,duration:t};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:i*2*Math.sqrt(r*c),duration:t}}}const dW=12;function hW(t,e,n){let r=n;for(let s=1;s<dW;s++)r=r-t(r)/e(r);return r}function Qx(t,e){return t*Math.sqrt(1-e*e)}const fW=["duration","bounce"],mW=["stiffness","damping","mass"];function _T(t,e){return e.some(n=>t[n]!==void 0)}function pW(t){let e={velocity:sn.velocity,stiffness:sn.stiffness,damping:sn.damping,mass:sn.mass,isResolvedFromDuration:!1,...t};if(!_T(t,mW)&&_T(t,fW))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,o=2*Ai(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:sn.mass,stiffness:s,damping:o}}else{const n=uW(t);e={...e,...n,mass:sn.mass},e.isResolvedFromDuration=!0}return e}function vw(t=sn.visualDuration,e=sn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:s}=n;const o=n.keyframes[0],i=n.keyframes[n.keyframes.length-1],a={done:!1,value:o},{stiffness:l,damping:c,mass:u,duration:h,velocity:f,isResolvedFromDuration:g}=pW({...n,velocity:-xs(n.velocity||0)}),y=f||0,w=c/(2*Math.sqrt(l*u)),v=i-o,C=xs(Math.sqrt(l/u)),x=Math.abs(v)<5;r||(r=x?sn.restSpeed.granular:sn.restSpeed.default),s||(s=x?sn.restDelta.granular:sn.restDelta.default);let A;if(w<1){const M=Qx(C,w);A=k=>{const E=Math.exp(-w*C*k);return i-E*((y+w*C*v)/M*Math.sin(M*k)+v*Math.cos(M*k))}}else if(w===1)A=M=>i-Math.exp(-C*M)*(v+(y+C*v)*M);else{const M=C*Math.sqrt(w*w-1);A=k=>{const E=Math.exp(-w*C*k),b=Math.min(M*k,300);return i-E*((y+w*C*v)*Math.sinh(b)+M*v*Math.cosh(b))/M}}const N={calculatedDuration:g&&h||null,next:M=>{const k=A(M);if(g)a.done=M>=h;else{let E=M===0?y:0;w<1&&(E=M===0?No(y):uL(A,M,k));const b=Math.abs(E)<=r,I=Math.abs(i-k)<=s;a.done=b&&I}return a.value=a.done?i:k,a},toString:()=>{const M=Math.min(YE(N),bw),k=cL(E=>N.next(M*E).value,M,30);return M+"ms "+k},toTransition:()=>{}};return N}vw.applyToOptions=t=>{const e=lW(t,100,vw);return t.ease=e.ease,t.duration=No(e.duration),t.type="keyframes",t};function Yx({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:i,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],f={done:!1,value:h},g=b=>a!==void 0&&b<a||l!==void 0&&b>l,y=b=>a===void 0?l:l===void 0||Math.abs(a-b)<Math.abs(l-b)?a:l;let w=n*e;const v=h+w,C=i===void 0?v:i(v);C!==v&&(w=C-h);const x=b=>-w*Math.exp(-b/r),A=b=>C+x(b),N=b=>{const I=x(b),P=A(b);f.done=Math.abs(I)<=c,f.value=f.done?C:P};let M,k;const E=b=>{g(f.value)&&(M=b,k=vw({keyframes:[f.value,y(f.value)],velocity:uL(A,b,f.value),damping:s,stiffness:o,restDelta:c,restSpeed:u}))};return E(0),{calculatedDuration:null,next:b=>{let I=!1;return!k&&M===void 0&&(I=!0,N(b),E(b)),M!==void 0&&b>=M?k.next(b-M):(!I&&N(b),f)}}}function gW(t,e,n){const r=[],s=n||Si.mix||lL,o=t.length-1;for(let i=0;i<o;i++){let a=s(t[i],t[i+1]);if(e){const l=Array.isArray(e)?e[i]||Cs:e;a=zp(l,a)}r.push(a)}return r}function yW(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const o=t.length;if(BE(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const i=t[0]===t[1];t[0]>t[o-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=gW(e,r,s),l=a.length,c=u=>{if(i&&u<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(u<t[h+1]);h++);const f=Lm(t[h],t[h+1],u);return a[h](f)};return n?u=>c(Ai(t[0],t[o-1],u)):c}function wW(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=Lm(0,e,r);t.push(en(n,1,s))}}function bW(t){const e=[0];return wW(e,t.length-1),e}function vW(t,e){return t.map(n=>n*e)}function xW(t,e){return t.map(()=>e||XO).splice(0,t.length-1)}function cm({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=N7(r)?r.map(vT):vT(r),o={done:!1,value:e[0]},i=vW(n&&n.length===e.length?n:bW(e),t),a=yW(i,e,{ease:Array.isArray(s)?s:xW(e,s)});return{calculatedDuration:t,next:l=>(o.value=a(l),o.done=l>=t,o)}}const CW=t=>t!==null;function JE(t,{repeat:e,repeatType:n="loop"},r,s=1){const o=t.filter(CW),a=s<0||e&&n!=="loop"&&e%2===1?0:o.length-1;return!a||r===void 0?o[a]:r}const EW={decay:Yx,inertia:Yx,tween:cm,keyframes:cm,spring:vw};function dL(t){typeof t.type=="string"&&(t.type=EW[t.type])}class XE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const IW=t=>t/100;class ZE extends XE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==Or.now()&&this.tick(Or.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;dL(e);const{type:n=cm,repeat:r=0,repeatDelay:s=0,repeatType:o,velocity:i=0}=e;let{keyframes:a}=e;const l=n||cm;l!==cm&&typeof a[0]!="number"&&(this.mixKeyframes=zp(IW,lL(a[0],a[1])),a=[0,100]);const c=l({...e,keyframes:a});o==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-i})),c.calculatedDuration===null&&(c.calculatedDuration=YE(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:s,mixKeyframes:o,mirroredGenerator:i,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:h,repeatType:f,repeatDelay:g,type:y,onUpdate:w,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const C=this.currentTime-c*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?C<0:C>s;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let A=this.currentTime,N=r;if(h){const b=Math.min(this.currentTime,s)/a;let I=Math.floor(b),P=b%1;!P&&b>=1&&(P=1),P===1&&I--,I=Math.min(I,h+1),!!(I%2)&&(f==="reverse"?(P=1-P,g&&(P-=g/a)):f==="mirror"&&(N=i)),A=Ai(0,1,P)*a}const M=x?{done:!1,value:u[0]}:N.next(A);o&&(M.value=o(M.value));let{done:k}=M;!x&&l!==null&&(k=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const E=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return E&&y!==Yx&&(M.value=JE(u,this.options,v,this.speed)),w&&w(M.value),E&&this.finish(),M}then(e,n){return this.finished.then(e,n)}get duration(){return xs(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+xs(e)}get time(){return xs(this.currentTime)}set time(e){e=No(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Or.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=xs(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=aW,startTime:n}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Or.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function _W(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Bl=t=>t*180/Math.PI,Jx=t=>{const e=Bl(Math.atan2(t[1],t[0]));return Xx(e)},AW={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Jx,rotateZ:Jx,skewX:t=>Bl(Math.atan(t[1])),skewY:t=>Bl(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Xx=t=>(t=t%360,t<0&&(t+=360),t),AT=Jx,ST=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),TT=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),SW={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:ST,scaleY:TT,scale:t=>(ST(t)+TT(t))/2,rotateX:t=>Xx(Bl(Math.atan2(t[6],t[5]))),rotateY:t=>Xx(Bl(Math.atan2(-t[2],t[0]))),rotateZ:AT,rotate:AT,skewX:t=>Bl(Math.atan(t[4])),skewY:t=>Bl(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Zx(t){return t.includes("scale")?1:0}function eC(t,e){if(!t||t==="none")return Zx(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=SW,s=n;else{const a=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=AW,s=a}if(!s)return Zx(e);const o=r[e],i=s[1].split(",").map(PW);return typeof o=="function"?o(i):i[o]}const TW=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return eC(n,e)};function PW(t){return parseFloat(t.trim())}const kh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Rh=new Set(kh),PT=t=>t===Ph||t===Ze,kW=new Set(["x","y","z"]),RW=kh.filter(t=>!kW.has(t));function NW(t){const e=[];return RW.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const gc={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>eC(e,"x"),y:(t,{transform:e})=>eC(e,"y")};gc.translateX=gc.x;gc.translateY=gc.y;const yc=new Set;let tC=!1,nC=!1,rC=!1;function hL(){if(nC){const t=Array.from(yc).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const s=NW(r);s.length&&(n.set(r,s),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([o,i])=>{r.getValue(o)?.set(i)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}nC=!1,tC=!1,yc.forEach(t=>t.complete(rC)),yc.clear()}function fL(){yc.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(nC=!0)})}function DW(){rC=!0,fL(),hL(),rC=!1}class eI{constructor(e,n,r,s,o,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=s,this.element=o,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(yc.add(this),tC||(tC=!0,Yt.read(fL),Yt.resolveKeyframes(hL))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:s}=this;if(e[0]===null){const o=s?.get(),i=e[e.length-1];if(o!==void 0)e[0]=o;else if(r&&n){const a=r.readValue(n,i);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=i),s&&o===void 0&&s.set(e[0])}_W(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),yc.delete(this)}cancel(){this.state==="scheduled"&&(yc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const MW=t=>t.startsWith("--");function OW(t,e,n){MW(e)?t.style.setProperty(e,n):t.style[e]=n}const LW=UE(()=>window.ScrollTimeline!==void 0),FW={};function jW(t,e){const n=UE(t);return()=>FW[e]??n()}const mL=jW(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),jf=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,kT={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:jf([0,.65,.55,1]),circOut:jf([.55,0,1,.45]),backIn:jf([.31,.01,.66,-.59]),backOut:jf([.33,1.53,.69,.99])};function pL(t,e){if(t)return typeof t=="function"?mL()?cL(t,e):"ease-out":ZO(t)?jf(t):Array.isArray(t)?t.map(n=>pL(n,e)||kT.easeOut):kT[t]}function VW(t,e,n,{delay:r=0,duration:s=300,repeat:o=0,repeatType:i="loop",ease:a="easeOut",times:l}={},c=void 0){const u={[e]:n};l&&(u.offset=l);const h=pL(a,s);Array.isArray(h)&&(u.easing=h);const f={delay:r,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:o+1,direction:i==="reverse"?"alternate":"normal"};return c&&(f.pseudoElement=c),t.animate(u,f)}function gL(t){return typeof t=="function"&&"applyToOptions"in t}function BW({type:t,...e}){return gL(t)&&mL()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class UW extends XE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:r,keyframes:s,pseudoElement:o,allowFlatten:i=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!o,this.allowFlatten=i,this.options=e,BE(typeof e.type!="string");const c=BW(e);this.animation=VW(n,r,s,c,o),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!o){const u=JE(s,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):OW(n,r,u),this.animation.cancel()}l?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return xs(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+xs(e)}get time(){return xs(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=No(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&LW()?(this.animation.timeline=e,Cs):n(this)}}const yL={anticipate:QO,backInOut:qO,circInOut:JO};function HW(t){return t in yL}function $W(t){typeof t.ease=="string"&&HW(t.ease)&&(t.ease=yL[t.ease])}const RT=10;class zW extends UW{constructor(e){$W(e),dL(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:s,element:o,...i}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const a=new ZE({...i,autoplay:!1}),l=No(this.finishedTime??this.time);n.setWithVelocity(a.sample(l-RT).value,a.sample(l).value,RT),a.stop()}}const NT=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(za.test(t)||t==="0")&&!t.startsWith("url("));function GW(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function WW(t,e,n,r){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const o=t[t.length-1],i=NT(s,e),a=NT(o,e);return!i||!a?!1:GW(t)||(n==="spring"||gL(n))&&r}function sC(t){t.duration=0,t.type="keyframes"}const KW=new Set(["opacity","clipPath","filter","transform"]),qW=UE(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function QW(t){const{motionValue:e,name:n,repeatDelay:r,repeatType:s,damping:o,type:i}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return qW()&&n&&KW.has(n)&&(n!=="transform"||!c)&&!l&&!r&&s!=="mirror"&&o!==0&&i!=="inertia"}const YW=40;class JW extends XE{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:i="loop",keyframes:a,name:l,motionValue:c,element:u,...h}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Or.now();const f={autoplay:e,delay:n,type:r,repeat:s,repeatDelay:o,repeatType:i,name:l,motionValue:c,element:u,...h},g=u?.KeyframeResolver||eI;this.keyframeResolver=new g(a,(y,w,v)=>this.onKeyframesResolved(y,w,f,!v),l,c,u),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,n,r,s){this.keyframeResolver=void 0;const{name:o,type:i,velocity:a,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=Or.now(),WW(e,o,i,a)||((Si.instantAnimations||!l)&&u?.(JE(e,r,n)),e[0]=e[e.length-1],sC(r),r.repeat=0);const f={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>YW?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},g=!c&&QW(f)?new zW({...f,element:f.motionValue.owner.current}):new ZE(f);g.finished.then(()=>this.notifyFinished()).catch(Cs),this.pendingTimeline&&(this.stopTimeline=g.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=g}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),DW()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const XW=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function ZW(t){const e=XW.exec(t);if(!e)return[,];const[,n,r,s]=e;return[`--${n??r}`,s]}function wL(t,e,n=1){const[r,s]=ZW(t);if(!r)return;const o=window.getComputedStyle(e).getPropertyValue(r);if(o){const i=o.trim();return BO(i)?parseFloat(i):i}return WE(s)?wL(s,e,n+1):s}function tI(t,e){return t?.[e]??t?.default??t}const bL=new Set(["width","height","top","left","right","bottom",...kh]),eK={test:t=>t==="auto",parse:t=>t},vL=t=>e=>e.test(t),xL=[Ph,Ze,Do,Zi,G7,z7,eK],DT=t=>xL.find(vL(t));function tK(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||HO(t):!0}const nK=new Set(["brightness","contrast","saturate","opacity"]);function rK(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(KE)||[];if(!r)return t;const s=n.replace(r,"");let o=nK.has(e)?1:0;return r!==n&&(o*=100),e+"("+o+s+")"}const sK=/\b([a-z-]*)\(.*?\)/gu,oC={...za,getAnimatableNone:t=>{const e=t.match(sK);return e?e.map(rK).join(" "):t}},MT={...Ph,transform:Math.round},oK={rotate:Zi,rotateX:Zi,rotateY:Zi,rotateZ:Zi,scale:jg,scaleX:jg,scaleY:jg,scaleZ:jg,skew:Zi,skewX:Zi,skewY:Zi,distance:Ze,translateX:Ze,translateY:Ze,translateZ:Ze,x:Ze,y:Ze,z:Ze,perspective:Ze,transformPerspective:Ze,opacity:Fm,originX:xT,originY:xT,originZ:Ze},nI={borderWidth:Ze,borderTopWidth:Ze,borderRightWidth:Ze,borderBottomWidth:Ze,borderLeftWidth:Ze,borderRadius:Ze,radius:Ze,borderTopLeftRadius:Ze,borderTopRightRadius:Ze,borderBottomRightRadius:Ze,borderBottomLeftRadius:Ze,width:Ze,maxWidth:Ze,height:Ze,maxHeight:Ze,top:Ze,right:Ze,bottom:Ze,left:Ze,padding:Ze,paddingTop:Ze,paddingRight:Ze,paddingBottom:Ze,paddingLeft:Ze,margin:Ze,marginTop:Ze,marginRight:Ze,marginBottom:Ze,marginLeft:Ze,backgroundPositionX:Ze,backgroundPositionY:Ze,...oK,zIndex:MT,fillOpacity:Fm,strokeOpacity:Fm,numOctaves:MT},iK={...nI,color:Cn,backgroundColor:Cn,outlineColor:Cn,fill:Cn,stroke:Cn,borderColor:Cn,borderTopColor:Cn,borderRightColor:Cn,borderBottomColor:Cn,borderLeftColor:Cn,filter:oC,WebkitFilter:oC},CL=t=>iK[t];function EL(t,e){let n=CL(t);return n!==oC&&(n=za),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const aK=new Set(["auto","none","0"]);function lK(t,e,n){let r=0,s;for(;r<t.length&&!s;){const o=t[r];typeof o=="string"&&!aK.has(o)&&jm(o).values.length&&(s=t[r]),r++}if(s&&n)for(const o of e)t[o]=EL(n,s)}class cK extends eI{constructor(e,n,r,s,o){super(e,n,r,s,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),WE(c))){const u=wL(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!bL.has(r)||e.length!==2)return;const[s,o]=e,i=DT(s),a=DT(o);if(i!==a)if(PT(i)&&PT(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else gc[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let s=0;s<e.length;s++)(e[s]===null||tK(e[s]))&&r.push(s);r.length&&lK(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=gc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const s=e.getValue(n);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,i=r[o];r[o]=gc[n](e.measureViewportBox(),window.getComputedStyle(e.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([a,l])=>{e.getValue(a).set(l)}),this.resolveNoneKeyframes()}}function uK(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const s=n?.[t]??r.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const IL=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function _L(t){return UO(t)&&"offsetHeight"in t}const OT=30,dK=t=>!isNaN(parseFloat(t));class hK{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const s=Or.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Or.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=dK(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new HE);const r=this.events[e].add(n);return e==="change"?()=>{r(),Yt.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Or.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>OT)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,OT);return $O(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function oh(t,e){return new hK(t,e)}const{schedule:rI}=eL(queueMicrotask,!1),Ps={x:!1,y:!1};function AL(){return Ps.x||Ps.y}function fK(t){return t==="x"||t==="y"?Ps[t]?null:(Ps[t]=!0,()=>{Ps[t]=!1}):Ps.x||Ps.y?null:(Ps.x=Ps.y=!0,()=>{Ps.x=Ps.y=!1})}function SL(t,e){const n=uK(t),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[n,s,()=>r.abort()]}function LT(t){return!(t.pointerType==="touch"||AL())}function mK(t,e,n={}){const[r,s,o]=SL(t,n),i=a=>{if(!LT(a))return;const{target:l}=a,c=e(l,a);if(typeof c!="function"||!l)return;const u=h=>{LT(h)&&(c(h),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(a=>{a.addEventListener("pointerenter",i,s)}),o}const TL=(t,e)=>e?t===e?!0:TL(t,e.parentElement):!1,sI=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,pK=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function gK(t){return pK.has(t.tagName)||t.tabIndex!==-1}const vy=new WeakSet;function FT(t){return e=>{e.key==="Enter"&&t(e)}}function yv(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const yK=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=FT(()=>{if(vy.has(n))return;yv(n,"down");const s=FT(()=>{yv(n,"up")}),o=()=>yv(n,"cancel");n.addEventListener("keyup",s,e),n.addEventListener("blur",o,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function jT(t){return sI(t)&&!AL()}function wK(t,e,n={}){const[r,s,o]=SL(t,n),i=a=>{const l=a.currentTarget;if(!jT(a))return;vy.add(l);const c=e(l,a),u=(g,y)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),vy.has(l)&&vy.delete(l),jT(g)&&typeof c=="function"&&c(g,{success:y})},h=g=>{u(g,l===window||l===document||n.useGlobalTarget||TL(l,g.target))},f=g=>{u(g,!1)};window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",f,s)};return r.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",i,s),_L(a)&&(a.addEventListener("focus",c=>yK(c,s)),!gK(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),o}function PL(t){return UO(t)&&"ownerSVGElement"in t}function bK(t){return PL(t)&&t.tagName==="svg"}const cr=t=>!!(t&&t.getVelocity),vK=[...xL,Cn,za],xK=t=>vK.find(vL(t)),oI=p.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function VT(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function CK(...t){return e=>{let n=!1;const r=t.map(s=>{const o=VT(s,e);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let s=0;s<r.length;s++){const o=r[s];typeof o=="function"?o():VT(t[s],null)}}}}function EK(...t){return p.useCallback(CK(...t),t)}class IK extends p.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=_L(r)&&r.offsetWidth||0,o=this.props.sizeRef.current;o.height=n.offsetHeight||0,o.width=n.offsetWidth||0,o.top=n.offsetTop,o.left=n.offsetLeft,o.right=s-o.width-o.left}return null}componentDidUpdate(){}render(){return this.props.children}}function _K({children:t,isPresent:e,anchorX:n,root:r}){const s=p.useId(),o=p.useRef(null),i=p.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=p.useContext(oI),l=EK(o,t?.ref);return p.useInsertionEffect(()=>{const{width:c,height:u,top:h,left:f,right:g}=i.current;if(e||!o.current||!c||!u)return;const y=n==="left"?`left: ${f}`:`right: ${g}`;o.current.dataset.motionPopId=s;const w=document.createElement("style");a&&(w.nonce=a);const v=r??document.head;return v.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${u}px !important;
            ${y}px !important;
            top: ${h}px !important;
          }
        `),()=>{v.contains(w)&&v.removeChild(w)}},[e]),d.jsx(IK,{isPresent:e,childRef:o,sizeRef:i,children:p.cloneElement(t,{ref:l})})}const AK=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:o,mode:i,anchorX:a,root:l})=>{const c=LE(SK),u=p.useId();let h=!0,f=p.useMemo(()=>(h=!1,{id:u,initial:e,isPresent:n,custom:s,onExitComplete:g=>{c.set(g,!0);for(const y of c.values())if(!y)return;r&&r()},register:g=>(c.set(g,!1),()=>c.delete(g))}),[n,c,r]);return o&&h&&(f={...f}),p.useMemo(()=>{c.forEach((g,y)=>c.set(y,!1))},[n]),p.useEffect(()=>{!n&&!c.size&&r&&r()},[n]),i==="popLayout"&&(t=d.jsx(_K,{isPresent:n,anchorX:a,root:l,children:t})),d.jsx(Hb.Provider,{value:f,children:t})};function SK(){return new Map}function kL(t=!0){const e=p.useContext(Hb);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=e,o=p.useId();p.useEffect(()=>{if(t)return s(o)},[t]);const i=p.useCallback(()=>t&&r&&r(o),[o,r,t]);return!n&&r?[!1,i]:[!0]}const Vg=t=>t.key||"";function BT(t){const e=[];return p.Children.forEach(t,n=>{p.isValidElement(n)&&e.push(n)}),e}const RL=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:o="sync",propagate:i=!1,anchorX:a="left",root:l})=>{const[c,u]=kL(i),h=p.useMemo(()=>BT(t),[t]),f=i&&!c?[]:h.map(Vg),g=p.useRef(!0),y=p.useRef(h),w=LE(()=>new Map),[v,C]=p.useState(h),[x,A]=p.useState(h);VO(()=>{g.current=!1,y.current=h;for(let k=0;k<x.length;k++){const E=Vg(x[k]);f.includes(E)?w.delete(E):w.get(E)!==!0&&w.set(E,!1)}},[x,f.length,f.join("-")]);const N=[];if(h!==v){let k=[...h];for(let E=0;E<x.length;E++){const b=x[E],I=Vg(b);f.includes(I)||(k.splice(E,0,b),N.push(b))}return o==="wait"&&N.length&&(k=N),A(BT(k)),C(h),null}const{forceRender:M}=p.useContext(OE);return d.jsx(d.Fragment,{children:x.map(k=>{const E=Vg(k),b=i&&!c?!1:h===x||f.includes(E),I=()=>{if(w.has(E))w.set(E,!0);else return;let P=!0;w.forEach(S=>{S||(P=!1)}),P&&(M?.(),A(y.current),i&&u?.(),r&&r())};return d.jsx(AK,{isPresent:b,initial:!g.current||n?void 0:!1,custom:e,presenceAffectsLayout:s,mode:o,root:l,onExitComplete:b?void 0:I,anchorX:a,children:k},E)})})},NL=p.createContext({strict:!1}),UT={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ih={};for(const t in UT)ih[t]={isEnabled:e=>UT[t].some(n=>!!e[n])};function TK(t){for(const e in t)ih[e]={...ih[e],...t[e]}}const PK=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function xw(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||PK.has(t)}let DL=t=>!xw(t);function kK(t){typeof t=="function"&&(DL=e=>e.startsWith("on")?!xw(e):t(e))}try{kK(require("@emotion/is-prop-valid").default)}catch{}function RK(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(DL(s)||n===!0&&xw(s)||!e&&!xw(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}const $b=p.createContext({});function zb(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Vm(t){return typeof t=="string"||Array.isArray(t)}const iI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],aI=["initial",...iI];function Gb(t){return zb(t.animate)||aI.some(e=>Vm(t[e]))}function ML(t){return!!(Gb(t)||t.variants)}function NK(t,e){if(Gb(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Vm(n)?n:void 0,animate:Vm(r)?r:void 0}}return t.inherit!==!1?e:{}}function DK(t){const{initial:e,animate:n}=NK(t,p.useContext($b));return p.useMemo(()=>({initial:e,animate:n}),[HT(e),HT(n)])}function HT(t){return Array.isArray(t)?t.join(" "):t}const Bm={};function MK(t){for(const e in t)Bm[e]=t[e],GE(e)&&(Bm[e].isCSSVariable=!0)}function OL(t,{layout:e,layoutId:n}){return Rh.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Bm[t]||t==="opacity")}const OK={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},LK=kh.length;function FK(t,e,n){let r="",s=!0;for(let o=0;o<LK;o++){const i=kh[o],a=t[i];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(i.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=IL(a,nI[i]);if(!l){s=!1;const u=OK[i]||i;r+=`${u}(${c}) `}n&&(e[i]=c)}}return r=r.trim(),n?r=n(e,s?"":r):s&&(r="none"),r}function lI(t,e,n){const{style:r,vars:s,transformOrigin:o}=t;let i=!1,a=!1;for(const l in e){const c=e[l];if(Rh.has(l)){i=!0;continue}else if(GE(l)){s[l]=c;continue}else{const u=IL(c,nI[l]);l.startsWith("origin")?(a=!0,o[l]=u):r[l]=u}}if(e.transform||(i||n?r.transform=FK(e,t.transform,n):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=o;r.transformOrigin=`${l} ${c} ${u}`}}const cI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function LL(t,e,n){for(const r in e)!cr(e[r])&&!OL(r,n)&&(t[r]=e[r])}function jK({transformTemplate:t},e){return p.useMemo(()=>{const n=cI();return lI(n,e,t),Object.assign({},n.vars,n.style)},[e])}function VK(t,e){const n=t.style||{},r={};return LL(r,n,t),Object.assign(r,jK(t,e)),r}function BK(t,e){const n={},r=VK(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const UK={offset:"stroke-dashoffset",array:"stroke-dasharray"},HK={offset:"strokeDashoffset",array:"strokeDasharray"};function $K(t,e,n=1,r=0,s=!0){t.pathLength=1;const o=s?UK:HK;t[o.offset]=Ze.transform(-r);const i=Ze.transform(e),a=Ze.transform(n);t[o.array]=`${i} ${a}`}function FL(t,{attrX:e,attrY:n,attrScale:r,pathLength:s,pathSpacing:o=1,pathOffset:i=0,...a},l,c,u){if(lI(t,a,c),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:f}=t;h.transform&&(f.transform=h.transform,delete h.transform),(f.transform||h.transformOrigin)&&(f.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),f.transform&&(f.transformBox=u?.transformBox??"fill-box",delete h.transformBox),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),r!==void 0&&(h.scale=r),s!==void 0&&$K(h,s,o,i,!1)}const jL=()=>({...cI(),attrs:{}}),VL=t=>typeof t=="string"&&t.toLowerCase()==="svg";function zK(t,e,n,r){const s=p.useMemo(()=>{const o=jL();return FL(o,e,VL(r),t.transformTemplate,t.style),{...o.attrs,style:{...o.style}}},[e]);if(t.style){const o={};LL(o,t.style,t),s.style={...o,...s.style}}return s}const GK=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function uI(t){return typeof t!="string"||t.includes("-")?!1:!!(GK.indexOf(t)>-1||/[A-Z]/u.test(t))}function WK(t,e,n,{latestValues:r},s,o=!1){const a=(uI(t)?zK:BK)(e,r,s,t),l=RK(e,typeof t=="string",o),c=t!==p.Fragment?{...l,...a,ref:n}:{},{children:u}=e,h=p.useMemo(()=>cr(u)?u.get():u,[u]);return p.createElement(t,{...c,children:h})}function $T(t){const e=[{},{}];return t?.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function dI(t,e,n,r){if(typeof e=="function"){const[s,o]=$T(r);e=e(n!==void 0?n:t.custom,s,o)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,o]=$T(r);e=e(n!==void 0?n:t.custom,s,o)}return e}function xy(t){return cr(t)?t.get():t}function KK({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,s){return{latestValues:qK(n,r,s,t),renderState:e()}}function qK(t,e,n,r){const s={},o=r(t,{});for(const f in o)s[f]=xy(o[f]);let{initial:i,animate:a}=t;const l=Gb(t),c=ML(t);e&&c&&!l&&t.inherit!==!1&&(i===void 0&&(i=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||i===!1;const h=u?a:i;if(h&&typeof h!="boolean"&&!zb(h)){const f=Array.isArray(h)?h:[h];for(let g=0;g<f.length;g++){const y=dI(t,f[g]);if(y){const{transitionEnd:w,transition:v,...C}=y;for(const x in C){let A=C[x];if(Array.isArray(A)){const N=u?A.length-1:0;A=A[N]}A!==null&&(s[x]=A)}for(const x in w)s[x]=w[x]}}}return s}const BL=t=>(e,n)=>{const r=p.useContext($b),s=p.useContext(Hb),o=()=>KK(t,e,r,s);return n?o():LE(o)};function hI(t,e,n){const{style:r}=t,s={};for(const o in r)(cr(r[o])||e.style&&cr(e.style[o])||OL(o,t)||n?.getValue(o)?.liveStyle!==void 0)&&(s[o]=r[o]);return s}const QK=BL({scrapeMotionValuesFromProps:hI,createRenderState:cI});function UL(t,e,n){const r=hI(t,e,n);for(const s in t)if(cr(t[s])||cr(e[s])){const o=kh.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[o]=t[s]}return r}const YK=BL({scrapeMotionValuesFromProps:UL,createRenderState:jL}),JK=Symbol.for("motionComponentSymbol");function Du(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function XK(t,e,n){return p.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Du(n)&&(n.current=r))},[e])}const fI=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),ZK="framerAppearId",HL="data-"+fI(ZK),$L=p.createContext({});function eq(t,e,n,r,s){const{visualElement:o}=p.useContext($b),i=p.useContext(NL),a=p.useContext(Hb),l=p.useContext(oI).reducedMotion,c=p.useRef(null);r=r||i.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:o,props:n,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,h=p.useContext($L);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&tq(c.current,n,s,h);const f=p.useRef(!1);p.useInsertionEffect(()=>{u&&f.current&&u.update(n,a)});const g=n[HL],y=p.useRef(!!g&&!window.MotionHandoffIsComplete?.(g)&&window.MotionHasOptimisedAnimation?.(g));return VO(()=>{u&&(f.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),y.current&&u.animationState&&u.animationState.animateChanges())}),p.useEffect(()=>{u&&(!y.current&&u.animationState&&u.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(g)}),y.current=!1),u.enteringChildren=void 0)}),u}function tq(t,e,n,r){const{layoutId:s,layout:o,drag:i,dragConstraints:a,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:zL(t.parent)),t.projection.setOptions({layoutId:s,layout:o,alwaysMeasureLayout:!!i||a&&Du(a),visualElement:t,animationType:typeof o=="string"?o:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function zL(t){if(t)return t.options.allowProjection!==!1?t.projection:zL(t.parent)}function wv(t,{forwardMotionProps:e=!1}={},n,r){n&&TK(n);const s=uI(t)?YK:QK;function o(a,l){let c;const u={...p.useContext(oI),...a,layoutId:nq(a)},{isStatic:h}=u,f=DK(a),g=s(a,h);if(!h&&FE){rq();const y=sq(u);c=y.MeasureLayout,f.visualElement=eq(t,g,u,r,y.ProjectionNode)}return d.jsxs($b.Provider,{value:f,children:[c&&f.visualElement?d.jsx(c,{visualElement:f.visualElement,...u}):null,WK(t,a,XK(g,f.visualElement,l),g,h,e)]})}o.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const i=p.forwardRef(o);return i[JK]=t,i}function nq({layoutId:t}){const e=p.useContext(OE).id;return e&&t!==void 0?e+"-"+t:t}function rq(t,e){p.useContext(NL).strict}function sq(t){const{drag:e,layout:n}=ih;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function oq(t,e){if(typeof Proxy>"u")return wv;const n=new Map,r=(o,i)=>wv(o,i,t,e),s=(o,i)=>r(o,i);return new Proxy(s,{get:(o,i)=>i==="create"?r:(n.has(i)||n.set(i,wv(i,void 0,t,e)),n.get(i))})}function GL({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function iq({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function aq(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function bv(t){return t===void 0||t===1}function iC({scale:t,scaleX:e,scaleY:n}){return!bv(t)||!bv(e)||!bv(n)}function Al(t){return iC(t)||WL(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function WL(t){return zT(t.x)||zT(t.y)}function zT(t){return t&&t!=="0%"}function Cw(t,e,n){const r=t-n,s=e*r;return n+s}function GT(t,e,n,r,s){return s!==void 0&&(t=Cw(t,s,r)),Cw(t,n,r)+e}function aC(t,e=0,n=1,r,s){t.min=GT(t.min,e,n,r,s),t.max=GT(t.max,e,n,r,s)}function KL(t,{x:e,y:n}){aC(t.x,e.translate,e.scale,e.originPoint),aC(t.y,n.translate,n.scale,n.originPoint)}const WT=.999999999999,KT=1.0000000000001;function lq(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let o,i;for(let a=0;a<s;a++){o=n[a],i=o.projectionDelta;const{visualElement:l}=o.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&Ou(t,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),i&&(e.x*=i.x.scale,e.y*=i.y.scale,KL(t,i)),r&&Al(o.latestValues)&&Ou(t,o.latestValues))}e.x<KT&&e.x>WT&&(e.x=1),e.y<KT&&e.y>WT&&(e.y=1)}function Mu(t,e){t.min=t.min+e,t.max=t.max+e}function qT(t,e,n,r,s=.5){const o=en(t.min,t.max,s);aC(t,e,n,o,r)}function Ou(t,e){qT(t.x,e.x,e.scaleX,e.scale,e.originX),qT(t.y,e.y,e.scaleY,e.scale,e.originY)}function qL(t,e){return GL(aq(t.getBoundingClientRect(),e))}function cq(t,e,n){const r=qL(t,n),{scroll:s}=e;return s&&(Mu(r.x,s.offset.x),Mu(r.y,s.offset.y)),r}const QT=()=>({translate:0,scale:1,origin:0,originPoint:0}),Lu=()=>({x:QT(),y:QT()}),YT=()=>({min:0,max:0}),dn=()=>({x:YT(),y:YT()}),lC={current:null},QL={current:!1};function uq(){if(QL.current=!0,!!FE)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>lC.current=t.matches;t.addEventListener("change",e),e()}else lC.current=!1}const dq=new WeakMap;function hq(t,e,n){for(const r in e){const s=e[r],o=n[r];if(cr(s))t.addValue(r,s);else if(cr(o))t.addValue(r,oh(s,{owner:t}));else if(o!==s)if(t.hasValue(r)){const i=t.getValue(r);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=t.getStaticValue(r);t.addValue(r,oh(i!==void 0?i:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const JT=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class fq{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:o,visualState:i},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=eI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Or.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,Yt.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=Gb(n),this.isVariantNode=ML(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in h){const g=h[f];l[f]!==void 0&&cr(g)&&g.set(l[f])}}mount(e){this.current=e,dq.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),QL.current||uq(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:lC.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),$a(this.notifyUpdate),$a(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Rh.has(e);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",i=>{this.latestValues[e]=i,this.props.onUpdate&&Yt.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{s(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in ih){const n=ih[e];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):dn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<JT.length;r++){const s=JT[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const o="on"+s,i=e[o];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=hq(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=oh(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(BO(r)||HO(r))?r=parseFloat(r):!xK(r)&&za.test(n)&&(r=EL(e,n)),this.setBaseTarget(e,cr(r)?r.get():r)),cr(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const o=dI(this.props,n,this.presenceContext?.custom);o&&(r=o[e])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!cr(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new HE),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){rI.render(this.render)}}class YL extends fq{constructor(){super(...arguments),this.KeyframeResolver=cK}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;cr(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function JL(t,{style:e,vars:n},r,s){const o=t.style;let i;for(i in e)o[i]=e[i];s?.applyProjectionStyles(o,r);for(i in n)o.setProperty(i,n[i])}function mq(t){return window.getComputedStyle(t)}class pq extends YL{constructor(){super(...arguments),this.type="html",this.renderInstance=JL}readValueFromInstance(e,n){if(Rh.has(n))return this.projection?.isProjecting?Zx(n):TW(e,n);{const r=mq(e),s=(GE(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return qL(e,n)}build(e,n,r){lI(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return hI(e,n,r)}}const XL=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function gq(t,e,n,r){JL(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(XL.has(s)?s:fI(s),e.attrs[s])}class yq extends YL{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=dn}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Rh.has(n)){const r=CL(n);return r&&r.default||0}return n=XL.has(n)?n:fI(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return UL(e,n,r)}build(e,n,r){FL(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,s){gq(e,n,r,s)}mount(e){this.isSVGTag=VL(e.tagName),super.mount(e)}}const wq=(t,e)=>uI(t)?new yq(e):new pq(e,{allowProjection:t!==p.Fragment});function Qu(t,e,n){const r=t.getProps();return dI(r,e,n!==void 0?n:r.custom,t)}const cC=t=>Array.isArray(t);function bq(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,oh(n))}function vq(t){return cC(t)?t[t.length-1]||0:t}function xq(t,e){const n=Qu(t,e);let{transitionEnd:r={},transition:s={},...o}=n||{};o={...o,...r};for(const i in o){const a=vq(o[i]);bq(t,i,a)}}function Cq(t){return!!(cr(t)&&t.add)}function uC(t,e){const n=t.getValue("willChange");if(Cq(n))return n.add(e);if(!n&&Si.WillChange){const r=new Si.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function ZL(t){return t.props[HL]}const Eq=t=>t!==null;function Iq(t,{repeat:e,repeatType:n="loop"},r){const s=t.filter(Eq),o=e&&n!=="loop"&&e%2===1?0:s.length-1;return s[o]}const _q={type:"spring",stiffness:500,damping:25,restSpeed:10},Aq=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Sq={type:"keyframes",duration:.8},Tq={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Pq=(t,{keyframes:e})=>e.length>2?Sq:Rh.has(t)?t.startsWith("scale")?Aq(e[1]):_q:Tq;function kq({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:o,repeatType:i,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const mI=(t,e,n,r={},s,o)=>i=>{const a=tI(r,t)||{},l=a.delay||r.delay||0;let{elapsed:c=0}=r;c=c-No(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:f=>{e.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{i(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:o?void 0:s};kq(a)||Object.assign(u,Pq(t,u)),u.duration&&(u.duration=No(u.duration)),u.repeatDelay&&(u.repeatDelay=No(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(sC(u),u.delay===0&&(h=!0)),(Si.instantAnimations||Si.skipAnimations)&&(h=!0,sC(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,h&&!o&&e.get()!==void 0){const f=Iq(u.keyframes,a);if(f!==void 0){Yt.update(()=>{u.onUpdate(f),u.onComplete()});return}}return a.isSync?new ZE(u):new JW(u)};function Rq({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function eF(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:o=t.getDefaultTransition(),transitionEnd:i,...a}=e;r&&(o=r);const l=[],c=s&&t.animationState&&t.animationState.getState()[s];for(const u in a){const h=t.getValue(u,t.latestValues[u]??null),f=a[u];if(f===void 0||c&&Rq(c,u))continue;const g={delay:n,...tI(o||{},u)},y=h.get();if(y!==void 0&&!h.isAnimating&&!Array.isArray(f)&&f===y&&!g.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const C=ZL(t);if(C){const x=window.MotionHandoffAnimation(C,u,Yt);x!==null&&(g.startTime=x,w=!0)}}uC(t,u),h.start(mI(u,h,f,t.shouldReduceMotion&&bL.has(u)?{type:!1}:g,t,w));const v=h.animation;v&&l.push(v)}return i&&Promise.all(l).then(()=>{Yt.update(()=>{i&&xq(t,i)})}),l}function tF(t,e,n,r=0,s=1){const o=Array.from(t).sort((c,u)=>c.sortNodePosition(u)).indexOf(e),i=t.size,a=(i-1)*r;return typeof n=="function"?n(o,i):s===1?o*r:a-o*r}function dC(t,e,n={}){const r=Qu(t,e,n.type==="exit"?t.presenceContext?.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const o=r?()=>Promise.all(eF(t,r,n)):()=>Promise.resolve(),i=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:h}=s;return Nq(t,e,l,c,u,h,n)}:()=>Promise.resolve(),{when:a}=s;if(a){const[l,c]=a==="beforeChildren"?[o,i]:[i,o];return l().then(()=>c())}else return Promise.all([o(),i(n.delay)])}function Nq(t,e,n=0,r=0,s=0,o=1,i){const a=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),a.push(dC(l,e,{...i,delay:n+(typeof r=="function"?0:r)+tF(t.variantChildren,l,r,s,o)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(a)}function Dq(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(o=>dC(t,o,n));r=Promise.all(s)}else if(typeof e=="string")r=dC(t,e,n);else{const s=typeof e=="function"?Qu(t,e,n.custom):e;r=Promise.all(eF(t,s,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}function nF(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const Mq=aI.length;function rF(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?rF(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<Mq;n++){const r=aI[n],s=t.props[r];(Vm(s)||s===!1)&&(e[r]=s)}return e}const Oq=[...iI].reverse(),Lq=iI.length;function Fq(t){return e=>Promise.all(e.map(({animation:n,options:r})=>Dq(t,n,r)))}function jq(t){let e=Fq(t),n=XT(),r=!0;const s=l=>(c,u)=>{const h=Qu(t,u,l==="exit"?t.presenceContext?.custom:void 0);if(h){const{transition:f,transitionEnd:g,...y}=h;c={...c,...y,...g}}return c};function o(l){e=l(t)}function i(l){const{props:c}=t,u=rF(t.parent)||{},h=[],f=new Set;let g={},y=1/0;for(let v=0;v<Lq;v++){const C=Oq[v],x=n[C],A=c[C]!==void 0?c[C]:u[C],N=Vm(A),M=C===l?x.isActive:null;M===!1&&(y=v);let k=A===u[C]&&A!==c[C]&&N;if(k&&r&&t.manuallyAnimateOnMount&&(k=!1),x.protectedKeys={...g},!x.isActive&&M===null||!A&&!x.prevProp||zb(A)||typeof A=="boolean")continue;const E=Vq(x.prevProp,A);let b=E||C===l&&x.isActive&&!k&&N||v>y&&N,I=!1;const P=Array.isArray(A)?A:[A];let S=P.reduce(s(C),{});M===!1&&(S={});const{prevResolvedValues:D={}}=x,T={...D,...S},j=U=>{b=!0,f.has(U)&&(I=!0,f.delete(U)),x.needsAnimating[U]=!0;const F=t.getValue(U);F&&(F.liveStyle=!1)};for(const U in T){const F=S[U],$=D[U];if(g.hasOwnProperty(U))continue;let W=!1;cC(F)&&cC($)?W=!nF(F,$):W=F!==$,W?F!=null?j(U):f.add(U):F!==void 0&&f.has(U)?j(U):x.protectedKeys[U]=!0}x.prevProp=A,x.prevResolvedValues=S,x.isActive&&(g={...g,...S}),r&&t.blockInitialAnimation&&(b=!1);const R=k&&E;b&&(!R||I)&&h.push(...P.map(U=>{const F={type:C};if(typeof U=="string"&&r&&!R&&t.manuallyAnimateOnMount&&t.parent){const{parent:$}=t,W=Qu($,U);if($.enteringChildren&&W){const{delayChildren:Z}=W.transition||{};F.delay=tF($.enteringChildren,t,Z)}}return{animation:U,options:F}}))}if(f.size){const v={};if(typeof c.initial!="boolean"){const C=Qu(t,Array.isArray(c.initial)?c.initial[0]:c.initial);C&&C.transition&&(v.transition=C.transition)}f.forEach(C=>{const x=t.getBaseTarget(C),A=t.getValue(C);A&&(A.liveStyle=!0),v[C]=x??null}),h.push({animation:v})}let w=!!h.length;return r&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(h):Promise.resolve()}function a(l,c){if(n[l].isActive===c)return Promise.resolve();t.variantChildren?.forEach(h=>h.animationState?.setActive(l,c)),n[l].isActive=c;const u=i(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:i,setActive:a,setAnimateFunction:o,getState:()=>n,reset:()=>{n=XT()}}}function Vq(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!nF(e,t):!1}function yl(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function XT(){return{animate:yl(!0),whileInView:yl(),whileHover:yl(),whileTap:yl(),whileDrag:yl(),whileFocus:yl(),exit:yl()}}class sl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Bq extends sl{constructor(e){super(e),e.animationState||(e.animationState=jq(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();zb(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let Uq=0;class Hq extends sl{constructor(){super(...arguments),this.id=Uq++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const $q={animation:{Feature:Bq},exit:{Feature:Hq}};function Um(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function Kp(t){return{point:{x:t.pageX,y:t.pageY}}}const zq=t=>e=>sI(e)&&t(e,Kp(e));function um(t,e,n,r){return Um(t,e,zq(n),r)}const sF=1e-4,Gq=1-sF,Wq=1+sF,oF=.01,Kq=0-oF,qq=0+oF;function br(t){return t.max-t.min}function Qq(t,e,n){return Math.abs(t-e)<=n}function ZT(t,e,n,r=.5){t.origin=r,t.originPoint=en(e.min,e.max,t.origin),t.scale=br(n)/br(e),t.translate=en(n.min,n.max,t.origin)-t.originPoint,(t.scale>=Gq&&t.scale<=Wq||isNaN(t.scale))&&(t.scale=1),(t.translate>=Kq&&t.translate<=qq||isNaN(t.translate))&&(t.translate=0)}function dm(t,e,n,r){ZT(t.x,e.x,n.x,r?r.originX:void 0),ZT(t.y,e.y,n.y,r?r.originY:void 0)}function eP(t,e,n){t.min=n.min+e.min,t.max=t.min+br(e)}function Yq(t,e,n){eP(t.x,e.x,n.x),eP(t.y,e.y,n.y)}function tP(t,e,n){t.min=e.min-n.min,t.max=t.min+br(e)}function hm(t,e,n){tP(t.x,e.x,n.x),tP(t.y,e.y,n.y)}function as(t){return[t("x"),t("y")]}const iF=({current:t})=>t?t.ownerDocument.defaultView:null,nP=(t,e)=>Math.abs(t-e);function Jq(t,e){const n=nP(t.x,e.x),r=nP(t.y,e.y);return Math.sqrt(n**2+r**2)}class aF{constructor(e,n,{transformPagePoint:r,contextWindow:s=window,dragSnapToOrigin:o=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=xv(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,y=Jq(f.offset,{x:0,y:0})>=this.distanceThreshold;if(!g&&!y)return;const{point:w}=f,{timestamp:v}=zn;this.history.push({...w,timestamp:v});const{onStart:C,onMove:x}=this.handlers;g||(C&&C(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,f)},this.handlePointerMove=(f,g)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=vv(g,this.transformPagePoint),Yt.update(this.updatePoint,!0)},this.handlePointerUp=(f,g)=>{this.end();const{onEnd:y,onSessionEnd:w,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=xv(f.type==="pointercancel"?this.lastMoveEventInfo:vv(g,this.transformPagePoint),this.history);this.startEvent&&y&&y(f,C),w&&w(f,C)},!sI(e))return;this.dragSnapToOrigin=o,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=i,this.contextWindow=s||window;const a=Kp(e),l=vv(a,this.transformPagePoint),{point:c}=l,{timestamp:u}=zn;this.history=[{...c,timestamp:u}];const{onSessionStart:h}=n;h&&h(e,xv(l,this.history)),this.removeListeners=zp(um(this.contextWindow,"pointermove",this.handlePointerMove),um(this.contextWindow,"pointerup",this.handlePointerUp),um(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),$a(this.updatePoint)}}function vv(t,e){return e?{point:e(t.point)}:t}function rP(t,e){return{x:t.x-e.x,y:t.y-e.y}}function xv({point:t},e){return{point:t,delta:rP(t,lF(e)),offset:rP(t,Xq(e)),velocity:Zq(e,.1)}}function Xq(t){return t[0]}function lF(t){return t[t.length-1]}function Zq(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=lF(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>No(e)));)n--;if(!r)return{x:0,y:0};const o=xs(s.timestamp-r.timestamp);if(o===0)return{x:0,y:0};const i={x:(s.x-r.x)/o,y:(s.y-r.y)/o};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function eQ(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?en(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?en(n,t,r.max):Math.min(t,n)),t}function sP(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function tQ(t,{top:e,left:n,bottom:r,right:s}){return{x:sP(t.x,n,s),y:sP(t.y,e,r)}}function oP(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function nQ(t,e){return{x:oP(t.x,e.x),y:oP(t.y,e.y)}}function rQ(t,e){let n=.5;const r=br(t),s=br(e);return s>r?n=Lm(e.min,e.max-r,t.min):r>s&&(n=Lm(t.min,t.max-s,e.min)),Ai(0,1,n)}function sQ(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const hC=.35;function oQ(t=hC){return t===!1?t=0:t===!0&&(t=hC),{x:iP(t,"left","right"),y:iP(t,"top","bottom")}}function iP(t,e,n){return{min:aP(t,e),max:aP(t,n)}}function aP(t,e){return typeof t=="number"?t:t[e]||0}const iQ=new WeakMap;class aQ{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=dn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const o=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Kp(h).point)},i=(h,f)=>{const{drag:g,dragPropagation:y,onDragStart:w}=this.getProps();if(g&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=fK(g),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),as(C=>{let x=this.getAxisMotionValue(C).get()||0;if(Do.test(x)){const{projection:A}=this.visualElement;if(A&&A.layout){const N=A.layout.layoutBox[C];N&&(x=br(N)*(parseFloat(x)/100))}}this.originPoint[C]=x}),w&&Yt.postRender(()=>w(h,f)),uC(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f;const{dragPropagation:g,dragDirectionLock:y,onDirectionLock:w,onDrag:v}=this.getProps();if(!g&&!this.openDragLock)return;const{offset:C}=f;if(y&&this.currentDirection===null){this.currentDirection=lQ(C),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",f.point,C),this.updateAxis("y",f.point,C),this.visualElement.render(),v&&v(h,f)},l=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f,this.stop(h,f),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>as(h=>this.getAnimationState(h)==="paused"&&this.getAxisMotionValue(h).animation?.play()),{dragSnapToOrigin:u}=this.getProps();this.panSession=new aF(e,{onSessionStart:o,onStart:i,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:r,contextWindow:iF(this.visualElement)})}stop(e,n){const r=e||this.latestPointerEvent,s=n||this.latestPanInfo,o=this.isDragging;if(this.cancel(),!o||!s||!r)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:a}=this.getProps();a&&Yt.postRender(()=>a(r,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!Bg(e,s,this.currentDirection))return;const o=this.getAxisMotionValue(e);let i=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(i=eQ(i,this.constraints[e],this.elastic[e])),o.set(i)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;e&&Du(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=tQ(r.layoutBox,e):this.constraints=!1,this.elastic=oQ(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&as(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=sQ(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Du(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const o=cq(r,s.root,this.visualElement.getTransformPagePoint());let i=nQ(s.layout.layoutBox,o);if(n){const a=n(iq(i));this.hasMutatedConstraints=!!a,a&&(i=GL(a))}return i}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:o,dragSnapToOrigin:i,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=as(u=>{if(!Bg(u,n,this.currentDirection))return;let h=l&&l[u]||{};i&&(h={min:0,max:0});const f=s?200:1e6,g=s?40:1e7,y={type:"inertia",velocity:r?e[u]:0,bounceStiffness:f,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...o,...h};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return uC(this.visualElement,e),r.start(mI(e,r,0,n,this.visualElement,!1))}stopAnimation(){as(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){as(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){as(n=>{const{drag:r}=this.getProps();if(!Bg(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,o=this.getAxisMotionValue(n);if(s&&s.layout){const{min:i,max:a}=s.layout.layoutBox[n];o.set(e[n]-en(i,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Du(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};as(i=>{const a=this.getAxisMotionValue(i);if(a&&this.constraints!==!1){const l=a.get();s[i]=rQ({min:l,max:l},this.constraints[i])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),as(i=>{if(!Bg(i,e,null))return;const a=this.getAxisMotionValue(i),{min:l,max:c}=this.constraints[i];a.set(en(l,c,s[i]))})}addListeners(){if(!this.visualElement.current)return;iQ.set(this.visualElement,this);const e=this.visualElement.current,n=um(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Du(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,o=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Yt.read(r);const i=Um(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(as(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())}));return()=>{i(),n(),o(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:o=!1,dragElastic:i=hC,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:o,dragElastic:i,dragMomentum:a}}}function Bg(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function lQ(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class cQ extends sl{constructor(e){super(e),this.removeGroupControls=Cs,this.removeListeners=Cs,this.controls=new aQ(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Cs}unmount(){this.removeGroupControls(),this.removeListeners()}}const lP=t=>(e,n)=>{t&&Yt.postRender(()=>t(e,n))};class uQ extends sl{constructor(){super(...arguments),this.removePointerDownListener=Cs}onPointerDown(e){this.session=new aF(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:iF(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:lP(e),onStart:lP(n),onMove:r,onEnd:(o,i)=>{delete this.session,s&&Yt.postRender(()=>s(o,i))}}}mount(){this.removePointerDownListener=um(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Cy={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function cP(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const hf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ze.test(t))t=parseFloat(t);else return t;const n=cP(t,e.target.x),r=cP(t,e.target.y);return`${n}% ${r}%`}},dQ={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=za.parse(t);if(s.length>5)return r;const o=za.createTransformer(t),i=typeof s[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;s[0+i]/=a,s[1+i]/=l;const c=en(a,l,.5);return typeof s[2+i]=="number"&&(s[2+i]/=c),typeof s[3+i]=="number"&&(s[3+i]/=c),o(s)}};let Cv=!1;class hQ extends p.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:o}=e;MK(fQ),o&&(n.group&&n.group.add(o),r&&r.register&&s&&r.register(o),Cv&&o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),Cy.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:o}=this.props,{projection:i}=r;return i&&(i.isPresent=o,Cv=!0,s||e.layoutDependency!==n||n===void 0||e.isPresent!==o?i.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?i.promote():i.relegate()||Yt.postRender(()=>{const a=i.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),rI.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;Cv=!0,s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function cF(t){const[e,n]=kL(),r=p.useContext(OE);return d.jsx(hQ,{...t,layoutGroup:r,switchLayoutGroup:p.useContext($L),isPresent:e,safeToRemove:n})}const fQ={borderRadius:{...hf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:hf,borderTopRightRadius:hf,borderBottomLeftRadius:hf,borderBottomRightRadius:hf,boxShadow:dQ};function mQ(t,e,n){const r=cr(t)?t:oh(t);return r.start(mI("",r,e,n)),r.animation}const pQ=(t,e)=>t.depth-e.depth;class gQ{constructor(){this.children=[],this.isDirty=!1}add(e){jE(this.children,e),this.isDirty=!0}remove(e){VE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(pQ),this.isDirty=!1,this.children.forEach(e)}}function yQ(t,e){const n=Or.now(),r=({timestamp:s})=>{const o=s-n;o>=e&&($a(r),t(o-e))};return Yt.setup(r,!0),()=>$a(r)}const uF=["TopLeft","TopRight","BottomLeft","BottomRight"],wQ=uF.length,uP=t=>typeof t=="string"?parseFloat(t):t,dP=t=>typeof t=="number"||Ze.test(t);function bQ(t,e,n,r,s,o){s?(t.opacity=en(0,n.opacity??1,vQ(r)),t.opacityExit=en(e.opacity??1,0,xQ(r))):o&&(t.opacity=en(e.opacity??1,n.opacity??1,r));for(let i=0;i<wQ;i++){const a=`border${uF[i]}Radius`;let l=hP(e,a),c=hP(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||dP(l)===dP(c)?(t[a]=Math.max(en(uP(l),uP(c),r),0),(Do.test(c)||Do.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=en(e.rotate||0,n.rotate||0,r))}function hP(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const vQ=dF(0,.5,YO),xQ=dF(.5,.95,Cs);function dF(t,e,n){return r=>r<t?0:r>e?1:n(Lm(t,e,r))}function fP(t,e){t.min=e.min,t.max=e.max}function rs(t,e){fP(t.x,e.x),fP(t.y,e.y)}function mP(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function pP(t,e,n,r,s){return t-=e,t=Cw(t,1/n,r),s!==void 0&&(t=Cw(t,1/s,r)),t}function CQ(t,e=0,n=1,r=.5,s,o=t,i=t){if(Do.test(e)&&(e=parseFloat(e),e=en(i.min,i.max,e/100)-i.min),typeof e!="number")return;let a=en(o.min,o.max,r);t===o&&(a-=e),t.min=pP(t.min,e,n,a,s),t.max=pP(t.max,e,n,a,s)}function gP(t,e,[n,r,s],o,i){CQ(t,e[n],e[r],e[s],e.scale,o,i)}const EQ=["x","scaleX","originX"],IQ=["y","scaleY","originY"];function yP(t,e,n,r){gP(t.x,e,EQ,n?n.x:void 0,r?r.x:void 0),gP(t.y,e,IQ,n?n.y:void 0,r?r.y:void 0)}function wP(t){return t.translate===0&&t.scale===1}function hF(t){return wP(t.x)&&wP(t.y)}function bP(t,e){return t.min===e.min&&t.max===e.max}function _Q(t,e){return bP(t.x,e.x)&&bP(t.y,e.y)}function vP(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function fF(t,e){return vP(t.x,e.x)&&vP(t.y,e.y)}function xP(t){return br(t.x)/br(t.y)}function CP(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class AQ{constructor(){this.members=[]}add(e){jE(this.members,e),e.scheduleRender()}remove(e){if(VE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const o=this.members[s];if(o.isPresent!==!1){r=o;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function SQ(t,e,n){let r="";const s=t.x.translate/e.x,o=t.y.translate/e.y,i=n?.z||0;if((s||o||i)&&(r=`translate3d(${s}px, ${o}px, ${i}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:f,skewX:g,skewY:y}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),h&&(r+=`rotateX(${h}deg) `),f&&(r+=`rotateY(${f}deg) `),g&&(r+=`skewX(${g}deg) `),y&&(r+=`skewY(${y}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}const Ev=["","X","Y","Z"],TQ=1e3;let PQ=0;function Iv(t,e,n,r){const{latestValues:s}=e;s[t]&&(n[t]=s[t],e.setStaticValue(t,0),r&&(r[t]=0))}function mF(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=ZL(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:o}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Yt,!(s||o))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&mF(r)}function pF({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(i={},a=e?.()){this.id=PQ++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(NQ),this.nodes.forEach(LQ),this.nodes.forEach(FQ),this.nodes.forEach(DQ)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new gQ)}addEventListener(i,a){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new HE),this.eventHandlers.get(i).add(a)}notifyListeners(i,...a){const l=this.eventHandlers.get(i);l&&l.notify(...a)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=PL(i)&&!bK(i),this.instance=i;const{layoutId:a,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),t){let u,h=0;const f=()=>this.root.updateBlockedByResize=!1;Yt.read(()=>{h=window.innerWidth}),t(i,()=>{const g=window.innerWidth;g!==h&&(h=g,this.root.updateBlockedByResize=!0,u&&u(),u=yQ(f,250),Cy.hasAnimatedSinceResize&&(Cy.hasAnimatedSinceResize=!1,this.nodes.forEach(_P)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&c&&(a||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:f,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||c.getDefaultTransition()||HQ,{onLayoutAnimationStart:w,onLayoutAnimationComplete:v}=c.getProps(),C=!this.targetLayout||!fF(this.targetLayout,g),x=!h&&f;if(this.options.layoutRoot||this.resumeFrom||x||h&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const A={...tI(y,"layout"),onPlay:w,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(A.delay=0,A.type=!1),this.startAnimation(A),this.setAnimationOrigin(u,x)}else h||_P(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),$a(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(jQ),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&mF(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(EP);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(IP);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(OQ),this.nodes.forEach(kQ),this.nodes.forEach(RQ)):this.nodes.forEach(IP),this.clearAllSnapshots();const a=Or.now();zn.delta=Ai(0,1e3/60,a-zn.timestamp),zn.timestamp=a,zn.isProcessing=!0,hv.update.process(zn),hv.preRender.process(zn),hv.render.process(zn),zn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,rI.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(MQ),this.sharedNodes.forEach(VQ)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Yt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Yt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!br(this.snapshot.measuredBox.x)&&!br(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=dn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(a=!1),a&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!hF(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;i&&this.instance&&(a||Al(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return i&&(l=this.removeTransform(l)),$Q(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return dn();const a=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(zQ))){const{scroll:c}=this.root;c&&(Mu(a.x,c.offset.x),Mu(a.y,c.offset.y))}return a}removeElementScroll(i){const a=dn();if(rs(a,i),this.scroll?.wasRoot)return a;for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:h}=c;c!==this.root&&u&&h.layoutScroll&&(u.wasRoot&&rs(a,i),Mu(a.x,u.offset.x),Mu(a.y,u.offset.y))}return a}applyTransform(i,a=!1){const l=dn();rs(l,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Ou(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Al(u.latestValues)&&Ou(l,u.latestValues)}return Al(this.latestValues)&&Ou(l,this.latestValues),l}removeTransform(i){const a=dn();rs(a,i);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Al(c.latestValues))continue;iC(c.latestValues)&&c.updateSnapshot();const u=dn(),h=c.measurePageBox();rs(u,h),yP(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Al(this.latestValues)&&yP(a,this.latestValues),a}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==zn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(i||l&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:h}=this.options;if(!(!this.layout||!(u||h))){if(this.resolvedRelativeTargetAt=zn.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dn(),this.relativeTargetOrigin=dn(),hm(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),rs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=dn(),this.targetWithTransforms=dn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Yq(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):rs(this.target,this.layout.layoutBox),KL(this.target,this.targetDelta)):rs(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dn(),this.relativeTargetOrigin=dn(),hm(this.relativeTargetOrigin,this.target,f.target),rs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||iC(this.parent.latestValues)||WL(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const i=this.getLead(),a=!!this.resumingFrom||this!==i;let l=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===zn.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;rs(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;lq(this.layoutCorrected,this.treeScale,this.path,a),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=dn());const{target:g}=i;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(mP(this.prevProjectionDelta.x,this.projectionDelta.x),mP(this.prevProjectionDelta.y,this.projectionDelta.y)),dm(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!CP(this.projectionDelta.x,this.prevProjectionDelta.x)||!CP(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Lu(),this.projectionDelta=Lu(),this.projectionDeltaWithTransform=Lu()}setAnimationOrigin(i,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=Lu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const f=dn(),g=l?l.source:void 0,y=this.layout?this.layout.source:void 0,w=g!==y,v=this.getStack(),C=!v||v.members.length<=1,x=!!(w&&!C&&this.options.crossfade===!0&&!this.path.some(UQ));this.animationProgress=0;let A;this.mixTargetDelta=N=>{const M=N/1e3;AP(h.x,i.x,M),AP(h.y,i.y,M),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(hm(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),BQ(this.relativeTarget,this.relativeTargetOrigin,f,M),A&&_Q(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=dn()),rs(A,this.relativeTarget)),w&&(this.animationValues=u,bQ(u,c,this.latestValues,M,x,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=M},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&($a(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Yt.update(()=>{Cy.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=oh(0)),this.currentAnimation=mQ(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:a=>{this.mixTargetDelta(a),i.onUpdate&&i.onUpdate(a)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(TQ),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=i;if(!(!a||!l||!c)){if(this!==i&&this.layout&&c&&gF(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||dn();const h=br(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+h;const f=br(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+f}rs(a,l),Ou(a,u),dm(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(i,a){this.sharedNodes.has(i)||this.sharedNodes.set(i,new AQ),this.sharedNodes.get(i).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let a=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&Iv("z",i,c,this.animationValues);for(let u=0;u<Ev.length;u++)Iv(`rotate${Ev[u]}`,i,c,this.animationValues),Iv(`skew${Ev[u]}`,i,c,this.animationValues);i.render();for(const u in c)i.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);i.scheduleRender()}applyProjectionStyles(i,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=xy(a?.pointerEvents)||"",i.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=xy(a?.pointerEvents)||""),this.hasProjected&&!Al(this.latestValues)&&(i.transform=l?l({},""):"none",this.hasProjected=!1);return}i.visibility="";const u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let h=SQ(this.projectionDeltaWithTransform,this.treeScale,u);l&&(h=l(u,h)),i.transform=h;const{x:f,y:g}=this.projectionDelta;i.transformOrigin=`${f.origin*100}% ${g.origin*100}% 0`,c.animationValues?i.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:i.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const y in Bm){if(u[y]===void 0)continue;const{correct:w,applyTo:v,isCSSVariable:C}=Bm[y],x=h==="none"?u[y]:w(u[y],c);if(v){const A=v.length;for(let N=0;N<A;N++)i[v[N]]=x}else C?this.options.visualElement.renderState.vars[y]=x:i[y]=x}this.options.layoutId&&(i.pointerEvents=c===this?xy(a?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(EP),this.root.sharedNodes.clear()}}}function kQ(t){t.updateLayout()}function RQ(t){const e=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=t.layout,{animationType:s}=t.options,o=e.source!==t.layout.source;s==="size"?as(u=>{const h=o?e.measuredBox[u]:e.layoutBox[u],f=br(h);h.min=n[u].min,h.max=h.min+f}):gF(s,e.layoutBox,n)&&as(u=>{const h=o?e.measuredBox[u]:e.layoutBox[u],f=br(n[u]);h.max=h.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[u].max=t.relativeTarget[u].min+f)});const i=Lu();dm(i,n,e.layoutBox);const a=Lu();o?dm(a,t.applyTransform(r,!0),e.measuredBox):dm(a,n,e.layoutBox);const l=!hF(i);let c=!1;if(!t.resumeFrom){const u=t.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:h,layout:f}=u;if(h&&f){const g=dn();hm(g,e.layoutBox,h.layoutBox);const y=dn();hm(y,n,f.layoutBox),fF(g,y)||(c=!0),u.options.layoutRoot&&(t.relativeTarget=y,t.relativeTargetOrigin=g,t.relativeParent=u)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:a,layoutDelta:i,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function NQ(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function DQ(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function MQ(t){t.clearSnapshot()}function EP(t){t.clearMeasurements()}function IP(t){t.isLayoutDirty=!1}function OQ(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function _P(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function LQ(t){t.resolveTargetDelta()}function FQ(t){t.calcProjection()}function jQ(t){t.resetSkewAndRotation()}function VQ(t){t.removeLeadSnapshot()}function AP(t,e,n){t.translate=en(e.translate,0,n),t.scale=en(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function SP(t,e,n,r){t.min=en(e.min,n.min,r),t.max=en(e.max,n.max,r)}function BQ(t,e,n,r){SP(t.x,e.x,n.x,r),SP(t.y,e.y,n.y,r)}function UQ(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const HQ={duration:.45,ease:[.4,0,.1,1]},TP=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),PP=TP("applewebkit/")&&!TP("chrome/")?Math.round:Cs;function kP(t){t.min=PP(t.min),t.max=PP(t.max)}function $Q(t){kP(t.x),kP(t.y)}function gF(t,e,n){return t==="position"||t==="preserve-aspect"&&!Qq(xP(e),xP(n),.2)}function zQ(t){return t!==t.root&&t.scroll?.wasRoot}const GQ=pF({attachResizeListener:(t,e)=>Um(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),_v={current:void 0},yF=pF({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!_v.current){const t=new GQ({});t.mount(window),t.setOptions({layoutScroll:!0}),_v.current=t}return _v.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),WQ={pan:{Feature:uQ},drag:{Feature:cQ,ProjectionNode:yF,MeasureLayout:cF}};function RP(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,o=r[s];o&&Yt.postRender(()=>o(e,Kp(e)))}class KQ extends sl{mount(){const{current:e}=this.node;e&&(this.unmount=mK(e,(n,r)=>(RP(this.node,r,"Start"),s=>RP(this.node,s,"End"))))}unmount(){}}class qQ extends sl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=zp(Um(this.node.current,"focus",()=>this.onFocus()),Um(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function NP(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),o=r[s];o&&Yt.postRender(()=>o(e,Kp(e)))}class QQ extends sl{mount(){const{current:e}=this.node;e&&(this.unmount=wK(e,(n,r)=>(NP(this.node,r,"Start"),(s,{success:o})=>NP(this.node,s,o?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const fC=new WeakMap,Av=new WeakMap,YQ=t=>{const e=fC.get(t.target);e&&e(t)},JQ=t=>{t.forEach(YQ)};function XQ({root:t,...e}){const n=t||document;Av.has(n)||Av.set(n,{});const r=Av.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(JQ,{root:t,...e})),r[s]}function ZQ(t,e,n){const r=XQ(e);return fC.set(t,n),r.observe(t),()=>{fC.delete(t),r.unobserve(t)}}const eY={some:0,all:1};class tY extends sl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:o}=e,i={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:eY[s]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,o&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=c?u:h;f&&f(l)};return ZQ(this.node.current,i,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(nY(e,n))&&this.startObserver()}unmount(){}}function nY({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const rY={inView:{Feature:tY},tap:{Feature:QQ},focus:{Feature:qQ},hover:{Feature:KQ}},sY={layout:{ProjectionNode:yF,MeasureLayout:cF}},oY={...$q,...rY,...WQ,...sY},or=oq(oY,wq),Vf=({name:t,icon:e,link:n,onClick:r,className:s="",subtitle:o,color:i="primary"})=>{const a={primary:"from-primary-500 to-primary-600",secondary:"from-secondary-500 to-secondary-600",success:"from-success-500 to-success-600",warning:"from-warning-500 to-warning-600",danger:"from-danger-500 to-danger-600"},l={primary:"text-primary-600",secondary:"text-secondary-600",success:"text-success-600",warning:"text-warning-600",danger:"text-danger-600"},c=d.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-6 md:p-8 rounded-2xl bg-white border border-neutral-100 shadow-sm hover:shadow-md transition-all duration-200 overflow-hidden relative",children:[d.jsx("div",{className:`absolute inset-0 bg-gradient-to-br opacity-0 group-hover:opacity-10 transition-opacity duration-300 ${a[i]}`,"aria-hidden":"true"}),d.jsx("div",{className:`w-16 h-16 md:w-20 md:h-20 rounded-2xl flex items-center justify-center mb-6 transition-colors duration-200 bg-opacity-10 group-hover:bg-opacity-20 ${l[i]} bg-${i}-500`,children:Ft.isValidElement(e)?d.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 flex items-center justify-center",children:e}):d.jsx(e,{className:"w-8 h-8 md:w-10 md:h-10"})}),d.jsxs("div",{className:"text-center",children:[d.jsx("h3",{className:"text-lg md:text-xl font-semibold text-neutral-900 mb-2 group-hover:text-neutral-800 transition-colors",children:t}),o&&d.jsx("p",{className:"text-sm md:text-base text-neutral-500 mt-1 max-w-xs mx-auto",children:o})]}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-primary-400 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]});return d.jsx(or.div,{className:`h-full ${s}`,whileHover:{y:-4},transition:{type:"spring",stiffness:400,damping:10},children:n?d.jsx(Wn,{to:n,onClick:r,className:"h-full block group","aria-label":t,children:c}):d.jsx("button",{onClick:r,className:"h-full w-full block group","aria-label":t,children:c})})};Vf.propTypes={name:ne.string.isRequired,icon:ne.oneOfType([ne.elementType,ne.element]).isRequired,link:ne.string,onClick:ne.func,className:ne.string,subtitle:ne.string,color:ne.oneOf(["primary","secondary","success","warning","danger"])};const wF=(t,e,n="citizen")=>{if(console.log("fetchComplaintsByUser called with:",{uid:t,userRole:n}),!t)return console.warn("No UID provided to fetchComplaintsByUser"),e([]),()=>{};try{const r=wn(Oe,"complaints");let s;return n===TO.official?(console.log("Setting up query for official user"),s=Ha(r,Oa("reportedBy","==",t),Oa("status","in",[Es.inProgress,Es.rejected]))):(console.log("Setting up query for citizen user"),s=Ha(r,Oa("reportedBy","==",t))),console.log("Setting up snapshot listener with query:",s),Ir(s,async o=>{console.log("Query snapshot received");try{const i=[];for(const l of o.docs)try{console.log("Processing complaint:",l.id);const c=l.data(),u=l.id,h=wn(Oe,"complaints",u,"comments"),g=(await Mp(h)).docs.map(w=>({id:w.id,...w.data()}));let y={};if(c.reportedBy){const w=await Nn(tt(Oe,"users",c.reportedBy));w.exists()&&(y=w.data())}i.push({id:u,...c,comments:g,author:y?.name||"Unknown User",timestamp:c.timestamp?.toDate?c.timestamp.toDate():new Date(c.timestamp||Date.now())})}catch(c){console.error("Error processing complaint:",c);continue}const a=i.sort((l,c)=>new Date(c.timestamp||0)-new Date(l.timestamp||0));console.log("Successfully processed",a.length,"complaints"),e(a)}catch(i){console.error("Error in complaint processing:",i),e([])}},o=>{console.error("Error in onSnapshot:",o),e([])})}catch(r){return console.error("Error setting up complaints query:",r),e([]),()=>{}}},pI=(t,e="citizen")=>{console.log("[fetchComplaints] Starting with role:",e);const n=wn(Oe,"complaints"),r=[];let s;if(e==="official")s=Ha(n,Oa("status","in",["pending","inProgress","solved","rejected"]));else{const i=it.currentUser;if(!i)return()=>{};s=Ha(n,Oa("reportedBy","==",i.uid))}console.log("[fetchComplaints] Setting up snapshot listener with query:",s);const o=Ir(s,async i=>{console.log(`[fetchComplaints] Received snapshot with ${i.size} complaints`),r.length=0,(async()=>{for(const l of i.docs)try{const c=l.data(),u=l.id,h=c.reportedBy,f=await Nn(tt(Oe,"users",h)),g=f.exists()?f.data():null,y={id:u,author:g?.name||"Unknown user",...c,comments:[]},w=wn(Oe,"complaints",u,"comments"),v=Ir(w,C=>{const x=C.docs.map(N=>({id:N.id,...N.data()})),A=r.findIndex(N=>N.id===u);A!==-1&&(r[A].comments=x,typeof t=="function"&&(console.log(`[fetchComplaints] Sending ${r.length} complaints to handler`),t([...r])))});y.commentsUnsubscribe=v,r.push(y)}catch(c){console.error("Error processing complaint:",c)}typeof t=="function"&&(console.log(`[fetchComplaints] Sending ${r.length} complaints to handler`),t([...r]))})()});return()=>{r.forEach(i=>{i.commentsUnsubscribe&&typeof i.commentsUnsubscribe=="function"&&i.commentsUnsubscribe()}),o&&typeof o=="function"&&o()}},iY=async(t,e)=>{try{const n=it.currentUser;if(!n)throw new Error("User not authenticated");const r=wn(Oe,"complaints",t,"comments"),s=typeof e=="string"?{author:n.uid,comment:e,timestamp:Date.now()}:{...e,author:n.uid,timestamp:e.timestamp||Date.now()};await Lb(r,s)}catch(n){throw console.error("Error adding comment:",n),new Error(n.message)}},Ew=async t=>{try{const e=tt(Oe,"users",t);return(await Nn(e)).data()}catch(e){throw console.error("Error fetching complaints:",e),e}},fm=async t=>{try{if(!t)return[];const e=tt(Oe,"users",t),n=await Nn(e);return(n.exists()?n.data():{}).following||[]}catch{return[]}},bF=async(t,e)=>{!t||!e||t===e||(await Xn(tt(Oe,"users",t),{following:HS(e)},{merge:!0}),await Xn(tt(Oe,"users",e),{followers:HS(t)},{merge:!0}))},vF=async(t,e)=>{!t||!e||t===e||(await Xn(tt(Oe,"users",t),{following:$S(e)},{merge:!0}),await Xn(tt(Oe,"users",e),{followers:$S(t)},{merge:!0}))},aY=(t,e)=>{const n=wn(Oe,"complaints");return Ir(n,async r=>{const s=[];for(const o of r.docs){const i=o.data();if(!i)continue;let a=null;if(typeof i.reportedBy=="string"?a=i.reportedBy:Array.isArray(i.reportedBy)&&i.reportedBy.length>0&&(a=i.reportedBy[0]),a&&a===t)continue;const l=o.id;let c="Unknown user";if(a)try{const u=tt(Oe,"users",a),h=await Nn(u);c=(h.exists()?h.data():null)?.name||c}catch{}s.push({id:l,...i,authorId:a||null,authorName:c})}s.sort((o,i)=>(i.timestamp||0)-(o.timestamp||0)),e(s)})},lY=async t=>{const e=it.currentUser;if(!e?.uid||!t)throw new Error("User not authenticated or invalid complaint ID");const n=AM(Oe),r=tt(Oe,"complaints",t,"likes",e.uid),s=tt(Oe,"complaints",t);if((await Nn(r)).exists())throw new Error("User has already liked this complaint");n.set(r,{uid:e.uid,timestamp:qs()}),n.update(s,{likesCount:Fb(1),updatedAt:qs()}),await n.commit()},cY=async t=>{const e=it.currentUser;if(!e?.uid||!t)throw new Error("User not authenticated or invalid complaint ID");const n=AM(Oe),r=tt(Oe,"complaints",t,"likes",e.uid),s=tt(Oe,"complaints",t);if(!(await Nn(r)).exists())throw new Error("User has not liked this complaint");n.delete(r),n.update(s,{likesCount:Fb(-1),updatedAt:qs()}),await n.commit()},uY=async(t,e)=>{if(!e||!t)return!1;try{const n=tt(Oe,"complaints",t,"likes",e);return(await Nn(n)).exists()}catch(n){return console.error("Error checking like status:",n),!1}},dY=async(t,e)=>{try{const n=tt(Oe,"complaints",t),r=tt(wn(Oe,"reports"),`${t}_${e}`);if((await Nn(r)).exists())throw new Error("You have already reported this post");return await Xn(r,{complaintId:t,userId:e,timestamp:qs()}),await Ii(n,{reportCount:Fb(1)}),!0}catch(n){throw console.error("Error reporting complaint:",n),n}},hY=async(t,e)=>{try{const n=tt(Oe,"complaints",t),r=tt(wn(Oe,"reports"),`${t}_${e}`);if(!(await Nn(r)).exists())throw new Error("You have not reported this post");return await gE(r),await Ii(n,{reportCount:Fb(-1)}),!0}catch(n){throw console.error("Error unreporting complaint:",n),n}},fY=async(t,e)=>{try{const n=tt(Oe,"reports",`${t}_${e}`);return(await Nn(n)).exists()}catch(n){return console.error("Error checking report status:",n),!1}},mY=async t=>{try{const e=await Mp(wn(Oe,"complaints")),n={};e.forEach(a=>{const c=a.data().userId;n[c]=(n[c]||0)+1});const r=Object.entries(n).map(([a,l])=>({userId:a,postCount:l}));r.sort((a,l)=>l.postCount-a.postCount);const s=r.findIndex(a=>a.userId===t),o=r.length;if(s===-1||o===0)return 50;const i=(o-s)/o*100;return Math.min(100,Math.max(1,Math.round(i)))}catch(e){return console.error("Error calculating contribution score:",e),50}};function DP(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function pY(...t){return e=>{let n=!1;const r=t.map(s=>{const o=DP(s,e);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let s=0;s<r.length;s++){const o=r[s];typeof o=="function"?o():DP(t[s],null)}}}}var gY=Symbol.for("react.lazy"),Iw=FB[" use ".trim().toString()];function yY(t){return typeof t=="object"&&t!==null&&"then"in t}function xF(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===gY&&"_payload"in t&&yY(t._payload)}function wY(t){const e=vY(t),n=p.forwardRef((r,s)=>{let{children:o,...i}=r;xF(o)&&typeof Iw=="function"&&(o=Iw(o._payload));const a=p.Children.toArray(o),l=a.find(CY);if(l){const c=l.props.children,u=a.map(h=>h===l?p.Children.count(c)>1?p.Children.only(null):p.isValidElement(c)?c.props.children:null:h);return d.jsx(e,{...i,ref:s,children:p.isValidElement(c)?p.cloneElement(c,void 0,u):null})}return d.jsx(e,{...i,ref:s,children:o})});return n.displayName=`${t}.Slot`,n}var bY=wY("Slot");function vY(t){const e=p.forwardRef((n,r)=>{let{children:s,...o}=n;if(xF(s)&&typeof Iw=="function"&&(s=Iw(s._payload)),p.isValidElement(s)){const i=IY(s),a=EY(o,s.props);return s.type!==p.Fragment&&(a.ref=r?pY(r,i):i),p.cloneElement(s,a)}return p.Children.count(s)>1?p.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var xY=Symbol("radix.slottable");function CY(t){return p.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===xY}function EY(t,e){const n={...e};for(const r in e){const s=t[r],o=e[r];/^on[A-Z]/.test(r)?s&&o?n[r]=(...a)=>{const l=o(...a);return s(...a),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...o}:r==="className"&&(n[r]=[s,o].filter(Boolean).join(" "))}return{...t,...n}}function IY(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function CF(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=CF(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function _Y(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=CF(t))&&(r&&(r+=" "),r+=e);return r}const MP=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,OP=_Y,EF=(t,e)=>n=>{var r;if(e?.variants==null)return OP(t,n?.class,n?.className);const{variants:s,defaultVariants:o}=e,i=Object.keys(s).map(c=>{const u=n?.[c],h=o?.[c];if(u===null)return null;const f=MP(u)||MP(h);return s[c][f]}),a=n&&Object.entries(n).reduce((c,u)=>{let[h,f]=u;return f===void 0||(c[h]=f),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:h,className:f,...g}=u;return Object.entries(g).every(y=>{let[w,v]=y;return Array.isArray(v)?v.includes({...o,...a}[w]):{...o,...a}[w]===v})?[...c,h,f]:c},[]);return OP(t,i,l,n?.class,n?.className)},AY=(t,e)=>{const n=new Array(t.length+e.length);for(let r=0;r<t.length;r++)n[r]=t[r];for(let r=0;r<e.length;r++)n[t.length+r]=e[r];return n},SY=(t,e)=>({classGroupId:t,validator:e}),IF=(t=new Map,e=null,n)=>({nextPart:t,validators:e,classGroupId:n}),_w="-",LP=[],TY="arbitrary..",PY=t=>{const e=RY(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:i=>{if(i.startsWith("[")&&i.endsWith("]"))return kY(i);const a=i.split(_w),l=a[0]===""&&a.length>1?1:0;return _F(a,l,e)},getConflictingClassGroupIds:(i,a)=>{if(a){const l=r[i],c=n[i];return l?c?AY(c,l):l:c||LP}return n[i]||LP}}},_F=(t,e,n)=>{if(t.length-e===0)return n.classGroupId;const s=t[e],o=n.nextPart.get(s);if(o){const c=_F(t,e+1,o);if(c)return c}const i=n.validators;if(i===null)return;const a=e===0?t.join(_w):t.slice(e).join(_w),l=i.length;for(let c=0;c<l;c++){const u=i[c];if(u.validator(a))return u.classGroupId}},kY=t=>t.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=t.slice(1,-1),n=e.indexOf(":"),r=e.slice(0,n);return r?TY+r:void 0})(),RY=t=>{const{theme:e,classGroups:n}=t;return NY(n,e)},NY=(t,e)=>{const n=IF();for(const r in t){const s=t[r];gI(s,n,r,e)}return n},gI=(t,e,n,r)=>{const s=t.length;for(let o=0;o<s;o++){const i=t[o];DY(i,e,n,r)}},DY=(t,e,n,r)=>{if(typeof t=="string"){MY(t,e,n);return}if(typeof t=="function"){OY(t,e,n,r);return}LY(t,e,n,r)},MY=(t,e,n)=>{const r=t===""?e:AF(e,t);r.classGroupId=n},OY=(t,e,n,r)=>{if(FY(t)){gI(t(r),e,n,r);return}e.validators===null&&(e.validators=[]),e.validators.push(SY(n,t))},LY=(t,e,n,r)=>{const s=Object.entries(t),o=s.length;for(let i=0;i<o;i++){const[a,l]=s[i];gI(l,AF(e,a),n,r)}},AF=(t,e)=>{let n=t;const r=e.split(_w),s=r.length;for(let o=0;o<s;o++){const i=r[o];let a=n.nextPart.get(i);a||(a=IF(),n.nextPart.set(i,a)),n=a}return n},FY=t=>"isThemeGetter"in t&&t.isThemeGetter===!0,jY=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=Object.create(null),r=Object.create(null);const s=(o,i)=>{n[o]=i,e++,e>t&&(e=0,r=n,n=Object.create(null))};return{get(o){let i=n[o];if(i!==void 0)return i;if((i=r[o])!==void 0)return s(o,i),i},set(o,i){o in n?n[o]=i:s(o,i)}}},mC="!",FP=":",VY=[],jP=(t,e,n,r,s)=>({modifiers:t,hasImportantModifier:e,baseClassName:n,maybePostfixModifierPosition:r,isExternal:s}),BY=t=>{const{prefix:e,experimentalParseClassName:n}=t;let r=s=>{const o=[];let i=0,a=0,l=0,c;const u=s.length;for(let w=0;w<u;w++){const v=s[w];if(i===0&&a===0){if(v===FP){o.push(s.slice(l,w)),l=w+1;continue}if(v==="/"){c=w;continue}}v==="["?i++:v==="]"?i--:v==="("?a++:v===")"&&a--}const h=o.length===0?s:s.slice(l);let f=h,g=!1;h.endsWith(mC)?(f=h.slice(0,-1),g=!0):h.startsWith(mC)&&(f=h.slice(1),g=!0);const y=c&&c>l?c-l:void 0;return jP(o,g,f,y)};if(e){const s=e+FP,o=r;r=i=>i.startsWith(s)?o(i.slice(s.length)):jP(VY,!1,i,void 0,!0)}if(n){const s=r;r=o=>n({className:o,parseClassName:s})}return r},UY=t=>{const e=new Map;return t.orderSensitiveModifiers.forEach((n,r)=>{e.set(n,1e6+r)}),n=>{const r=[];let s=[];for(let o=0;o<n.length;o++){const i=n[o],a=i[0]==="[",l=e.has(i);a||l?(s.length>0&&(s.sort(),r.push(...s),s=[]),r.push(i)):s.push(i)}return s.length>0&&(s.sort(),r.push(...s)),r}},HY=t=>({cache:jY(t.cacheSize),parseClassName:BY(t),sortModifiers:UY(t),...PY(t)}),$Y=/\s+/,zY=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:o}=e,i=[],a=t.trim().split($Y);let l="";for(let c=a.length-1;c>=0;c-=1){const u=a[c],{isExternal:h,modifiers:f,hasImportantModifier:g,baseClassName:y,maybePostfixModifierPosition:w}=n(u);if(h){l=u+(l.length>0?" "+l:l);continue}let v=!!w,C=r(v?y.substring(0,w):y);if(!C){if(!v){l=u+(l.length>0?" "+l:l);continue}if(C=r(y),!C){l=u+(l.length>0?" "+l:l);continue}v=!1}const x=f.length===0?"":f.length===1?f[0]:o(f).join(":"),A=g?x+mC:x,N=A+C;if(i.indexOf(N)>-1)continue;i.push(N);const M=s(C,v);for(let k=0;k<M.length;++k){const E=M[k];i.push(A+E)}l=u+(l.length>0?" "+l:l)}return l},GY=(...t)=>{let e=0,n,r,s="";for(;e<t.length;)(n=t[e++])&&(r=SF(n))&&(s&&(s+=" "),s+=r);return s},SF=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=SF(t[r]))&&(n&&(n+=" "),n+=e);return n},WY=(t,...e)=>{let n,r,s,o;const i=l=>{const c=e.reduce((u,h)=>h(u),t());return n=HY(c),r=n.cache.get,s=n.cache.set,o=a,a(l)},a=l=>{const c=r(l);if(c)return c;const u=zY(l,n);return s(l,u),u};return o=i,(...l)=>o(GY(...l))},KY=[],Sn=t=>{const e=n=>n[t]||KY;return e.isThemeGetter=!0,e},TF=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,PF=/^\((?:(\w[\w-]*):)?(.+)\)$/i,qY=/^\d+\/\d+$/,QY=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,YY=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,JY=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,XY=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ZY=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,hu=t=>qY.test(t),at=t=>!!t&&!Number.isNaN(Number(t)),Wi=t=>!!t&&Number.isInteger(Number(t)),Sv=t=>t.endsWith("%")&&at(t.slice(0,-1)),Wo=t=>QY.test(t),eJ=()=>!0,tJ=t=>YY.test(t)&&!JY.test(t),kF=()=>!1,nJ=t=>XY.test(t),rJ=t=>ZY.test(t),sJ=t=>!Be(t)&&!Ue(t),oJ=t=>Nh(t,DF,kF),Be=t=>TF.test(t),wl=t=>Nh(t,MF,tJ),Tv=t=>Nh(t,uJ,at),VP=t=>Nh(t,RF,kF),iJ=t=>Nh(t,NF,rJ),Ug=t=>Nh(t,OF,nJ),Ue=t=>PF.test(t),ff=t=>Dh(t,MF),aJ=t=>Dh(t,dJ),BP=t=>Dh(t,RF),lJ=t=>Dh(t,DF),cJ=t=>Dh(t,NF),Hg=t=>Dh(t,OF,!0),Nh=(t,e,n)=>{const r=TF.exec(t);return r?r[1]?e(r[1]):n(r[2]):!1},Dh=(t,e,n=!1)=>{const r=PF.exec(t);return r?r[1]?e(r[1]):n:!1},RF=t=>t==="position"||t==="percentage",NF=t=>t==="image"||t==="url",DF=t=>t==="length"||t==="size"||t==="bg-size",MF=t=>t==="length",uJ=t=>t==="number",dJ=t=>t==="family-name",OF=t=>t==="shadow",hJ=()=>{const t=Sn("color"),e=Sn("font"),n=Sn("text"),r=Sn("font-weight"),s=Sn("tracking"),o=Sn("leading"),i=Sn("breakpoint"),a=Sn("container"),l=Sn("spacing"),c=Sn("radius"),u=Sn("shadow"),h=Sn("inset-shadow"),f=Sn("text-shadow"),g=Sn("drop-shadow"),y=Sn("blur"),w=Sn("perspective"),v=Sn("aspect"),C=Sn("ease"),x=Sn("animate"),A=()=>["auto","avoid","all","avoid-page","page","left","right","column"],N=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],M=()=>[...N(),Ue,Be],k=()=>["auto","hidden","clip","visible","scroll"],E=()=>["auto","contain","none"],b=()=>[Ue,Be,l],I=()=>[hu,"full","auto",...b()],P=()=>[Wi,"none","subgrid",Ue,Be],S=()=>["auto",{span:["full",Wi,Ue,Be]},Wi,Ue,Be],D=()=>[Wi,"auto",Ue,Be],T=()=>["auto","min","max","fr",Ue,Be],j=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],R=()=>["start","end","center","stretch","center-safe","end-safe"],V=()=>["auto",...b()],U=()=>[hu,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...b()],F=()=>[t,Ue,Be],$=()=>[...N(),BP,VP,{position:[Ue,Be]}],W=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Z=()=>["auto","cover","contain",lJ,oJ,{size:[Ue,Be]}],Y=()=>[Sv,ff,wl],le=()=>["","none","full",c,Ue,Be],fe=()=>["",at,ff,wl],we=()=>["solid","dashed","dotted","double"],Me=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ee=()=>[at,Sv,BP,VP],X=()=>["","none",y,Ue,Be],ue=()=>["none",at,Ue,Be],re=()=>["none",at,Ue,Be],ie=()=>[at,Ue,Be],Ce=()=>[hu,"full",...b()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Wo],breakpoint:[Wo],color:[eJ],container:[Wo],"drop-shadow":[Wo],ease:["in","out","in-out"],font:[sJ],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Wo],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Wo],shadow:[Wo],spacing:["px",at],text:[Wo],"text-shadow":[Wo],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",hu,Be,Ue,v]}],container:["container"],columns:[{columns:[at,Be,Ue,a]}],"break-after":[{"break-after":A()}],"break-before":[{"break-before":A()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:M()}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:E()}],"overscroll-x":[{"overscroll-x":E()}],"overscroll-y":[{"overscroll-y":E()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[Wi,"auto",Ue,Be]}],basis:[{basis:[hu,"full","auto",a,...b()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[at,hu,"auto","initial","none",Be]}],grow:[{grow:["",at,Ue,Be]}],shrink:[{shrink:["",at,Ue,Be]}],order:[{order:[Wi,"first","last","none",Ue,Be]}],"grid-cols":[{"grid-cols":P()}],"col-start-end":[{col:S()}],"col-start":[{"col-start":D()}],"col-end":[{"col-end":D()}],"grid-rows":[{"grid-rows":P()}],"row-start-end":[{row:S()}],"row-start":[{"row-start":D()}],"row-end":[{"row-end":D()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":T()}],"auto-rows":[{"auto-rows":T()}],gap:[{gap:b()}],"gap-x":[{"gap-x":b()}],"gap-y":[{"gap-y":b()}],"justify-content":[{justify:[...j(),"normal"]}],"justify-items":[{"justify-items":[...R(),"normal"]}],"justify-self":[{"justify-self":["auto",...R()]}],"align-content":[{content:["normal",...j()]}],"align-items":[{items:[...R(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...R(),{baseline:["","last"]}]}],"place-content":[{"place-content":j()}],"place-items":[{"place-items":[...R(),"baseline"]}],"place-self":[{"place-self":["auto",...R()]}],p:[{p:b()}],px:[{px:b()}],py:[{py:b()}],ps:[{ps:b()}],pe:[{pe:b()}],pt:[{pt:b()}],pr:[{pr:b()}],pb:[{pb:b()}],pl:[{pl:b()}],m:[{m:V()}],mx:[{mx:V()}],my:[{my:V()}],ms:[{ms:V()}],me:[{me:V()}],mt:[{mt:V()}],mr:[{mr:V()}],mb:[{mb:V()}],ml:[{ml:V()}],"space-x":[{"space-x":b()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":b()}],"space-y-reverse":["space-y-reverse"],size:[{size:U()}],w:[{w:[a,"screen",...U()]}],"min-w":[{"min-w":[a,"screen","none",...U()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[i]},...U()]}],h:[{h:["screen","lh",...U()]}],"min-h":[{"min-h":["screen","lh","none",...U()]}],"max-h":[{"max-h":["screen","lh",...U()]}],"font-size":[{text:["base",n,ff,wl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Ue,Tv]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Sv,Be]}],"font-family":[{font:[aJ,Be,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,Ue,Be]}],"line-clamp":[{"line-clamp":[at,"none",Ue,Tv]}],leading:[{leading:[o,...b()]}],"list-image":[{"list-image":["none",Ue,Be]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ue,Be]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:F()}],"text-color":[{text:F()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...we(),"wavy"]}],"text-decoration-thickness":[{decoration:[at,"from-font","auto",Ue,wl]}],"text-decoration-color":[{decoration:F()}],"underline-offset":[{"underline-offset":[at,"auto",Ue,Be]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:b()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ue,Be]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ue,Be]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:$()}],"bg-repeat":[{bg:W()}],"bg-size":[{bg:Z()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Wi,Ue,Be],radial:["",Ue,Be],conic:[Wi,Ue,Be]},cJ,iJ]}],"bg-color":[{bg:F()}],"gradient-from-pos":[{from:Y()}],"gradient-via-pos":[{via:Y()}],"gradient-to-pos":[{to:Y()}],"gradient-from":[{from:F()}],"gradient-via":[{via:F()}],"gradient-to":[{to:F()}],rounded:[{rounded:le()}],"rounded-s":[{"rounded-s":le()}],"rounded-e":[{"rounded-e":le()}],"rounded-t":[{"rounded-t":le()}],"rounded-r":[{"rounded-r":le()}],"rounded-b":[{"rounded-b":le()}],"rounded-l":[{"rounded-l":le()}],"rounded-ss":[{"rounded-ss":le()}],"rounded-se":[{"rounded-se":le()}],"rounded-ee":[{"rounded-ee":le()}],"rounded-es":[{"rounded-es":le()}],"rounded-tl":[{"rounded-tl":le()}],"rounded-tr":[{"rounded-tr":le()}],"rounded-br":[{"rounded-br":le()}],"rounded-bl":[{"rounded-bl":le()}],"border-w":[{border:fe()}],"border-w-x":[{"border-x":fe()}],"border-w-y":[{"border-y":fe()}],"border-w-s":[{"border-s":fe()}],"border-w-e":[{"border-e":fe()}],"border-w-t":[{"border-t":fe()}],"border-w-r":[{"border-r":fe()}],"border-w-b":[{"border-b":fe()}],"border-w-l":[{"border-l":fe()}],"divide-x":[{"divide-x":fe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":fe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...we(),"hidden","none"]}],"divide-style":[{divide:[...we(),"hidden","none"]}],"border-color":[{border:F()}],"border-color-x":[{"border-x":F()}],"border-color-y":[{"border-y":F()}],"border-color-s":[{"border-s":F()}],"border-color-e":[{"border-e":F()}],"border-color-t":[{"border-t":F()}],"border-color-r":[{"border-r":F()}],"border-color-b":[{"border-b":F()}],"border-color-l":[{"border-l":F()}],"divide-color":[{divide:F()}],"outline-style":[{outline:[...we(),"none","hidden"]}],"outline-offset":[{"outline-offset":[at,Ue,Be]}],"outline-w":[{outline:["",at,ff,wl]}],"outline-color":[{outline:F()}],shadow:[{shadow:["","none",u,Hg,Ug]}],"shadow-color":[{shadow:F()}],"inset-shadow":[{"inset-shadow":["none",h,Hg,Ug]}],"inset-shadow-color":[{"inset-shadow":F()}],"ring-w":[{ring:fe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:F()}],"ring-offset-w":[{"ring-offset":[at,wl]}],"ring-offset-color":[{"ring-offset":F()}],"inset-ring-w":[{"inset-ring":fe()}],"inset-ring-color":[{"inset-ring":F()}],"text-shadow":[{"text-shadow":["none",f,Hg,Ug]}],"text-shadow-color":[{"text-shadow":F()}],opacity:[{opacity:[at,Ue,Be]}],"mix-blend":[{"mix-blend":[...Me(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Me()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[at]}],"mask-image-linear-from-pos":[{"mask-linear-from":Ee()}],"mask-image-linear-to-pos":[{"mask-linear-to":Ee()}],"mask-image-linear-from-color":[{"mask-linear-from":F()}],"mask-image-linear-to-color":[{"mask-linear-to":F()}],"mask-image-t-from-pos":[{"mask-t-from":Ee()}],"mask-image-t-to-pos":[{"mask-t-to":Ee()}],"mask-image-t-from-color":[{"mask-t-from":F()}],"mask-image-t-to-color":[{"mask-t-to":F()}],"mask-image-r-from-pos":[{"mask-r-from":Ee()}],"mask-image-r-to-pos":[{"mask-r-to":Ee()}],"mask-image-r-from-color":[{"mask-r-from":F()}],"mask-image-r-to-color":[{"mask-r-to":F()}],"mask-image-b-from-pos":[{"mask-b-from":Ee()}],"mask-image-b-to-pos":[{"mask-b-to":Ee()}],"mask-image-b-from-color":[{"mask-b-from":F()}],"mask-image-b-to-color":[{"mask-b-to":F()}],"mask-image-l-from-pos":[{"mask-l-from":Ee()}],"mask-image-l-to-pos":[{"mask-l-to":Ee()}],"mask-image-l-from-color":[{"mask-l-from":F()}],"mask-image-l-to-color":[{"mask-l-to":F()}],"mask-image-x-from-pos":[{"mask-x-from":Ee()}],"mask-image-x-to-pos":[{"mask-x-to":Ee()}],"mask-image-x-from-color":[{"mask-x-from":F()}],"mask-image-x-to-color":[{"mask-x-to":F()}],"mask-image-y-from-pos":[{"mask-y-from":Ee()}],"mask-image-y-to-pos":[{"mask-y-to":Ee()}],"mask-image-y-from-color":[{"mask-y-from":F()}],"mask-image-y-to-color":[{"mask-y-to":F()}],"mask-image-radial":[{"mask-radial":[Ue,Be]}],"mask-image-radial-from-pos":[{"mask-radial-from":Ee()}],"mask-image-radial-to-pos":[{"mask-radial-to":Ee()}],"mask-image-radial-from-color":[{"mask-radial-from":F()}],"mask-image-radial-to-color":[{"mask-radial-to":F()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":N()}],"mask-image-conic-pos":[{"mask-conic":[at]}],"mask-image-conic-from-pos":[{"mask-conic-from":Ee()}],"mask-image-conic-to-pos":[{"mask-conic-to":Ee()}],"mask-image-conic-from-color":[{"mask-conic-from":F()}],"mask-image-conic-to-color":[{"mask-conic-to":F()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:$()}],"mask-repeat":[{mask:W()}],"mask-size":[{mask:Z()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ue,Be]}],filter:[{filter:["","none",Ue,Be]}],blur:[{blur:X()}],brightness:[{brightness:[at,Ue,Be]}],contrast:[{contrast:[at,Ue,Be]}],"drop-shadow":[{"drop-shadow":["","none",g,Hg,Ug]}],"drop-shadow-color":[{"drop-shadow":F()}],grayscale:[{grayscale:["",at,Ue,Be]}],"hue-rotate":[{"hue-rotate":[at,Ue,Be]}],invert:[{invert:["",at,Ue,Be]}],saturate:[{saturate:[at,Ue,Be]}],sepia:[{sepia:["",at,Ue,Be]}],"backdrop-filter":[{"backdrop-filter":["","none",Ue,Be]}],"backdrop-blur":[{"backdrop-blur":X()}],"backdrop-brightness":[{"backdrop-brightness":[at,Ue,Be]}],"backdrop-contrast":[{"backdrop-contrast":[at,Ue,Be]}],"backdrop-grayscale":[{"backdrop-grayscale":["",at,Ue,Be]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[at,Ue,Be]}],"backdrop-invert":[{"backdrop-invert":["",at,Ue,Be]}],"backdrop-opacity":[{"backdrop-opacity":[at,Ue,Be]}],"backdrop-saturate":[{"backdrop-saturate":[at,Ue,Be]}],"backdrop-sepia":[{"backdrop-sepia":["",at,Ue,Be]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":b()}],"border-spacing-x":[{"border-spacing-x":b()}],"border-spacing-y":[{"border-spacing-y":b()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ue,Be]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[at,"initial",Ue,Be]}],ease:[{ease:["linear","initial",C,Ue,Be]}],delay:[{delay:[at,Ue,Be]}],animate:[{animate:["none",x,Ue,Be]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[w,Ue,Be]}],"perspective-origin":[{"perspective-origin":M()}],rotate:[{rotate:ue()}],"rotate-x":[{"rotate-x":ue()}],"rotate-y":[{"rotate-y":ue()}],"rotate-z":[{"rotate-z":ue()}],scale:[{scale:re()}],"scale-x":[{"scale-x":re()}],"scale-y":[{"scale-y":re()}],"scale-z":[{"scale-z":re()}],"scale-3d":["scale-3d"],skew:[{skew:ie()}],"skew-x":[{"skew-x":ie()}],"skew-y":[{"skew-y":ie()}],transform:[{transform:[Ue,Be,"","none","gpu","cpu"]}],"transform-origin":[{origin:M()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Ce()}],"translate-x":[{"translate-x":Ce()}],"translate-y":[{"translate-y":Ce()}],"translate-z":[{"translate-z":Ce()}],"translate-none":["translate-none"],accent:[{accent:F()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:F()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ue,Be]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":b()}],"scroll-mx":[{"scroll-mx":b()}],"scroll-my":[{"scroll-my":b()}],"scroll-ms":[{"scroll-ms":b()}],"scroll-me":[{"scroll-me":b()}],"scroll-mt":[{"scroll-mt":b()}],"scroll-mr":[{"scroll-mr":b()}],"scroll-mb":[{"scroll-mb":b()}],"scroll-ml":[{"scroll-ml":b()}],"scroll-p":[{"scroll-p":b()}],"scroll-px":[{"scroll-px":b()}],"scroll-py":[{"scroll-py":b()}],"scroll-ps":[{"scroll-ps":b()}],"scroll-pe":[{"scroll-pe":b()}],"scroll-pt":[{"scroll-pt":b()}],"scroll-pr":[{"scroll-pr":b()}],"scroll-pb":[{"scroll-pb":b()}],"scroll-pl":[{"scroll-pl":b()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ue,Be]}],fill:[{fill:["none",...F()]}],"stroke-w":[{stroke:[at,ff,wl,Tv]}],stroke:[{stroke:["none",...F()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},fJ=WY(hJ);function Mh(...t){return fJ(ui(t))}const mJ=EF("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Vn=p.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},o)=>{const i=r?bY:"button";return d.jsx(i,{className:Mh(mJ({variant:e,size:n,className:t})),ref:o,...s})});Vn.displayName="Button";const yI=p.forwardRef(({className:t,...e},n)=>d.jsx("textarea",{className:Mh("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));yI.displayName="Textarea";const LF=p.forwardRef(({className:t,...e},n)=>d.jsx("div",{ref:n,className:Mh("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));LF.displayName="Avatar";const pJ=p.forwardRef(({className:t,...e},n)=>d.jsx("img",{ref:n,className:Mh("aspect-square h-full w-full",t),...e}));pJ.displayName="AvatarImage";const FF=p.forwardRef(({className:t,...e},n)=>d.jsx("div",{ref:n,className:Mh("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));FF.displayName="AvatarFallback";const gJ=EF("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function yJ({className:t,variant:e,...n}){return d.jsx("div",{className:Mh(gJ({variant:e}),t),...n})}const wJ=({status:t,className:e=""})=>{const n=pr[t]||pr.PENDING;return d.jsx(yJ,{className:`px-3 py-1 rounded-full text-sm font-medium ${e}`,style:{backgroundColor:`${n}15`,color:n,border:`1px solid ${n}40`},children:t})},bl=({onClick:t,icon:e,label:n,variant:r="default",className:s="",disabled:o=!1})=>{const i={default:"bg-primary-600 hover:bg-primary-700 text-white",outline:"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50",danger:"bg-red-600 hover:bg-red-700 text-white",success:"bg-green-600 hover:bg-green-700 text-white"};return d.jsxs(Vn,{onClick:t,className:`inline-flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${i[r]} ${s}`,disabled:o,children:[e&&d.jsx(e,{className:"w-4 h-4"}),n]})},UP=t=>{switch(Number(t)){case 1:return"etherscan.io";case 5:return"goerli.etherscan.io";case 11155111:return"sepolia.etherscan.io";case 10:return"optimistic.etherscan.io";case 11155420:return"sepolia-optimism.etherscan.io";default:return"etherscan.io"}},Wb=({open:t,onClose:e,complaint:n,onStatusUpdate:r})=>{const[s,o]=p.useState(!1),[i,a]=p.useState(""),[l,c]=p.useState(!1),[u,h]=p.useState(n.status||"pending"),[f,g]=p.useState(!1),y=new Date(n.timestamp),w=y.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),v=y.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});p.useEffect(()=>{const A=it.onAuthStateChanged(async N=>{if(N){const M=await Hp(N.uid);o(M)}});return()=>A()},[]);const C=async A=>{if(A.preventDefault(),!!i.trim()){c(!0);try{await RO(n.id,{text:i,timestamp:new Date().toISOString(),userId:it.currentUser.uid,userName:it.currentUser.displayName||"Anonymous"}),a("")}catch(N){console.error("Error adding comment:",N)}finally{c(!1)}}},x=async A=>{try{c(!0),await r(n.id,A),h(A),ge.success(`Status updated to ${A.replace("_"," ").toLowerCase()}`)}catch(N){console.error("Error updating status:",N),ge.error(`Failed to update status: ${N.message||"Unknown error"}`)}finally{c(!1)}};return d.jsxs("div",{className:`fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50 transition-opacity ${t?"opacity-100":"opacity-0 pointer-events-none"}`,children:[d.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"border-b border-neutral-100 px-6 py-4 flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold text-neutral-900",children:"Complaint Details"}),d.jsxs("div",{className:"flex items-center mt-1",children:[d.jsx(wJ,{status:u,className:"text-sm"}),n.onChain?.enabled&&d.jsxs("a",{href:`https://${UP(n.onChain.chainId)}/tx/${n.onChain.txHash}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800 border border-emerald-200 hover:bg-emerald-200 transition-colors",children:[d.jsx(ME,{className:"w-3 h-3 mr-1.5"}),"Certified on Blockchain",d.jsx(gw,{className:"w-2.5 h-2.5 ml-1.5 opacity-70"})]}),d.jsxs("span",{className:"text-sm text-neutral-500 ml-2",children:["Reported on ",w," at ",v]})]})]}),d.jsx("button",{onClick:e,className:"p-1.5 rounded-full hover:bg-neutral-100 transition-colors","aria-label":"Close dialog",disabled:l,children:d.jsx(Vc,{className:"w-5 h-5 text-neutral-500"})})]}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-medium text-neutral-900 mb-2",children:"Issue"}),d.jsx("p",{className:"text-neutral-700",children:n.reason})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("div",{className:"p-2 bg-primary-50 rounded-lg",children:d.jsx(yw,{className:"w-5 h-5 text-primary-600"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-neutral-500",children:"Location"}),d.jsx("p",{className:"text-neutral-900",children:typeof n.location=="string"?n.location:n.location?.name||"Not specified"})]})]}),d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:d.jsx(Ff,{className:"w-5 h-5 text-blue-600"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-neutral-500",children:"Reported"}),d.jsxs("p",{className:"text-neutral-900",children:[w,"  ",v]})]})]})]}),n.description&&d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-neutral-500 mb-1",children:"Description"}),d.jsx("p",{className:"text-neutral-700 whitespace-pre-line",children:n.description})]}),n.audioUrl&&d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"text-sm font-medium text-neutral-500 mb-2",children:"Voice Note"}),d.jsx("div",{className:"flex items-center space-x-3 bg-gray-50 p-3 rounded-lg",children:d.jsx("audio",{src:n.audioUrl,controls:!0,className:"h-8 w-full",controlsList:"nodownload"})})]}),n.mediaUrl&&d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-neutral-500 mb-2",children:"Attached Image"}),d.jsxs("div",{className:"relative group cursor-pointer rounded-lg overflow-hidden border border-neutral-200 w-full max-w-md",onClick:()=>g(!0),children:[d.jsx("img",{src:n.mediaUrl,alt:"Complaint evidence",className:"w-full h-auto object-cover transition-transform duration-200 group-hover:scale-105"}),d.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 flex items-center justify-center",children:d.jsx("div",{className:"bg-white bg-opacity-80 p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:d.jsx(KG,{className:"w-4 h-4 text-neutral-700"})})})]}),d.jsx("p",{className:"mt-1 text-xs text-neutral-500",children:"Click to view full size"})]})]}),d.jsxs("div",{className:"border-t border-neutral-100 pt-6",children:[d.jsx("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:"Comments"}),d.jsx("div",{className:"space-y-4 mb-6 max-h-64 overflow-y-auto pr-2",children:n.comments?.length>0?n.comments.map((A,N)=>d.jsxs("div",{className:"flex space-x-3",children:[d.jsx(LF,{className:"h-8 w-8",children:d.jsx(FF,{children:A.userName?.charAt(0)?.toUpperCase()||"U"})}),d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:"bg-neutral-50 rounded-lg p-3",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("span",{className:"text-sm font-medium text-neutral-900",children:A.userName||"Anonymous"}),d.jsx("span",{className:"text-xs text-neutral-500",children:new Date(A.timestamp).toLocaleString()})]}),d.jsx("p",{className:"mt-1 text-sm text-neutral-700",children:A.text})]})})]},N)):d.jsx("p",{className:"text-sm text-neutral-500 text-center py-4",children:"No comments yet"})}),d.jsx("form",{onSubmit:C,className:"mt-4",children:d.jsxs("div",{className:"flex space-x-2",children:[d.jsx(yI,{value:i,onChange:A=>a(A.target.value),placeholder:"Add a comment...",className:"flex-1 min-h-[80px] resize-none",disabled:l}),d.jsxs(Vn,{type:"submit",className:"self-end",disabled:!i.trim()||l,children:[d.jsx(e7,{className:"w-4 h-4 mr-1"}),"Send"]})]})})]}),n.onChain?.enabled&&d.jsx("div",{className:"border-t border-neutral-100 pt-4 flex flex-wrap gap-3 justify-end",children:d.jsxs("a",{href:`https://${UP(n.onChain.chainId)}/tx/${n.onChain.txHash}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50 transition-colors text-sm font-medium",children:[d.jsx(gw,{className:"w-4 h-4"}),"View on Blockchain"]})}),s&&d.jsxs("div",{className:"border-t border-neutral-100 pt-4 flex flex-wrap gap-3 justify-end",children:[u==="pending"&&d.jsxs(d.Fragment,{children:[d.jsx(bl,{onClick:()=>x("inProgress"),icon:Ff,label:"Mark as In Progress",variant:"default",disabled:l}),d.jsx(bl,{onClick:()=>x("solved"),icon:wT,label:"Mark as Solved",variant:"success",disabled:l}),d.jsx(bl,{onClick:()=>x("rejected"),icon:bT,label:"Mark as Rejected",variant:"danger",disabled:l})]}),u==="inProgress"&&d.jsxs(d.Fragment,{children:[d.jsx(bl,{onClick:()=>x("solved"),icon:wT,label:"Mark as Solved",variant:"success",disabled:l}),d.jsx(bl,{onClick:()=>x("rejected"),icon:bT,label:"Mark as Rejected",variant:"danger",disabled:l})]}),u==="solved"&&d.jsx(bl,{onClick:()=>x("inProgress"),icon:Ff,label:"Reopen as In Progress",variant:"outline",disabled:l}),u==="rejected"&&d.jsx(bl,{onClick:()=>x("inProgress"),icon:Ff,label:"Reopen as In Progress",variant:"outline",disabled:l})]})]})]}),f&&n.mediaUrl&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90",onClick:()=>g(!1),children:d.jsxs("div",{className:"relative max-w-4xl w-full max-h-[90vh]",onClick:A=>A.stopPropagation(),children:[d.jsx("button",{onClick:()=>g(!1),className:"absolute -top-10 right-0 p-2 text-white hover:bg-white/10 rounded-full transition-colors z-10","aria-label":"Close image viewer",children:d.jsx(Vc,{className:"w-6 h-6"})}),d.jsx("div",{className:"flex items-center justify-center h-full",children:d.jsx("img",{src:n.mediaUrl,alt:"Complaint evidence",className:"max-h-[80vh] max-w-full object-contain"})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 text-white text-sm p-2 text-center",children:d.jsx("p",{children:"Click outside to close"})})]})})]})},bJ=({status:t})=>{const e=pr[t]||pr.PENDING;return d.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",style:{backgroundColor:`${e}15`,color:e,border:`1px solid ${e}40`},children:t})},vJ=t=>{switch(Number(t)){case 1:return"etherscan.io";case 5:return"goerli.etherscan.io";case 11155111:return"sepolia.etherscan.io";case 10:return"optimistic.etherscan.io";case 11155420:return"sepolia-optimism.etherscan.io";default:return"etherscan.io"}},xJ=({complaint:t})=>{const[e,n]=p.useState(!1),[r,s]=p.useState(!1),o=new Date(t.timestamp);Object.keys(Es).find(a=>Es[a]===t.status);const i=o.toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return d.jsxs(d.Fragment,{children:[d.jsx(RL,{children:d.jsxs(or.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"bg-white rounded-xl shadow-sm border border-neutral-100 overflow-hidden transition-all duration-200 hover:shadow-md",onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[d.jsxs("div",{className:"p-4",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-neutral-900 line-clamp-2 mb-1",children:t.reason}),d.jsx("p",{className:"text-sm text-neutral-500",children:typeof t.location=="string"?t.location:t.location?.name||"Location not specified"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(bJ,{status:t.status}),t.onChain?.enabled&&d.jsxs("a",{href:`https://${vJ(t.onChain.chainId)}/tx/${t.onChain.txHash}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800 border border-emerald-200 hover:bg-emerald-200 transition-colors",onClick:a=>a.stopPropagation(),children:[d.jsx(ME,{className:"w-3 h-3 mr-1"}),d.jsx("span",{className:"hidden sm:inline",children:"Certified"}),d.jsx(gw,{className:"w-2.5 h-2.5 ml-1 opacity-70"})]})]})]}),d.jsxs("div",{className:"flex items-center justify-between mt-4 pt-3 border-t border-neutral-100",children:[d.jsxs("div",{className:"flex items-center text-sm text-neutral-500",children:[d.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),d.jsx("span",{children:i})]}),d.jsxs(or.button,{whileHover:{scale:1.03},whileTap:{scale:.98},onClick:()=>n(!0),className:"text-sm font-medium text-primary-600 hover:text-primary-700 transition-colors flex items-center",children:["View Details",d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),d.jsx(or.div,{className:"h-1 bg-gradient-to-r from-primary-500 to-primary-300",initial:{width:"0%"},animate:{width:r?"100%":"0%"},transition:{duration:.3,ease:"easeInOut"}})]})}),d.jsx(b2,{open:e,onClose:()=>n(!1),maxWidth:"md",fullWidth:!0,children:d.jsx(Wb,{setDialogOpen:n,complaint:t})})]})},HP={"In-Progress":1,REJECTED:2,SOLVED:3},CJ=()=>{const[t,e]=p.useState([]),[n,r]=p.useState("timestamp"),[s,o]=p.useState("desc"),i=ts();p.useEffect(()=>{const c=it.onAuthStateChanged(u=>{if(!u){i("/citizen-login");return}const h=wF(u.uid,a);return()=>h()});return()=>c&&c()},[]);const a=c=>{console.log("Updated complaints:",c),console.log("Number of complaints:",c.length),e(c)},l=p.useMemo(()=>{const c=[...t];return c.sort((u,h)=>{let f,g;switch(n){case"status":f=HP[u.status]||0,g=HP[h.status]||0;break;case"location":f=(u.location?.name||"").toLowerCase(),g=(h.location?.name||"").toLowerCase();break;case"timestamp":default:f=u.timestamp||0,g=h.timestamp||0;break}return f<g?s==="asc"?-1:1:f>g?s==="asc"?1:-1:0}),c},[t,n,s]);return console.log("Rendering with complaints:",t),d.jsxs("div",{className:"lg:border lg:shadow-[3px_4px_4px_rgba(0,0,0,0.26)] rounded-lg lg:border-solid lg:border-black w-full flex flex-col items-center lg:h-[28rem] py-2",children:[d.jsxs("div",{className:"w-full flex flex-col lg:flex-row items-center justify-between px-4 gap-3",children:[d.jsx("h3",{className:"font-bold my-2",children:"Complaints Reported by You"}),d.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[d.jsx("label",{className:"text-gray-700",children:"Sort by"}),d.jsxs("select",{className:"rounded-md border border-gray-300 bg-white px-2 py-1 focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500",value:n,onChange:c=>r(c.target.value),children:[d.jsx("option",{value:"timestamp",children:"Date"}),d.jsx("option",{value:"status",children:"Status"}),d.jsx("option",{value:"location",children:"Location"})]}),d.jsxs("select",{className:"rounded-md border border-gray-300 bg-white px-2 py-1 focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500",value:s,onChange:c=>o(c.target.value),children:[d.jsx("option",{value:"desc",children:"Desc"}),d.jsx("option",{value:"asc",children:"Asc"})]})]})]}),d.jsx("div",{className:"container px-4 overflow-y-auto w-full",children:l.length===0?d.jsx("h2",{children:"No Complaints Found"}):l.map(c=>d.jsx(xJ,{complaint:c},c.id))})]})},qp=({visible:t,label:e="Loading..."})=>t?d.jsxs("div",{className:"fixed inset-0 z-50 grid place-items-center",children:[d.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-white/60"}),d.jsxs("div",{className:"relative flex flex-col items-center gap-4 rounded-2xl bg-white/90 px-8 py-8 ring-1 ring-gray-200 shadow-xl",children:[d.jsx("div",{className:"h-10 w-10",children:d.jsx("span",{className:"block h-full w-full animate-[spin_1.2s_linear_infinite] rounded-full border-2 border-emerald-600 border-t-transparent"})}),d.jsx("p",{className:"text-sm font-medium text-gray-800",children:e})]})]}):null,EJ=()=>{const[t,e]=p.useState(null),[n,r]=p.useState(!1),s=ts(),[o]=v2();p.useEffect(()=>(o.get("newUser")&&ge.success("Registration Succesful, Welcome to citizen dashboard",{icon:""}),window.addEventListener("beforeinstallprompt",i),()=>{window.removeEventListener("beforeinstallprompt",i)}),[]);const i=c=>{c.preventDefault(),e(c)},a=()=>{t&&(t.prompt(),t.userChoice.then(c=>{e(null)}))},l=()=>{s("/")};return d.jsxs(d.Fragment,{children:[d.jsx(qp,{visible:n}),d.jsx(Vy,{position:"bottom-center",autoClose:5e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),d.jsx("h2",{className:" lg:mt-4 leading-normal font-semibold text-center text-lg lg:text-[1.6rem] my-4 lg:text-left lg:mx-20",children:"Dashboard"}),d.jsxs("div",{className:"grid lg:grid-cols-[0.8fr_0.6fr] mx-10",children:[d.jsxs("div",{children:[d.jsx(Vf,{icon:a7,name:"New Complaint",link:"/report"}),d.jsx(Vf,{icon:d7,name:"Track Reported complaints",link:"/track-complaints",className:"lg:hidden"}),d.jsx(Vf,{icon:o7,name:"Install as an app (Mobile)",onClick:a,className:"lg:hidden"}),d.jsx(Vf,{icon:DE,name:"Logout",onClick:l,className:"lg:hidden"})]}),d.jsx("div",{className:"hidden lg:flex",children:d.jsx(CJ,{})})]})]})};function $P(){const[t,e]=p.useState({email:"",password:""}),[n,r]=p.useState(!1),[s,o]=p.useState("");ts();const i=gp(),[a,l]=p.useState(null),c=i.pathname==="/official-login",u=c?"official":"citizen";p.useEffect(()=>{const g=it.onAuthStateChanged(async y=>{l(y||null)});return()=>g()},[]);const h=g=>{const{name:y,value:w}=g.target;e(v=>({...v,[y]:w}))},f=async g=>{if(g.preventDefault(),!n){o(""),r(!0);try{const{email:y,password:w}=t;console.groupCollapsed("[Login] Attempting login"),console.log("Email:",y),console.log("Is Official Login:",c),console.log("[Login] Setting auth persistence..."),await JM(it,EE),console.log("[Login] Auth persistence set to LOCAL");try{console.log("[Login] Signing out any existing session..."),await it.signOut(),console.log("[Login] Successfully signed out any existing session")}catch{console.log("[Login] No existing session to sign out of")}console.log("[Login] Signing in with email/password...");const C=(await B9(it,y,w)).user;console.log("[Login] Firebase Auth successful, checking user role..."),console.log("[Login] Checking user role...");const x=await Hp(C.uid);if(console.log("[Login] User role check complete:",{uid:C.uid,isOfficial:x,expectedOfficial:c}),c&&!x||!c&&x){console.log("[Login] Role mismatch detected, signing out..."),await it.signOut();const N=c?"This account is not authorized for official access. Please use the citizen login.":"This is an official account. Please use the official login page.";console.log("[Login] Error:",N),o(N),ge.error(N),r(!1),console.groupEnd();return}console.log("[Login] Refreshing ID token..."),await C.getIdToken(!0);const A=x?"/official-dashboard":"/feed";console.log("[Login] Login successful, redirecting to:",A),console.groupEnd(),window.location.href=A}catch(y){console.error("Login error:",y);let w="Login failed. Please check your credentials and try again.";y.code==="auth/user-not-found"||y.code==="auth/wrong-password"?w="Invalid email or password.":y.code==="auth/too-many-requests"?w="Too many failed attempts. Please try again later.":y.code==="auth/user-disabled"&&(w="This account has been disabled. Please contact support."),o(w),ge.error(w)}finally{r(!1)}}};return d.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[d.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[d.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:c?"Official Login":"Citizen Login"}),d.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",d.jsx(Wn,{to:"/register",className:"font-medium text-emerald-600 hover:text-emerald-500",children:"create a new account"})]})]}),d.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:d.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[a&&d.jsxs("div",{className:"mb-4 p-3 rounded-md bg-amber-50 border border-amber-200 text-amber-800 text-sm flex items-center justify-between",children:[d.jsx("span",{children:"You are currently signed in. If you expected to be logged out, please sign out below."}),d.jsx("button",{type:"button",onClick:async()=>{try{await it.signOut(),ge.info("Signed out")}catch{}},className:"ml-3 inline-flex items-center px-2.5 py-1.5 border border-amber-300 rounded-md text-xs font-medium bg-white hover:bg-amber-100",children:"Sign Out"})]}),d.jsxs("form",{className:"space-y-6",onSubmit:f,children:[s&&d.jsx("div",{className:"rounded-md bg-red-50 p-4",children:d.jsxs("div",{className:"flex",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),d.jsx("div",{className:"ml-3",children:d.jsx("h3",{className:"text-sm font-medium text-red-800",children:s})})]})}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),d.jsx("div",{className:"mt-1",children:d.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t.email,onChange:h,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm"})})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),d.jsx("div",{className:"mt-1",children:d.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:t.password,onChange:h,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm"})})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-emerald-600 focus:ring-emerald-500 border-gray-300 rounded"}),d.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),d.jsx("div",{className:"text-sm",children:d.jsx(Wn,{to:"/forgot-password",className:"font-medium text-emerald-600 hover:text-emerald-500",children:"Forgot your password?"})})]}),d.jsx("div",{children:d.jsx("button",{type:"submit",disabled:n,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-70 disabled:cursor-not-allowed transition-colors",children:n?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):`Sign in as ${u}`})})]}),d.jsxs("div",{className:"mt-6",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-0 flex items-center",children:d.jsx("div",{className:"w-full border-t border-gray-300"})}),d.jsx("div",{className:"relative flex justify-center text-sm",children:d.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),d.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[d.jsx("div",{children:d.jsxs("a",{href:"#",className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[d.jsx("span",{className:"sr-only",children:"Sign in with Google"}),d.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:d.jsx("path",{d:"M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .307 5.387.307 12s5.56 12 12.173 12c3.573 0 6.267-1.173 8.373-3.36 2.16-2.16 2.84-5.213 2.84-7.667 0-.76-.053-1.467-.173-2.053H12.48z"})})]})}),d.jsx("div",{children:d.jsxs("a",{href:"#",className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[d.jsx("span",{className:"sr-only",children:"Sign in with Aadhaar"}),d.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"})})]})})]})]}),d.jsx("div",{className:"mt-6 text-center",children:d.jsxs("p",{className:"text-sm text-gray-600",children:[c?"Are you a citizen? ":"Are you a government official? ",d.jsx(Wn,{to:c?"/citizen-login":"/official-login",className:"font-medium text-emerald-600 hover:text-emerald-500",children:c?"Citizen Login":"Official Login"})]})})]})})]})}const IJ="modulepreload",_J=function(t){return"/"+t},zP={},Kb=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){let l=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=i?.nonce||i?.getAttribute("nonce");s=l(n.map(c=>{if(c=_J(c),c in zP)return;zP[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":IJ,u||(f.as="script"),f.crossOrigin="",f.href=c,a&&f.setAttribute("nonce",a),document.head.appendChild(f),u)return new Promise((g,y)=>{f.addEventListener("load",g),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return s.then(i=>{for(const a of i||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})},jF=p.createContext(void 0);function mt(){const t=p.useContext(jF);if(t===void 0)throw new Error(["MUI: Could not find the data grid context.","It looks like you rendered your component outside of a DataGrid, DataGridPro or DataGridPremium parent component.","This can also happen if you are bundling multiple versions of the data grid."].join(`
`));return t}const VF=p.createContext(void 0),$e=()=>{const t=p.useContext(VF);if(!t)throw new Error("MUI: useGridRootProps should only be used inside the DataGrid, DataGridPro or DataGridPremium component.");return t},BF=p.createContext(void 0);function ol(){const t=p.useContext(BF);if(t===void 0)throw new Error(["MUI: Could not find the data grid private context.","It looks like you rendered your component outside of a DataGrid, DataGridPro or DataGridPremium parent component.","This can also happen if you are bundling multiple versions of the data grid."].join(`
`));return t}const GP={};function wI(t,e){const n=p.useRef(GP);return n.current===GP&&(n.current=t(e)),n}const AJ=[];function UF(t){p.useEffect(t,AJ)}const Ho=(t,e="warning")=>{let n=!1;const r=Array.isArray(t)?t.join(`
`):t;return()=>{n||(n=!0,e==="error"?console.error(r):console.warn(r))}},SJ=Object.is;function HF(t,e){if(t===e)return!0;if(!(t instanceof Object)||!(e instanceof Object))return!1;let n=0,r=0;for(const s in t)if(n+=1,!SJ(t[s],e[s])||!(s in e))return!1;for(const s in e)r+=1;return n===r}Ho(["MUI: `useGridSelector` has been called before the initialization of the state.","This hook can only be used inside the context of the grid."]);function TJ(t){return t.acceptsApiRef}function WP(t,e){return TJ(e)?e(t):e(t.current.state)}const PJ=Object.is,bI=HF,kJ=()=>({state:null,equals:null,selector:null}),Re=(t,e,n=PJ)=>{const r=wI(kJ),s=r.current.selector!==null,[o,i]=p.useState(s?null:WP(t,e));return r.current.state=o,r.current.equals=n,r.current.selector=e,UF(()=>t.current.store.subscribe(()=>{const a=WP(t,r.current.selector);r.current.equals(r.current.state,a)||(r.current.state=a,i(a))})),o};function pt(t){return jB("MuiDataGrid",t)}const q=x2("MuiDataGrid",["actionsCell","aggregationColumnHeader","aggregationColumnHeader--alignLeft","aggregationColumnHeader--alignCenter","aggregationColumnHeader--alignRight","aggregationColumnHeaderLabel","autoHeight","autosizing","booleanCell","cell--editable","cell--editing","cell--textCenter","cell--textLeft","cell--textRight","cell--withRenderer","cell--rangeTop","cell--rangeBottom","cell--rangeLeft","cell--rangeRight","cell--selectionMode","cell","cellContent","cellCheckbox","cellSkeleton","checkboxInput","columnHeader--alignCenter","columnHeader--alignLeft","columnHeader--alignRight","columnHeader--dragging","columnHeader--moving","columnHeader--numeric","columnHeader--sortable","columnHeader--sorted","columnHeader--filtered","columnHeader","columnHeaderCheckbox","columnHeaderDraggableContainer","columnHeaderDropZone","columnHeaderTitle","columnHeaderTitleContainer","columnHeaderTitleContainerContent","columnGroupHeader","columnHeader--filledGroup","columnHeader--emptyGroup","columnHeader--showColumnBorder","columnHeaders","columnHeadersInner","columnHeadersInner--scrollable","columnSeparator--resizable","columnSeparator--resizing","columnSeparator--sideLeft","columnSeparator--sideRight","columnSeparator","columnsPanel","columnsPanelRow","detailPanel","detailPanels","detailPanelToggleCell","detailPanelToggleCell--expanded","footerCell","panel","panelHeader","panelWrapper","panelContent","panelFooter","paper","editBooleanCell","editInputCell","filterForm","filterFormDeleteIcon","filterFormLogicOperatorInput","filterFormColumnInput","filterFormOperatorInput","filterFormValueInput","filterIcon","footerContainer","headerFilterRow","iconButtonContainer","iconSeparator","main","menu","menuIcon","menuIconButton","menuOpen","menuList","overlay","overlayWrapper","overlayWrapperInner","root","root--densityStandard","root--densityComfortable","root--densityCompact","root--disableUserSelection","row","row--editable","row--editing","row--lastVisible","row--dragging","row--dynamicHeight","row--detailPanelExpanded","rowReorderCellPlaceholder","rowCount","rowReorderCellContainer","rowReorderCell","rowReorderCell--draggable","scrollArea--left","scrollArea--right","scrollArea","selectedRowCount","sortIcon","toolbarContainer","toolbarFilterList","virtualScroller","virtualScrollerContent","virtualScrollerContent--overflowed","virtualScrollerRenderZone","pinnedColumns","pinnedColumns--left","pinnedColumns--right","pinnedColumnHeaders","pinnedColumnHeaders--left","pinnedColumnHeaders--right","withBorderColor","cell--withRightBorder","columnHeader--withRightBorder","treeDataGroupingCell","treeDataGroupingCellToggle","groupingCriteriaCell","groupingCriteriaCellToggle","pinnedRows","pinnedRows--top","pinnedRows--bottom","pinnedRowsRenderZone"]);var Aw="NOT_FOUND";function RJ(t){var e;return{get:function(r){return e&&t(e.key,r)?e.value:Aw},put:function(r,s){e={key:r,value:s}},getEntries:function(){return e?[e]:[]},clear:function(){e=void 0}}}function NJ(t,e){var n=[];function r(a){var l=n.findIndex(function(u){return e(a,u.key)});if(l>-1){var c=n[l];return l>0&&(n.splice(l,1),n.unshift(c)),c.value}return Aw}function s(a,l){r(a)===Aw&&(n.unshift({key:a,value:l}),n.length>t&&n.pop())}function o(){return n}function i(){n=[]}return{get:r,put:s,getEntries:o,clear:i}}var DJ=function(e,n){return e===n};function MJ(t){return function(n,r){if(n===null||r===null||n.length!==r.length)return!1;for(var s=n.length,o=0;o<s;o++)if(!t(n[o],r[o]))return!1;return!0}}function qb(t,e){var n=typeof e=="object"?e:{equalityCheck:e},r=n.equalityCheck,s=r===void 0?DJ:r,o=n.maxSize,i=o===void 0?1:o,a=n.resultEqualityCheck,l=MJ(s),c=i===1?RJ(l):NJ(i,l);function u(){var h=c.get(arguments);if(h===Aw){if(h=t.apply(null,arguments),a){var f=c.getEntries(),g=f.find(function(y){return a(y.value,h)});g&&(h=g.value)}c.put(arguments,h)}return h}return u.clearCache=function(){return c.clear()},u}function OJ(t){var e=Array.isArray(t[0])?t[0]:t;if(!e.every(function(r){return typeof r=="function"})){var n=e.map(function(r){return typeof r=="function"?"function "+(r.name||"unnamed")+"()":typeof r}).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return e}function LJ(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var s=function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var c=0,u,h={memoizeOptions:void 0},f=a.pop();if(typeof f=="object"&&(h=f,f=a.pop()),typeof f!="function")throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof f+"]");var g=h,y=g.memoizeOptions,w=y===void 0?n:y,v=Array.isArray(w)?w:[w],C=OJ(a),x=t.apply(void 0,[function(){return c++,f.apply(null,arguments)}].concat(v)),A=t(function(){for(var M=[],k=C.length,E=0;E<k;E++)M.push(C[E].apply(null,arguments));return u=x.apply(null,M),u});return Object.assign(A,{resultFunc:f,memoizedResultFunc:x,dependencies:C,lastResult:function(){return u},recomputations:function(){return c},resetRecomputations:function(){return c=0}}),A};return s}var FJ=LJ(qb);const jJ={cache:new WeakMap};Ho(["MUI: A selector was called without passing the instance ID, which may impact the performance of the grid.","To fix, call it with `apiRef`, e.g. `mySelector(apiRef)`, or pass the instance ID explicitly, e.g. `mySelector(state, apiRef.current.instanceId)`."]);function pC(t){return"current"in t&&"instanceId"in t.current}const gC={id:"default"},nt=(t,e,n,r,s,o,...i)=>{if(i.length>0)throw new Error("Unsupported number of selectors");let a;if(t&&e&&n)a=(l,c)=>{const u=pC(l),h=c??(u?l.current.instanceId:gC),f=u?l.current.state:l,g=t(f,h),y=e(f,h);return n(g,y)};else if(t&&e)a=(l,c)=>{const u=pC(l),h=c??(u?l.current.instanceId:gC),f=u?l.current.state:l,g=t(f,h);return e(g)};else throw new Error("Missing arguments");return a.acceptsApiRef=!0,a},Kt=(...t)=>{const e=(...n)=>{var r,s;const[o,i]=n,a=pC(o),l=a?o.current.instanceId:i??gC,c=a?o.current.state:o,{cache:u}=jJ;if(u.get(l)&&(r=u.get(l))!=null&&r.get(t)){var h;return(h=u.get(l))==null?void 0:h.get(t)(c,l)}const f=FJ(...t);return u.get(l)||u.set(l,new Map),(s=u.get(l))==null||s.set(t,f),f(c,l)};return e.acceptsApiRef=!0,e},wc=t=>t.columns,wi=nt(wc,t=>t.orderedFields),Oh=nt(wc,t=>t.lookup),Mo=Kt(wi,Oh,(t,e)=>t.map(n=>e[n])),Gs=nt(wc,t=>t.columnVisibilityModel),Qn=Kt(Mo,Gs,(t,e)=>t.filter(n=>e[n.field]!==!1)),Qb=Kt(Qn,t=>t.map(e=>e.field)),ah=Kt(Qn,t=>{const e=[];let n=0;for(let r=0;r<t.length;r+=1)e.push(n),n+=t[r].computedWidth;return e}),vI=nt(Qn,ah,(t,e)=>{const n=t.length;return n===0?0:e[n-1]+t[n-1].computedWidth}),$F=Kt(Mo,t=>t.filter(e=>e.filterable)),VJ=Kt(Mo,t=>t.reduce((e,n)=>(n.filterable&&(e[n.field]=n),e),{})),Yb=t=>t.columnGrouping,BJ=Kt(Yb,t=>{var e;return(e=t?.unwrappedGroupingModel)!=null?e:{}}),zF=Kt(Yb,t=>{var e;return(e=t?.lookup)!=null?e:{}}),UJ=Kt(Yb,t=>{var e;return(e=t?.headerStructure)!=null?e:[]}),Qp=nt(Yb,t=>{var e;return(e=t?.maxDepth)!=null?e:0}),Xs=t=>t.rows,Jb=nt(Xs,t=>t.totalRowCount),HJ=nt(Xs,t=>t.loading),$J=nt(Xs,t=>t.totalTopLevelRowCount),mi=nt(Xs,t=>t.dataRowIdToModelLookup),Sw=nt(Xs,t=>t.dataRowIdToIdLookup),Us=nt(Xs,t=>t.tree),zJ=nt(Xs,t=>t.groupingName),KP=nt(Xs,t=>t.treeDepths),Xb=Kt(Xs,t=>{const e=Object.entries(t.treeDepths);return e.length===0?1:e.filter(([,n])=>n>0).map(([n])=>Number(n)).sort((n,r)=>r-n)[0]+1}),Bf=nt(Xs,t=>t.dataRowIds),GJ=nt(Xs,t=>t?.additionalRowGroups),Lh=Kt(GJ,t=>{var e,n;const r=t?.pinnedRows;return{bottom:r==null||(e=r.bottom)==null?void 0:e.map(s=>{var o;return{id:s.id,model:(o=s.model)!=null?o:{}}}),top:r==null||(n=r.top)==null?void 0:n.map(s=>{var o;return{id:s.id,model:(o=s.model)!=null?o:{}}})}}),WJ=nt(Lh,t=>{var e,n;return((t==null||(e=t.top)==null?void 0:e.length)||0)+((t==null||(n=t.bottom)==null?void 0:n.length)||0)}),GF=()=>{var t;const e=ol(),n=$e(),r=Re(e,Qn),s=Re(e,Jb),o=Re(e,Qp),i=Re(e,WJ);let a="grid";return(t=n.experimentalFeatures)!=null&&t.ariaV7&&n.treeData&&(a="treegrid"),{role:a,"aria-colcount":r.length,"aria-rowcount":o+1+i+s,"aria-multiselectable":!n.disableMultipleRowSelection}},KJ=t=>{const{classes:e}=t;return ft({root:["main"]},pt,e)},qJ=Zn("div",{name:"MuiDataGrid",slot:"Main",overridesResolver:(t,e)=>e.main})(()=>({position:"relative",flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden"})),QJ=p.forwardRef((t,e)=>{var n;const r=$e(),s=KJ(r),o=(n=r.experimentalFeatures)!=null&&n.ariaV7?GF:null,i=typeof o=="function"?o():null;return d.jsx(qJ,B({ref:e,className:s.root,ownerState:r},i,{children:t.children}))}),WF=t=>t.sorting,xI=nt(WF,t=>t.sortedRows),CI=Kt(xI,mi,(t,e)=>t.map(n=>{var r;return{id:n,model:(r=e[n])!=null?r:{}}})),ps=nt(WF,t=>t.sortModel),YJ=Kt(ps,t=>t.reduce((n,r,s)=>(n[r.field]={sortDirection:r.sort,sortIndex:t.length>1?s+1:void 0},n),{})),EI=t=>t.filter,Ln=nt(EI,t=>t.filterModel);nt(Ln,t=>t.quickFilterValues);const JJ=t=>t.visibleRowsLookup,KF=nt(EI,t=>t.filteredRowsLookup);nt(EI,t=>t.filteredDescendantCountLookup);const il=Kt(JJ,CI,(t,e)=>e.filter(n=>t[n.id]!==!1)),mm=Kt(il,t=>t.map(e=>e.id)),XJ=Kt(KF,CI,(t,e)=>e.filter(n=>t[n.id]!==!1)),ZJ=Kt(XJ,t=>t.map(e=>e.id)),qF=Kt(il,Us,Xb,(t,e,n)=>n<2?t:t.filter(r=>{var s;return((s=e[r.id])==null?void 0:s.depth)===0})),QF=nt(il,t=>t.length),YF=nt(qF,t=>t.length),eX=Kt(Ln,Oh,(t,e)=>{var n;return(n=t.items)==null?void 0:n.filter(r=>{var s,o;if(!r.field)return!1;const i=e[r.field];if(!(i!=null&&i.filterOperators)||(i==null||(s=i.filterOperators)==null?void 0:s.length)===0)return!1;const a=i.filterOperators.find(l=>l.value===r.operator);return a?!a.InputComponent||r.value!=null&&((o=r.value)==null?void 0:o.toString())!=="":!1})}),tX=Kt(eX,t=>t.reduce((n,r)=>(n[r.field]?n[r.field].push(r):n[r.field]=[r],n),{})),Zb=t=>t.focus,Kr=nt(Zb,t=>t.cell),nX=nt(Zb,t=>t.columnHeader);nt(Zb,t=>t.columnHeaderFilter);const Tw=nt(Zb,t=>t.columnGroupHeader),e0=t=>t.tabIndex,Pw=nt(e0,t=>t.cell),JF=nt(e0,t=>t.columnHeader);nt(e0,t=>t.columnHeaderFilter);const rX=nt(e0,t=>t.columnGroupHeader),II=t=>t.density,sX=nt(II,t=>t.value),Fh=nt(II,t=>t.factor),yC=t=>t.columnMenu;function oX(t){const{VirtualScrollerComponent:e,ColumnHeadersProps:n,children:r}=t,s=ol(),o=$e(),i=p.useRef(null),a=Re(s,Qn),l=Re(s,tX),c=Re(s,YJ),u=Re(s,ah),h=Re(s,JF),f=Re(s,Pw),g=Re(s,rX),y=Re(s,nX),w=Re(s,Tw),v=Re(s,Fh),C=Re(s,Qp),x=Re(s,yC),A=Re(s,Gs),N=Re(s,UJ),M=!(g===null&&h===null&&f===null);Yn(()=>{s.current.computeSizeAndPublishResizeEvent();const P=i.current;if(typeof ResizeObserver>"u")return()=>{};let S;const D=new ResizeObserver(()=>{S=requestAnimationFrame(()=>{s.current.computeSizeAndPublishResizeEvent()})});return P&&D.observe(P),()=>{S&&window.cancelAnimationFrame(S),P&&D.unobserve(P)}},[s]);const k=p.useRef(null),E=p.useRef(null),b=p.useRef(null);s.current.register("private",{columnHeadersContainerElementRef:E,columnHeadersElementRef:k,virtualScrollerRef:b,mainElementRef:i});const I=!!s.current.getRootDimensions();return d.jsxs(QJ,{ref:i,children:[d.jsx(o.slots.columnHeaders,B({ref:E,innerRef:k,visibleColumns:a,filterColumnLookup:l,sortColumnLookup:c,columnPositions:u,columnHeaderTabIndexState:h,columnGroupHeaderTabIndexState:g,columnHeaderFocus:y,columnGroupHeaderFocus:w,densityFactor:v,headerGroupingMaxDepth:C,columnMenuState:x,columnVisibility:A,columnGroupsHeaderStructure:N,hasOtherElementInTabSequence:M},n)),I&&d.jsx(e,{ref:b}),r]})}function iX(){var t;const e=$e();return e.hideFooter?null:d.jsx(e.slots.footer,B({},(t=e.slotProps)==null?void 0:t.footer))}function XF(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=XF(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function At(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=XF(t))&&(r&&(r+=" "),r+=e);return r}const yr="auto-generated-group-node-root",Yu=Symbol("mui.id_autogenerated"),aX=()=>({type:"group",id:yr,depth:-1,groupingField:null,groupingKey:null,isAutoGenerated:!0,children:[],childrenFromPath:{},childrenExpanded:!0,parent:null});function lX(t,e,n="A row was provided without id in the rows prop:"){if(t==null)throw new Error(["MUI: The data grid component requires all rows to have a unique `id` property.","Alternatively, you can use the `getRowId` prop to specify a custom id for each row.",n,JSON.stringify(e)].join(`
`))}const kw=(t,e,n)=>{const r=e?e(t):t.id;return lX(r,t,n),r},Ey=({rows:t,getRowId:e,loading:n,rowCount:r})=>{const s={type:"full",rows:[]},o={},i={};for(let a=0;a<t.length;a+=1){const l=t[a],c=kw(l,e);o[c]=l,i[c]=c,s.rows.push(c)}return{rowsBeforePartialUpdates:t,loadingPropBeforePartialUpdates:n,rowCountPropBeforePartialUpdates:r,updates:s,dataRowIdToIdLookup:i,dataRowIdToModelLookup:o}},ZF=({tree:t,rowCountProp:e=0})=>{const n=t[yr];return Math.max(e,n.children.length+(n.footerId==null?0:1))},ej=({apiRef:t,rowCountProp:e=0,loadingProp:n,previousTree:r,previousTreeDepths:s})=>{const o=t.current.caches.rows,{tree:i,treeDepths:a,dataRowIds:l,groupingName:c}=t.current.applyStrategyProcessor("rowTreeCreation",{previousTree:r,previousTreeDepths:s,updates:o.updates,dataRowIdToIdLookup:o.dataRowIdToIdLookup,dataRowIdToModelLookup:o.dataRowIdToModelLookup}),u=t.current.unstable_applyPipeProcessors("hydrateRows",{tree:i,treeDepths:a,dataRowIdToIdLookup:o.dataRowIdToIdLookup,dataRowIds:l,dataRowIdToModelLookup:o.dataRowIdToModelLookup});return t.current.caches.rows.updates={type:"partial",actions:{insert:[],modify:[],remove:[]},idToActionLookup:{}},B({},u,{totalRowCount:Math.max(e,u.dataRowIds.length),totalTopLevelRowCount:ZF({tree:u.tree,rowCountProp:e}),groupingName:c,loading:n})},Hm=t=>t.type==="skeletonRow"||t.type==="footer"||t.type==="group"&&t.isAutoGenerated||t.type==="pinnedRow"&&t.isAutoGenerated,_I=(t,e,n)=>{const r=t[e];if(r.type!=="group")return[];const s=[];for(let o=0;o<r.children.length;o+=1){const i=r.children[o];(!n||!Hm(t[i]))&&s.push(i);const a=_I(t,i,n);for(let l=0;l<a.length;l+=1)s.push(a[l])}return!n&&r.footerId!=null&&s.push(r.footerId),s},cX=({previousCache:t,getRowId:e,updates:n})=>{var r,s,o;if(t.updates.type==="full")throw new Error("MUI: Unable to prepare a partial update if a full update is not applied yet");const i=new Map;n.forEach(f=>{const g=kw(f,e,"A row was provided without id when calling updateRows():");i.has(g)?i.set(g,B({},i.get(g),f)):i.set(g,f)});const a={type:"partial",actions:{insert:[...(r=t.updates.actions.insert)!=null?r:[]],modify:[...(s=t.updates.actions.modify)!=null?s:[]],remove:[...(o=t.updates.actions.remove)!=null?o:[]]},idToActionLookup:B({},t.updates.idToActionLookup)},l=B({},t.dataRowIdToModelLookup),c=B({},t.dataRowIdToIdLookup),u={insert:{},modify:{},remove:{}};i.forEach((f,g)=>{const y=a.idToActionLookup[g];if(f._action==="delete"){if(y==="remove"||!l[g])return;y!=null&&(u[y][g]=!0),a.actions.remove.push(g),delete l[g],delete c[g];return}const w=l[g];if(w){y==="remove"?(u.remove[g]=!0,a.actions.modify.push(g)):y==null&&a.actions.modify.push(g),l[g]=B({},w,f);return}y==="remove"?(u.remove[g]=!0,a.actions.insert.push(g)):y==null&&a.actions.insert.push(g),l[g]=f,c[g]=g});const h=Object.keys(u);for(let f=0;f<h.length;f+=1){const g=h[f],y=u[g];Object.keys(y).length>0&&(a.actions[g]=a.actions[g].filter(w=>!y[w]))}return{dataRowIdToModelLookup:l,dataRowIdToIdLookup:c,updates:a,rowsBeforePartialUpdates:t.rowsBeforePartialUpdates,loadingPropBeforePartialUpdates:t.loadingPropBeforePartialUpdates,rowCountPropBeforePartialUpdates:t.rowCountPropBeforePartialUpdates}};function tj(t){var e,n;const r=Lh(t),s=(r==null||(e=r.top)==null?void 0:e.reduce((i,a)=>(i+=t.current.unstable_getRowHeight(a.id),i),0))||0,o=(r==null||(n=r.bottom)==null?void 0:n.reduce((i,a)=>(i+=t.current.unstable_getRowHeight(a.id),i),0))||0;return{top:s,bottom:o}}function nj(t,e){const n=Fh(t);return`var(--DataGrid-overlayHeight, ${2*Math.floor(e*n)}px)`}const uX=Zn("div",{name:"MuiDataGrid",slot:"OverlayWrapper",shouldForwardProp:t=>t!=="overlayType",overridesResolver:(t,e)=>e.overlayWrapper})(({overlayType:t})=>({position:"sticky",top:0,left:0,width:0,height:0,zIndex:t==="loadingOverlay"?5:4})),dX=Zn("div",{name:"MuiDataGrid",slot:"OverlayWrapperInner",shouldForwardProp:t=>t!=="overlayType",overridesResolver:(t,e)=>e.overlayWrapperInner})({}),hX=t=>{const{classes:e}=t;return ft({root:["overlayWrapper"],inner:["overlayWrapperInner"]},pt,e)};function fX(t){var e,n;const r=mt(),s=$e(),[o,i]=p.useState(()=>{var u,h;return(u=(h=r.current.getRootDimensions())==null?void 0:h.viewportInnerSize)!=null?u:null}),a=p.useCallback(()=>{var u,h;i((u=(h=r.current.getRootDimensions())==null?void 0:h.viewportInnerSize)!=null?u:null)},[r]);Yn(()=>r.current.subscribeEvent("viewportInnerSizeChange",a),[r,a]);let l=(e=o?.height)!=null?e:0;s.autoHeight&&l===0&&(l=nj(r,s.rowHeight));const c=hX(B({},t,{classes:s.classes}));return o?d.jsx(uX,{className:At(c.root),overlayType:t.overlayType,children:d.jsx(dX,B({className:At(c.inner),style:{height:l,width:(n=o?.width)!=null?n:0}},t))}):null}function mX(){const t=mt(),e=$e(),n=Re(t,Jb),r=Re(t,QF),s=Re(t,HJ),o=!s&&n===0,i=!s&&n>0&&r===0;let a=null,l="";if(o){var c;a=d.jsx(e.slots.noRowsOverlay,B({},(c=e.slotProps)==null?void 0:c.noRowsOverlay)),l="noRowsOverlay"}if(i){var u;a=d.jsx(e.slots.noResultsOverlay,B({},(u=e.slotProps)==null?void 0:u.noResultsOverlay)),l="noResultsOverlay"}if(s){var h;a=d.jsx(e.slots.loadingOverlay,B({},(h=e.slotProps)==null?void 0:h.loadingOverlay)),l="loadingOverlay"}return a===null?null:d.jsx(fX,{overlayType:l,children:a})}function t0(t){return p.memo(t,HF)}let Pv;function pX(){return Pv===void 0&&document.createElement("div").focus({get preventScroll(){return Pv=!0,!1}}),Pv}var Bo=(function(t){return t.Cell="cell",t.Row="row",t})(Bo||{}),kt=(function(t){return t.Edit="edit",t.View="view",t})(kt||{}),Vt=(function(t){return t.Edit="edit",t.View="view",t})(Vt||{}),Rr=(function(t){return t.And="and",t.Or="or",t})(Rr||{}),Ko=(function(t){return t.enterKeyDown="enterKeyDown",t.cellDoubleClick="cellDoubleClick",t.printableKeyDown="printableKeyDown",t.deleteKeyDown="deleteKeyDown",t.pasteKeyDown="pasteKeyDown",t})(Ko||{}),Ds=(function(t){return t.cellFocusOut="cellFocusOut",t.escapeKeyDown="escapeKeyDown",t.enterKeyDown="enterKeyDown",t.tabKeyDown="tabKeyDown",t.shiftTabKeyDown="shiftTabKeyDown",t})(Ds||{}),ea=(function(t){return t.enterKeyDown="enterKeyDown",t.cellDoubleClick="cellDoubleClick",t.printableKeyDown="printableKeyDown",t.deleteKeyDown="deleteKeyDown",t})(ea||{}),qo=(function(t){return t.rowFocusOut="rowFocusOut",t.escapeKeyDown="escapeKeyDown",t.enterKeyDown="enterKeyDown",t.tabKeyDown="tabKeyDown",t.shiftTabKeyDown="shiftTabKeyDown",t})(qo||{});function rj(t){return t.field!==void 0}function gX(t){return t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth}function yX(t,e){return t.closest(`.${e}`)}function AI(t){return t.replace(/["\\]/g,"\\$&")}function wX(t,e){return t.querySelector(`[role="columnheader"][data-field="${AI(e)}"]`)}function sj(t){return`.${q.row}[data-id="${AI(String(t))}"]`}function bX(t,e){return t.querySelector(sj(e))}function vX(t,{id:e,field:n}){const r=sj(e),s=`.${q.cell}[data-field="${AI(n)}"]`,o=`${r} ${s}`;return t.querySelector(o)}function Yp(t){return t.target.nodeType===1&&!t.currentTarget.contains(t.target)}function rt(t,e,n){const r=p.useRef(!0);p.useEffect(()=>{r.current=!1,t.current.register(n,e)},[t,n,e]),r.current&&t.current.register(n,e)}class Fu extends Error{}function xX(t,e){const{getRowId:n}=e,r=p.useCallback(y=>({field:y,colDef:t.current.getColumn(y)}),[t]),s=p.useCallback(y=>{const w=t.current.getRow(y);if(!w)throw new Fu(`No row with id #${y} found`);return{id:y,columns:t.current.getAllColumns(),row:w}},[t]),o=p.useCallback((y,w)=>{const v=t.current.getRow(y),C=t.current.getRowNode(y);if(!v||!C)throw new Fu(`No row with id #${y} found`);const x=Kr(t),A=Pw(t);return{id:y,field:w,row:v,rowNode:C,value:v[w],colDef:t.current.getColumn(w),cellMode:t.current.getCellMode(y,w),api:t.current,hasFocus:x!==null&&x.field===w&&x.id===y,tabIndex:A&&A.field===w&&A.id===y?0:-1}},[t]),i=p.useCallback((y,w)=>{const v=t.current.getColumn(w),C=t.current.getCellValue(y,w),x=t.current.getRow(y),A=t.current.getRowNode(y);if(!x||!A)throw new Fu(`No row with id #${y} found`);const N=Kr(t),M=Pw(t),k={id:y,field:w,row:x,rowNode:A,colDef:v,cellMode:t.current.getCellMode(y,w),hasFocus:N!==null&&N.field===w&&N.id===y,tabIndex:M&&M.field===w&&M.id===y?0:-1,value:C,formattedValue:C,isEditable:!1};return v&&v.valueFormatter&&(k.formattedValue=v.valueFormatter({id:y,field:k.field,value:k.value,api:t.current})),k.isEditable=v&&t.current.isCellEditable(k),k},[t]),a=p.useCallback((y,w)=>{const v=t.current.getColumn(w);if(!v||!v.valueGetter){const C=t.current.getRow(y);if(!C)throw new Fu(`No row with id #${y} found`);return C[w]}return v.valueGetter(o(y,w))},[t,o]),l=p.useCallback((y,w)=>{var v;const C=Yu in y?y[Yu]:(v=n?.(y))!=null?v:y.id,x=w.field;return!w||!w.valueGetter?y[x]:w.valueGetter(o(C,x))},[o,n]),c=p.useCallback((y,w)=>{var v;const C=l(y,w);if(!w||!w.valueFormatter)return C;const x=(v=n?n(y):y.id)!=null?v:y[Yu],A=w.field;return w.valueFormatter({id:x,field:A,value:C,api:t.current})},[t,n,l]),u=p.useCallback(y=>t.current.rootElementRef.current?wX(t.current.rootElementRef.current,y):null,[t]),h=p.useCallback(y=>t.current.rootElementRef.current?bX(t.current.rootElementRef.current,y):null,[t]),f=p.useCallback((y,w)=>t.current.rootElementRef.current?vX(t.current.rootElementRef.current,{id:y,field:w}):null,[t]);rt(t,{getCellValue:a,getCellParams:i,getCellElement:f,getRowValue:l,getRowFormattedValue:c,getRowParams:s,getRowElement:h,getColumnHeaderParams:r,getColumnHeaderElement:u},"public")}const CX=["changeReason","unstable_updateValueOnRender"],EX=["column","rowId","editCellState","align","children","colIndex","height","width","className","showRightBorder","extendRowFullWidth","row","colSpan","disableDragEvents","isNotVisible","onClick","onDoubleClick","onMouseDown","onMouseUp","onMouseOver","onKeyDown","onKeyUp","onDragEnter","onDragOver","style"],IX=["changeReason","unstable_updateValueOnRender"],Rw={id:-1,field:"__unset__",row:{},rowNode:{id:-1,depth:0,type:"leaf",parent:-1,groupingKey:null},colDef:{type:"string",field:"__unset__",computedWidth:0},cellMode:kt.View,hasFocus:!1,tabIndex:-1,value:null,formattedValue:"__unset__",isEditable:!1,api:{}},_X=t=>{const{align:e,showRightBorder:n,isEditable:r,isSelected:s,isSelectionMode:o,classes:i}=t,a={root:["cell",`cell--text${Ec(e)}`,r&&"cell--editable",s&&"selected",n&&"cell--withRightBorder",o&&!r&&"cell--selectionMode","withBorderColor"],content:["cellContent"]};return ft(a,pt,i)},AX=p.forwardRef((t,e)=>{const{column:n,rowId:r,editCellState:s}=t,o=mt(),i=$e(),a=n.field,l=Re(o,()=>{try{const I=o.current.getCellParams(r,a);return I.api=o.current,I}catch(b){if(b instanceof Fu)return Rw;throw b}},bI),c=Re(o,()=>o.current.unstable_applyPipeProcessors("isCellSelected",!1,{id:r,field:a}));if(l===Rw)return null;const{cellMode:u,hasFocus:h,isEditable:f,value:g,formattedValue:y}=l,w=n.type==="actions",v=(u==="view"||!f)&&!w?l.tabIndex:-1,{classes:C,getCellClassName:x}=i,A=o.current.unstable_applyPipeProcessors("cellClassName",[],{id:r,field:a});n.cellClassName&&A.push(typeof n.cellClassName=="function"?n.cellClassName(l):n.cellClassName),x&&A.push(x(l));let N;if(s==null&&n.renderCell&&(N=n.renderCell(l),A.push(q["cell--withRenderer"]),A.push(C?.["cell--withRenderer"])),s!=null&&n.renderEditCell){const b=o.current.getRowWithUpdatedValues(r,n.field),I=He(s,CX),P=B({},l,{row:b},I);N=n.renderEditCell(P),A.push(q["cell--editing"]),A.push(C?.["cell--editing"])}const{slots:M}=i,k=M.cell,E=B({},t,{ref:e,field:a,formattedValue:y,hasFocus:h,isEditable:f,isSelected:c,value:g,cellMode:u,children:N,tabIndex:v,className:At(A)});return p.createElement(k,E)}),SX=t0(AX),TX=p.forwardRef((t,e)=>{var n,r,s,o;const{column:i,rowId:a,editCellState:l,align:c,colIndex:u,height:h,width:f,className:g,showRightBorder:y,colSpan:w,disableDragEvents:v,isNotVisible:C,onClick:x,onDoubleClick:A,onMouseDown:N,onMouseUp:M,onMouseOver:k,onKeyDown:E,onKeyUp:b,onDragEnter:I,onDragOver:P,style:S}=t,D=He(t,EX),T=mt(),j=$e(),R=i.field,V=Re(T,()=>{try{const Se=T.current.getCellParams(a,R);return Se.api=T.current,Se}catch(be){if(be instanceof Fu)return Rw;throw be}},bI),U=Re(T,()=>T.current.unstable_applyPipeProcessors("isCellSelected",!1,{id:a,field:R})),{cellMode:F,hasFocus:$,isEditable:W,value:Z,formattedValue:Y}=V,le=i.type==="actions"&&((n=(r=i).getActions)==null?void 0:n.call(r,T.current.getRowParams(a)).some(be=>!be.props.disabled)),fe=(F==="view"||!W)&&!le?V.tabIndex:-1,{classes:we,getCellClassName:Me}=j,Ee=T.current.unstable_applyPipeProcessors("cellClassName",[],{id:a,field:R});i.cellClassName&&Ee.push(typeof i.cellClassName=="function"?i.cellClassName(V):i.cellClassName),Me&&Ee.push(Me(V));const X=Y??Z,ue=p.useRef(null),re=Kc(e,ue),ie=p.useRef(null),Ce=(s=j.unstable_cellSelection)!=null?s:!1,K={align:c,showRightBorder:y,isEditable:W,classes:j.classes,isSelected:U,isSelectionMode:Ce},me=_X(K),Q=p.useCallback(be=>Se=>{const De=T.current.getCellParams(a,R||"");T.current.publishEvent(be,De,Se),M&&M(Se)},[T,R,M,a]),ee=p.useCallback(be=>Se=>{const De=T.current.getCellParams(a,R||"");T.current.publishEvent(be,De,Se),N&&N(Se)},[T,R,N,a]),de=p.useCallback((be,Se)=>De=>{if(!T.current.getRow(a))return;const Ye=T.current.getCellParams(a,R||"");T.current.publishEvent(be,Ye,De),Se&&Se(De)},[T,R,a]),ye=p.useMemo(()=>C?B({padding:0,opacity:0,width:0,border:0},S):B({minWidth:f,maxWidth:f,minHeight:h,maxHeight:h==="auto"?"none":h},S),[f,h,C,S]);if(p.useEffect(()=>{if(!$||F===kt.Edit)return;const be=ib(T.current.rootElementRef.current);if(ue.current&&!ue.current.contains(be.activeElement)){const Se=ue.current.querySelector('[tabindex="0"]'),De=ie.current||Se||ue.current;if(pX())De.focus({preventScroll:!0});else{const Ye=T.current.getScrollPosition();De.focus(),T.current.scroll(Ye)}}},[$,F,T]),V===Rw)return null;let pe=D.onFocus,_e;if(l==null&&i.renderCell&&(_e=i.renderCell(V),Ee.push(q["cell--withRenderer"]),Ee.push(we?.["cell--withRenderer"])),l!=null&&i.renderEditCell){const be=T.current.getRowWithUpdatedValues(a,i.field),Se=He(l,IX),De=B({},V,{row:be},Se);_e=i.renderEditCell(De),Ee.push(q["cell--editing"]),Ee.push(we?.["cell--editing"])}if(_e===void 0){const be=X?.toString();_e=d.jsx("div",{className:me.content,title:be,role:"presentation",children:be})}p.isValidElement(_e)&&le&&(_e=p.cloneElement(_e,{focusElementRef:ie}));const qe=v?null:{onDragEnter:de("cellDragEnter",I),onDragOver:de("cellDragOver",P)},Ie=(o=j.experimentalFeatures)==null?void 0:o.ariaV7;return d.jsx("div",B({ref:re,className:At(g,Ee,me.root),role:Ie?"gridcell":"cell","data-field":R,"data-colindex":u,"aria-colindex":u+1,"aria-colspan":w,style:ye,tabIndex:fe,onClick:de("cellClick",x),onDoubleClick:de("cellDoubleClick",A),onMouseOver:de("cellMouseOver",k),onMouseDown:ee("cellMouseDown"),onMouseUp:Q("cellMouseUp"),onKeyDown:de("cellKeyDown",E),onKeyUp:de("cellKeyUp",b)},qe,D,{onFocus:pe,children:_e}))}),wC=t0(TX),PX=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","hasFocus","tabIndex"],kX=t=>{const{classes:e}=t;return ft({root:["booleanCell"]},pt,e)};function RX(t){const{value:e}=t,n=He(t,PX),r=mt(),s=$e(),o={classes:s.classes},i=kX(o),a=p.useMemo(()=>e?s.slots.booleanCellTrueIcon:s.slots.booleanCellFalseIcon,[s.slots.booleanCellFalseIcon,s.slots.booleanCellTrueIcon,e]);return d.jsx(a,B({fontSize:"small",className:i.root,titleAccess:r.current.getLocaleText(e?"booleanCellTrueLabel":"booleanCellFalseLabel"),"data-value":!!e},n))}const NX=p.memo(RX),DX=t=>Hm(t.rowNode)?"":d.jsx(NX,B({},t)),MX=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","className","hasFocus","isValidating","isProcessingProps","error","onValueChange"],OX=t=>{const{classes:e}=t;return ft({root:["editBooleanCell"]},pt,e)};function LX(t){var e;const{id:n,value:r,field:s,className:o,hasFocus:i,onValueChange:a}=t,l=He(t,MX),c=mt(),u=p.useRef(null),h=En(),[f,g]=p.useState(r),y=$e(),w={classes:y.classes},v=OX(w),C=p.useCallback(async x=>{const A=x.target.checked;a&&await a(x,A),g(A),await c.current.setEditCellValue({id:n,field:s,value:A},x)},[c,s,n,a]);return p.useEffect(()=>{g(r)},[r]),Yn(()=>{i&&u.current.focus()},[i]),d.jsx("label",B({htmlFor:h,className:At(v.root,o)},l,{children:d.jsx(y.slots.baseCheckbox,B({id:h,inputRef:u,checked:!!f,onChange:C,size:"small"},(e=y.slotProps)==null?void 0:e.baseCheckbox))}))}const FX=t=>d.jsx(LX,B({},t)),jX=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","hasFocus","inputProps","isValidating","isProcessingProps","onValueChange"],VX=bn(C2)({fontSize:"inherit"}),BX=t=>{const{classes:e}=t;return ft({root:["editInputCell"]},pt,e)};function UX(t){const{id:e,value:n,field:r,colDef:s,hasFocus:o,inputProps:i,onValueChange:a}=t,l=He(t,jX),c=s.type==="dateTime",u=mt(),h=p.useRef(),f=p.useMemo(()=>{let N;n==null?N=null:n instanceof Date?N=n:N=new Date((n??"").toString());let M;return N==null||Number.isNaN(N.getTime())?M="":M=new Date(N.getTime()-N.getTimezoneOffset()*60*1e3).toISOString().substr(0,c?16:10),{parsed:N,formatted:M}},[n,c]),[g,y]=p.useState(f),v={classes:$e().classes},C=BX(v),x=p.useCallback(N=>{if(N==="")return null;const[M,k]=N.split("T"),[E,b,I]=M.split("-"),P=new Date;if(P.setFullYear(Number(E),Number(b)-1,Number(I)),P.setHours(0,0,0,0),k){const[S,D]=k.split(":");P.setHours(Number(S),Number(D),0,0)}return P},[]),A=p.useCallback(async N=>{const M=N.target.value,k=x(M);a&&await a(N,k),y({parsed:k,formatted:M}),u.current.setEditCellValue({id:e,field:r,value:k},N)},[u,r,e,a,x]);return p.useEffect(()=>{y(N=>{var M,k;return f.parsed!==N.parsed&&((M=f.parsed)==null?void 0:M.getTime())!==((k=N.parsed)==null?void 0:k.getTime())?f:N})},[f]),Yn(()=>{o&&h.current.focus()},[o]),d.jsx(VX,B({inputRef:h,fullWidth:!0,className:C.root,type:c?"datetime-local":"date",inputProps:B({max:c?"9999-12-31T23:59":"9999-12-31"},i),value:g.formatted,onChange:A},l))}const oj=t=>d.jsx(UX,B({},t)),HX=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","hasFocus","isValidating","debounceMs","isProcessingProps","onValueChange"],$X=t=>{const{classes:e}=t;return ft({root:["editInputCell"]},pt,e)},zX=bn(C2,{name:"MuiDataGrid",slot:"EditInputCell",overridesResolver:(t,e)=>e.editInputCell})(({theme:t})=>B({},t.typography.body2,{padding:"1px 0","& input":{padding:"0 16px",height:"100%"}})),GX=p.forwardRef((t,e)=>{const n=$e(),{id:r,value:s,field:o,colDef:i,hasFocus:a,debounceMs:l=200,isProcessingProps:c,onValueChange:u}=t,h=He(t,HX),f=mt(),g=p.useRef(),[y,w]=p.useState(s),v=$X(n),C=p.useCallback(async A=>{const N=A.target.value;u&&await u(A,N);const M=f.current.getColumn(o);let k=N;M.valueParser&&(k=M.valueParser(N,f.current.getCellParams(r,o))),w(k),f.current.setEditCellValue({id:r,field:o,value:k,debounceMs:l,unstable_skipValueParser:!0},A)},[f,l,o,r,u]),x=f.current.unstable_getEditCellMeta(r,o);return p.useEffect(()=>{x?.changeReason!=="debouncedSetEditCellValue"&&w(s)},[x,s]),Yn(()=>{a&&g.current.focus()},[a]),d.jsx(zX,B({ref:e,inputRef:g,className:v.root,ownerState:n,fullWidth:!0,type:i.type==="number"?i.type:"text",value:y??"",onChange:C,endAdornment:c?d.jsx(n.slots.loadIcon,{fontSize:"small",color:"action"}):void 0},h))}),WX=t=>d.jsx(GX,B({},t)),Nw=t=>t==="Escape",KX=t=>t==="Enter",ij=t=>t==="Tab",aj=t=>t===" ",qX=t=>t.indexOf("Arrow")===0,QX=t=>t==="Home"||t==="End",YX=t=>t.indexOf("Page")===0;function lj(t){return t.key.length===1&&!t.ctrlKey&&!t.metaKey}const Dw=t=>QX(t)||qX(t)||YX(t)||aj(t),JX=t=>!!t.key,XX=t=>ij(t)||Nw(t);function bc(t){return t?.type==="singleSelect"}function bC(t,e,n){if(e===void 0)return;const r=e.find(s=>{const o=n(s);return String(o)===String(t)});return n(r)}const ZX=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","className","hasFocus","isValidating","isProcessingProps","error","onValueChange","initialOpen","getOptionLabel","getOptionValue"],eZ=["MenuProps"];function tZ(t){return!!t.key}function nZ(t){var e,n,r;const s=$e(),{id:o,value:i,field:a,row:l,colDef:c,hasFocus:u,error:h,onValueChange:f,initialOpen:g=s.editMode===Bo.Cell,getOptionLabel:y,getOptionValue:w}=t,v=He(t,ZX),C=mt(),x=p.useRef(),A=p.useRef(),[N,M]=p.useState(g),E=(n=(((e=s.slotProps)==null?void 0:e.baseSelect)||{}).native)!=null?n:!1,b=((r=s.slotProps)==null?void 0:r.baseSelect)||{},{MenuProps:I}=b,P=He(b,eZ);if(Yn(()=>{if(u){var U;(U=A.current)==null||U.focus()}},[u]),!bc(c))return null;let S;if(typeof c?.valueOptions=="function"?S=c?.valueOptions({id:o,row:l,field:a}):S=c?.valueOptions,!S)return null;const D=w||c.getOptionValue,T=y||c.getOptionLabel,j=async U=>{if(!bc(c)||!S)return;M(!1);const F=U.target,$=bC(F.value,S,D);f&&await f(U,$),await C.current.setEditCellValue({id:o,field:a,value:$},U)},R=(U,F)=>{if(s.editMode===Bo.Row){M(!1);return}if(F==="backdropClick"||Nw(U.key)){const $=C.current.getCellParams(o,a);C.current.publishEvent("cellEditStop",B({},$,{reason:Nw(U.key)?Ds.escapeKeyDown:Ds.cellFocusOut}))}},V=U=>{tZ(U)&&U.key==="Enter"||M(!0)};return!S||!c?null:d.jsx(s.slots.baseSelect,B({ref:x,inputRef:A,value:i,onChange:j,open:N,onOpen:V,MenuProps:B({onClose:R},I),error:h,native:E,fullWidth:!0},v,P,{children:S.map(U=>{var F;const $=D(U);return p.createElement(s.slots.baseSelectOption,B({},((F=s.slotProps)==null?void 0:F.baseSelectOption)||{},{native:E,key:$,value:$}),T(U))})}))}const rZ=t=>d.jsx(nZ,B({},t)),sZ=["open","target","onClose","children","position","className","onExited"],oZ=t=>{const{classes:e}=t;return ft({root:["menu"]},pt,e)},iZ=bn(d1,{name:"MuiDataGrid",slot:"Menu",overridesResolver:(t,e)=>e.menu})(({theme:t})=>({zIndex:t.zIndex.modal,[`& .${q.menuList}`]:{outline:0}})),aZ={"bottom-start":"top left","bottom-end":"top right"};function cj(t){var e;const{open:n,target:r,onClose:s,children:o,position:i,className:a,onExited:l}=t,c=He(t,sZ),u=mt(),h=$e(),f=oZ(h),g=p.useRef(null);Yn(()=>{if(n)g.current=document.activeElement instanceof HTMLElement?document.activeElement:null;else{var v,C;(v=g.current)==null||(C=v.focus)==null||C.call(v),g.current=null}},[n]),p.useEffect(()=>{const v=n?"menuOpen":"menuClose";u.current.publishEvent(v,{target:r})},[u,n,r]);const y=v=>C=>{v&&v(),l&&l(C)},w=v=>{v.target&&(r===v.target||r!=null&&r.contains(v.target))||s(v)};return d.jsx(iZ,B({as:h.slots.basePopper,className:At(a,f.root),ownerState:h,open:n,anchorEl:r,transition:!0,placement:i},c,(e=h.slotProps)==null?void 0:e.basePopper,{children:({TransitionProps:v,placement:C})=>d.jsx(E2,{onClickAway:w,mouseEvent:"onMouseDown",children:d.jsx(VB,B({},v,{style:{transformOrigin:aZ[C]},onExited:y(v?.onExited),children:d.jsx(wm,{children:o})}))})}))}const lZ=["api","colDef","id","hasFocus","isEditable","field","value","formattedValue","row","rowNode","cellMode","tabIndex","position","focusElementRef"],cZ=t=>typeof t.getActions=="function";function uZ(t){var e;const{colDef:n,id:r,hasFocus:s,tabIndex:o,position:i="bottom-end",focusElementRef:a}=t,l=He(t,lZ),[c,u]=p.useState(-1),[h,f]=p.useState(!1),g=mt(),y=p.useRef(null),w=p.useRef(null),v=p.useRef(!1),C=p.useRef({}),x=bh(),A=En(),N=En(),M=$e();if(!cZ(n))throw new Error("MUI: Missing the `getActions` property in the `GridColDef`.");const k=n.getActions(g.current.getRowParams(r)),E=k.filter(V=>!V.props.showInMenu),b=k.filter(V=>V.props.showInMenu),I=E.length+(b.length?1:0);p.useLayoutEffect(()=>{s||Object.entries(C.current).forEach(([V,U])=>{U?.stop({},()=>{delete C.current[V]})})},[s]),p.useEffect(()=>{if(c<0||!y.current||c>=y.current.children.length)return;y.current.children[c].focus({preventScroll:!0})},[c]),p.useEffect(()=>{s||(u(-1),v.current=!1)},[s]),p.useImperativeHandle(a,()=>({focus(){if(!v.current){const V=k.findIndex(U=>!U.props.disabled);u(V)}}}),[k]),p.useEffect(()=>{c>=I&&u(I-1)},[c,I]);const P=()=>{f(!0),u(I-1),v.current=!0},S=()=>{f(!1)},D=V=>U=>{C.current[V]=U},T=(V,U)=>F=>{u(V),v.current=!0,U&&U(F)},j=V=>{if(I<=1)return;const U=($,W)=>{var Z;if($<0||$>k.length)return $;const Y=x.direction==="rtl"?-1:1,le=(W==="left"?-1:1)*Y;return(Z=k[$+le])!=null&&Z.props.disabled?U($+le,W):$+le};let F=c;V.key==="ArrowRight"?F=U(c,"right"):V.key==="ArrowLeft"&&(F=U(c,"left")),!(F<0||F>=I)&&F!==c&&(V.preventDefault(),V.stopPropagation(),u(F))},R=V=>{V.key==="Tab"&&V.preventDefault(),["Tab","Escape"].includes(V.key)&&S()};return d.jsxs("div",B({role:"menu",ref:y,tabIndex:-1,className:q.actionsCell,onKeyDown:j},l,{children:[E.map((V,U)=>p.cloneElement(V,{key:U,touchRippleRef:D(U),onClick:T(U,V.props.onClick),tabIndex:c===U?o:-1})),b.length>0&&N&&d.jsx(M.slots.baseIconButton,B({ref:w,id:N,"aria-label":g.current.getLocaleText("actionsCellMore"),"aria-haspopup":"menu","aria-expanded":h,"aria-controls":h?A:void 0,role:"menuitem",size:"small",onClick:P,touchRippleRef:D(N),tabIndex:c===E.length?o:-1},(e=M.slotProps)==null?void 0:e.baseIconButton,{children:d.jsx(M.slots.moreActionsIcon,{fontSize:"small"})})),b.length>0&&d.jsx(cj,{open:h,target:w.current,position:i,onClose:S,children:d.jsx(I2,{id:A,className:q.menuList,onKeyDown:R,"aria-labelledby":N,variant:"menu",autoFocusItem:!0,children:b.map((V,U)=>p.cloneElement(V,{key:U,closeMenu:S}))})})]}))}const dZ=t=>d.jsx(uZ,B({},t)),hZ=["field","align","width","contentWidth"],fZ=t=>{const{align:e,classes:n}=t,r={root:["cell","cellSkeleton",`cell--text${Ec(e)}`,"withBorderColor"]};return ft(r,pt,n)};function mZ(t){const{align:e,width:n,contentWidth:r}=t,s=He(t,hZ),i={classes:$e().classes,align:e},a=fZ(i);return d.jsx("div",B({className:a.root,style:{width:n}},s,{children:d.jsx(BB,{width:`${r}%`})}))}function pZ(t){return t.vars?t.vars.palette.TableCell.border:t.palette.mode==="light"?UB(ro(t.palette.divider,1),.88):HB(ro(t.palette.divider,1),.68)}const qP={[`.${q.columnSeparator}, .${q["columnSeparator--resizing"]}`]:{visibility:"visible",width:"auto"}},QP={[`& .${q.iconButtonContainer}`]:{visibility:"visible",width:"auto"},[`& .${q.menuIcon}`]:{width:"auto",visibility:"visible"}},gZ=bn("div",{name:"MuiDataGrid",slot:"Root",overridesResolver:(t,e)=>[{[`&.${q.autoHeight}`]:e.autoHeight},{[`&.${q.aggregationColumnHeader}`]:e.aggregationColumnHeader},{[`&.${q["aggregationColumnHeader--alignLeft"]}`]:e["aggregationColumnHeader--alignLeft"]},{[`&.${q["aggregationColumnHeader--alignCenter"]}`]:e["aggregationColumnHeader--alignCenter"]},{[`&.${q["aggregationColumnHeader--alignRight"]}`]:e["aggregationColumnHeader--alignRight"]},{[`&.${q.aggregationColumnHeaderLabel}`]:e.aggregationColumnHeaderLabel},{[`&.${q["root--disableUserSelection"]} .${q.cell}`]:e["root--disableUserSelection"]},{[`&.${q.autosizing}`]:e.autosizing},{[`& .${q.editBooleanCell}`]:e.editBooleanCell},{[`& .${q["cell--editing"]}`]:e["cell--editing"]},{[`& .${q["cell--textCenter"]}`]:e["cell--textCenter"]},{[`& .${q["cell--textLeft"]}`]:e["cell--textLeft"]},{[`& .${q["cell--textRight"]}`]:e["cell--textRight"]},{[`& .${q["cell--withRenderer"]}`]:e["cell--withRenderer"]},{[`& .${q.cell}`]:e.cell},{[`& .${q["cell--rangeTop"]}`]:e["cell--rangeTop"]},{[`& .${q["cell--rangeBottom"]}`]:e["cell--rangeBottom"]},{[`& .${q["cell--rangeLeft"]}`]:e["cell--rangeLeft"]},{[`& .${q["cell--rangeRight"]}`]:e["cell--rangeRight"]},{[`& .${q["cell--withRightBorder"]}`]:e["cell--withRightBorder"]},{[`& .${q.cellContent}`]:e.cellContent},{[`& .${q.cellCheckbox}`]:e.cellCheckbox},{[`& .${q.cellSkeleton}`]:e.cellSkeleton},{[`& .${q.checkboxInput}`]:e.checkboxInput},{[`& .${q["columnHeader--alignCenter"]}`]:e["columnHeader--alignCenter"]},{[`& .${q["columnHeader--alignLeft"]}`]:e["columnHeader--alignLeft"]},{[`& .${q["columnHeader--alignRight"]}`]:e["columnHeader--alignRight"]},{[`& .${q["columnHeader--dragging"]}`]:e["columnHeader--dragging"]},{[`& .${q["columnHeader--moving"]}`]:e["columnHeader--moving"]},{[`& .${q["columnHeader--numeric"]}`]:e["columnHeader--numeric"]},{[`& .${q["columnHeader--sortable"]}`]:e["columnHeader--sortable"]},{[`& .${q["columnHeader--sorted"]}`]:e["columnHeader--sorted"]},{[`& .${q["columnHeader--withRightBorder"]}`]:e["columnHeader--withRightBorder"]},{[`& .${q.columnHeader}`]:e.columnHeader},{[`& .${q.headerFilterRow}`]:e.headerFilterRow},{[`& .${q.columnHeaderCheckbox}`]:e.columnHeaderCheckbox},{[`& .${q.columnHeaderDraggableContainer}`]:e.columnHeaderDraggableContainer},{[`& .${q.columnHeaderTitleContainer}`]:e.columnHeaderTitleContainer},{[`& .${q["columnSeparator--resizable"]}`]:e["columnSeparator--resizable"]},{[`& .${q["columnSeparator--resizing"]}`]:e["columnSeparator--resizing"]},{[`& .${q.columnSeparator}`]:e.columnSeparator},{[`& .${q.filterIcon}`]:e.filterIcon},{[`& .${q.iconSeparator}`]:e.iconSeparator},{[`& .${q.menuIcon}`]:e.menuIcon},{[`& .${q.menuIconButton}`]:e.menuIconButton},{[`& .${q.menuOpen}`]:e.menuOpen},{[`& .${q.menuList}`]:e.menuList},{[`& .${q["row--editable"]}`]:e["row--editable"]},{[`& .${q["row--editing"]}`]:e["row--editing"]},{[`& .${q["row--dragging"]}`]:e["row--dragging"]},{[`& .${q.row}`]:e.row},{[`& .${q.rowReorderCellPlaceholder}`]:e.rowReorderCellPlaceholder},{[`& .${q.rowReorderCell}`]:e.rowReorderCell},{[`& .${q["rowReorderCell--draggable"]}`]:e["rowReorderCell--draggable"]},{[`& .${q.sortIcon}`]:e.sortIcon},{[`& .${q.withBorderColor}`]:e.withBorderColor},{[`& .${q.treeDataGroupingCell}`]:e.treeDataGroupingCell},{[`& .${q.treeDataGroupingCellToggle}`]:e.treeDataGroupingCellToggle},{[`& .${q.detailPanelToggleCell}`]:e.detailPanelToggleCell},{[`& .${q["detailPanelToggleCell--expanded"]}`]:e["detailPanelToggleCell--expanded"]},e.root]})(({theme:t})=>{const e=pZ(t),n=t.shape.borderRadius;return B({"--unstable_DataGrid-radius":typeof n=="number"?`${n}px`:n,"--unstable_DataGrid-headWeight":t.typography.fontWeightMedium,"--unstable_DataGrid-overlayBackground":t.vars?`rgba(${t.vars.palette.background.defaultChannel} / ${t.vars.palette.action.disabledOpacity})`:ro(t.palette.background.default,t.palette.action.disabledOpacity),"--DataGrid-cellOffsetMultiplier":2,flex:1,boxSizing:"border-box",position:"relative",borderWidth:"1px",borderStyle:"solid",borderColor:e,borderRadius:"var(--unstable_DataGrid-radius)",color:(t.vars||t).palette.text.primary},t.typography.body2,{outline:"none",height:"100%",display:"flex",minWidth:0,minHeight:0,flexDirection:"column",overflowAnchor:"none",[`&.${q.autoHeight}`]:{height:"auto",[`& .${q["row--lastVisible"]} .${q.cell}`]:{borderBottomColor:"transparent"}},[`&.${q.autosizing}`]:{[`& .${q.columnHeaderTitleContainerContent} > *`]:{overflow:"visible !important"},[`& .${q.cell} > *`]:{overflow:"visible !important",whiteSpace:"nowrap"},[`& .${q.groupingCriteriaCell}`]:{width:"unset"},[`& .${q.treeDataGroupingCell}`]:{width:"unset"}},[`& .${q["virtualScrollerContent--overflowed"]} .${q["row--lastVisible"]} .${q.cell}`]:{borderBottomColor:"transparent"},[`& .${q.columnHeader}, & .${q.cell}`]:{WebkitTapHighlightColor:"transparent",lineHeight:null,padding:"0 10px",boxSizing:"border-box"},[`& .${q.columnHeader}:focus-within, & .${q.cell}:focus-within`]:{outline:`solid ${t.vars?`rgba(${t.vars.palette.primary.mainChannel} / 0.5)`:ro(t.palette.primary.main,.5)} 1px`,outlineWidth:1,outlineOffset:-1},[`& .${q.columnHeader}:focus, & .${q.cell}:focus`]:{outline:`solid ${t.palette.primary.main} 1px`},[`& .${q.columnHeaderCheckbox}, & .${q.cellCheckbox}`]:{padding:0,justifyContent:"center",alignItems:"center"},[`& .${q.columnHeader}`]:{position:"relative",display:"flex",alignItems:"center"},[`& .${q["columnHeader--sorted"]} .${q.iconButtonContainer}, & .${q["columnHeader--filtered"]} .${q.iconButtonContainer}`]:{visibility:"visible",width:"auto"},[`& .${q.columnHeader}:not(.${q["columnHeader--sorted"]}) .${q.sortIcon}`]:{opacity:0,transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.shorter})},[`& .${q.columnHeaderTitleContainer}`]:{display:"flex",alignItems:"center",minWidth:0,flex:1,whiteSpace:"nowrap",overflow:"hidden",position:"relative"},[`& .${q.columnHeaderTitleContainerContent}`]:{overflow:"hidden",display:"flex",alignItems:"center"},[`& .${q["columnHeader--filledGroup"]} .${q.columnHeaderTitleContainer}`]:{borderBottomWidth:"1px",borderBottomStyle:"solid",boxSizing:"border-box"},[`& .${q["columnHeader--filledGroup"]}.${q["columnHeader--showColumnBorder"]} .${q.columnHeaderTitleContainer}`]:{borderBottom:"none"},[`& .${q["columnHeader--filledGroup"]}.${q["columnHeader--showColumnBorder"]}`]:{borderBottomWidth:"1px",borderBottomStyle:"solid",boxSizing:"border-box"},[`& .${q.headerFilterRow}`]:{borderTop:`1px solid ${e}`},[`& .${q.sortIcon}, & .${q.filterIcon}`]:{fontSize:"inherit"},[`& .${q["columnHeader--sortable"]}`]:{cursor:"pointer"},[`& .${q["columnHeader--alignCenter"]} .${q.columnHeaderTitleContainer}`]:{justifyContent:"center"},[`& .${q["columnHeader--alignRight"]} .${q.columnHeaderDraggableContainer}, & .${q["columnHeader--alignRight"]} .${q.columnHeaderTitleContainer}`]:{flexDirection:"row-reverse"},[`& .${q["columnHeader--alignCenter"]} .${q.menuIcon}, & .${q["columnHeader--alignRight"]} .${q.menuIcon}`]:{marginRight:"auto",marginLeft:-6},[`& .${q["columnHeader--alignRight"]} .${q.menuIcon}, & .${q["columnHeader--alignRight"]} .${q.menuIcon}`]:{marginRight:"auto",marginLeft:-10},[`& .${q["columnHeader--moving"]}`]:{backgroundColor:(t.vars||t).palette.action.hover},[`& .${q.columnSeparator}`]:{visibility:"hidden",position:"absolute",zIndex:100,display:"flex",flexDirection:"column",justifyContent:"center",color:e},"@media (hover: hover)":{[`& .${q.columnHeaders}:hover`]:qP,[`& .${q.columnHeader}:hover`]:QP,[`& .${q.columnHeader}:not(.${q["columnHeader--sorted"]}):hover .${q.sortIcon}`]:{opacity:.5}},"@media (hover: none)":{[`& .${q.columnHeaders}`]:qP,[`& .${q.columnHeader}`]:QP},[`& .${q["columnSeparator--sideLeft"]}`]:{left:-12},[`& .${q["columnSeparator--sideRight"]}`]:{right:-12},[`& .${q["columnSeparator--resizable"]}`]:{cursor:"col-resize",touchAction:"none","&:hover":{color:(t.vars||t).palette.text.primary,"@media (hover: none)":{color:e}},[`&.${q["columnSeparator--resizing"]}`]:{color:(t.vars||t).palette.text.primary},"& svg":{pointerEvents:"none"}},[`& .${q.iconSeparator}`]:{color:"inherit"},[`& .${q.menuIcon}`]:{width:0,visibility:"hidden",fontSize:20,marginRight:-10,display:"flex",alignItems:"center"},[`.${q.menuOpen}`]:{visibility:"visible",width:"auto"},[`& .${q.row}`]:{display:"flex",width:"fit-content",breakInside:"avoid","&:hover, &.Mui-hovered":{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:ro(t.palette.primary.main,t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(
                ${t.vars.palette.action.selectedOpacity} + 
                ${t.vars.palette.action.hoverOpacity}
              ))`:ro(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:ro(t.palette.primary.main,t.palette.action.selectedOpacity)}}}},[`& .${q.cell}`]:{display:"flex",alignItems:"center",borderBottom:"1px solid","&.Mui-selected":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:ro(t.palette.primary.main,t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity+t.palette.action.hoverOpacity})`:ro(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:ro(t.palette.primary.main,t.palette.action.selectedOpacity)}}}},[`&.${q["root--disableUserSelection"]} .${q.cell}`]:{userSelect:"none"},[`& .${q.row}:not(.${q["row--dynamicHeight"]}) > .${q.cell}`]:{overflow:"hidden",whiteSpace:"nowrap"},[`& .${q.cellContent}`]:{overflow:"hidden",textOverflow:"ellipsis"},[`& .${q.cell}.${q["cell--selectionMode"]}`]:{cursor:"default"},[`& .${q.cell}.${q["cell--editing"]}`]:{padding:1,display:"flex",boxShadow:t.shadows[2],backgroundColor:(t.vars||t).palette.background.paper,"&:focus-within":{outline:`solid ${(t.vars||t).palette.primary.main} 1px`,outlineOffset:"-1px"}},[`& .${q["row--editing"]}`]:{boxShadow:t.shadows[2]},[`& .${q["row--editing"]} .${q.cell}`]:{boxShadow:t.shadows[0],backgroundColor:(t.vars||t).palette.background.paper},[`& .${q.editBooleanCell}`]:{display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center"},[`& .${q.booleanCell}[data-value="true"]`]:{color:(t.vars||t).palette.text.secondary},[`& .${q.booleanCell}[data-value="false"]`]:{color:(t.vars||t).palette.text.disabled},[`& .${q.actionsCell}`]:{display:"inline-flex",alignItems:"center",gridGap:t.spacing(1)},[`& .${q.rowReorderCell}`]:{display:"inline-flex",flex:1,alignItems:"center",justifyContent:"center",opacity:(t.vars||t).palette.action.disabledOpacity},[`& .${q["rowReorderCell--draggable"]}`]:{cursor:"move",opacity:1},[`& .${q.rowReorderCellContainer}`]:{padding:0,alignItems:"stretch"},[`.${q.withBorderColor}`]:{borderColor:e},[`& .${q["cell--withRightBorder"]}`]:{borderRightWidth:"1px",borderRightStyle:"solid"},[`& .${q["columnHeader--withRightBorder"]}`]:{borderRightWidth:"1px",borderRightStyle:"solid"},[`& .${q["cell--textLeft"]}`]:{justifyContent:"flex-start"},[`& .${q["cell--textRight"]}`]:{justifyContent:"flex-end"},[`& .${q["cell--textCenter"]}`]:{justifyContent:"center"},[`& .${q.columnHeaderDraggableContainer}`]:{display:"flex",width:"100%",height:"100%"},[`& .${q.rowReorderCellPlaceholder}`]:{display:"none"},[`& .${q["columnHeader--dragging"]}, & .${q["row--dragging"]}`]:{background:(t.vars||t).palette.background.paper,padding:"0 12px",borderRadius:"var(--unstable_DataGrid-radius)",opacity:(t.vars||t).palette.action.disabledOpacity},[`& .${q["row--dragging"]}`]:{background:(t.vars||t).palette.background.paper,padding:"0 12px",borderRadius:"var(--unstable_DataGrid-radius)",opacity:(t.vars||t).palette.action.disabledOpacity,[`& .${q.rowReorderCellPlaceholder}`]:{display:"flex"}},[`& .${q.treeDataGroupingCell}`]:{display:"flex",alignItems:"center",width:"100%"},[`& .${q.treeDataGroupingCellToggle}`]:{flex:"0 0 28px",alignSelf:"stretch",marginRight:t.spacing(2)},[`& .${q.groupingCriteriaCell}`]:{display:"flex",alignItems:"center",width:"100%"},[`& .${q.groupingCriteriaCellToggle}`]:{flex:"0 0 28px",alignSelf:"stretch",marginRight:t.spacing(2)}})}),yZ=["children","className"],wZ=t=>{const{autoHeight:e,density:n,classes:r}=t,s={root:["root",e&&"autoHeight",`root--density${Ec(n)}`,"withBorderColor"]};return ft(s,pt,r)},bZ=p.forwardRef(function(e,n){var r;const s=$e(),{children:o,className:i}=e,a=He(e,yZ),l=ol(),c=Re(l,sX),u=p.useRef(null),h=Kc(u,n),f=(r=s.experimentalFeatures)!=null&&r.ariaV7?null:GF,g=typeof f=="function"?f():null,y=B({},s,{density:c}),w=wZ(y);l.current.register("public",{rootElementRef:u});const[v,C]=p.useState(!1);return Yn(()=>{C(!0)},[]),v?d.jsx(gZ,B({ref:h,className:At(i,w.root),ownerState:y},g,a,{children:o})):null}),vZ=["className"],xZ=t=>{const{classes:e}=t;return ft({root:["footerContainer","withBorderColor"]},pt,e)},CZ=Zn("div",{name:"MuiDataGrid",slot:"FooterContainer",overridesResolver:(t,e)=>e.footerContainer})({display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:52,borderTop:"1px solid"}),EZ=p.forwardRef(function(e,n){const{className:r}=e,s=He(e,vZ),o=$e(),i=xZ(o);return d.jsx(CZ,B({ref:n,className:At(i.root,r),ownerState:o},s))}),IZ=["className"],_Z=t=>{const{classes:e}=t;return ft({root:["overlay"]},pt,e)},AZ=Zn("div",{name:"MuiDataGrid",slot:"Overlay",overridesResolver:(t,e)=>e.overlay})({width:"100%",height:"100%",display:"flex",alignSelf:"center",alignItems:"center",justifyContent:"center",backgroundColor:"var(--unstable_DataGrid-overlayBackground)"}),SI=p.forwardRef(function(e,n){const{className:r}=e,s=He(e,IZ),o=$e(),i=_Z(o);return d.jsx(AZ,B({ref:n,className:At(i.root,r),ownerState:o},s))}),SZ=["className"],TZ=t=>{const{classes:e}=t;return ft({root:["iconButtonContainer"]},pt,e)},PZ=Zn("div",{name:"MuiDataGrid",slot:"IconButtonContainer",overridesResolver:(t,e)=>e.iconButtonContainer})(()=>({display:"flex",visibility:"hidden",width:0})),uj=p.forwardRef(function(e,n){const{className:r}=e,s=He(e,SZ),o=$e(),i=TZ(o);return d.jsx(PZ,B({ref:n,className:At(i.root,r),ownerState:o},s))}),kZ=t=>{const{classes:e}=t;return ft({icon:["sortIcon"]},pt,e)};function RZ(t,e,n,r){let s;const o={};return e==="asc"?s=t.columnSortedAscendingIcon:e==="desc"?s=t.columnSortedDescendingIcon:(s=t.columnUnsortedIcon,o.sortingOrder=r),s?d.jsx(s,B({fontSize:"small",className:n},o)):null}function NZ(t){var e;const{direction:n,index:r,sortingOrder:s}=t,o=mt(),i=$e(),a=B({},t,{classes:i.classes}),l=kZ(a),c=RZ(i.slots,n,l.icon,s);if(!c)return null;const u=d.jsx(i.slots.baseIconButton,B({tabIndex:-1,"aria-label":o.current.getLocaleText("columnHeaderSortIconLabel"),title:o.current.getLocaleText("columnHeaderSortIconLabel"),size:"small"},(e=i.slotProps)==null?void 0:e.baseIconButton,{children:c}));return d.jsxs(uj,{children:[r!=null&&d.jsx(_2,{badgeContent:r,color:"default",children:u}),r==null&&u]})}const DZ=p.memo(NZ),MZ=t=>{const{classes:e,open:n}=t;return ft({root:["menuIcon",n&&"menuOpen"],button:["menuIconButton"]},pt,e)},OZ=p.memo(t=>{var e,n;const{colDef:r,open:s,columnMenuId:o,columnMenuButtonId:i,iconButtonRef:a}=t,l=mt(),c=$e(),u=B({},t,{classes:c.classes}),h=MZ(u),f=p.useCallback(g=>{g.preventDefault(),g.stopPropagation(),l.current.toggleColumnMenu(r.field)},[l,r.field]);return d.jsx("div",{className:h.root,children:d.jsx(c.slots.baseTooltip,B({title:l.current.getLocaleText("columnMenuLabel"),enterDelay:1e3},(e=c.slotProps)==null?void 0:e.baseTooltip,{children:d.jsx(c.slots.baseIconButton,B({ref:a,tabIndex:-1,className:h.button,"aria-label":l.current.getLocaleText("columnMenuLabel"),size:"small",onClick:f,"aria-haspopup":"menu","aria-expanded":s,"aria-controls":s?o:void 0,id:i},(n=c.slotProps)==null?void 0:n.baseIconButton,{children:d.jsx(c.slots.columnMenuIcon,{fontSize:"small"})}))}))})});function LZ({columnMenuId:t,columnMenuButtonId:e,ContentComponent:n,contentComponentProps:r,field:s,open:o,target:i,onExited:a}){const l=mt(),c=l.current.getColumn(s),u=Ws(h=>{h&&(h.stopPropagation(),i!=null&&i.contains(h.target))||l.current.hideColumnMenu()});return!i||!c?null:d.jsx(cj,{placement:`bottom-${c.align==="right"?"start":"end"}`,open:o,target:i,onClose:u,onExited:a,children:d.jsx(n,B({colDef:c,hideMenu:u,open:o,id:t,labelledby:e},r))})}const FZ=["className"],jZ=t=>{const{classes:e}=t;return ft({root:["columnHeaderTitle"]},pt,e)},VZ=Zn("div",{name:"MuiDataGrid",slot:"ColumnHeaderTitle",overridesResolver:(t,e)=>e.columnHeaderTitle})({textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontWeight:"var(--unstable_DataGrid-headWeight)"}),BZ=p.forwardRef(function(e,n){const{className:r}=e,s=He(e,FZ),o=$e(),i=jZ(o);return d.jsx(VZ,B({ref:n,className:At(i.root,r),ownerState:o},s))});function UZ(t){var e;const{label:n,description:r}=t,s=$e(),o=p.useRef(null),[i,a]=p.useState(""),l=p.useCallback(()=>{if(!r&&o!=null&&o.current){const c=gX(o.current);a(c?n:"")}},[r,n]);return d.jsx(s.slots.baseTooltip,B({title:r||i},(e=s.slotProps)==null?void 0:e.baseTooltip,{children:d.jsx(BZ,{onMouseOver:l,ref:o,children:n})}))}const HZ=["resizable","resizing","height","side"];var dj=(function(t){return t.Left="left",t.Right="right",t})(dj||{});const $Z=t=>{const{resizable:e,resizing:n,classes:r,side:s}=t,o={root:["columnSeparator",e&&"columnSeparator--resizable",n&&"columnSeparator--resizing",s&&`columnSeparator--side${Ec(s)}`],icon:["iconSeparator"]};return ft(o,pt,r)};function zZ(t){const{height:e,side:n=dj.Right}=t,r=He(t,HZ),s=$e(),o=B({},t,{side:n,classes:s.classes}),i=$Z(o),a=p.useCallback(l=>{l.preventDefault(),l.stopPropagation()},[]);return d.jsx("div",B({className:i.root,style:{minHeight:e,opacity:s.showColumnVerticalBorder?0:1}},r,{onClick:a,children:d.jsx(s.slots.columnResizeIcon,{className:i.icon})}))}const GZ=p.memo(zZ),WZ=["classes","columnMenuOpen","colIndex","height","isResizing","sortDirection","hasFocus","tabIndex","separatorSide","isDraggable","headerComponent","description","elementId","width","columnMenuIconButton","columnMenu","columnTitleIconButtons","headerClassName","label","resizable","draggableContainerProps","columnHeaderSeparatorProps"],hj=p.forwardRef(function(e,n){const{classes:r,columnMenuOpen:s,colIndex:o,height:i,isResizing:a,sortDirection:l,hasFocus:c,tabIndex:u,separatorSide:h,isDraggable:f,headerComponent:g,description:y,width:w,columnMenuIconButton:v=null,columnMenu:C=null,columnTitleIconButtons:x=null,headerClassName:A,label:N,resizable:M,draggableContainerProps:k,columnHeaderSeparatorProps:E}=e,b=He(e,WZ),I=ol(),P=$e(),S=p.useRef(null),[D,T]=p.useState(s),j=Kc(S,n);let R="none";return l!=null&&(R=l==="asc"?"ascending":"descending"),p.useEffect(()=>{D||T(s)},[D,s]),p.useLayoutEffect(()=>{const V=I.current.state.columnMenu;if(c&&!V.open){const F=S.current.querySelector('[tabindex="0"]')||S.current;F?.focus(),I.current.columnHeadersContainerElementRef.current.scrollLeft=0}},[I,c]),d.jsxs("div",B({ref:j,className:At(r.root,A),style:{height:i,width:w,minWidth:w,maxWidth:w},role:"columnheader",tabIndex:u,"aria-colindex":o+1,"aria-sort":R,"aria-label":g==null?N:void 0},b,{children:[d.jsxs("div",B({className:r.draggableContainer,draggable:f,role:"presentation"},k,{children:[d.jsxs("div",{className:r.titleContainer,role:"presentation",children:[d.jsx("div",{className:r.titleContainerContent,children:g!==void 0?g:d.jsx(UZ,{label:N,description:y,columnWidth:w})}),x]}),v]})),d.jsx(GZ,B({resizable:!P.disableColumnResize&&!!M,resizing:a,height:i,side:h},E)),C]}))}),KZ=t=>{const{colDef:e,classes:n,isDragging:r,sortDirection:s,showRightBorder:o,filterItemsCounter:i}=t,a=s!=null,l=i!=null&&i>0,c=e.type==="number",u={root:["columnHeader",e.headerAlign==="left"&&"columnHeader--alignLeft",e.headerAlign==="center"&&"columnHeader--alignCenter",e.headerAlign==="right"&&"columnHeader--alignRight",e.sortable&&"columnHeader--sortable",r&&"columnHeader--moving",a&&"columnHeader--sorted",l&&"columnHeader--filtered",c&&"columnHeader--numeric","withBorderColor",o&&"columnHeader--withRightBorder"],draggableContainer:["columnHeaderDraggableContainer"],titleContainer:["columnHeaderTitleContainer"],titleContainerContent:["columnHeaderTitleContainerContent"]};return ft(u,pt,n)};function qZ(t){var e,n,r,s;const{colDef:o,columnMenuOpen:i,colIndex:a,headerHeight:l,isResizing:c,sortDirection:u,sortIndex:h,filterItemsCounter:f,hasFocus:g,tabIndex:y,disableReorder:w,separatorSide:v}=t,C=ol(),x=$e(),A=p.useRef(null),N=En(),M=En(),k=p.useRef(null),[E,b]=p.useState(i),I=p.useMemo(()=>!x.disableColumnReorder&&!w&&!o.disableReorder,[x.disableColumnReorder,w,o.disableReorder]);let P;o.renderHeader&&(P=o.renderHeader(C.current.getColumnHeaderParams(o.field)));const S=B({},t,{classes:x.classes,showRightBorder:x.showColumnVerticalBorder}),D=KZ(S),T=p.useCallback(fe=>we=>{Yp(we)||C.current.publishEvent(fe,C.current.getColumnHeaderParams(o.field),we)},[C,o.field]),j=p.useMemo(()=>({onClick:T("columnHeaderClick"),onDoubleClick:T("columnHeaderDoubleClick"),onMouseOver:T("columnHeaderOver"),onMouseOut:T("columnHeaderOut"),onMouseEnter:T("columnHeaderEnter"),onMouseLeave:T("columnHeaderLeave"),onKeyDown:T("columnHeaderKeyDown"),onFocus:T("columnHeaderFocus"),onBlur:T("columnHeaderBlur")}),[T]),R=p.useMemo(()=>I?{onDragStart:T("columnHeaderDragStart"),onDragEnter:T("columnHeaderDragEnter"),onDragOver:T("columnHeaderDragOver"),onDragEnd:T("columnHeaderDragEnd")}:{},[I,T]),V=p.useMemo(()=>({onMouseDown:T("columnSeparatorMouseDown"),onDoubleClick:T("columnSeparatorDoubleClick")}),[T]);p.useEffect(()=>{E||b(i)},[E,i]);const U=p.useCallback(()=>{b(!1)},[]),F=!x.disableColumnMenu&&!o.disableColumnMenu&&d.jsx(OZ,{colDef:o,columnMenuId:N,columnMenuButtonId:M,open:E,iconButtonRef:k}),$=d.jsx(LZ,{columnMenuId:N,columnMenuButtonId:M,field:o.field,open:i,target:k.current,ContentComponent:x.slots.columnMenu,contentComponentProps:(e=x.slotProps)==null?void 0:e.columnMenu,onExited:U}),W=(n=o.sortingOrder)!=null?n:x.sortingOrder,Z=d.jsxs(p.Fragment,{children:[!x.disableColumnFilter&&d.jsx(x.slots.columnHeaderFilterIconButton,B({field:o.field,counter:f},(r=x.slotProps)==null?void 0:r.columnHeaderFilterIconButton)),o.sortable&&!o.hideSortIcons&&d.jsx(DZ,{direction:u,index:h,sortingOrder:W})]});p.useLayoutEffect(()=>{const fe=C.current.state.columnMenu;if(g&&!fe.open){var we;const Ee=A.current.querySelector('[tabindex="0"]')||A.current;Ee?.focus(),(we=C.current.columnHeadersContainerElementRef)!=null&&we.current&&(C.current.columnHeadersContainerElementRef.current.scrollLeft=0)}},[C,g]);const Y=typeof o.headerClassName=="function"?o.headerClassName({field:o.field,colDef:o}):o.headerClassName,le=(s=o.headerName)!=null?s:o.field;return d.jsx(hj,B({ref:A,classes:D,columnMenuOpen:i,colIndex:a,height:l,isResizing:c,sortDirection:u,hasFocus:g,tabIndex:y,separatorSide:v,isDraggable:I,headerComponent:P,description:o.description,elementId:o.field,width:o.computedWidth,columnMenuIconButton:F,columnTitleIconButtons:Z,headerClassName:Y,label:le,resizable:!x.disableColumnResize&&!!o.resizable,"data-field":o.field,columnMenu:$,draggableContainerProps:R,columnHeaderSeparatorProps:V},j))}const $m=()=>({items:[],logicOperator:Rr.And,quickFilterValues:[],quickFilterLogicOperator:Rr.And}),YP=1e3;class QZ{constructor(e=YP){this.timeouts=new Map,this.cleanupTimeout=YP,this.cleanupTimeout=e}register(e,n,r){this.timeouts||(this.timeouts=new Map);const s=setTimeout(()=>{typeof n=="function"&&n(),this.timeouts.delete(r.cleanupToken)},this.cleanupTimeout);this.timeouts.set(r.cleanupToken,s)}unregister(e){const n=this.timeouts.get(e.cleanupToken);n&&(this.timeouts.delete(e.cleanupToken),clearTimeout(n))}reset(){this.timeouts&&(this.timeouts.forEach((e,n)=>{this.unregister({cleanupToken:n})}),this.timeouts=void 0)}}class YZ{constructor(){this.registry=new FinalizationRegistry(e=>{typeof e=="function"&&e()})}register(e,n,r){this.registry.register(e,n,r)}unregister(e){this.registry.unregister(e)}reset(){}}var Oo=(function(t){return t.DataGrid="DataGrid",t.DataGridPro="DataGridPro",t})(Oo||{});class JZ{}function XZ(t){let e=0;return function(r,s,o,i){t.registry===null&&(t.registry=typeof FinalizationRegistry<"u"?new YZ:new QZ);const[a]=p.useState(new JZ),l=p.useRef(null),c=p.useRef();c.current=o;const u=p.useRef(null);if(!l.current&&c.current){const h=(f,g,y)=>{if(!g.defaultMuiPrevented){var w;(w=c.current)==null||w.call(c,f,g,y)}};l.current=r.current.subscribeEvent(s,h,i),e+=1,u.current={cleanupToken:e},t.registry.register(a,()=>{var f;(f=l.current)==null||f.call(l),l.current=null,u.current=null},u.current)}else!c.current&&l.current&&(l.current(),l.current=null,u.current&&(t.registry.unregister(u.current),u.current=null));p.useEffect(()=>{if(!l.current&&c.current){const h=(f,g,y)=>{if(!g.defaultMuiPrevented){var w;(w=c.current)==null||w.call(c,f,g,y)}};l.current=r.current.subscribeEvent(s,h,i)}return u.current&&t.registry&&(t.registry.unregister(u.current),u.current=null),()=>{var h;(h=l.current)==null||h.call(l),l.current=null}},[r,s,i])}}const ZZ={registry:null},ze=XZ(ZZ),eee={isFirst:!0};function Gt(t,e,n){ze(t,e,n,eee)}function er(t,e){const n=p.useRef(null);if(n.current)return n.current;const r=t.current.getLogger(e);return n.current=r,r}function tee(t){return typeof t=="number"&&!Number.isNaN(t)}function fj(t){return typeof t=="function"}function TI(t){return typeof t=="object"&&t!==null}function nee(){try{const t="__some_random_key_you_are_not_going_to_use__";return window.localStorage.setItem(t,t),window.localStorage.removeItem(t),!0}catch{return!1}}function Iy(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}const lh=(t,e,n)=>Math.max(e,Math.min(n,t));function vc(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;if(Array.isArray(t)){const s=t.length;if(s!==e.length)return!1;for(let o=0;o<s;o+=1)if(!vc(t[o],e[o]))return!1;return!0}if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;const s=Array.from(t.entries());for(let o=0;o<s.length;o+=1)if(!e.has(s[o][0]))return!1;for(let o=0;o<s.length;o+=1){const i=s[o];if(!vc(i[1],e.get(i[0])))return!1}return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;const s=Array.from(t.entries());for(let o=0;o<s.length;o+=1)if(!e.has(s[o][0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){const s=t.length;if(s!==e.length)return!1;for(let o=0;o<s;o+=1)if(t[o]!==e[o])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const n=Object.keys(t),r=n.length;if(r!==Object.keys(e).length)return!1;for(let s=0;s<r;s+=1)if(!Object.prototype.hasOwnProperty.call(e,n[s]))return!1;for(let s=0;s<r;s+=1){const o=n[s];if(!vc(t[o],e[o]))return!1}return!0}return t!==t&&e!==e}function ree(t){return()=>{let e=t+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}}function see(t,e,n){const r=ree(t);return()=>e+(n-e)*r()}function mj(t){return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const oee=(t,e,n,r,s)=>{const o=er(t,"useNativeEventListener"),[i,a]=p.useState(!1),l=p.useRef(r),c=p.useCallback(u=>l.current&&l.current(u),[]);p.useEffect(()=>{l.current=r},[r]),p.useEffect(()=>{let u;if(fj(e)?u=e():u=e&&e.current?e.current:null,u&&n&&!i){o.debug(`Binding native ${n} event`),u.addEventListener(n,c,s);const h=u;a(!0);const f=()=>{o.debug(`Clearing native ${n} event`),h.removeEventListener(n,c,s)};t.current.subscribeEvent("unmount",f)}},[e,c,n,i,o,s,t])},Jp=t=>{const e=p.useRef(!0);e.current&&(e.current=!1,t())},iee=100,aee=t=>t?0:100,pj=(t,e)=>e>0&&t>0?Math.ceil(t/e):0;Ho(["MUI: the 'rowCount' prop is undefined while using paginationMode='server'","For more detail, see http://mui.com/components/data-grid/pagination/#basic-implementation"],"error");const gj=t=>({page:0,pageSize:t?0:100}),lee=(t,e=0)=>e===0?t:Math.max(Math.min(t,e-1),0),yj=(t,e)=>{if(e===Oo.DataGrid&&t>iee)throw new Error(["MUI: `pageSize` cannot exceed 100 in the MIT version of the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join(`
`))},PI=t=>t.pagination,gs=nt(PI,t=>t.paginationModel),ju=nt(PI,t=>t.rowCount),cee=nt(gs,t=>t.page),wj=nt(gs,t=>t.pageSize),uee=nt(wj,ju,(t,e)=>pj(e,t)),kI=Kt(gs,Us,Xb,il,qF,(t,e,n,r,s)=>{const o=s.length,i=Math.min(t.pageSize*t.page,o-1),a=Math.min(i+t.pageSize-1,o-1);if(i===-1||a===-1)return null;if(n<2)return{firstRowIndex:i,lastRowIndex:a};const l=s[i],c=a-i+1,u=r.findIndex(y=>y.id===l.id);let h=u,f=0;for(;h<r.length&&f<=c;){var g;const y=r[h],w=(g=e[y.id])==null?void 0:g.depth;w===void 0?h+=1:((f<c||w>0)&&(h+=1),w===0&&(f+=1))}return{firstRowIndex:u,lastRowIndex:h-1}}),dee=Kt(il,kI,(t,e)=>e?t.slice(e.firstRowIndex,e.lastRowIndex+1):[]),bj=Kt(mm,kI,(t,e)=>e?t.slice(e.firstRowIndex,e.lastRowIndex+1):[]),zm=t=>t.preferencePanel;var Bc=(function(t){return t.filters="filters",t.columns="columns",t})(Bc||{});const Gm=t=>t.rowsMeta,ys=t=>t.rowSelection,hee=nt(ys,t=>t.length),fee=Kt(ys,mi,(t,e)=>new Map(t.map(n=>[n,e[n]]))),Mw=Kt(ys,t=>t.reduce((e,n)=>(e[n]=n,e),{})),mee=Ho(["MUI: The `sortModel` can only contain a single item when the `disableMultipleColumnsSorting` prop is set to `true`.","If you are using the community version of the `DataGrid`, this prop is always `true`."],"error"),vj=(t,e)=>e&&t.length>1?(mee(),[t[0]]):t,JP=(t,e)=>n=>B({},n,{sorting:B({},n.sorting,{sortModel:vj(t,e)})}),pee=t=>t==="desc",gee=(t,e)=>{const n=e.current.getColumn(t.field);if(!n)return null;const r=pee(t.sort)?(...o)=>-1*n.sortComparator(...o):n.sortComparator;return{getSortCellParams:o=>({id:o,field:n.field,rowNode:e.current.getRowNode(o),value:e.current.getCellValue(o,n.field),api:e.current}),comparator:r}},yee=(t,e,n)=>t.reduce((r,s,o)=>{if(r!==0)return r;const i=e.params[o],a=n.params[o];return r=s.comparator(i.value,a.value,i,a),r},0),wee=(t,e)=>{const n=t.map(r=>gee(r,e)).filter(r=>!!r);return n.length===0?null:r=>r.map(s=>({node:s,params:n.map(o=>o.getSortCellParams(s.id))})).sort((s,o)=>yee(n,s,o)).map(s=>s.node.id)},XP=(t,e)=>{const n=t.indexOf(e);return!e||n===-1||n+1===t.length?t[0]:t[n+1]},RI=(t,e)=>t==null&&e!=null?-1:e==null&&t!=null?1:t==null&&e==null?0:null,bee=new Intl.Collator,vee=(t,e)=>{const n=RI(t,e);return n!==null?n:typeof t=="string"?bee.compare(t.toString(),e.toString()):t-e},xj=(t,e)=>{const n=RI(t,e);return n!==null?n:Number(t)-Number(e)},Cj=(t,e)=>{const n=RI(t,e);return n!==null?n:t>e?1:t<e?-1:0},Ej=t=>t.headerFiltering,xee=nt(Ej,t=>t.editing),Cee=nt(Ej,t=>t.menuOpen),Eee=(t,e)=>{const n={enabled:!e.disableVirtualization,enabledForColumns:!0};return B({},t,{virtualization:n})};function Iee(t,e){const n=o=>{t.current.setState(i=>B({},i,{virtualization:B({},i.virtualization,{enabled:o})}))};rt(t,{unstable_setVirtualization:n,unstable_setColumnVirtualization:o=>{t.current.setState(i=>B({},i,{virtualization:B({},i.virtualization,{enabledForColumns:o})}))}},"public"),p.useEffect(()=>{n(!e.disableVirtualization)},[e.disableVirtualization])}const Ij=t=>t.virtualization,_ee=nt(Ij,t=>t.enabled),_j=nt(Ij,t=>t.enabledForColumns),Aee=t=>{const{classes:e}=t;return ft({icon:["filterIcon"]},pt,e)};function See(t){var e,n;const{counter:r,field:s,onClick:o}=t,i=mt(),a=$e(),l=B({},t,{classes:a.classes}),c=Aee(l),u=Re(i,zm),h=En(),f=En(),g=p.useCallback(v=>{v.preventDefault(),v.stopPropagation();const{open:C,openedPanelValue:x}=zm(i.current.state);C&&x===Bc.filters?i.current.hideFilterPanel():i.current.showFilterPanel(void 0,f,h),o&&o(i.current.getColumnHeaderParams(s),v)},[i,s,o,f,h]);if(!r)return null;const y=u.open&&u.labelId===h,w=d.jsx(a.slots.baseIconButton,B({id:h,onClick:g,color:"default","aria-label":i.current.getLocaleText("columnHeaderFiltersLabel"),size:"small",tabIndex:-1,"aria-haspopup":"menu","aria-expanded":y,"aria-controls":y?f:void 0},(e=a.slotProps)==null?void 0:e.baseIconButton,{children:d.jsx(a.slots.columnFilteredIcon,{className:c.icon,fontSize:"small"})}));return d.jsx(a.slots.baseTooltip,B({title:i.current.getLocaleText("columnHeaderFiltersTooltipActive")(r),enterDelay:1e3},(n=a.slotProps)==null?void 0:n.baseTooltip,{children:d.jsxs(uj,{children:[r>1&&d.jsx(_2,{badgeContent:r,color:"default",children:w}),r===1&&w]})}))}const Tee=["field","id","value","formattedValue","row","rowNode","colDef","isEditable","cellMode","hasFocus","tabIndex","api"],Pee=t=>{const{classes:e}=t;return ft({root:["checkboxInput"]},pt,e)},kee=p.forwardRef(function(e,n){var r;const{field:s,id:o,value:i,rowNode:a,hasFocus:l,tabIndex:c}=e,u=He(e,Tee),h=mt(),f=$e(),g={classes:f.classes},y=Pee(g),w=p.useRef(null),v=p.useRef(null),C=Kc(w,n),x=h.current.getCellElement(o,s),A=E=>{const b={value:E.target.checked,id:o};h.current.publishEvent("rowSelectionCheckboxChange",b,E)};p.useLayoutEffect(()=>{c===0&&x&&(x.tabIndex=-1)},[x,c]),p.useEffect(()=>{if(l){var E;const b=(E=w.current)==null?void 0:E.querySelector("input");b?.focus({preventScroll:!0})}else v.current&&v.current.stop({})},[l]);const N=p.useCallback(E=>{aj(E.key)&&E.stopPropagation()},[]);if(a.type==="footer"||a.type==="pinnedRow")return null;const M=h.current.isRowSelectable(o),k=h.current.getLocaleText(i?"checkboxSelectionUnselectRow":"checkboxSelectionSelectRow");return d.jsx(f.slots.baseCheckbox,B({ref:C,tabIndex:c,checked:i,onChange:A,className:y.root,inputProps:{"aria-label":k},onKeyDown:N,disabled:!M,touchRippleRef:v},(r=f.slotProps)==null?void 0:r.baseCheckbox,u))}),Ree=kee,Nee=["field","colDef"],Dee=t=>{const{classes:e}=t;return ft({root:["checkboxInput"]},pt,e)},Mee=p.forwardRef(function(e,n){var r;const s=He(e,Nee),[,o]=p.useState(!1),i=mt(),a=$e(),l={classes:a.classes},c=Dee(l),u=Re(i,JF),h=Re(i,ys),f=Re(i,mm),g=Re(i,bj),y=p.useMemo(()=>typeof a.isRowSelectable!="function"?h:h.filter(b=>i.current.getRow(b)?a.isRowSelectable(i.current.getRowParams(b)):!1),[i,a.isRowSelectable,h]),w=p.useMemo(()=>(!a.pagination||!a.checkboxSelectionVisibleOnly?f:g).reduce((I,P)=>(I[P]=!0,I),{}),[a.pagination,a.checkboxSelectionVisibleOnly,g,f]),v=p.useMemo(()=>y.filter(b=>w[b]).length,[y,w]),C=v>0&&v<Object.keys(w).length,x=v>0,A=b=>{const I={value:b.target.checked};i.current.publishEvent("headerSelectionCheckboxChange",I)},N=u!==null&&u.field===e.field?0:-1;p.useLayoutEffect(()=>{const b=i.current.getColumnHeaderElement(e.field);N===0&&b&&(b.tabIndex=-1)},[N,i,e.field]);const M=p.useCallback(b=>{b.key===" "&&i.current.publishEvent("headerSelectionCheckboxChange",{value:!x})},[i,x]),k=p.useCallback(()=>{o(b=>!b)},[]);p.useEffect(()=>i.current.subscribeEvent("rowSelectionChange",k),[i,k]);const E=i.current.getLocaleText(x?"checkboxSelectionUnselectAllRows":"checkboxSelectionSelectAllRows");return d.jsx(a.slots.baseCheckbox,B({ref:n,indeterminate:C,checked:x,onChange:A,className:c.root,inputProps:{"aria-label":E},tabIndex:N,onKeyDown:M},(r=a.slotProps)==null?void 0:r.baseCheckbox,s))}),ZP=ct(d.jsx("path",{d:"M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"}),"ArrowUpward"),ek=ct(d.jsx("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward"),tk=ct(d.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"KeyboardArrowRight"),nk=ct(d.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),Oee=ct(d.jsx("path",{d:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"}),"FilterList"),rk=ct(d.jsx("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z"}),"FilterAlt"),Lee=ct(d.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");ct(d.jsx("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),"Menu");ct(d.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle");const Fee=ct(d.jsx("path",{d:"M6 5H3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zm14 0h-3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zm-7 0h-3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1z"}),"ColumnIcon"),jee=ct(d.jsx("path",{d:"M11 19V5h2v14z"}),"Separator"),Vee=ct(d.jsx("path",{d:"M4 15h16v-2H4v2zm0 4h16v-2H4v2zm0-8h16V9H4v2zm0-6v2h16V5H4z"}),"ViewHeadline"),Bee=ct(d.jsx("path",{d:"M21,8H3V4h18V8z M21,10H3v4h18V10z M21,16H3v4h18V16z"}),"TableRows"),Uee=ct(d.jsx("path",{d:"M4 18h17v-6H4v6zM4 5v6h17V5H4z"}),"ViewStream"),Hee=ct(d.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"TripleDotsVertical"),kv=ct(d.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),sk=ct(d.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add"),$ee=ct(d.jsx("path",{d:"M19 13H5v-2h14v2z"}),"Remove"),zee=ct(d.jsx("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"}),"Load"),ok=ct(d.jsx("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"Drag"),Gee=ct(d.jsx("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"}),"SaveAlt"),Wee=ct(d.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),Kee=ct(d.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert"),qee=ct(d.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}),"VisibilityOff"),Qee=ct(d.jsx("g",{children:d.jsx("path",{d:"M14.67,5v14H9.33V5H14.67z M15.67,19H21V5h-5.33V19z M8.33,19V5H3v14H8.33z"})}),"ViewColumn"),Yee=ct(d.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");ct(d.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");const Jee=ct(d.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),Xee=["hideMenu","colDef","id","labelledby","className","children","open"],Zee=bn(I2)(()=>({minWidth:248})),ete=p.forwardRef(function(e,n){const{hideMenu:r,id:s,labelledby:o,className:i,children:a,open:l}=e,c=He(e,Xee),u=p.useCallback(h=>{ij(h.key)&&h.preventDefault(),XX(h.key)&&r(h)},[r]);return d.jsx(Zee,B({id:s,ref:n,className:At(q.menuList,i),"aria-labelledby":o,onKeyDown:u,autoFocus:l},c,{children:a}))}),tte=["displayOrder"],nte=t=>{const e=ol(),{defaultSlots:n,defaultSlotProps:r,slots:s={},slotProps:o={},hideMenu:i,colDef:a,addDividers:l=!0}=t,c=p.useMemo(()=>B({},n,s),[n,s]),u=p.useMemo(()=>{if(!o||Object.keys(o).length===0)return r;const g=B({},o);return Object.entries(r).forEach(([y,w])=>{g[y]=B({},w,o[y]||{})}),g},[r,o]),h=e.current.unstable_applyPipeProcessors("columnMenu",[],t.colDef),f=p.useMemo(()=>{const g=Object.keys(n);return Object.keys(s).filter(y=>!g.includes(y))},[s,n]);return p.useMemo(()=>{const w=Array.from(new Set([...h,...f])).filter(v=>c[v]!=null).sort((v,C)=>{const x=u[v],A=u[C],N=Number.isFinite(x?.displayOrder)?x.displayOrder:100,M=Number.isFinite(A?.displayOrder)?A.displayOrder:100;return N-M});return w.reduce((v,C,x)=>{let A={colDef:a,onClick:i};const N=u[C];if(N){const M=He(N,tte);A=B({},A,M)}return l&&x!==w.length-1?[...v,[c[C],A],[$B,{}]]:[...v,[c[C],A]]},[])},[l,a,h,i,c,u,f])};function rte(t){const{colDef:e,onClick:n}=t,r=mt(),s=$e(),a=Qn(r).filter(c=>c.disableColumnMenu!==!0).length===1,l=p.useCallback(c=>{a||(r.current.setColumnVisibility(e.field,!1),n(c))},[r,e.field,n,a]);return s.disableColumnSelector||e.hideable===!1?null:d.jsxs(Bn,{onClick:l,disabled:a,children:[d.jsx(vo,{children:d.jsx(s.slots.columnMenuHideIcon,{fontSize:"small"})}),d.jsx(xo,{children:r.current.getLocaleText("columnMenuHideColumn")})]})}function ste(t){const{onClick:e}=t,n=mt(),r=$e(),s=p.useCallback(o=>{e(o),n.current.showPreferences(Bc.columns)},[n,e]);return r.disableColumnSelector?null:d.jsxs(Bn,{onClick:s,children:[d.jsx(vo,{children:d.jsx(r.slots.columnMenuManageColumnsIcon,{fontSize:"small"})}),d.jsx(xo,{children:n.current.getLocaleText("columnMenuManageColumns")})]})}function ote(t){return d.jsxs(p.Fragment,{children:[d.jsx(rte,B({},t)),d.jsx(ste,B({},t))]})}function ite(t){const{colDef:e,onClick:n}=t,r=mt(),s=$e(),o=p.useCallback(i=>{n(i),r.current.showFilterPanel(e.field)},[r,e.field,n]);return s.disableColumnFilter||!e.filterable?null:d.jsxs(Bn,{onClick:o,children:[d.jsx(vo,{children:d.jsx(s.slots.columnMenuFilterIcon,{fontSize:"small"})}),d.jsx(xo,{children:r.current.getLocaleText("columnMenuFilter")})]})}function ate(t){var e;const{colDef:n,onClick:r}=t,s=mt(),o=Re(s,ps),i=$e(),a=p.useMemo(()=>{if(!n)return null;const h=o.find(f=>f.field===n.field);return h?.sort},[n,o]),l=(e=n.sortingOrder)!=null?e:i.sortingOrder,c=p.useCallback(h=>{r(h);const f=h.currentTarget.getAttribute("data-value")||null;s.current.sortColumn(n,f===a?null:f)},[s,n,r,a]);if(!n||!n.sortable||!l.some(h=>!!h))return null;const u=h=>{const f=s.current.getLocaleText(h);return typeof f=="function"?f(n):f};return d.jsxs(p.Fragment,{children:[l.includes("asc")&&a!=="asc"?d.jsxs(Bn,{onClick:c,"data-value":"asc",children:[d.jsx(vo,{children:d.jsx(i.slots.columnMenuSortAscendingIcon,{fontSize:"small"})}),d.jsx(xo,{children:u("columnMenuSortAsc")})]}):null,l.includes("desc")&&a!=="desc"?d.jsxs(Bn,{onClick:c,"data-value":"desc",children:[d.jsx(vo,{children:d.jsx(i.slots.columnMenuSortDescendingIcon,{fontSize:"small"})}),d.jsx(xo,{children:u("columnMenuSortDesc")})]}):null,l.includes(null)&&a!=null?d.jsxs(Bn,{onClick:c,children:[d.jsx(vo,{}),d.jsx(xo,{children:s.current.getLocaleText("columnMenuUnsort")})]}):null]})}const lte=["defaultSlots","defaultSlotProps","slots","slotProps"],cte={columnMenuSortItem:ate,columnMenuFilterItem:ite,columnMenuColumnsItem:ote},ute={columnMenuSortItem:{displayOrder:10},columnMenuFilterItem:{displayOrder:20},columnMenuColumnsItem:{displayOrder:30}},dte=p.forwardRef(function(e,n){const{defaultSlots:r,defaultSlotProps:s,slots:o,slotProps:i}=e,a=He(e,lte),l=nte(B({},a,{defaultSlots:r,defaultSlotProps:s,slots:o,slotProps:i}));return d.jsx(ete,B({ref:n},a,{children:l.map(([c,u],h)=>d.jsx(c,B({},u),h))}))}),hte=p.forwardRef(function(e,n){return d.jsx(dte,B({},e,{ref:n,defaultSlots:cte,defaultSlotProps:ute}))}),fte=["className"],mte=t=>{const{classes:e}=t;return ft({root:["panelContent"]},pt,e)},pte=Zn("div",{name:"MuiDataGrid",slot:"PanelContent",overridesResolver:(t,e)=>e.panelContent})({display:"flex",flexDirection:"column",overflow:"auto",flex:"1 1",maxHeight:400});function Aj(t){const{className:e}=t,n=He(t,fte),r=$e(),s=mte(r);return d.jsx(pte,B({className:At(e,s.root),ownerState:r},n))}const gte=["className"],yte=t=>{const{classes:e}=t;return ft({root:["panelFooter"]},pt,e)},wte=Zn("div",{name:"MuiDataGrid",slot:"PanelFooter",overridesResolver:(t,e)=>e.panelFooter})(({theme:t})=>({padding:t.spacing(.5),display:"flex",justifyContent:"space-between"}));function Sj(t){const{className:e}=t,n=He(t,gte),r=$e(),s=yte(r);return d.jsx(wte,B({className:At(e,s.root),ownerState:r},n))}const bte=["className"],vte=t=>{const{classes:e}=t;return ft({root:["panelHeader"]},pt,e)},xte=Zn("div",{name:"MuiDataGrid",slot:"PanelHeader",overridesResolver:(t,e)=>e.panelHeader})(({theme:t})=>({padding:t.spacing(1)}));function Cte(t){const{className:e}=t,n=He(t,bte),r=$e(),s=vte(r);return d.jsx(xte,B({className:At(e,s.root),ownerState:r},n))}const Ete=["className","slotProps"],Ite=t=>{const{classes:e}=t;return ft({root:["panelWrapper"]},pt,e)},_te=bn("div",{name:"MuiDataGrid",slot:"PanelWrapper",overridesResolver:(t,e)=>e.panelWrapper})({display:"flex",flexDirection:"column",flex:1,"&:focus":{outline:0}}),Ate=()=>!0,Tj=p.forwardRef(function(e,n){const{className:r,slotProps:s={}}=e,o=He(e,Ete),i=$e(),a=Ite(i);return d.jsx(zB,B({open:!0,disableEnforceFocus:!0,isEnabled:Ate},s.TrapFocus,{children:d.jsx(_te,B({ref:n,tabIndex:-1,className:At(r,a.root),ownerState:i},o))}))}),Ste=!1,Tte=["sort","searchPredicate","autoFocusSearchField","disableHideAllButton","disableShowAllButton","getTogglableColumns"],Pte=t=>{const{classes:e}=t;return ft({root:["columnsPanel"],columnsPanelRow:["columnsPanelRow"]},pt,e)},kte=bn("div",{name:"MuiDataGrid",slot:"ColumnsPanel",overridesResolver:(t,e)=>e.columnsPanel})({padding:"8px 0px 8px 8px"}),Rte=bn("div",{name:"MuiDataGrid",slot:"ColumnsPanelRow",overridesResolver:(t,e)=>e.columnsPanelRow})(({theme:t})=>({display:"flex",justifyContent:"space-between",padding:"1px 8px 1px 7px",[`& .${WB.root}`]:{marginRight:t.spacing(.5)}}));bn(Bd)({justifyContent:"flex-end"});const ik=new Intl.Collator,Nte=(t,e)=>(t.headerName||t.field).toLowerCase().indexOf(e)>-1;function Dte(t){var e,n,r;const s=mt(),o=p.useRef(null),i=Re(s,Mo),a=Re(s,Gs),l=$e(),[c,u]=p.useState(""),h=Pte(l),{sort:f,searchPredicate:g=Nte,autoFocusSearchField:y=!0,disableHideAllButton:w=!1,disableShowAllButton:v=!1,getTogglableColumns:C}=t,x=He(t,Tte),A=p.useMemo(()=>{switch(f){case"asc":return[...i].sort((S,D)=>ik.compare(S.headerName||S.field,D.headerName||D.field));case"desc":return[...i].sort((S,D)=>-ik.compare(S.headerName||S.field,D.headerName||D.field));default:return i}},[i,f]),N=S=>{const{name:D}=S.target;s.current.setColumnVisibility(D,a[D]===!1)},M=p.useCallback(S=>{const D=Gs(s),T=B({},D),j=C?C(i):null;return i.forEach(R=>{R.hideable&&(j==null||j.includes(R.field))&&(S?delete T[R.field]:T[R.field]=!1)}),s.current.setColumnVisibilityModel(T)},[s,i,C]),k=p.useCallback(S=>{u(S.target.value)},[]),E=p.useMemo(()=>{const S=C?C(A):null,D=S?A.filter(({field:T})=>S.includes(T)):A;return c?D.filter(T=>g(T,c.toLowerCase())):D},[A,c,g,C]),b=p.useRef(null);p.useEffect(()=>{y?o.current.focus():b.current&&typeof b.current.focus=="function"&&b.current.focus()},[y]);let I=!1;const P=S=>I===!1&&S.hideable!==!1?(I=!0,!0):!1;return d.jsxs(Tj,B({},x,{children:[d.jsx(Cte,{children:d.jsx(l.slots.baseTextField,B({label:s.current.getLocaleText("columnsPanelTextFieldLabel"),placeholder:s.current.getLocaleText("columnsPanelTextFieldPlaceholder"),inputRef:o,value:c,onChange:k,variant:"standard",fullWidth:!0},(e=l.slotProps)==null?void 0:e.baseTextField))}),d.jsx(Aj,{children:d.jsx(kte,{className:h.root,ownerState:l,children:E.map(S=>{var D;return d.jsxs(Rte,{className:h.columnsPanelRow,ownerState:l,children:[d.jsx(GB,{control:d.jsx(l.slots.baseSwitch,B({disabled:S.hideable===!1,checked:a[S.field]!==!1,onClick:N,name:S.field,size:"small",inputRef:P(S)?b:void 0},(D=l.slotProps)==null?void 0:D.baseSwitch)),label:S.headerName||S.field}),!l.disableColumnReorder&&Ste]},S.field)})})}),v&&w?null:d.jsxs(Sj,{children:[w?d.jsx("span",{}):d.jsx(l.slots.baseButton,B({onClick:()=>M(!1)},(n=l.slotProps)==null?void 0:n.baseButton,{disabled:w,children:s.current.getLocaleText("columnsPanelHideAllButton")})),v?null:d.jsx(l.slots.baseButton,B({onClick:()=>M(!0)},(r=l.slotProps)==null?void 0:r.baseButton,{disabled:v,children:s.current.getLocaleText("columnsPanelShowAllButton")}))]})]}))}const Mte=["children","className","classes"],Ote=x2("MuiDataGrid",["panel","paper"]),Lte=bn(d1,{name:"MuiDataGrid",slot:"Panel",overridesResolver:(t,e)=>e.panel})(({theme:t})=>({zIndex:t.zIndex.modal})),Fte=bn(wm,{name:"MuiDataGrid",slot:"Paper",overridesResolver:(t,e)=>e.paper})(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,minWidth:300,maxHeight:450,display:"flex"})),jte=p.forwardRef((t,e)=>{const{children:n,className:r}=t,s=He(t,Mte),o=mt(),i=$e(),a=Ote,[l,c]=p.useState(!1),u=p.useCallback(()=>{o.current.hidePreferences()},[o]),h=p.useCallback(w=>{Nw(w.key)&&o.current.hidePreferences()},[o]),f=p.useMemo(()=>[{name:"flip",enabled:!0,options:{rootBoundary:"document"}},{name:"isPlaced",enabled:!0,phase:"main",fn:()=>{c(!0)},effect:()=>()=>{c(!1)}}],[]),[g,y]=p.useState(null);return p.useEffect(()=>{var w;const v=(w=o.current.rootElementRef)==null||(w=w.current)==null?void 0:w.querySelector(`.${q.columnHeaders}`);v&&y(v)},[o]),g?d.jsx(Lte,B({ref:e,placement:"bottom-start",className:At(r,a.panel),ownerState:i,anchorEl:g,modifiers:f},s,{children:d.jsx(E2,{mouseEvent:"onMouseUp",onClickAway:u,children:d.jsx(Fte,{className:a.paper,ownerState:i,elevation:8,onKeyDown:h,children:l&&n})})})):null}),Vte=p.forwardRef(function(e,n){var r,s,o;const i=mt(),a=Re(i,Mo),l=$e(),c=Re(i,zm),u=i.current.unstable_applyPipeProcessors("preferencePanel",null,(r=c.openedPanelValue)!=null?r:Bc.filters);return d.jsx(l.slots.panel,B({ref:n,as:l.slots.basePopper,open:a.length>0&&c.open,id:c.panelId,"aria-labelledby":c.labelId},(s=l.slotProps)==null?void 0:s.panel,e,(o=l.slotProps)==null?void 0:o.basePopper,{children:u}))}),Bte=["item","hasMultipleFilters","deleteFilter","applyFilterChanges","multiFilterOperator","showMultiFilterOperators","disableMultiFilterOperator","applyMultiFilterOperatorChanges","focusElementRef","logicOperators","columnsSort","filterColumns","deleteIconProps","logicOperatorInputProps","operatorInputProps","columnInputProps","valueInputProps","children"],Ute=["InputComponentProps"],Hte=t=>{const{classes:e}=t;return ft({root:["filterForm"],deleteIcon:["filterFormDeleteIcon"],logicOperatorInput:["filterFormLogicOperatorInput"],columnInput:["filterFormColumnInput"],operatorInput:["filterFormOperatorInput"],valueInput:["filterFormValueInput"]},pt,e)},$te=bn("div",{name:"MuiDataGrid",slot:"FilterForm",overridesResolver:(t,e)=>e.filterForm})(({theme:t})=>({display:"flex",padding:t.spacing(1)})),zte=bn("div",{name:"MuiDataGrid",slot:"FilterFormDeleteIcon",overridesResolver:(t,e)=>e.filterFormDeleteIcon})(({theme:t})=>({flexShrink:0,justifyContent:"flex-end",marginRight:t.spacing(.5),marginBottom:t.spacing(.2)})),Gte=bn("div",{name:"MuiDataGrid",slot:"FilterFormLogicOperatorInput",overridesResolver:(t,e)=>e.filterFormLogicOperatorInput})({minWidth:55,marginRight:5,justifyContent:"end"}),Wte=bn("div",{name:"MuiDataGrid",slot:"FilterFormColumnInput",overridesResolver:(t,e)=>e.filterFormColumnInput})({width:150}),Kte=bn("div",{name:"MuiDataGrid",slot:"FilterFormOperatorInput",overridesResolver:(t,e)=>e.filterFormOperatorInput})({width:120}),qte=bn("div",{name:"MuiDataGrid",slot:"FilterFormValueInput",overridesResolver:(t,e)=>e.filterFormValueInput})({width:190}),Qte=t=>{switch(t){case Rr.And:return"filterPanelOperatorAnd";case Rr.Or:return"filterPanelOperatorOr";default:throw new Error("MUI: Invalid `logicOperator` property in the `GridFilterPanel`.")}},mf=t=>t.headerName||t.field,ak=new Intl.Collator,Yte=p.forwardRef(function(e,n){var r,s,o,i,a,l,c,u,h,f;const{item:g,hasMultipleFilters:y,deleteFilter:w,applyFilterChanges:v,multiFilterOperator:C,showMultiFilterOperators:x,disableMultiFilterOperator:A,applyMultiFilterOperatorChanges:N,focusElementRef:M,logicOperators:k=[Rr.And,Rr.Or],columnsSort:E,filterColumns:b,deleteIconProps:I={},logicOperatorInputProps:P={},operatorInputProps:S={},columnInputProps:D={},valueInputProps:T={}}=e,j=He(e,Bte),R=mt(),V=Re(R,$F),U=Re(R,Ln),F=En(),$=En(),W=En(),Z=En(),Y=$e(),le=Hte(Y),fe=p.useRef(null),we=p.useRef(null),Me=y&&k.length>0,Ee=((r=Y.slotProps)==null?void 0:r.baseFormControl)||{},ue=(o=(((s=Y.slotProps)==null?void 0:s.baseSelect)||{}).native)!=null?o:!0,re=((i=Y.slotProps)==null?void 0:i.baseInputLabel)||{},ie=((a=Y.slotProps)==null?void 0:a.baseSelectOption)||{},{InputComponentProps:Ce}=T,K=He(T,Ute),me=p.useMemo(()=>{if(b===void 0||typeof b!="function")return V;const Ie=b({field:g.field,columns:V,currentFilters:U?.items||[]});return V.filter(be=>Ie.includes(be.field))},[b,U?.items,V,g.field]),Q=p.useMemo(()=>{switch(E){case"asc":return me.sort((Ie,be)=>ak.compare(mf(Ie),mf(be)));case"desc":return me.sort((Ie,be)=>-ak.compare(mf(Ie),mf(be)));default:return me}},[me,E]),ee=g.field?R.current.getColumn(g.field):null,de=p.useMemo(()=>{var Ie;return!g.operator||!ee?null:(Ie=ee.filterOperators)==null?void 0:Ie.find(be=>be.value===g.operator)},[g,ee]),ye=p.useCallback(Ie=>{const be=Ie.target.value,Se=R.current.getColumn(be);if(Se.field===ee.field)return;const De=Se.filterOperators.find(gt=>gt.value===g.operator)||Se.filterOperators[0],Ye=!De.InputComponent||De.InputComponent!==de?.InputComponent||Se.type!==ee.type;v(B({},g,{field:be,operator:De.value,value:Ye?void 0:g.value}))},[R,v,g,ee,de]),pe=p.useCallback(Ie=>{const be=Ie.target.value,Se=ee?.filterOperators.find(Ye=>Ye.value===be),De=!(Se!=null&&Se.InputComponent)||Se?.InputComponent!==de?.InputComponent;v(B({},g,{operator:be,value:De?void 0:g.value}))},[v,g,ee,de]),_e=p.useCallback(Ie=>{const be=Ie.target.value===Rr.And.toString()?Rr.And:Rr.Or;N(be)},[N]),qe=()=>{Y.disableMultipleColumnsFiltering?g.value===void 0?w(g):v(B({},g,{value:void 0})):w(g)};return p.useImperativeHandle(M,()=>({focus:()=>{if(de!=null&&de.InputComponent){var Ie;fe==null||(Ie=fe.current)==null||Ie.focus()}else we.current.focus()}}),[de]),d.jsxs($te,B({ref:n,className:le.root,"data-id":g.id,ownerState:Y},j,{children:[d.jsx(zte,B({variant:"standard",as:Y.slots.baseFormControl},Ee,I,{className:At(le.deleteIcon,Ee.className,I.className),ownerState:Y,children:d.jsx(Y.slots.baseIconButton,B({"aria-label":R.current.getLocaleText("filterPanelDeleteIconLabel"),title:R.current.getLocaleText("filterPanelDeleteIconLabel"),onClick:qe,size:"small"},(l=Y.slotProps)==null?void 0:l.baseIconButton,{children:d.jsx(Y.slots.filterPanelDeleteIcon,{fontSize:"small"})}))})),d.jsx(Gte,B({variant:"standard",as:Y.slots.baseFormControl},Ee,P,{sx:B({display:Me?"flex":"none",visibility:x?"visible":"hidden"},Ee.sx||{},P.sx||{}),className:At(le.logicOperatorInput,Ee.className,P.className),ownerState:Y,children:d.jsx(Y.slots.baseSelect,B({inputProps:{"aria-label":R.current.getLocaleText("filterPanelLogicOperator")},value:C,onChange:_e,disabled:!!A||k.length===1,native:ue},(c=Y.slotProps)==null?void 0:c.baseSelect,{children:k.map(Ie=>p.createElement(Y.slots.baseSelectOption,B({},ie,{native:ue,key:Ie.toString(),value:Ie.toString()}),R.current.getLocaleText(Qte(Ie))))}))})),d.jsxs(Wte,B({variant:"standard",as:Y.slots.baseFormControl},Ee,D,{className:At(le.columnInput,Ee.className,D.className),ownerState:Y,children:[d.jsx(Y.slots.baseInputLabel,B({},re,{htmlFor:F,id:$,children:R.current.getLocaleText("filterPanelColumns")})),d.jsx(Y.slots.baseSelect,B({labelId:$,id:F,label:R.current.getLocaleText("filterPanelColumns"),value:g.field||"",onChange:ye,native:ue},(u=Y.slotProps)==null?void 0:u.baseSelect,{children:Q.map(Ie=>p.createElement(Y.slots.baseSelectOption,B({},ie,{native:ue,key:Ie.field,value:Ie.field}),mf(Ie)))}))]})),d.jsxs(Kte,B({variant:"standard",as:Y.slots.baseFormControl},Ee,S,{className:At(le.operatorInput,Ee.className,S.className),ownerState:Y,children:[d.jsx(Y.slots.baseInputLabel,B({},re,{htmlFor:W,id:Z,children:R.current.getLocaleText("filterPanelOperator")})),d.jsx(Y.slots.baseSelect,B({labelId:Z,label:R.current.getLocaleText("filterPanelOperator"),id:W,value:g.operator,onChange:pe,native:ue,inputRef:we},(h=Y.slotProps)==null?void 0:h.baseSelect,{children:ee==null||(f=ee.filterOperators)==null?void 0:f.map(Ie=>p.createElement(Y.slots.baseSelectOption,B({},ie,{native:ue,key:Ie.value,value:Ie.value}),Ie.label||R.current.getLocaleText(`filterOperator${Ec(Ie.value)}`)))}))]})),d.jsx(qte,B({variant:"standard",as:Y.slots.baseFormControl},Ee,K,{className:At(le.valueInput,Ee.className,K.className),ownerState:Y,children:de!=null&&de.InputComponent?d.jsx(de.InputComponent,B({apiRef:R,item:g,applyValue:v,focusElementRef:fe},de.InputComponentProps,Ce)):null}))]}))});class NI{constructor(){this.currentId=0,this.clear=()=>{this.currentId!==0&&(clearTimeout(this.currentId),this.currentId=0)},this.disposeEffect=()=>this.clear}static create(){return new NI}start(e,n){this.clear(),this.currentId=setTimeout(n,e)}}function DI(){const t=wI(NI.create).current;return UF(t.disposeEffect),t}const Jte=["item","applyValue","type","apiRef","focusElementRef","tabIndex","disabled","isFilterActive","clearButton","InputProps","variant"];function yo(t){var e,n;const{item:r,applyValue:s,type:o,apiRef:i,focusElementRef:a,tabIndex:l,disabled:c,clearButton:u,InputProps:h,variant:f="standard"}=t,g=He(t,Jte),y=DI(),[w,v]=p.useState((e=r.value)!=null?e:""),[C,x]=p.useState(!1),A=En(),N=$e(),M=p.useCallback(k=>{const{value:E}=k.target;v(String(E)),x(!0),y.start(N.filterDebounceMs,()=>{const b=B({},r,{value:E,fromInput:A});s(b),x(!1)})},[A,s,r,N.filterDebounceMs,y]);return p.useEffect(()=>{if(r.fromInput!==A||r.value===void 0){var E;v(String((E=r.value)!=null?E:""))}},[A,r]),d.jsx(N.slots.baseTextField,B({id:A,label:i.current.getLocaleText("filterPanelInputLabel"),placeholder:i.current.getLocaleText("filterPanelInputPlaceholder"),value:w,onChange:M,variant:f,type:o||"text",InputProps:B({},C||u?{endAdornment:C?d.jsx(N.slots.loadIcon,{fontSize:"small",color:"action"}):u}:{},{disabled:c},h,{inputProps:B({tabIndex:l},h?.inputProps)}),InputLabelProps:{shrink:!0},inputRef:a},g,(n=N.slotProps)==null?void 0:n.baseTextField))}const Xte=["item","applyValue","type","apiRef","focusElementRef","InputProps","isFilterActive","clearButton","tabIndex","disabled"];function fu(t){var e,n;const{item:r,applyValue:s,type:o,apiRef:i,focusElementRef:a,InputProps:l,clearButton:c,tabIndex:u,disabled:h}=t,f=He(t,Xte),g=DI(),[y,w]=p.useState((e=r.value)!=null?e:""),[v,C]=p.useState(!1),x=En(),A=$e(),N=p.useCallback(M=>{const k=M.target.value;w(String(k)),C(!0),g.start(A.filterDebounceMs,()=>{s(B({},r,{value:k})),C(!1)})},[s,r,A.filterDebounceMs,g]);return p.useEffect(()=>{var M;const k=(M=r.value)!=null?M:"";w(String(k))},[r.value]),d.jsx(A.slots.baseTextField,B({fullWidth:!0,id:x,label:i.current.getLocaleText("filterPanelInputLabel"),placeholder:i.current.getLocaleText("filterPanelInputPlaceholder"),value:y,onChange:N,variant:"standard",type:o||"text",InputLabelProps:{shrink:!0},inputRef:a,InputProps:B({},v||c?{endAdornment:v?d.jsx(A.slots.loadIcon,{fontSize:"small",color:"action"}):c}:{},{disabled:h},l,{inputProps:B({max:o==="datetime-local"?"9999-12-31T23:59":"9999-12-31",tabIndex:u},l?.inputProps)})},f,(n=A.slotProps)==null?void 0:n.baseTextField))}const Zte=["item","applyValue","type","apiRef","focusElementRef","getOptionLabel","getOptionValue","placeholder","tabIndex","label","variant","isFilterActive","clearButton","InputLabelProps"],ene=({column:{valueOptions:t,field:e},OptionComponent:n,getOptionLabel:r,getOptionValue:s,isSelectNative:o,baseSelectOptionProps:i})=>(typeof t=="function"?["",...t({field:e})]:["",...t||[]]).map(l=>{const c=s(l),u=r(l);return p.createElement(n,B({},i,{native:o,key:c,value:c}),u)}),tne=bn("div")({display:"flex",alignItems:"flex-end",width:"100%","& button":{margin:"auto 0px 5px 5px"}});function lk(t){var e,n,r,s,o,i,a,l;const{item:c,applyValue:u,type:h,apiRef:f,focusElementRef:g,getOptionLabel:y,getOptionValue:w,placeholder:v,tabIndex:C,label:x,variant:A="standard",clearButton:N}=t,M=He(t,Zte),[k,E]=p.useState((e=c.value)!=null?e:""),b=En(),I=En(),P=$e(),S=(n=(r=P.slotProps)==null||(r=r.baseSelect)==null?void 0:r.native)!=null?n:!0;let D=null;if(c.field){const F=f.current.getColumn(c.field);bc(F)&&(D=F)}const T=w||((s=D)==null?void 0:s.getOptionValue),j=y||((o=D)==null?void 0:o.getOptionLabel),R=p.useMemo(()=>{if(D)return typeof D.valueOptions=="function"?D.valueOptions({field:D.field}):D.valueOptions},[D]),V=p.useCallback(F=>{let $=F.target.value;$=bC($,R,T),E(String($)),u(B({},c,{value:$}))},[R,T,u,c]);if(p.useEffect(()=>{var F;let $;if(R!==void 0){if($=bC(c.value,R,T),$!==c.value){u(B({},c,{value:$}));return}}else $=c.value;$=(F=$)!=null?F:"",E(String($))},[c,R,u,T]),!bc(D)||!bc(D))return null;const U=x??f.current.getLocaleText("filterPanelInputLabel");return d.jsxs(tne,{children:[d.jsxs(P.slots.baseFormControl,{children:[d.jsx(P.slots.baseInputLabel,B({},(i=P.slotProps)==null?void 0:i.baseInputLabel,{id:I,htmlFor:b,shrink:!0,variant:A,children:U})),d.jsx(P.slots.baseSelect,B({id:b,label:U,labelId:I,value:k,onChange:V,variant:A,type:h||"text",inputProps:{tabIndex:C,ref:g,placeholder:v??f.current.getLocaleText("filterPanelInputPlaceholder")},native:S,notched:A==="outlined"?!0:void 0},M,(a=P.slotProps)==null?void 0:a.baseSelect,{children:ene({column:D,OptionComponent:P.slots.baseSelectOption,getOptionLabel:j,getOptionValue:T,isSelectNative:S,baseSelectOptionProps:(l=P.slotProps)==null?void 0:l.baseSelectOption})}))]}),N]})}const nne=["item","applyValue","apiRef","focusElementRef","isFilterActive","clearButton","tabIndex","label","variant","InputLabelProps"],rne=bn("div")({display:"flex",alignItems:"center",width:"100%","& button":{margin:"auto 0px 5px 5px"}});function sne(t){var e,n,r,s;const{item:o,applyValue:i,apiRef:a,focusElementRef:l,clearButton:c,tabIndex:u,label:h,variant:f="standard"}=t,g=He(t,nne),[y,w]=p.useState(o.value||""),v=$e(),C=En(),x=En(),A=((e=v.slotProps)==null?void 0:e.baseSelect)||{},N=(n=A.native)!=null?n:!0,M=((r=v.slotProps)==null?void 0:r.baseSelectOption)||{},k=p.useCallback(b=>{const I=b.target.value;w(I),i(B({},o,{value:I}))},[i,o]);p.useEffect(()=>{w(o.value||"")},[o.value]);const E=h??a.current.getLocaleText("filterPanelInputLabel");return d.jsxs(rne,{children:[d.jsxs(v.slots.baseFormControl,{fullWidth:!0,children:[d.jsx(v.slots.baseInputLabel,B({},(s=v.slotProps)==null?void 0:s.baseInputLabel,{id:C,shrink:!0,variant:f,children:E})),d.jsxs(v.slots.baseSelect,B({labelId:C,id:x,label:E,value:y,onChange:k,variant:f,notched:f==="outlined"?!0:void 0,native:N,displayEmpty:!0,inputProps:{ref:l,tabIndex:u}},g,A,{children:[d.jsx(v.slots.baseSelectOption,B({},M,{native:N,value:"",children:a.current.getLocaleText("filterValueAny")})),d.jsx(v.slots.baseSelectOption,B({},M,{native:N,value:"true",children:a.current.getLocaleText("filterValueTrue")})),d.jsx(v.slots.baseSelectOption,B({},M,{native:N,value:"false",children:a.current.getLocaleText("filterValueFalse")}))]}))]}),c]})}const one=["logicOperators","columnsSort","filterFormProps","getColumnForNewFilter","children","disableAddFilterButton","disableRemoveAllButton"],ck=t=>({field:t.field,operator:t.filterOperators[0].value,id:Math.round(Math.random()*1e5)}),ine=p.forwardRef(function(e,n){var r,s;const o=mt(),i=$e(),a=Re(o,Ln),l=Re(o,$F),c=p.useRef(null),u=p.useRef(null),{logicOperators:h=[Rr.And,Rr.Or],columnsSort:f,filterFormProps:g,getColumnForNewFilter:y,disableAddFilterButton:w=!1,disableRemoveAllButton:v=!1}=e,C=He(e,one),x=o.current.upsertFilterItem,A=p.useCallback(S=>{o.current.setFilterLogicOperator(S)},[o]),N=p.useCallback(()=>{let S;if(y&&typeof y=="function"){const D=y({currentFilters:a?.items||[],columns:l});if(D===null)return null;S=l.find(({field:T})=>T===D)}else S=l.find(D=>{var T;return(T=D.filterOperators)==null?void 0:T.length});return S?ck(S):null},[a?.items,l,y]),M=p.useCallback(()=>{if(y===void 0||typeof y!="function")return N();const S=a.items.length?a.items:[N()].filter(Boolean),D=y({currentFilters:S,columns:l});if(D===null)return null;const T=l.find(({field:j})=>j===D);return T?ck(T):null},[a.items,l,y,N]),k=p.useMemo(()=>a.items.length?a.items:(u.current||(u.current=N()),u.current?[u.current]:[]),[a.items,N]),E=k.length>1,b=()=>{const S=M();S&&o.current.upsertFilterItems([...k,S])},I=p.useCallback(S=>{const D=k.length===1;o.current.deleteFilterItem(S),D&&o.current.hideFilterPanel()},[o,k.length]),P=()=>{k.length===1&&k[0].value===void 0&&(o.current.deleteFilterItem(k[0]),o.current.hideFilterPanel()),o.current.setFilterModel(B({},a,{items:[]}))};return p.useEffect(()=>{h.length>0&&a.logicOperator&&!h.includes(a.logicOperator)&&A(h[0])},[h,A,a.logicOperator]),p.useEffect(()=>{k.length>0&&c.current.focus()},[k.length]),d.jsxs(Tj,B({ref:n},C,{children:[d.jsx(Aj,{children:k.map((S,D)=>d.jsx(Yte,B({item:S,applyFilterChanges:x,deleteFilter:I,hasMultipleFilters:E,showMultiFilterOperators:D>0,multiFilterOperator:a.logicOperator,disableMultiFilterOperator:D!==1,applyMultiFilterOperatorChanges:A,focusElementRef:D===k.length-1?c:null,logicOperators:h,columnsSort:f},g),S.id==null?D:S.id))}),!i.disableMultipleColumnsFiltering&&!(w&&v)?d.jsxs(Sj,{children:[w?d.jsx("span",{}):d.jsx(i.slots.baseButton,B({onClick:b,startIcon:d.jsx(i.slots.filterPanelAddIcon,{})},(r=i.slotProps)==null?void 0:r.baseButton,{children:o.current.getLocaleText("filterPanelAddFilter")})),v?null:d.jsx(i.slots.baseButton,B({onClick:P,startIcon:d.jsx(i.slots.filterPanelRemoveAllIcon,{})},(s=i.slotProps)==null?void 0:s.baseButton,{children:o.current.getLocaleText("filterPanelRemoveAll")}))]}):null]}))}),ane=["item","applyValue","type","apiRef","focusElementRef","color","error","helperText","size","variant"];function Pj(t){const{item:e,applyValue:n,type:r,apiRef:s,focusElementRef:o,color:i,error:a,helperText:l,size:c,variant:u}=t,h=He(t,ane),f={color:i,error:a,helperText:l,size:c,variant:u},[g,y]=p.useState(e.value||[]),w=En(),v=$e();p.useEffect(()=>{var x;const A=(x=e.value)!=null?x:[];y(A.map(String))},[e.value]);const C=p.useCallback((x,A)=>{y(A.map(String)),n(B({},e,{value:[...A]}))},[n,e]);return d.jsx(A2,B({multiple:!0,freeSolo:!0,options:[],filterOptions:(x,A)=>{const{inputValue:N}=A;return N==null||N===""?[]:[N]},id:w,value:g,onChange:C,renderTags:(x,A)=>x.map((N,M)=>d.jsx(v.slots.baseChip,B({variant:"outlined",size:"small",label:N},A({index:M})))),renderInput:x=>{var A;return d.jsx(v.slots.baseTextField,B({},x,{label:s.current.getLocaleText("filterPanelInputLabel"),placeholder:s.current.getLocaleText("filterPanelInputPlaceholder"),InputLabelProps:B({},x.InputLabelProps,{shrink:!0}),inputRef:o,type:r||"text"},f,(A=v.slotProps)==null?void 0:A.baseTextField))}},h))}const lne=["item","applyValue","type","apiRef","focusElementRef","color","error","helperText","size","variant","getOptionLabel","getOptionValue"],cne=KB();function une(t){var e,n;const{item:r,applyValue:s,apiRef:o,focusElementRef:i,color:a,error:l,helperText:c,size:u,variant:h="standard",getOptionLabel:f,getOptionValue:g}=t,y=He(t,lne),w={color:a,error:l,helperText:c,size:u,variant:h},v=En(),C=$e();let x=null;if(r.field){const P=o.current.getColumn(r.field);bc(P)&&(x=P)}const A=g||((e=x)==null?void 0:e.getOptionValue),N=f||((n=x)==null?void 0:n.getOptionLabel),M=p.useCallback((P,S)=>A(P)===A(S),[A]),k=p.useMemo(()=>{var P;return(P=x)!=null&&P.valueOptions?typeof x.valueOptions=="function"?x.valueOptions({field:x.field}):x.valueOptions:[]},[x]),E=p.useMemo(()=>k?.map(A),[k,A]),b=p.useMemo(()=>Array.isArray(r.value)?k!==void 0?r.value.map(S=>E?.findIndex(D=>D===S)).filter(S=>S>=0).map(S=>k[S]):r.value:[],[r.value,k,E]);p.useEffect(()=>{(!Array.isArray(r.value)||b.length!==r.value.length)&&s(B({},r,{value:b.map(A)}))},[r,b,s,A]);const I=p.useCallback((P,S)=>{s(B({},r,{value:S.map(A)}))},[s,r,A]);return d.jsx(A2,B({multiple:!0,options:k,isOptionEqualToValue:M,filterOptions:cne,id:v,value:b,onChange:I,getOptionLabel:N,renderTags:(P,S)=>P.map((D,T)=>d.jsx(C.slots.baseChip,B({variant:"outlined",size:"small",label:N(D)},S({index:T})))),renderInput:P=>{var S;return d.jsx(C.slots.baseTextField,B({},P,{label:o.current.getLocaleText("filterPanelInputLabel"),placeholder:o.current.getLocaleText("filterPanelInputPlaceholder"),InputLabelProps:B({},P.InputLabelProps,{shrink:!0}),inputRef:i,type:"singleSelect"},w,(S=C.slotProps)==null?void 0:S.baseTextField))}},y))}const dne=["hideMenu","options"],hne=["hideMenu","options"];function fne(t){const e=mt(),{hideMenu:n,options:r}=t,s=He(t,dne);return d.jsx(Bn,B({onClick:()=>{e.current.exportDataAsCsv(r),n?.()}},s,{children:e.current.getLocaleText("toolbarExportCSV")}))}function mne(t){const e=mt(),{hideMenu:n,options:r}=t,s=He(t,hne);return d.jsx(Bn,B({onClick:()=>{e.current.exportDataAsPrint(r),n?.()}},s,{children:e.current.getLocaleText("toolbarExportPrint")}))}const pne=["className","selectedRowCount"],gne=t=>{const{classes:e}=t;return ft({root:["selectedRowCount"]},pt,e)},yne=Zn("div",{name:"MuiDataGrid",slot:"SelectedRowCount",overridesResolver:(t,e)=>e.selectedRowCount})(({theme:t})=>({alignItems:"center",display:"flex",margin:t.spacing(0,2),visibility:"hidden",width:0,height:0,[t.breakpoints.up("sm")]:{visibility:"visible",width:"auto",height:"auto"}})),wne=p.forwardRef(function(e,n){const{className:r,selectedRowCount:s}=e,o=He(e,pne),i=mt(),a=$e(),l=gne(a),c=i.current.getLocaleText("footerRowSelected")(s);return d.jsx(yne,B({ref:n,className:At(l.root,r),ownerState:a},o,{children:c}))}),bne=p.forwardRef(function(e,n){var r,s;const o=mt(),i=$e(),a=Re(o,$J),l=Re(o,hee),c=Re(o,YF),u=!i.hideFooterSelectedRowCount&&l>0?d.jsx(wne,{selectedRowCount:l}):d.jsx("div",{}),h=!i.hideFooterRowCount&&!i.pagination?d.jsx(i.slots.footerRowCount,B({},(r=i.slotProps)==null?void 0:r.footerRowCount,{rowCount:a,visibleRowCount:c})):null,f=i.pagination&&!i.hideFooterPagination&&i.slots.pagination&&d.jsx(i.slots.pagination,B({},(s=i.slotProps)==null?void 0:s.pagination));return d.jsxs(EZ,B({ref:n},e,{children:[u,h,f]}))});function vne(){var t,e;const n=$e();return d.jsxs(p.Fragment,{children:[d.jsx(n.slots.preferencesPanel,B({},(t=n.slotProps)==null?void 0:t.preferencesPanel)),n.slots.toolbar&&d.jsx(n.slots.toolbar,B({},(e=n.slotProps)==null?void 0:e.toolbar))]})}const xne=p.forwardRef(function(e,n){return d.jsx(SI,B({ref:n},e,{children:d.jsx(vh,{})}))}),Cne=p.forwardRef(function(e,n){const s=mt().current.getLocaleText("noRowsLabel");return d.jsx(SI,B({ref:n},e,{children:s}))}),Ene=bn(qB)(({theme:t})=>({[`& .${X_.selectLabel}`]:{display:"none",[t.breakpoints.up("sm")]:{display:"block"}},[`& .${X_.input}`]:{display:"none",[t.breakpoints.up("sm")]:{display:"inline-flex"}}})),Ine=p.forwardRef(function(e,n){const r=mt(),s=$e(),o=Re(r,gs),i=Re(r,ju),a=p.useMemo(()=>Math.floor(i/(o.pageSize||1)),[i,o.pageSize]),l=p.useCallback(f=>{const g=Number(f.target.value);r.current.setPageSize(g)},[r]),c=p.useCallback((f,g)=>{r.current.setPage(g)},[r]),h=(f=>{for(let g=0;g<s.pageSizeOptions.length;g+=1){const y=s.pageSizeOptions[g];if(typeof y=="number"){if(y===f)return!0}else if(y.value===f)return!0}return!1})(o.pageSize)?s.pageSizeOptions:[];return d.jsx(Ene,B({ref:n,component:"div",count:i,page:o.page<=a?o.page:a,rowsPerPageOptions:h,rowsPerPage:o.pageSize,onPageChange:c,onRowsPerPageChange:l},r.current.getLocaleText("MuiTablePagination"),e))}),_ne=["className","rowCount","visibleRowCount"],Ane=t=>{const{classes:e}=t;return ft({root:["rowCount"]},pt,e)},Sne=Zn("div",{name:"MuiDataGrid",slot:"RowCount",overridesResolver:(t,e)=>e.rowCount})(({theme:t})=>({alignItems:"center",display:"flex",margin:t.spacing(0,2)})),Tne=p.forwardRef(function(e,n){const{className:r,rowCount:s,visibleRowCount:o}=e,i=He(e,_ne),a=mt(),l=$e(),c=Ane(l);if(s===0)return null;const u=o<s?a.current.getLocaleText("footerTotalVisibleRows")(o,s):s.toLocaleString();return d.jsxs(Sne,B({ref:n,className:At(c.root,r),ownerState:l},i,{children:[a.current.getLocaleText("footerTotalRows")," ",u]}))}),Ow=(t,e)=>{let n,r;return e.pagination&&e.paginationMode==="client"?(r=kI(t),n=dee(t)):(n=il(t),n.length===0?r=null:r={firstRowIndex:0,lastRowIndex:n.length-1}),{rows:n,range:r}},Zc=(t,e)=>{const n=Ow(t,e);return p.useMemo(()=>({rows:n.rows,range:n.range}),[n.rows,n.range])},vC={current:null};function Xp(t){return t.isInternal=!0,t}function Lw(t){return t!==void 0&&t.isInternal===!0}function Pne(t){return Xp((e,n)=>{const r=t(e,n);return r&&(s=>r(s.value,s.row,n,vC.current))})}function Zp(t){return t.map(e=>B({},e,{getApplyFilterFn:Pne(e.getApplyFilterFnV7),getApplyFilterFnV7:Xp(e.getApplyFilterFnV7)}))}function kj(t){return Xp((e,n,r)=>{const s=t(e,n,r);return s&&(o=>s(o.value,o.row,n,r))})}function Rj(t){return{current:t.current.getPublicApi()}}let pf;function kne(){if(pf!==void 0)return pf;try{pf=new Function("return true")()}catch{pf=!1}return pf}const xC=(t,e)=>{const n=B({},t);if(n.id==null&&(n.id=Math.round(Math.random()*1e5)),n.operator==null){const r=Oh(e)[n.field];n.operator=r&&r.filterOperators[0].value}return n},Rne=Ho(["MUI: The `filterModel` can only contain a single item when the `disableMultipleColumnsFiltering` prop is set to `true`.","If you are using the community version of the `DataGrid`, this prop is always `true`."],"error"),Nne=Ho("MUI: The `id` field is required on `filterModel.items` when you use multiple filters.","error"),Dne=Ho("MUI: The `operator` field is required on `filterModel.items`, one or more of your filtering item has no `operator` provided.","error"),Nj=(t,e,n)=>{const r=t.items.length>1;let s;r&&e?(Rne(),s=[t.items[0]]):s=t.items;const o=r&&s.some(a=>a.id==null),i=s.some(a=>a.operator==null);return o&&Nne(),i&&Dne(),i||o?B({},t,{items:s.map(a=>xC(a,n))}):t.items!==s?B({},t,{items:s}):t},uk=(t,e,n)=>r=>B({},r,{filterModel:Nj(t,e,n)}),Pa=t=>typeof t=="string"?t.normalize("NFD").replace(/[\u0300-\u036f]/g,""):t,Dj=(t,e)=>{if(!t.field||!t.operator)return null;const n=e.current.getColumn(t.field);if(!n)return null;let r;if(n.valueParser){var s;const g=n.valueParser;r=Array.isArray(t.value)?(s=t.value)==null?void 0:s.map(y=>g(y)):g(t.value)}else r=t.value;const{ignoreDiacritics:o}=e.current.rootProps;o&&(r=Pa(r));const i=B({},t,{value:r}),a=n.filterOperators;if(!(a!=null&&a.length))throw new Error(`MUI: No filter operators found for column '${n.field}'.`);const l=a.find(g=>g.value===i.operator);if(!l)throw new Error(`MUI: No filter operator found for column '${n.field}' and operator value '${i.operator}'.`);const c=!Lw(l.getApplyFilterFn),u=!Lw(l.getApplyFilterFnV7),h=Rj(e);if(l.getApplyFilterFnV7&&!(c&&!u)){const g=l.getApplyFilterFnV7(i,n);return typeof g!="function"?null:{v7:!0,item:i,fn:y=>{let w=e.current.getRowValue(y,n);return o&&(w=Pa(w)),g(w,y,n,h)}}}const f=l.getApplyFilterFn(i,n);return typeof f!="function"?null:{v7:!1,item:i,fn:g=>{const y=e.current.getCellParams(g,i.field);vC.current=h,o&&(y.value=Pa(y.value));const w=f(y);return vC.current=null,w}}};let dk=1;const Mne=(t,e,n)=>{const{items:r}=t,s=r.map(a=>Dj(a,e)).filter(a=>!!a);if(s.length===0)return null;if(n||!kne())return(a,l)=>{const c={};for(let u=0;u<s.length;u+=1){const h=s[u];(!l||l(h.item.field))&&(c[h.item.id]=h.v7?h.fn(a):h.fn(e.current.getRowId(a)))}return c};const o=new Function("getRowId","appliers","row","shouldApplyFilter",`"use strict";
${s.map((a,l)=>`const shouldApply${l} = !shouldApplyFilter || shouldApplyFilter(${JSON.stringify(a.item.field)});`).join(`
`)}

const result$$ = {
${s.map((a,l)=>`  ${JSON.stringify(String(a.item.id))}: !shouldApply${l}
    ? false
    : ${a.v7?`appliers[${l}].fn(row)`:`appliers[${l}].fn(getRowId(row))`},`).join(`
`)}
};

return result$$;`.replaceAll("$$",String(dk)));return dk+=1,(a,l)=>o(e.current.getRowId,s,a,l)},One=(t,e)=>{var n,r,s;const o=(n=(r=t.quickFilterValues)==null?void 0:r.filter(Boolean))!=null?n:[];if(o.length===0)return null;const a=((s=t.quickFilterExcludeHiddenColumns)!=null?s:!1)?Qb(e):wi(e),l=[],{ignoreDiacritics:c}=e.current.rootProps,u=Rj(e);return a.forEach(h=>{const f=e.current.getColumn(h),g=f?.getApplyQuickFilterFn,y=f?.getApplyQuickFilterFnV7,w=!Lw(g),v=!Lw(y);y&&!(w&&!v)?l.push({column:f,appliers:o.map(C=>{const x=c?Pa(C):C;return{v7:!0,fn:y(x,f,u)}})}):g&&l.push({column:f,appliers:o.map(C=>{const x=c?Pa(C):C;return{v7:!1,fn:g(x,f,u)}})})}),function(f,g){const y={},w={};e:for(let C=0;C<o.length;C+=1){const x=o[C];for(let A=0;A<l.length;A+=1){const{column:N,appliers:M}=l[A],{field:k}=N;if(g&&!g(k))continue;const E=M[C];let b=e.current.getRowValue(f,N);if(E.fn!==null)if(E.v7){if(c&&(b=Pa(b)),E.fn(b,f,N,u)){y[x]=!0;continue e}}else{var v;const I=(v=w[k])!=null?v:e.current.getCellParams(e.current.getRowId(f),k);if(c&&(I.value=Pa(I.value)),w[k]=I,E.fn(I)){y[x]=!0;continue e}}}y[x]=!1}return y}},Lne=(t,e,n)=>{const r=Mne(t,e,n),s=One(t,e);return function(i,a,l){var c,u;l.passingFilterItems=(c=r?.(i,a))!=null?c:null,l.passingQuickFilterValues=(u=s?.(i,a))!=null?u:null}},hk=t=>t!=null,Fne=(t,e,n)=>(t.cleanedFilterItems||(t.cleanedFilterItems=n.filter(r=>Dj(r,e)!==null)),t.cleanedFilterItems),jne=(t,e,n,r,s)=>{const o=Fne(s,r,n.items),i=t.filter(hk),a=e.filter(hk);if(i.length>0){var l;const u=f=>i.some(g=>g[f.id]);if(((l=n.logicOperator)!=null?l:$m().logicOperator)===Rr.And){if(!o.every(u))return!1}else if(!o.some(u))return!1}if(a.length>0&&n.quickFilterValues!=null){var c;const u=f=>a.some(g=>g[f]);if(((c=n.quickFilterLogicOperator)!=null?c:$m().quickFilterLogicOperator)===Rr.And){if(!n.quickFilterValues.every(u))return!1}else if(!n.quickFilterValues.some(u))return!1}return!0},fk=Xp(t=>{if(!t)return null;const e=new RegExp(Iy(t),"i");return(n,r,s,o)=>{let i=o.current.getRowFormattedValue(r,s);return o.current.ignoreDiacritics&&(i=Pa(i)),i!=null?e.test(i.toString()):!1}}),Vne=(t=!1)=>Zp([{value:"contains",getApplyFilterFnV7:e=>{if(!e.value)return null;const n=t?e.value:e.value.trim(),r=new RegExp(Iy(n),"i");return s=>s!=null?r.test(String(s)):!1},InputComponent:yo},{value:"equals",getApplyFilterFnV7:e=>{if(!e.value)return null;const n=t?e.value:e.value.trim(),r=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"});return s=>s!=null?r.compare(n,s.toString())===0:!1},InputComponent:yo},{value:"startsWith",getApplyFilterFnV7:e=>{if(!e.value)return null;const n=t?e.value:e.value.trim(),r=new RegExp(`^${Iy(n)}.*$`,"i");return s=>s!=null?r.test(s.toString()):!1},InputComponent:yo},{value:"endsWith",getApplyFilterFnV7:e=>{if(!e.value)return null;const n=t?e.value:e.value.trim(),r=new RegExp(`.*${Iy(n)}$`,"i");return s=>s!=null?r.test(s.toString()):!1},InputComponent:yo},{value:"isEmpty",getApplyFilterFnV7:()=>e=>e===""||e==null,requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFnV7:()=>e=>e!==""&&e!=null,requiresFilterValue:!1},{value:"isAnyOf",getApplyFilterFnV7:e=>{if(!Array.isArray(e.value)||e.value.length===0)return null;const n=t?e.value:e.value.map(s=>s.trim()),r=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"});return s=>s!=null?n.some(o=>r.compare(o,s.toString()||"")===0):!1},InputComponent:Pj}]),Ks={width:100,minWidth:50,maxWidth:1/0,hideable:!0,sortable:!0,resizable:!0,filterable:!0,groupable:!0,pinnable:!0,aggregable:!0,editable:!1,sortComparator:vee,type:"string",align:"left",filterOperators:Vne(),renderEditCell:WX,getApplyQuickFilterFn:kj(fk),getApplyQuickFilterFnV7:fk},Bne=()=>Zp([{value:"is",getApplyFilterFnV7:t=>{if(!t.value)return null;const e=t.value==="true";return n=>!!n===e},InputComponent:sne}]);function Une({value:t,api:e}){return t?e.getLocaleText("booleanCellTrueLabel"):e.getLocaleText("booleanCellFalseLabel")}const Hne=t=>{switch(t.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case"null":case"undefined":return!1;default:return}},Mj=B({},Ks,{type:"boolean",align:"center",headerAlign:"center",renderCell:DX,renderEditCell:FX,sortComparator:xj,valueFormatter:Une,filterOperators:Bne(),getApplyQuickFilterFn:void 0,getApplyQuickFilterFnV7:void 0,aggregable:!1,pastedValueParser:t=>Hne(t)}),ta="__check__",jh=B({},Mj,{field:ta,type:"checkboxSelection",width:50,resizable:!1,sortable:!1,filterable:!1,aggregable:!1,disableColumnMenu:!0,disableReorder:!0,disableExport:!0,getApplyQuickFilterFn:void 0,getApplyQuickFilterFnV7:void 0,valueGetter:t=>Mw(t.api.state,t.api.instanceId)[t.id]!==void 0,renderHeader:t=>d.jsx(Mee,B({},t)),renderCell:t=>d.jsx(Ree,B({},t))}),n0="actions",$ne=B({},Ks,{sortable:!1,filterable:!1,aggregable:!1,width:100,align:"center",headerAlign:"center",headerName:"",disableColumnMenu:!0,disableExport:!0,renderCell:dZ,getApplyQuickFilterFn:void 0,getApplyQuickFilterFnV7:void 0}),MI="__detail_panel_toggle__",gr=t=>t.editRows,zne=["selected","hovered","rowId","row","index","style","position","rowHeight","className","visibleColumns","renderedColumns","containerWidth","firstColumnToRender","lastColumnToRender","isLastVisible","focusedCellColumnIndexNotInRange","isNotVisible","focusedCell","tabbableCell","onClick","onDoubleClick","onMouseEnter","onMouseLeave","onMouseOut","onMouseOver"],Gne=t=>{const{editable:e,editing:n,selected:r,isLastVisible:s,rowHeight:o,classes:i}=t;return ft({root:["row",r&&"selected",e&&"row--editable",n&&"row--editing",s&&"row--lastVisible",o==="auto"&&"row--dynamicHeight"]},pt,i)};function Wne({width:t}){if(!t)return null;const e={width:t};return d.jsx("div",{className:`${q.cell} ${q.withBorderColor}`,style:e})}const Kne=p.forwardRef(function(e,n){const{selected:r,hovered:s,rowId:o,row:i,index:a,style:l,position:c,rowHeight:u,className:h,visibleColumns:f,renderedColumns:g,containerWidth:y,firstColumnToRender:w,isLastVisible:v=!1,focusedCellColumnIndexNotInRange:C,isNotVisible:x,focusedCell:A,onClick:N,onDoubleClick:M,onMouseEnter:k,onMouseLeave:E,onMouseOut:b,onMouseOver:I}=e,P=He(e,zne),S=mt(),D=p.useRef(null),T=$e(),j=Zc(S,T),R=Re(S,vI),V=Re(S,ps),U=Re(S,Xb),F=Re(S,Qp),$=Re(S,gr),W=Kc(D,n),Z=a+F+2,Y={selected:r,isLastVisible:v,classes:T.classes,editing:S.current.getRowMode(o)===Vt.Edit,editable:T.editMode===Bo.Row,rowHeight:u},le=Gne(Y);p.useLayoutEffect(()=>{u==="auto"&&D.current&&typeof ResizeObserver>"u"&&S.current.unstable_storeRowHeightMeasurement(o,D.current.clientHeight,c)},[S,u,o,c]),p.useLayoutEffect(()=>{if(j.range){const Ye=S.current.getRowIndexRelativeToVisibleRows(o);Ye!=null&&S.current.unstable_setLastMeasuredRowIndex(Ye)}const be=D.current;if(!be||u!=="auto"||typeof ResizeObserver>"u")return;const De=new ResizeObserver(Ye=>{const[gt]=Ye,un=gt.borderBoxSize&&gt.borderBoxSize.length>0?gt.borderBoxSize[0].blockSize:gt.contentRect.height;S.current.unstable_storeRowHeightMeasurement(o,un,c)});return De.observe(be),()=>De.disconnect()},[S,j.range,a,u,o,c]);const fe=p.useCallback((be,Se)=>De=>{Yp(De)||S.current.getRow(o)&&(S.current.publishEvent(be,S.current.getRowParams(o),De),Se&&Se(De))},[S,o]),we=p.useCallback(be=>{const Se=yX(be.target,q.cell),De=Se?.getAttribute("data-field");if(De){if(De===jh.field||De===MI||De==="__reorder__"||S.current.getCellMode(o,De)===kt.Edit)return;const Ye=S.current.getColumn(De);if(Ye?.type===n0)return}fe("rowClick",N)(be)},[S,N,fe,o]),{slots:Me,slotProps:Ee,disableColumnReorder:X}=T,ue=Me.cell===wC?wC:SX,re=T.rowReordering,ie=(be,Se)=>{var De,Ye;const gt=X&&be.disableReorder||!re&&!!V.length&&U>1&&Object.keys($).length>0,un=(De=(Ye=$[o])==null?void 0:Ye[be.field])!=null?De:null;let Tt=!1;return C!==void 0&&f[C].field===be.field&&(Tt=!0),d.jsx(ue,B({column:be,width:Se.width,rowId:o,height:u,showRightBorder:Se.showRightBorder,align:be.align||"left",colIndex:Se.indexRelativeToAllColumns,colSpan:Se.colSpan,disableDragEvents:gt,editCellState:un,isNotVisible:Tt},Ee?.cell),be.field)},Ce=Re(S,()=>B({},S.current.unstable_getRowInternalSizes(o)),bI);let K=u;if(K==="auto"&&Ce){let be=0;const Se=Object.entries(Ce).reduce((De,[Ye,gt])=>/^base[A-Z]/.test(Ye)?(be+=1,gt>De?gt:De):De,0);Se>0&&be>1&&(K=Se)}const me=p.useMemo(()=>{if(x)return{opacity:0,width:0,height:0};const be=B({},l,{maxHeight:u==="auto"?"none":u,minHeight:K});if(Ce!=null&&Ce.spacingTop){const Se=T.rowSpacingType==="border"?"borderTopWidth":"marginTop";be[Se]=Ce.spacingTop}if(Ce!=null&&Ce.spacingBottom){const Se=T.rowSpacingType==="border"?"borderBottomWidth":"marginBottom";let De=be[Se];typeof De!="number"&&(De=parseInt(De||"0",10)),De+=Ce.spacingBottom,be[Se]=De}return be},[x,u,l,K,Ce,T.rowSpacingType]),Q=S.current.unstable_applyPipeProcessors("rowClassName",[],o);if(typeof T.getRowClassName=="function"){var ee;const be=a-(((ee=j.range)==null?void 0:ee.firstRowIndex)||0),Se=B({},S.current.getRowParams(o),{isFirstVisible:be===0,isLastVisible:be===j.rows.length-1,indexRelativeToCurrentPage:be});Q.push(T.getRowClassName(Se))}const de=see(1e4,20,80),ye=S.current.getRowNode(o);if(!ye)return null;const pe=ye.type,_e=[];for(let be=0;be<g.length;be+=1){const Se=g[be];let De=w+be;C!==void 0&&A&&(f[C].field===Se.field?De=C:De-=1);const Ye=S.current.unstable_getCellColSpanInfo(o,De);if(Ye&&!Ye.spannedByColSpan)if(pe!=="skeletonRow"){const{colSpan:gt,width:un}=Ye.cellProps,Tt={width:un,colSpan:gt,showRightBorder:T.showCellVerticalBorder,indexRelativeToAllColumns:De};_e.push(ie(Se,Tt))}else{const{width:gt}=Ye.cellProps,un=Math.round(de());_e.push(d.jsx(Me.skeletonCell,{width:gt,contentWidth:un,field:Se.field,align:Se.align},Se.field))}}const qe=y-R,Ie=i?{onClick:we,onDoubleClick:fe("rowDoubleClick",M),onMouseEnter:fe("rowMouseEnter",k),onMouseLeave:fe("rowMouseLeave",E),onMouseOut:fe("rowMouseOut",b),onMouseOver:fe("rowMouseOver",I)}:null;return d.jsxs("div",B({ref:W,"data-id":o,"data-rowindex":a,role:"row",className:At(...Q,le.root,h,s&&"Mui-hovered"),"aria-rowindex":Z,"aria-selected":r,style:me},Ie,P,{children:[_e,qe>0&&d.jsx(Wne,{width:qe})]}))}),qne=t0(Kne);function Qne({privateApiRef:t,props:e,children:n}){const r=p.useRef(t.current.getPublicApi());return d.jsx(VF.Provider,{value:e,children:d.jsx(BF.Provider,{value:t,children:d.jsx(jF.Provider,{value:r,children:n})})})}const Yne=nee()&&window.localStorage.getItem("DEBUG")!=null,Uf=()=>{},Jne={debug:Uf,info:Uf,warn:Uf,error:Uf},mk=["debug","info","warn","error"];function pk(t,e,n=console){const r=mk.indexOf(e);if(r===-1)throw new Error(`MUI: Log level ${e} not recognized.`);return mk.reduce((o,i,a)=>(a>=r?o[i]=(...l)=>{const[c,...u]=l;n[i](`MUI: ${t} - ${c}`,...u)}:o[i]=Uf,o),{})}const Xne=(t,e)=>{const n=p.useCallback(r=>Yne?pk(r,"debug",e.logger):e.logLevel?pk(r,e.logLevel.toString(),e.logger):Jne,[e.logLevel,e.logger]);rt(t,{getLogger:n},"private")};class OI{static create(e){return new OI(e)}constructor(e){this.value=void 0,this.listeners=void 0,this.subscribe=n=>(this.listeners.add(n),()=>{this.listeners.delete(n)}),this.getSnapshot=()=>this.value,this.update=n=>{this.value=n,this.listeners.forEach(r=>r(n))},this.value=e,this.listeners=new Set}}class Zne{constructor(){this.maxListeners=20,this.warnOnce=!1,this.events={}}on(e,n,r={}){let s=this.events[e];s||(s={highPriority:new Map,regular:new Map},this.events[e]=s),r.isFirst?s.highPriority.set(n,!0):s.regular.set(n,!0)}removeListener(e,n){this.events[e]&&(this.events[e].regular.delete(n),this.events[e].highPriority.delete(n))}removeAllListeners(){this.events={}}emit(e,...n){const r=this.events[e];if(!r)return;const s=Array.from(r.highPriority.keys()),o=Array.from(r.regular.keys());for(let i=s.length-1;i>=0;i-=1){const a=s[i];r.highPriority.has(a)&&a.apply(this,n)}for(let i=0;i<o.length;i+=1){const a=o[i];r.regular.has(a)&&a.apply(this,n)}}once(e,n){const r=this;this.on(e,function s(...o){r.removeListener(e,s),n.apply(r,o)})}}const Oj=Symbol("mui.api_private"),ere=t=>t.isPropagationStopped!==void 0;let gk=0;function tre(t){var e;const n=(e=t.current)==null?void 0:e[Oj];if(n)return n;const r={},s={state:r,store:OI.create(r),instanceId:{id:gk}};return gk+=1,s.getPublicApi=()=>t.current,s.register=(o,i)=>{Object.keys(i).forEach(a=>{const l=i[a],c=s[a];if(c?.spying===!0?c.target=l:s[a]=l,o==="public"){const u=t.current,h=u[a];h?.spying===!0?h.target=l:u[a]=l}})},s.register("private",{caches:{},eventManager:new Zne}),s}function nre(t){return{get state(){return t.current.state},get store(){return t.current.store},get instanceId(){return t.current.instanceId},[Oj]:t.current}}function rre(t,e){const n=p.useRef(),r=p.useRef();r.current||(r.current=tre(n)),n.current||(n.current=nre(r));const s=p.useCallback((...i)=>{const[a,l,c={}]=i;if(c.defaultMuiPrevented=!1,ere(c)&&c.isPropagationStopped())return;const u=e.signature===Oo.DataGridPro?{api:r.current.getPublicApi()}:{};r.current.eventManager.emit(a,l,c,u)},[r,e.signature]),o=p.useCallback((i,a,l)=>{r.current.eventManager.on(i,a,l);const c=r.current;return()=>{c.eventManager.removeListener(i,a)}},[r]);return rt(r,{subscribeEvent:o,publishEvent:s},"public"),p.useImperativeHandle(t,()=>n.current,[n]),p.useEffect(()=>{const i=r.current;return()=>{i.publishEvent("unmount")}},[r]),r}const sre=(t,e)=>{const n=p.useCallback(r=>{if(e.localeText[r]==null)throw new Error(`Missing translation for key ${r}.`);return e.localeText[r]},[e.localeText]);t.current.register("public",{getLocaleText:n})},ore=t=>{const e=p.useRef({}),n=p.useRef(!1),r=p.useCallback(u=>{n.current||!u||(n.current=!0,Object.values(u.appliers).forEach(h=>{h()}),n.current=!1)},[]),s=p.useCallback((u,h,f)=>{e.current[u]||(e.current[u]={processors:new Map,appliers:{}});const g=e.current[u];return g.processors.get(h)!==f&&(g.processors.set(h,f),r(g)),()=>{e.current[u].processors.set(h,null)}},[r]),o=p.useCallback((u,h,f)=>(e.current[u]||(e.current[u]={processors:new Map,appliers:{}}),e.current[u].appliers[h]=f,()=>{const g=e.current[u].appliers,y=He(g,[h].map(bm));e.current[u].appliers=y}),[]),i=p.useCallback(u=>{const h=e.current[u];r(h)},[r]),a=p.useCallback((...u)=>{const[h,f,g]=u;return e.current[h]?Array.from(e.current[h].processors.values()).reduce((w,v)=>v?v(w,g):w,f):f},[]),l={registerPipeProcessor:s,registerPipeApplier:o,requestPipeProcessorsApplication:i},c={unstable_applyPipeProcessors:a};rt(t,l,"private"),rt(t,c,"public")},gn=(t,e,n)=>{const r=p.useRef(),s=p.useRef(`mui-${Math.round(Math.random()*1e9)}`),o=p.useCallback(()=>{r.current=t.current.registerPipeProcessor(e,s.current,n)},[t,n,e]);Jp(()=>{o()});const i=p.useRef(!0);p.useEffect(()=>(i.current?i.current=!1:o(),()=>{r.current&&(r.current(),r.current=null)}),[o])},LI=(t,e,n)=>{const r=p.useRef(),s=p.useRef(`mui-${Math.round(Math.random()*1e9)}`),o=p.useCallback(()=>{r.current=t.current.registerPipeApplier(e,s.current,n)},[t,n,e]);Jp(()=>{o()});const i=p.useRef(!0);p.useEffect(()=>(i.current?i.current=!1:o(),()=>{r.current&&(r.current(),r.current=null)}),[o])},Fw=(t,e,n,r)=>{const s=p.useCallback(()=>{t.current.registerStrategyProcessor(e,n,r)},[t,r,n,e]);Jp(()=>{s()});const o=p.useRef(!0);p.useEffect(()=>{o.current?o.current=!1:s()},[s])},Uc="none",yk={rowTreeCreation:"rowTree",filtering:"rowTree",sorting:"rowTree",visibleRowsLookupCreation:"rowTree"},ire=t=>{const e=p.useRef(new Map),n=p.useRef({}),r=p.useCallback((l,c,u)=>{const h=()=>{const y=n.current[c],w=He(y,[l].map(bm));n.current[c]=w};n.current[c]||(n.current[c]={});const f=n.current[c],g=f[l];return f[l]=u,!g||g===u||l===t.current.getActiveStrategy(yk[c])&&t.current.publishEvent("activeStrategyProcessorChange",c),h},[t]),s=p.useCallback((l,c)=>{const u=t.current.getActiveStrategy(yk[l]);if(u==null)throw new Error("Can't apply a strategy processor before defining an active strategy");const h=n.current[l];if(!h||!h[u])throw new Error(`No processor found for processor "${l}" on strategy "${u}"`);const f=h[u];return f(c)},[t]),o=p.useCallback(l=>{var c;const h=Array.from(e.current.entries()).find(([,f])=>f.group!==l?!1:f.isAvailable());return(c=h?.[0])!=null?c:Uc},[]),i=p.useCallback((l,c,u)=>{e.current.set(c,{group:l,isAvailable:u}),t.current.publishEvent("strategyAvailabilityChange")},[t]);rt(t,{registerStrategyProcessor:r,applyStrategyProcessor:s,getActiveStrategy:o,setStrategyAvailability:i},"private")},are=(t,e)=>{const n=p.useRef({}),[,r]=p.useState(),s=p.useCallback(u=>{n.current[u.stateId]=u},[]),o=p.useCallback((u,h)=>{let f;if(fj(u)?f=u(t.current.state):f=u,t.current.state===f)return!1;let g=!1;const y=[];if(Object.keys(n.current).forEach(w=>{const v=n.current[w],C=v.stateSelector(t.current.state,t.current.instanceId),x=v.stateSelector(f,t.current.instanceId);x!==C&&(y.push({stateId:v.stateId,hasPropChanged:x!==v.propModel}),v.propModel!==void 0&&x!==v.propModel&&(g=!0))}),y.length>1)throw new Error(`You're not allowed to update several sub-state in one transaction. You already updated ${y[0].stateId}, therefore, you're not allowed to update ${y.map(w=>w.stateId).join(", ")} in the same transaction.`);if(g||(t.current.state=f,t.current.publishEvent&&t.current.publishEvent("stateChange",f),t.current.store.update(f)),y.length===1){const{stateId:w,hasPropChanged:v}=y[0],C=n.current[w],x=C.stateSelector(f,t.current.instanceId);if(C.propOnChange&&v){const A=e.signature===Oo.DataGridPro?{api:t.current,reason:h}:{reason:h};C.propOnChange(x,A)}g||t.current.publishEvent(C.changeEvent,x,{reason:h})}return!g},[t,e.signature]),i=p.useCallback((u,h,f)=>t.current.setState(g=>B({},g,{[u]:h(g[u])}),f),[t]),a=p.useCallback(()=>r(()=>t.current.state),[t]),l={setState:o,forceUpdate:a},c={updateControlState:i,registerControlState:s};rt(t,l,"public"),rt(t,c,"private")},lre=(t,e)=>{const n=rre(t,e);return Xne(n,e),are(n,e),ore(n),ire(n),sre(n,e),n.current.register("private",{rootProps:e}),n},_r=(t,e,n)=>{const r=p.useRef(!1);r.current||(e.current.state=t(e.current.state,n,e),r.current=!0)},cre=/(\d+)-(\d+)-(\d+)/,ure=/(\d+)-(\d+)-(\d+)T(\d+):(\d+)/;function mu(t,e,n,r){if(!t.value)return null;const[s,o,i,a,l]=t.value.match(n?ure:cre).slice(1).map(Number),c=new Date(s,o-1,i,a||0,l||0).getTime();return u=>{if(!u)return!1;if(r)return e(u.getTime(),c);const f=new Date(u).setHours(n?u.getHours():0,n?u.getMinutes():0,0,0);return e(f,c)}}const Lj=t=>Zp([{value:"is",getApplyFilterFnV7:e=>mu(e,(n,r)=>n===r,t),InputComponent:fu,InputComponentProps:{type:t?"datetime-local":"date"}},{value:"not",getApplyFilterFnV7:e=>mu(e,(n,r)=>n!==r,t),InputComponent:fu,InputComponentProps:{type:t?"datetime-local":"date"}},{value:"after",getApplyFilterFnV7:e=>mu(e,(n,r)=>n>r,t),InputComponent:fu,InputComponentProps:{type:t?"datetime-local":"date"}},{value:"onOrAfter",getApplyFilterFnV7:e=>mu(e,(n,r)=>n>=r,t),InputComponent:fu,InputComponentProps:{type:t?"datetime-local":"date"}},{value:"before",getApplyFilterFnV7:e=>mu(e,(n,r)=>n<r,t,!t),InputComponent:fu,InputComponentProps:{type:t?"datetime-local":"date"}},{value:"onOrBefore",getApplyFilterFnV7:e=>mu(e,(n,r)=>n<=r,t),InputComponent:fu,InputComponentProps:{type:t?"datetime-local":"date"}},{value:"isEmpty",getApplyFilterFnV7:()=>e=>e==null,requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFnV7:()=>e=>e!=null,requiresFilterValue:!1}]);function Fj({value:t,columnType:e,rowId:n,field:r}){if(!(t instanceof Date))throw new Error([`MUI: \`${e}\` column type only accepts \`Date\` objects as values.`,"Use `valueGetter` to transform the value into a `Date` object.",`Row ID: ${n}, field: "${r}".`].join(`
`))}function dre({value:t,field:e,id:n}){return t?(Fj({value:t,columnType:"date",rowId:n,field:e}),t.toLocaleDateString()):""}function hre({value:t,field:e,id:n}){return t?(Fj({value:t,columnType:"dateTime",rowId:n,field:e}),t.toLocaleString()):""}const fre=B({},Ks,{type:"date",sortComparator:Cj,valueFormatter:dre,filterOperators:Lj(),renderEditCell:oj,pastedValueParser:t=>new Date(t)}),mre=B({},Ks,{type:"dateTime",sortComparator:Cj,valueFormatter:hre,filterOperators:Lj(!0),renderEditCell:oj,pastedValueParser:t=>new Date(t)}),ra=t=>t==null?null:Number(t),wk=Xp(t=>t==null||Number.isNaN(t)||t===""?null:e=>ra(e)===ra(t)),pre=()=>Zp([{value:"=",getApplyFilterFnV7:t=>t.value==null||Number.isNaN(t.value)?null:e=>ra(e)===t.value,InputComponent:yo,InputComponentProps:{type:"number"}},{value:"!=",getApplyFilterFnV7:t=>t.value==null||Number.isNaN(t.value)?null:e=>ra(e)!==t.value,InputComponent:yo,InputComponentProps:{type:"number"}},{value:">",getApplyFilterFnV7:t=>t.value==null||Number.isNaN(t.value)?null:e=>e==null?!1:ra(e)>t.value,InputComponent:yo,InputComponentProps:{type:"number"}},{value:">=",getApplyFilterFnV7:t=>t.value==null||Number.isNaN(t.value)?null:e=>e==null?!1:ra(e)>=t.value,InputComponent:yo,InputComponentProps:{type:"number"}},{value:"<",getApplyFilterFnV7:t=>t.value==null||Number.isNaN(t.value)?null:e=>e==null?!1:ra(e)<t.value,InputComponent:yo,InputComponentProps:{type:"number"}},{value:"<=",getApplyFilterFnV7:t=>t.value==null||Number.isNaN(t.value)?null:e=>e==null?!1:ra(e)<=t.value,InputComponent:yo,InputComponentProps:{type:"number"}},{value:"isEmpty",getApplyFilterFnV7:()=>t=>t==null,requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFnV7:()=>t=>t!=null,requiresFilterValue:!1},{value:"isAnyOf",getApplyFilterFnV7:t=>!Array.isArray(t.value)||t.value.length===0?null:e=>e!=null&&t.value.includes(Number(e)),InputComponent:Pj,InputComponentProps:{type:"number"}}]),gre=B({},Ks,{type:"number",align:"right",headerAlign:"right",sortComparator:xj,valueParser:t=>t===""?null:Number(t),valueFormatter:({value:t})=>tee(t)?t.toLocaleString():t||"",filterOperators:pre(),getApplyQuickFilterFn:kj(wk),getApplyQuickFilterFnV7:wk}),pu=t=>t==null||!TI(t)?t:t.value,yre=()=>Zp([{value:"is",getApplyFilterFnV7:t=>t.value==null||t.value===""?null:e=>pu(e)===pu(t.value),InputComponent:lk},{value:"not",getApplyFilterFnV7:t=>t.value==null||t.value===""?null:e=>pu(e)!==pu(t.value),InputComponent:lk},{value:"isAnyOf",getApplyFilterFnV7:t=>{if(!Array.isArray(t.value)||t.value.length===0)return null;const e=t.value.map(pu);return n=>e.includes(pu(n))},InputComponent:une}]),wre=t=>typeof t[0]=="object",bre=t=>TI(t)?t.value:t,vre=t=>TI(t)?t.label:String(t),xre=B({},Ks,{type:"singleSelect",getOptionLabel:vre,getOptionValue:bre,valueFormatter(t){const{id:e,field:n,value:r,api:s}=t,o=t.api.getColumn(n);if(!bc(o))return"";let i;if(typeof o.valueOptions=="function"?i=o.valueOptions({id:e,row:e?s.getRow(e):null,field:n}):i=o.valueOptions,r==null)return"";if(!i)return r;if(!wre(i))return o.getOptionLabel(r);const a=i.find(l=>o.getOptionValue(l)===r);return a?o.getOptionLabel(a):""},renderEditCell:rZ,filterOperators:yre(),pastedValueParser:(t,e)=>{const n=e.colDef,r=n.valueOptions,s=typeof r=="function"?r({field:n.field}):r||[],o=n.getOptionValue;if(s.find(a=>o(a)===t))return t}}),jj="__default__",Cre=()=>({string:Ks,number:gre,date:fre,dateTime:mre,boolean:Mj,singleSelect:xre,[n0]:$ne,[jj]:Ks});function CC(t,e){if(typeof t=="string"){if(e.shouldAppendQuotes||e.escapeFormulas){const n=t.replace(/"/g,'""');return[e.delimiter,`
`,"\r",'"'].some(r=>t.includes(r))?`"${n}"`:e.escapeFormulas&&["=","+","-","@","	","\r"].includes(n[0])?`'${n}`:n}return t}return t}const Vj=(t,e)=>{const{csvOptions:n,ignoreValueFormatter:r}=e;let s;if(r){var o;const a=t.colDef.type;if(a==="number")s=String(t.value);else if(a==="date"||a==="dateTime"){var i;s=(i=t.value)==null?void 0:i.toISOString()}else typeof((o=t.value)==null?void 0:o.toString)=="function"?s=t.value.toString():s=t.value}else s=t.formattedValue;return CC(s,n)};Ho(["MUI: When the value of a field is an object or a `renderCell` is provided, the CSV export might not display the value correctly.","You can provide a `valueFormatter` with a string representation to be used."]);class EC{constructor(e){this.options=void 0,this.rowString="",this.isEmpty=!0,this.options=e}addValue(e){this.isEmpty||(this.rowString+=this.options.csvOptions.delimiter),e==null?this.rowString+="":typeof this.options.sanitizeCellValue=="function"?this.rowString+=this.options.sanitizeCellValue(e,this.options.csvOptions):this.rowString+=e,this.isEmpty=!1}getRowString(){return this.rowString}}const Ere=({id:t,columns:e,getCellParams:n,csvOptions:r,ignoreValueFormatter:s})=>{const o=new EC({csvOptions:r});return e.forEach(i=>{const a=n(t,i.field);o.addValue(Vj(a,{ignoreValueFormatter:s,csvOptions:r}))}),o.getRowString()};function Ire(t){const{columns:e,rowIds:n,csvOptions:r,ignoreValueFormatter:s,apiRef:o}=t,i=n.reduce((h,f)=>`${h}${Ere({id:f,columns:e,getCellParams:o.current.getCellParams,ignoreValueFormatter:s,csvOptions:r})}\r
`,"").trim();if(!r.includeHeaders)return i;const a=e.filter(h=>h.field!==jh.field),l=[];if(r.includeColumnGroupsHeaders){const h=o.current.unstable_getAllGroupDetails();let f=0;const g=a.reduce((y,w)=>{const v=o.current.unstable_getColumnGroupPath(w.field);return y[w.field]=v,f=Math.max(f,v.length),y},{});for(let y=0;y<f;y+=1){const w=new EC({csvOptions:r,sanitizeCellValue:CC});l.push(w),a.forEach(v=>{const C=(g[v.field]||[])[y],x=h[C];w.addValue(x?x.headerName||x.groupId:"")})}}const c=new EC({csvOptions:r,sanitizeCellValue:CC});return a.forEach(h=>{c.addValue(h.headerName||h.field)}),l.push(c),`${`${l.map(h=>h.getRowString()).join(`\r
`)}\r
`}${i}`.trim()}function bk(t){const e=document.createElement("span");e.style.whiteSpace="pre",e.style.userSelect="all",e.style.opacity="0px",e.textContent=t,document.body.appendChild(e);const n=document.createRange();n.selectNode(e);const r=window.getSelection();r.removeAllRanges(),r.addRange(n);try{document.execCommand("copy")}finally{document.body.removeChild(e)}}function _re(t){navigator.clipboard?navigator.clipboard.writeText(t).catch(()=>{bk(t)}):bk(t)}function Are(t){var e;return!!((e=window.getSelection())!=null&&e.toString()||t&&(t.selectionEnd||0)-(t.selectionStart||0)>0)}const Sre=(t,e)=>{const n=e.unstable_ignoreValueFormatterDuringExport,r=(typeof n=="object"?n?.clipboardExport:n)||!1,s=e.clipboardCopyCellDelimiter,o=p.useCallback(i=>{if(!((i.ctrlKey||i.metaKey)&&i.key==="c")||Are(i.target))return;let a="";if(t.current.getSelectedRows().size>0)a=t.current.getDataAsCsv({includeHeaders:!1,delimiter:s,shouldAppendQuotes:!1,escapeFormulas:!1});else{const c=Kr(t);if(c){const u=t.current.getCellParams(c.id,c.field);a=Vj(u,{csvOptions:{delimiter:s,shouldAppendQuotes:!1,escapeFormulas:!1},ignoreValueFormatter:r})}}a=t.current.unstable_applyPipeProcessors("clipboardCopy",a),a&&(_re(a),t.current.publishEvent("clipboardCopy",a))},[t,r,s]);oee(t,t.current.rootElementRef,"keydown",o),Gt(t,"clipboardCopy",e.onClipboardCopy)},Tre=t=>B({},t,{columnMenu:{open:!1}}),Pre=t=>{const e=er(t,"useGridColumnMenu"),n=p.useCallback(i=>{t.current.setState(l=>l.columnMenu.open&&l.columnMenu.field===i?l:(e.debug("Opening Column Menu"),B({},l,{columnMenu:{open:!0,field:i}})))&&(t.current.hidePreferences(),t.current.forceUpdate())},[t,e]),r=p.useCallback(()=>{const i=yC(t.current.state);if(i.field){const l=Oh(t),c=Gs(t),u=wi(t);let h=i.field;if(l[h]||(h=u[0]),c[h]===!1){const f=u.filter(y=>y===h?!0:c[y]!==!1),g=f.indexOf(h);h=f[g+1]||f[g-1]}t.current.setColumnHeaderFocus(h)}t.current.setState(l=>!l.columnMenu.open&&l.columnMenu.field===void 0?l:(e.debug("Hiding Column Menu"),B({},l,{columnMenu:B({},l.columnMenu,{open:!1,field:void 0})})))&&t.current.forceUpdate()},[t,e]),s=p.useCallback(i=>{e.debug("Toggle Column Menu");const a=yC(t.current.state);!a.open||a.field!==i?n(i):r()},[t,e,n,r]);rt(t,{showColumnMenu:n,hideColumnMenu:r,toggleColumnMenu:s},"public"),ze(t,"columnResizeStart",r),ze(t,"virtualScrollerWheel",t.current.hideColumnMenu),ze(t,"virtualScrollerTouchMove",t.current.hideColumnMenu)},Bj=["maxWidth","minWidth","width","flex"];function kre({initialFreeSpace:t,totalFlexUnits:e,flexColumns:n}){const r=new Set(n.map(i=>i.field)),s={all:{},frozenFields:[],freeze:i=>{const a=s.all[i];a&&a.frozen!==!0&&(s.all[i].frozen=!0,s.frozenFields.push(i))}};function o(){if(s.frozenFields.length===r.size)return;const i={min:{},max:{}};let a=t,l=e,c=0;s.frozenFields.forEach(u=>{a-=s.all[u].computedWidth,l-=s.all[u].flex});for(let u=0;u<n.length;u+=1){const h=n[u];if(s.all[h.field]&&s.all[h.field].frozen===!0)continue;let g=a/l*h.flex;g<h.minWidth?(c+=h.minWidth-g,g=h.minWidth,i.min[h.field]=!0):g>h.maxWidth&&(c+=h.maxWidth-g,g=h.maxWidth,i.max[h.field]=!0),s.all[h.field]={frozen:!1,computedWidth:g,flex:h.flex}}c<0?Object.keys(i.max).forEach(u=>{s.freeze(u)}):c>0?Object.keys(i.min).forEach(u=>{s.freeze(u)}):n.forEach(({field:u})=>{s.freeze(u)}),o()}return o(),s.all}const IC=(t,e)=>{const n={};let r=0,s=0;const o=[];t.orderedFields.forEach(a=>{const l=B({},t.lookup[a]);if(t.columnVisibilityModel[a]===!1)l.computedWidth=0;else{let c;l.flex&&l.flex>0?(r+=l.flex,c=0,o.push(l)):c=lh(l.width||Ks.width,l.minWidth||Ks.minWidth,l.maxWidth||Ks.maxWidth),s+=c,l.computedWidth=c}n[a]=l});const i=Math.max(e-s,0);if(r>0&&e>0){const a=kre({initialFreeSpace:i,totalFlexUnits:r,flexColumns:o});Object.keys(a).forEach(l=>{n[l].computedWidth=a[l].computedWidth})}return B({},t,{lookup:n})},Rre=(t,e)=>{if(!e)return t;const{orderedFields:n=[],dimensions:r={}}=e,s=Object.keys(r);if(s.length===0&&n.length===0)return t;const o={},i=[];for(let u=0;u<n.length;u+=1){const h=n[u];t.lookup[h]&&(o[h]=!0,i.push(h))}const a=i.length===0?t.orderedFields:[...i,...t.orderedFields.filter(u=>!o[u])],l=B({},t.lookup);for(let u=0;u<s.length;u+=1){const h=s[u],f=B({},l[h],{hasBeenResized:!0});Object.entries(r[h]).forEach(([g,y])=>{f[g]=y===-1?1/0:y}),l[h]=f}return B({},t,{orderedFields:a,lookup:l})};function vk(t,e){let n=t[jj];return e&&t[e]&&(n=t[e]),n}const Su=({apiRef:t,columnsToUpsert:e,initialState:n,columnTypes:r,columnVisibilityModel:s=Gs(t),keepOnlyColumnsToUpsert:o=!1})=>{var i,a,l;const c=!t.current.state.columns;let u;if(c)u={orderedFields:[],lookup:{},columnVisibilityModel:s};else{const y=wc(t.current.state);u={orderedFields:o?[]:[...y.orderedFields],lookup:B({},y.lookup),columnVisibilityModel:s}}let h={};o&&!c&&(h=Object.keys(u.lookup).reduce((y,w)=>B({},y,{[w]:!1}),{})),e.forEach(y=>{const{field:w}=y;h[w]=!0;let v=u.lookup[w];v==null?(v=B({},vk(r,y.type),{field:w,hasBeenResized:!1}),u.orderedFields.push(w)):o&&u.orderedFields.push(w),v&&v.type!==y.type&&(v=B({},vk(r,y.type),{field:w}));let C=v.hasBeenResized;Bj.forEach(x=>{y[x]!==void 0&&(C=!0,y[x]===-1&&(y[x]=1/0))}),u.lookup[w]=B({},v,y,{hasBeenResized:C})}),o&&!c&&Object.keys(u.lookup).forEach(y=>{h[y]||delete u.lookup[y]});const f=t.current.unstable_applyPipeProcessors("hydrateColumns",u),g=Rre(f,n);return IC(g,(i=(a=(l=t.current).getRootDimensions)==null||(a=a.call(l))==null?void 0:a.viewportInnerSize.width)!=null?i:0)},xk=t=>e=>B({},e,{columns:t});function _C({firstColumnToRender:t,apiRef:e,firstRowToRender:n,lastRowToRender:r,visibleRows:s}){let o=t;for(let i=n;i<r;i+=1)if(s[i]){const l=s[i].id,c=e.current.unstable_getCellColSpanInfo(l,t);c&&c.spannedByColSpan&&(o=c.leftVisibleCellIndex)}return o}function Nre({firstColumnIndex:t,minColumnIndex:e,columnBuffer:n,firstRowToRender:r,lastRowToRender:s,apiRef:o,visibleRows:i}){const a=Math.max(t-n,e);return _C({firstColumnToRender:a,apiRef:o,firstRowToRender:r,lastRowToRender:s,visibleRows:i})}function FI(t,e){const n=Fh(t),r=Qp(t);return Math.floor(e*n)*((r??0)+1)}const Uj=Cre(),Dre=(t,e,n)=>{var r,s,o,i;const a=Su({apiRef:n,columnTypes:Uj,columnsToUpsert:e.columns,initialState:(r=e.initialState)==null?void 0:r.columns,columnVisibilityModel:(s=(o=e.columnVisibilityModel)!=null?o:(i=e.initialState)==null||(i=i.columns)==null?void 0:i.columnVisibilityModel)!=null?s:{},keepOnlyColumnsToUpsert:!0});return B({},t,{columns:a})};function Mre(t,e){var n,r;const s=er(t,"useGridColumns"),o=Uj,i=p.useRef(e.columns),a=p.useRef(o);t.current.registerControlState({stateId:"visibleColumns",propModel:e.columnVisibilityModel,propOnChange:e.onColumnVisibilityModelChange,stateSelector:Gs,changeEvent:"columnVisibilityModelChange"});const l=p.useCallback(j=>{s.debug("Updating columns state."),t.current.setState(xk(j)),t.current.forceUpdate(),t.current.publishEvent("columnsChange",j.orderedFields)},[s,t]),c=p.useCallback(j=>Oh(t)[j],[t]),u=p.useCallback(()=>Mo(t),[t]),h=p.useCallback(()=>Qn(t),[t]),f=p.useCallback((j,R=!0)=>(R?Qn(t):Mo(t)).findIndex(U=>U.field===j),[t]),g=p.useCallback(j=>{const R=f(j);return ah(t)[R]},[t,f]),y=p.useCallback(j=>{Gs(t)!==j&&(t.current.setState(V=>B({},V,{columns:Su({apiRef:t,columnTypes:o,columnsToUpsert:[],initialState:void 0,columnVisibilityModel:j,keepOnlyColumnsToUpsert:!1})})),t.current.forceUpdate())},[t,o]),w=p.useCallback(j=>{const R=Su({apiRef:t,columnTypes:o,columnsToUpsert:j,initialState:void 0,keepOnlyColumnsToUpsert:!1});l(R)},[t,l,o]),v=p.useCallback((j,R)=>{var V;const U=Gs(t),F=(V=U[j])!=null?V:!0;if(R!==F){const $=B({},U,{[j]:R});t.current.setColumnVisibilityModel($)}},[t]),C=p.useCallback(j=>wi(t).findIndex(V=>V===j),[t]),x=p.useCallback((j,R)=>{const V=wi(t),U=C(j);if(U===R)return;s.debug(`Moving column ${j} to index ${R}`);const F=[...V],$=F.splice(U,1)[0];F.splice(R,0,$),l(B({},wc(t.current.state),{orderedFields:F}));const W={column:t.current.getColumn(j),targetIndex:t.current.getColumnIndexRelativeToVisibleColumns(j),oldIndex:U};t.current.publishEvent("columnIndexChange",W)},[t,s,l,C]),A=p.useCallback((j,R)=>{var V,U;s.debug(`Updating column ${j} width to ${R}`);const F=wc(t.current.state),$=F.lookup[j],W=B({},$,{width:R,hasBeenResized:!0});l(IC(B({},F,{lookup:B({},F.lookup,{[j]:W})}),(V=(U=t.current.getRootDimensions())==null?void 0:U.viewportInnerSize.width)!=null?V:0)),t.current.publishEvent("columnWidthChange",{element:t.current.getColumnHeaderElement(j),colDef:W,width:R})},[t,s,l]),N={getColumn:c,getAllColumns:u,getColumnIndex:f,getColumnPosition:g,getVisibleColumns:h,getColumnIndexRelativeToVisibleColumns:C,updateColumns:w,setColumnVisibilityModel:y,setColumnVisibility:v,setColumnWidth:A},M={setColumnIndex:x};rt(t,N,"public"),rt(t,M,e.signature===Oo.DataGrid?"private":"public");const k=p.useCallback((j,R)=>{var V,U;const F={},$=Gs(t);(!R.exportOnlyDirtyModels||e.columnVisibilityModel!=null||Object.keys((V=(U=e.initialState)==null||(U=U.columns)==null?void 0:U.columnVisibilityModel)!=null?V:{}).length>0||Object.keys($).length>0)&&(F.columnVisibilityModel=$),F.orderedFields=wi(t);const Z=Mo(t),Y={};return Z.forEach(le=>{if(le.hasBeenResized){const fe={};Bj.forEach(we=>{let Me=le[we];Me===1/0&&(Me=-1),fe[we]=Me}),Y[le.field]=fe}}),Object.keys(Y).length>0&&(F.dimensions=Y),B({},j,{columns:F})},[t,e.columnVisibilityModel,(n=e.initialState)==null?void 0:n.columns]),E=p.useCallback((j,R)=>{var V;const U=(V=R.stateToRestore.columns)==null?void 0:V.columnVisibilityModel,F=R.stateToRestore.columns;if(U==null&&F==null)return j;const $=Su({apiRef:t,columnTypes:o,columnsToUpsert:[],initialState:F,columnVisibilityModel:U,keepOnlyColumnsToUpsert:!1});return t.current.setState(xk($)),F!=null&&t.current.publishEvent("columnsChange",$.orderedFields),j},[t,o]),b=p.useCallback((j,R)=>{if(R===Bc.columns){var V;const U=e.slots.columnsPanel;return d.jsx(U,B({},(V=e.slotProps)==null?void 0:V.columnsPanel))}return j},[e.slots.columnsPanel,(r=e.slotProps)==null?void 0:r.columnsPanel]),I=p.useCallback(j=>e.disableColumnSelector?j:[...j,"columnMenuColumnsItem"],[e.disableColumnSelector]);gn(t,"columnMenu",I),gn(t,"exportState",k),gn(t,"restoreState",E),gn(t,"preferencePanel",b);const P=p.useRef(null);ze(t,"viewportInnerSizeChange",j=>{P.current!==j.width&&(P.current=j.width,l(IC(wc(t.current.state),j.width)))});const D=p.useCallback(()=>{s.info("Columns pipe processing have changed, regenerating the columns");const j=Su({apiRef:t,columnTypes:o,columnsToUpsert:[],initialState:void 0,keepOnlyColumnsToUpsert:!1});l(j)},[t,s,l,o]);LI(t,"hydrateColumns",D);const T=p.useRef(!0);p.useEffect(()=>{if(T.current){T.current=!1;return}if(s.info(`GridColumns have changed, new length ${e.columns.length}`),i.current===e.columns&&a.current===o)return;const j=Su({apiRef:t,columnTypes:o,initialState:void 0,columnsToUpsert:e.columns,keepOnlyColumnsToUpsert:!0});i.current=e.columns,a.current=o,l(j)},[s,t,l,e.columns,o]),p.useEffect(()=>{e.columnVisibilityModel!==void 0&&t.current.setColumnVisibilityModel(e.columnVisibilityModel)},[t,s,e.columnVisibilityModel])}const Ore=.7,Lre=1.3,Hj={compact:Ore,comfortable:Lre,standard:1},Fre=(t,e)=>B({},t,{density:{value:e.density,factor:Hj[e.density]}}),jre=(t,e)=>{const n=er(t,"useDensity"),r=p.useCallback(o=>{n.debug(`Set grid density to ${o}`),t.current.setState(i=>{const a=II(i),l={value:o,factor:Hj[o]};return vc(a,l)?i:B({},i,{density:l})}),t.current.forceUpdate()},[n,t]);p.useEffect(()=>{t.current.setDensity(e.density)},[t,e.density]),rt(t,{setDensity:r},"public")};function Vre(t,e="csv",n=document.title||"untitled"){const r=`${n}.${e}`;if("download"in HTMLAnchorElement.prototype){const s=URL.createObjectURL(t),o=document.createElement("a");o.href=s,o.download=r,o.click(),setTimeout(()=>{URL.revokeObjectURL(s)});return}throw new Error("MUI: exportAs not supported")}const $j=({apiRef:t,options:e})=>{const n=Mo(t);return e.fields?e.fields.reduce((s,o)=>{const i=n.find(a=>a.field===o);return i&&s.push(i),s},[]):(e.allColumns?n:Qn(t)).filter(s=>!s.disableExport)},Bre=({apiRef:t})=>{var e,n;const r=ZJ(t),s=Us(t),o=t.current.getSelectedRows(),i=r.filter(u=>s[u].type!=="footer"),a=Lh(t),l=(a==null||(e=a.top)==null?void 0:e.map(u=>u.id))||[],c=(a==null||(n=a.bottom)==null?void 0:n.map(u=>u.id))||[];return i.unshift(...l),i.push(...c),o.size>0?i.filter(u=>o.has(u)):i},Ure=(t,e)=>{const n=er(t,"useGridCsvExport"),r=e.unstable_ignoreValueFormatterDuringExport,s=(typeof r=="object"?r?.csvExport:r)||!1,o=p.useCallback((c={})=>{var u,h,f,g,y;n.debug("Get data as CSV");const w=$j({apiRef:t,options:c}),C=((u=c.getRowsToExport)!=null?u:Bre)({apiRef:t});return Ire({columns:w,rowIds:C,csvOptions:{delimiter:c.delimiter||",",shouldAppendQuotes:(h=c.shouldAppendQuotes)!=null?h:!0,includeHeaders:(f=c.includeHeaders)!=null?f:!0,includeColumnGroupsHeaders:(g=c.includeColumnGroupsHeaders)!=null?g:!0,escapeFormulas:(y=c.escapeFormulas)!=null?y:!0},ignoreValueFormatter:s,apiRef:t})},[n,t,s]),i=p.useCallback(c=>{n.debug("Export data as CSV");const u=o(c),h=new Blob([c!=null&&c.utf8WithBom?new Uint8Array([239,187,191]):"",u],{type:"text/csv"});Vre(h,"csv",c?.fileName)},[n,o]);rt(t,{getDataAsCsv:o,exportDataAsCsv:i},"public");const l=p.useCallback((c,u)=>{var h;return(h=u.csvOptions)!=null&&h.disableToolbarButton?c:[...c,{component:d.jsx(fne,{options:u.csvOptions}),componentName:"csvExport"}]},[]);gn(t,"exportMenu",l)},_y=(t,e,n)=>{var r;let s=t.paginationModel;const o=t.rowCount,i=(r=n?.pageSize)!=null?r:s.pageSize,a=pj(o,i);n&&(n?.page!==s.page||n?.pageSize!==s.pageSize)&&(s=n);const l=lee(s.page,a);return l!==s.page&&(s=B({},s,{page:l})),yj(s.pageSize,e),s},Hre=(t,e)=>{var n;const r=er(t,"useGridPaginationModel"),s=Re(t,Fh),o=Math.floor(e.rowHeight*s);t.current.registerControlState({stateId:"paginationModel",propModel:e.paginationModel,propOnChange:e.onPaginationModelChange,stateSelector:gs,changeEvent:"paginationModelChange"});const i=p.useCallback(w=>{const v=gs(t);w!==v.page&&(r.debug(`Setting page to ${w}`),t.current.setPaginationModel({page:w,pageSize:v.pageSize}))},[t,r]),a=p.useCallback(w=>{const v=gs(t);w!==v.pageSize&&(r.debug(`Setting page size to ${w}`),t.current.setPaginationModel({pageSize:w,page:v.page}))},[t,r]),l=p.useCallback(w=>{const v=gs(t);w!==v&&(r.debug("Setting 'paginationModel' to",w),t.current.setState(C=>B({},C,{pagination:B({},C.pagination,{paginationModel:_y(C.pagination,e.signature,w)})})))},[t,r,e.signature]);rt(t,{setPage:i,setPageSize:a,setPaginationModel:l},"public");const u=p.useCallback((w,v)=>{var C;const x=gs(t);return!v.exportOnlyDirtyModels||e.paginationModel!=null||((C=e.initialState)==null||(C=C.pagination)==null?void 0:C.paginationModel)!=null||x.page!==0&&x.pageSize!==aee(e.autoPageSize)?B({},w,{pagination:B({},w.pagination,{paginationModel:x})}):w},[t,e.paginationModel,(n=e.initialState)==null||(n=n.pagination)==null?void 0:n.paginationModel,e.autoPageSize]),h=p.useCallback((w,v)=>{var C,x;const A=(C=v.stateToRestore.pagination)!=null&&C.paginationModel?B({},gj(e.autoPageSize),(x=v.stateToRestore.pagination)==null?void 0:x.paginationModel):gs(t);return t.current.setState(N=>B({},N,{pagination:B({},N.pagination,{paginationModel:_y(N.pagination,e.signature,A)})})),w},[t,e.autoPageSize,e.signature]);gn(t,"exportState",u),gn(t,"restoreState",h);const f=()=>{var w;const v=gs(t);(w=t.current.virtualScrollerRef)!=null&&w.current&&t.current.scrollToIndexes({rowIndex:v.page*v.pageSize})},g=p.useCallback(()=>{if(!e.autoPageSize)return;const w=t.current.getRootDimensions()||{viewportInnerSize:{height:0}},v=tj(t),C=Math.floor((w.viewportInnerSize.height-v.top-v.bottom)/o);t.current.setPageSize(C)},[t,e.autoPageSize,o]),y=p.useCallback(w=>{if(w==null)return;const v=gs(t),C=uee(t);v.page>C-1&&t.current.setPage(Math.max(0,C-1))},[t]);ze(t,"viewportInnerSizeChange",g),ze(t,"paginationModelChange",f),ze(t,"rowCountChange",y),p.useEffect(()=>{t.current.setState(w=>B({},w,{pagination:B({},w.pagination,{paginationModel:_y(w.pagination,e.signature,e.paginationModel)})}))},[t,e.paginationModel,e.paginationMode,e.signature]),p.useEffect(g,[g])};function $re(){return new Promise(t=>{requestAnimationFrame(()=>{t()})})}function zre(t){const e=document.createElement("iframe");return e.style.position="absolute",e.style.width="0px",e.style.height="0px",e.title=t||document.title,e}const Gre=(t,e)=>{const n=er(t,"useGridPrintExport"),r=p.useRef(null),s=p.useRef(null),o=p.useRef({}),i=p.useRef([]);p.useEffect(()=>{r.current=ib(t.current.rootElementRef.current)},[t]);const a=p.useCallback((y,w,v)=>new Promise(C=>{const x=$j({apiRef:t,options:{fields:y,allColumns:w}}).map(M=>M.field),A=Mo(t),N={};A.forEach(M=>{N[M.field]=x.includes(M.field)}),v&&(N[jh.field]=!0),t.current.setColumnVisibilityModel(N),C()}),[t]),l=p.useCallback(y=>{const v=y({apiRef:t}).map(C=>t.current.getRow(C));t.current.setRows(v)},[t]),c=p.useCallback((y,w)=>{var v,C;const x=B({copyStyles:!0,hideToolbar:!1,hideFooter:!1,includeCheckboxes:!1},w),A=y.contentDocument;if(!A)return;const N=Gm(t.current.state),M=t.current.rootElementRef.current,k=M.cloneNode(!0),E=k.querySelector(`.${q.main}`);E.style.overflow="visible",k.style.contain="size";const I=k.querySelector(`.${q.columnHeaders}`).querySelector(`.${q.columnHeadersInner}`);I.style.width="100%";let P=((v=M.querySelector(`.${q.toolbarContainer}`))==null?void 0:v.offsetHeight)||0,S=((C=M.querySelector(`.${q.footerContainer}`))==null?void 0:C.offsetHeight)||0;if(x.hideToolbar){var D;(D=k.querySelector(`.${q.toolbarContainer}`))==null||D.remove(),P=0}if(x.hideFooter){var T;(T=k.querySelector(`.${q.footerContainer}`))==null||T.remove(),S=0}const j=N.currentPageTotalHeight+FI(t,e.columnHeaderHeight)+P+S;if(k.style.height=`${j}px`,k.style.boxSizing="content-box",w!=null&&w.getRowsToExport){const F=k.querySelector(`.${q.footerContainer}`);F.style.position="absolute",F.style.width="100%",F.style.top=`${j-S}px`}const R=document.createElement("div");R.appendChild(k),A.body.innerHTML=R.innerHTML;const V=typeof x.pageStyle=="function"?x.pageStyle():x.pageStyle;if(typeof V=="string"){const F=A.createElement("style");F.appendChild(A.createTextNode(V)),A.head.appendChild(F)}x.bodyClassName&&A.body.classList.add(...x.bodyClassName.split(" "));const U=[];if(x.copyStyles){const F=M.getRootNode(),W=(F.constructor.name==="ShadowRoot"?F:r.current).querySelectorAll("style, link[rel='stylesheet']");for(let Z=0;Z<W.length;Z+=1){const Y=W[Z];if(Y.tagName==="STYLE"){const le=A.createElement(Y.tagName),fe=Y.sheet;if(fe){let we="";for(let Me=0;Me<fe.cssRules.length;Me+=1)typeof fe.cssRules[Me].cssText=="string"&&(we+=`${fe.cssRules[Me].cssText}\r
`);le.appendChild(A.createTextNode(we)),A.head.appendChild(le)}}else if(Y.getAttribute("href")){const le=A.createElement(Y.tagName);for(let fe=0;fe<Y.attributes.length;fe+=1){const we=Y.attributes[fe];we&&le.setAttribute(we.nodeName,we.nodeValue||"")}U.push(new Promise(fe=>{le.addEventListener("load",()=>fe())})),A.head.appendChild(le)}}}Promise.all(U).then(()=>{y.contentWindow.print()})},[t,r,e.columnHeaderHeight]),u=p.useCallback(y=>{var w;r.current.body.removeChild(y),t.current.restoreState(s.current||{}),(w=s.current)!=null&&(w=w.columns)!=null&&w.columnVisibilityModel||t.current.setColumnVisibilityModel(o.current),t.current.unstable_setVirtualization(!0),t.current.setRows(i.current),s.current=null,o.current={},i.current=[]},[t]),f={exportDataAsPrint:p.useCallback(async y=>{if(n.debug("Export data as Print"),!t.current.rootElementRef.current)throw new Error("MUI: No grid root element available.");s.current=t.current.exportState(),o.current=Gs(t);const w=mi(t);if(i.current=Bf(t).map(C=>w[C]),e.pagination){const x={page:0,pageSize:QF(t)};t.current.setState(A=>B({},A,{pagination:B({},A.pagination,{paginationModel:_y(A.pagination,"DataGridPro",x)})})),t.current.forceUpdate()}await a(y?.fields,y?.allColumns,y?.includeCheckboxes),y!=null&&y.getRowsToExport&&l(y.getRowsToExport),t.current.unstable_setVirtualization(!1),await $re();const v=zre(y?.fileName);v.onload=()=>{c(v,y),v.contentWindow.matchMedia("print").addEventListener("change",x=>{x.matches===!1&&u(v)})},r.current.body.appendChild(v)},[e,n,t,c,u,a,l])};rt(t,f,"public");const g=p.useCallback((y,w)=>{var v;return(v=w.printOptions)!=null&&v.disableToolbarButton?y:[...y,{component:d.jsx(mne,{options:w.printOptions}),componentName:"printExport"}]},[]);gn(t,"exportMenu",g)},Wre=(t,e,n)=>{var r,s,o;const i=(r=(s=e.filterModel)!=null?s:(o=e.initialState)==null||(o=o.filter)==null?void 0:o.filterModel)!=null?r:$m();return B({},t,{filter:{filterModel:Nj(i,e.disableMultipleColumnsFiltering,n),filteredRowsLookup:{},filteredDescendantCountLookup:{}},visibleRowsLookup:{}})},Kre=t=>t.filteredRowsLookup;function Ck(t,e){return t.current.applyStrategyProcessor("visibleRowsLookupCreation",{tree:e.rows.tree,filteredRowsLookup:e.filter.filteredRowsLookup})}function qre(){return qb(Object.values)}const Qre=(t,e)=>{var n,r;const s=er(t,"useGridFilter");t.current.registerControlState({stateId:"filter",propModel:e.filterModel,propOnChange:e.onFilterModelChange,stateSelector:Ln,changeEvent:"filterModelChange"});const o=p.useCallback(()=>{t.current.setState(P=>{const S=Ln(P,t.current.instanceId),D=e.filterMode==="client"?Lne(S,t,e.disableEval):null,T=t.current.applyStrategyProcessor("filtering",{isRowMatchingFilters:D,filterModel:S??$m()}),j=B({},P,{filter:B({},P.filter,T)}),R=Ck(t,j);return B({},j,{visibleRowsLookup:R})}),t.current.publishEvent("filteredRowsSet")},[t,e.filterMode,e.disableEval]),i=p.useCallback((P,S)=>S==null||S.filterable===!1||e.disableColumnFilter?P:[...P,"columnMenuFilterItem"],[e.disableColumnFilter]),a=p.useCallback(()=>{o(),t.current.forceUpdate()},[t,o]),l=p.useCallback(P=>{const S=Ln(t),D=[...S.items],T=D.findIndex(j=>j.id===P.id);T===-1?D.push(P):D[T]=P,t.current.setFilterModel(B({},S,{items:D}),"upsertFilterItem")},[t]),c=p.useCallback(P=>{const S=Ln(t),D=[...S.items];P.forEach(T=>{const j=P.findIndex(R=>R.id===T.id);j===-1?D.push(T):D[j]=T}),t.current.setFilterModel(B({},S,{items:P}),"upsertFilterItems")},[t]),u=p.useCallback(P=>{const S=Ln(t),D=S.items.filter(T=>T.id!==P.id);D.length!==S.items.length&&t.current.setFilterModel(B({},S,{items:D}),"deleteFilterItem")},[t]),h=p.useCallback((P,S,D)=>{if(s.debug("Displaying filter panel"),P){const T=Ln(t),j=T.items.filter(F=>{var $;if(F.value!==void 0)return!(Array.isArray(F.value)&&F.value.length===0);const Z=($=t.current.getColumn(F.field).filterOperators)==null?void 0:$.find(le=>le.value===F.operator);return!(typeof Z?.requiresFilterValue>"u"?!0:Z?.requiresFilterValue)});let R;const V=j.find(F=>F.field===P),U=t.current.getColumn(P);V?R=j:e.disableMultipleColumnsFiltering?R=[xC({field:P,operator:U.filterOperators[0].value},t)]:R=[...j,xC({field:P,operator:U.filterOperators[0].value},t)],t.current.setFilterModel(B({},T,{items:R}))}t.current.showPreferences(Bc.filters,S,D)},[t,s,e.disableMultipleColumnsFiltering]),f=p.useCallback(()=>{s.debug("Hiding filter panel"),t.current.hidePreferences()},[t,s]),g=p.useCallback(P=>{const S=Ln(t);S.logicOperator!==P&&t.current.setFilterModel(B({},S,{logicOperator:P}),"changeLogicOperator")},[t]),y=p.useCallback(P=>{const S=Ln(t);vc(S.quickFilterValues,P)||t.current.setFilterModel(B({},S,{quickFilterValues:[...P]}))},[t]),w=p.useCallback((P,S)=>{Ln(t)!==P&&(s.debug("Setting filter model"),t.current.updateControlState("filter",uk(P,e.disableMultipleColumnsFiltering,t),S),t.current.unstable_applyFilters())},[t,s,e.disableMultipleColumnsFiltering]),v={setFilterLogicOperator:g,unstable_applyFilters:a,deleteFilterItem:u,upsertFilterItem:l,upsertFilterItems:c,setFilterModel:w,showFilterPanel:h,hideFilterPanel:f,setQuickFilterValues:y,ignoreDiacritics:e.ignoreDiacritics};rt(t,v,"public");const C=p.useCallback((P,S)=>{var D;const T=Ln(t);return!S.exportOnlyDirtyModels||e.filterModel!=null||((D=e.initialState)==null||(D=D.filter)==null?void 0:D.filterModel)!=null||!vc(T,$m())?B({},P,{filter:{filterModel:T}}):P},[t,e.filterModel,(n=e.initialState)==null||(n=n.filter)==null?void 0:n.filterModel]),x=p.useCallback((P,S)=>{var D;const T=(D=S.stateToRestore.filter)==null?void 0:D.filterModel;return T==null?P:(t.current.updateControlState("filter",uk(T,e.disableMultipleColumnsFiltering,t),"restoreState"),B({},P,{callbacks:[...P.callbacks,t.current.unstable_applyFilters]}))},[t,e.disableMultipleColumnsFiltering]),A=p.useCallback((P,S)=>{if(S===Bc.filters){var D;const T=e.slots.filterPanel;return d.jsx(T,B({},(D=e.slotProps)==null?void 0:D.filterPanel))}return P},[e.slots.filterPanel,(r=e.slotProps)==null?void 0:r.filterPanel]),{getRowId:N}=e,M=wI(qre),k=p.useCallback(P=>{if(e.filterMode!=="client"||!P.isRowMatchingFilters)return{filteredRowsLookup:{},filteredDescendantCountLookup:{}};const S=mi(t),D={},{isRowMatchingFilters:T}=P,j={},R={passingFilterItems:null,passingQuickFilterValues:null},V=M.current(t.current.state.rows.dataRowIdToModelLookup);for(let $=0;$<V.length;$+=1){const W=V[$],Z=N?N(W):W.id;T(W,void 0,R);const Y=jne([R.passingFilterItems],[R.passingQuickFilterValues],P.filterModel,t,j);D[Z]=Y}const U="auto-generated-group-footer-root";return S[U]&&(D[U]=!0),{filteredRowsLookup:D,filteredDescendantCountLookup:{}}},[t,e.filterMode,N,M]);gn(t,"columnMenu",i),gn(t,"exportState",C),gn(t,"restoreState",x),gn(t,"preferencePanel",A),Fw(t,Uc,"filtering",k),Fw(t,Uc,"visibleRowsLookupCreation",Kre);const E=p.useCallback(()=>{s.debug("onColUpdated - GridColumns changed, applying filters");const P=Ln(t),S=VJ(t),D=P.items.filter(T=>T.field&&S[T.field]);D.length<P.items.length&&t.current.setFilterModel(B({},P,{items:D}))},[t,s]),b=p.useCallback(P=>{P==="filtering"&&t.current.unstable_applyFilters()},[t]),I=p.useCallback(()=>{t.current.setState(P=>B({},P,{visibleRowsLookup:Ck(t,P)})),t.current.forceUpdate()},[t]);ze(t,"rowsSet",o),ze(t,"columnsChange",E),ze(t,"activeStrategyProcessorChange",b),ze(t,"rowExpansionChange",I),ze(t,"columnVisibilityModelChange",()=>{const P=Ln(t);P.quickFilterValues&&P.quickFilterExcludeHiddenColumns&&t.current.unstable_applyFilters()}),Jp(()=>{t.current.unstable_applyFilters()}),Yn(()=>{e.filterModel!==void 0&&t.current.setFilterModel(e.filterModel)},[t,s,e.filterModel])},Yre=t=>B({},t,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null},tabIndex:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}),Jre=(t,e)=>{const n=er(t,"useGridFocus"),r=p.useRef(null),s=p.useCallback((E,b)=>{E&&t.current.getRow(E.id)&&t.current.publishEvent("cellFocusOut",t.current.getCellParams(E.id,E.field),b)},[t]),o=p.useCallback((E,b)=>{const I=Kr(t);I?.id===E&&I?.field===b||(t.current.setState(P=>(n.debug(`Focusing on cell with id=${E} and field=${b}`),B({},P,{tabIndex:{cell:{id:E,field:b},columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null},focus:{cell:{id:E,field:b},columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}))),t.current.forceUpdate(),t.current.getRow(E)&&(I&&s(I,{}),t.current.publishEvent("cellFocusIn",t.current.getCellParams(E,b))))},[t,n,s]),i=p.useCallback((E,b={})=>{const I=Kr(t);s(I,b),t.current.setState(P=>(n.debug(`Focusing on column header with colIndex=${E}`),B({},P,{tabIndex:{columnHeader:{field:E},columnHeaderFilter:null,cell:null,columnGroupHeader:null},focus:{columnHeader:{field:E},columnHeaderFilter:null,cell:null,columnGroupHeader:null}}))),t.current.forceUpdate()},[t,n,s]),a=p.useCallback((E,b={})=>{const I=Kr(t);s(I,b),t.current.setState(P=>(n.debug(`Focusing on column header filter with colIndex=${E}`),B({},P,{tabIndex:{columnHeader:null,columnHeaderFilter:{field:E},cell:null,columnGroupHeader:null},focus:{columnHeader:null,columnHeaderFilter:{field:E},cell:null,columnGroupHeader:null}}))),t.current.forceUpdate()},[t,n,s]),l=p.useCallback((E,b,I={})=>{const P=Kr(t);P&&t.current.publishEvent("cellFocusOut",t.current.getCellParams(P.id,P.field),I),t.current.setState(S=>B({},S,{tabIndex:{columnGroupHeader:{field:E,depth:b},columnHeader:null,columnHeaderFilter:null,cell:null},focus:{columnGroupHeader:{field:E,depth:b},columnHeader:null,columnHeaderFilter:null,cell:null}})),t.current.forceUpdate()},[t]),c=p.useCallback(()=>Tw(t),[t]),u=p.useCallback((E,b,I)=>{let P=t.current.getColumnIndex(b);const S=Qn(t),D=Ow(t,{pagination:e.pagination,paginationMode:e.paginationMode}),T=Lh(t),j=[].concat(T.top||[],D.rows,T.bottom||[]);let R=j.findIndex($=>$.id===E);I==="right"?P+=1:I==="left"?P-=1:R+=1,P>=S.length?(R+=1,R<j.length&&(P=0)):P<0&&(R-=1,R>=0&&(P=S.length-1)),R=lh(R,0,j.length-1);const V=j[R];if(!V)return;const U=t.current.unstable_getCellColSpanInfo(V.id,P);U&&U.spannedByColSpan&&(I==="left"||I==="below"?P=U.leftVisibleCellIndex:I==="right"&&(P=U.rightVisibleCellIndex)),P=lh(P,0,S.length-1);const F=S[P];t.current.setCellFocus(V.id,F.field)},[t,e.pagination,e.paginationMode]),h=p.useCallback(({id:E,field:b})=>{t.current.setCellFocus(E,b)},[t]),f=p.useCallback((E,b)=>{b.key==="Enter"||b.key==="Tab"||b.key==="Shift"||Dw(b.key)||t.current.setCellFocus(E.id,E.field)},[t]),g=p.useCallback(({field:E},b)=>{b.target===b.currentTarget&&t.current.setColumnHeaderFocus(E,b)},[t]),y=p.useCallback(({fields:E,depth:b},I)=>{if(I.target!==I.currentTarget)return;const P=Tw(t);P!==null&&P.depth===b&&E.includes(P.field)||t.current.setColumnGroupHeaderFocus(E[0],b,I)},[t]),w=p.useCallback((E,b)=>{var I;(I=b.relatedTarget)!=null&&I.className.includes(q.columnHeader)||(n.debug("Clearing focus"),t.current.setState(P=>B({},P,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}})))},[n,t]),v=p.useCallback(E=>{r.current=E},[]),C=p.useCallback(E=>{const b=r.current;r.current=null;const I=Kr(t);if(!t.current.unstable_applyPipeProcessors("canUpdateFocus",!0,{event:E,cell:b}))return;if(!I){b&&t.current.setCellFocus(b.id,b.field);return}if(b?.id===I.id&&b?.field===I.field)return;const S=t.current.getCellElement(I.id,I.field);S!=null&&S.contains(E.target)||(b?t.current.setCellFocus(b.id,b.field):(t.current.setState(D=>B({},D,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}})),t.current.forceUpdate(),s(I,E)))},[t,s]),x=p.useCallback(E=>{if(E.cellMode==="view")return;const b=Kr(t);(b?.id!==E.id||b?.field!==E.field)&&t.current.setCellFocus(E.id,E.field)},[t]),A=p.useCallback(()=>{const E=Kr(t);E&&!t.current.getRow(E.id)&&t.current.setState(b=>B({},b,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}))},[t]),N=Ws(()=>{const E=Kr(t);if(!E)return;const b=Ow(t,{pagination:e.pagination,paginationMode:e.paginationMode});if(b.rows.find(S=>S.id===E.id))return;const P=Qn(t);t.current.setState(S=>B({},S,{tabIndex:{cell:{id:b.rows[0].id,field:P[0].field},columnGroupHeader:null,columnHeader:null,columnHeaderFilter:null}}))}),M={setCellFocus:o,setColumnHeaderFocus:i,setColumnHeaderFilterFocus:a},k={moveFocusToRelativeCell:u,setColumnGroupHeaderFocus:l,getColumnGroupHeaderFocus:c};rt(t,M,"public"),rt(t,k,"private"),p.useEffect(()=>{const E=ib(t.current.rootElementRef.current);return E.addEventListener("mouseup",C),()=>{E.removeEventListener("mouseup",C)}},[t,C]),ze(t,"columnHeaderBlur",w),ze(t,"cellDoubleClick",h),ze(t,"cellMouseDown",v),ze(t,"cellKeyDown",f),ze(t,"cellModeChange",x),ze(t,"columnHeaderFocus",g),ze(t,"columnGroupHeaderFocus",y),ze(t,"rowsSet",A),ze(t,"paginationModelChange",N)};function Xre(t,e){const n=Lh(t)||{};return[...n.top||[],...e,...n.bottom||[]]}const Rv=({currentColIndex:t,firstColIndex:e,lastColIndex:n,direction:r})=>{if(r==="rtl"){if(t<n)return t+1}else if(r==="ltr"&&t>e)return t-1;return null},Nv=({currentColIndex:t,firstColIndex:e,lastColIndex:n,direction:r})=>{if(r==="rtl"){if(t>e)return t-1}else if(r==="ltr"&&t<n)return t+1;return null},Zre=(t,e)=>{const n=er(t,"useGridKeyboardNavigation"),r=Zc(t,e).rows,s=bh(),o=p.useMemo(()=>Xre(t,r),[t,r]),i=e.signature!=="DataGrid"&&e.unstable_headerFilters,a=p.useCallback((C,x,A="left")=>{const N=il(t),M=t.current.unstable_getCellColSpanInfo(x,C);M&&M.spannedByColSpan&&(A==="left"?C=M.leftVisibleCellIndex:A==="right"&&(C=M.rightVisibleCellIndex));const k=N.findIndex(b=>b.id===x);n.debug(`Navigating to cell row ${k}, col ${C}`),t.current.scrollToIndexes({colIndex:C,rowIndex:k});const E=t.current.getVisibleColumns()[C].field;t.current.setCellFocus(x,E)},[t,n]),l=p.useCallback((C,x)=>{n.debug(`Navigating to header col ${C}`),t.current.scrollToIndexes({colIndex:C});const A=t.current.getVisibleColumns()[C].field;t.current.setColumnHeaderFocus(A,x)},[t,n]),c=p.useCallback((C,x)=>{n.debug(`Navigating to header filter col ${C}`),t.current.scrollToIndexes({colIndex:C});const A=t.current.getVisibleColumns()[C].field;t.current.setColumnHeaderFilterFocus(A,x)},[t,n]),u=p.useCallback((C,x,A)=>{n.debug(`Navigating to header col ${C}`),t.current.scrollToIndexes({colIndex:C});const{field:N}=t.current.getVisibleColumns()[C];t.current.setColumnGroupHeaderFocus(N,x,A)},[t,n]),h=p.useCallback(C=>{var x;return(x=o[C])==null?void 0:x.id},[o]),f=p.useCallback((C,x)=>{const A=x.currentTarget.querySelector(`.${q.columnHeaderTitleContainerContent}`);if(!!A&&A.contains(x.target)&&C.field!==jh.field||!t.current.getRootDimensions())return;const k=t.current.getViewportPageSize(),E=C.field?t.current.getColumnIndex(C.field):0,b=o.length>0?0:null,I=o.length-1,P=0,S=Qn(t).length-1,D=Qp(t);let T=!0;switch(x.key){case"ArrowDown":{b!==null&&(i?c(E,x):a(E,h(b)));break}case"ArrowRight":{const j=Nv({currentColIndex:E,firstColIndex:P,lastColIndex:S,direction:s.direction});j!==null&&l(j,x);break}case"ArrowLeft":{const j=Rv({currentColIndex:E,firstColIndex:P,lastColIndex:S,direction:s.direction});j!==null&&l(j,x);break}case"ArrowUp":{D>0&&u(E,D-1,x);break}case"PageDown":{b!==null&&I!==null&&a(E,h(Math.min(b+k,I)));break}case"Home":{l(P,x);break}case"End":{l(S,x);break}case"Enter":{(x.ctrlKey||x.metaKey)&&t.current.toggleColumnMenu(C.field);break}case" ":break;default:T=!1}T&&x.preventDefault()},[t,o.length,i,c,a,h,s.direction,l,u]),g=p.useCallback((C,x)=>{if(!t.current.getRootDimensions())return;const N=xee(t)===C.field,M=Cee(t)===C.field;if(N||M||!Dw(x.key))return;const k=t.current.getViewportPageSize(),E=C.field?t.current.getColumnIndex(C.field):0,b=0,I=o.length-1,P=0,S=Qn(t).length-1;let D=!0;switch(x.key){case"ArrowDown":{const T=h(b);T!=null&&a(E,T);break}case"ArrowRight":{const T=Nv({currentColIndex:E,firstColIndex:P,lastColIndex:S,direction:s.direction});T!==null&&c(T,x);break}case"ArrowLeft":{const T=Rv({currentColIndex:E,firstColIndex:P,lastColIndex:S,direction:s.direction});T!==null?c(T,x):t.current.setColumnHeaderFilterFocus(C.field,x);break}case"ArrowUp":{l(E,x);break}case"PageDown":{I!==null&&a(E,h(Math.min(b+k,I)));break}case"Home":{c(P,x);break}case"End":{c(S,x);break}case" ":break;default:D=!1}D&&x.preventDefault()},[t,o.length,c,s.direction,l,a,h]),y=p.useCallback((C,x)=>{if(!t.current.getRootDimensions())return;const N=Tw(t);if(N===null)return;const{field:M,depth:k}=N,{fields:E,depth:b,maxDepth:I}=C,P=t.current.getViewportPageSize(),S=t.current.getColumnIndex(M),D=M?t.current.getColumnIndex(M):0,T=0,j=o.length-1,R=0,V=Qn(t).length-1;let U=!0;switch(x.key){case"ArrowDown":{b===I-1?l(S,x):u(S,k+1,x);break}case"ArrowUp":{b>0&&u(S,k-1,x);break}case"ArrowRight":{const F=E.length-E.indexOf(M)-1;S+F+1<=V&&u(S+F+1,k,x);break}case"ArrowLeft":{const F=E.indexOf(M);S-F-1>=R&&u(S-F-1,k,x);break}case"PageDown":{j!==null&&a(D,h(Math.min(T+P,j)));break}case"Home":{u(R,k,x);break}case"End":{u(V,k,x);break}case" ":break;default:U=!1}U&&x.preventDefault()},[t,o.length,l,u,a,h]),w=p.useCallback((C,x)=>{if(Yp(x))return;const A=t.current.getCellParams(C.id,C.field);if(A.cellMode===kt.Edit||!Dw(x.key)||!t.current.unstable_applyPipeProcessors("canUpdateFocus",!0,{event:x,cell:A}))return;const M=t.current.getRootDimensions();if(o.length===0||!M)return;const k=s.direction,E=t.current.getViewportPageSize(),b=C.field?t.current.getColumnIndex(C.field):0,I=o.findIndex(R=>R.id===C.id),P=0,S=o.length-1,D=0,T=Qn(t).length-1;let j=!0;switch(x.key){case"ArrowDown":{I<S&&a(b,h(I+1));break}case"ArrowUp":{I>P?a(b,h(I-1)):i?c(b,x):l(b,x);break}case"ArrowRight":{const R=Nv({currentColIndex:b,firstColIndex:D,lastColIndex:T,direction:k});R!==null&&a(R,h(I),k==="rtl"?"left":"right");break}case"ArrowLeft":{const R=Rv({currentColIndex:b,firstColIndex:D,lastColIndex:T,direction:k});R!==null&&a(R,h(I),k==="rtl"?"right":"left");break}case"Tab":{x.shiftKey&&b>D?a(b-1,h(I),"left"):!x.shiftKey&&b<T&&a(b+1,h(I),"right");break}case" ":{if(C.field===MI)break;const V=C.colDef;if(V&&V.type==="treeDataGroup")break;!x.shiftKey&&I<S&&a(b,h(Math.min(I+E,S)));break}case"PageDown":{I<S&&a(b,h(Math.min(I+E,S)));break}case"PageUp":{const R=Math.max(I-E,P);R!==I&&R>=P?a(b,h(R)):l(b,x);break}case"Home":{x.ctrlKey||x.metaKey||x.shiftKey?a(D,h(P)):a(D,h(I));break}case"End":{x.ctrlKey||x.metaKey||x.shiftKey?a(T,h(S)):a(T,h(I));break}default:j=!1}j&&x.preventDefault()},[t,o,s.direction,a,h,i,c,l]),v=p.useCallback((C,{event:x})=>x.key===" "?!1:C,[]);gn(t,"canStartEditing",v),ze(t,"columnHeaderKeyDown",f),ze(t,"headerFilterKeyDown",g),ze(t,"columnGroupHeaderKeyDown",y),ze(t,"cellKeyDown",w)},ese=(t,e)=>{var n;const r=er(t,"useGridRowCount"),s=Re(t,YF),o=Re(t,ju);t.current.registerControlState({stateId:"paginationRowCount",propModel:e.rowCount,propOnChange:e.onRowCountChange,stateSelector:ju,changeEvent:"rowCountChange"});const a={setRowCount:p.useCallback(u=>{o!==u&&(r.debug("Setting 'rowCount' to",u),t.current.setState(h=>B({},h,{pagination:B({},h.pagination,{rowCount:u})})))},[t,r,o])};rt(t,a,"public");const l=p.useCallback((u,h)=>{var f;const g=ju(t);return!h.exportOnlyDirtyModels||e.rowCount!=null||((f=e.initialState)==null||(f=f.pagination)==null?void 0:f.rowCount)!=null?B({},u,{pagination:B({},u.pagination,{rowCount:g})}):u},[t,e.rowCount,(n=e.initialState)==null||(n=n.pagination)==null?void 0:n.rowCount]),c=p.useCallback((u,h)=>{var f;const g=(f=h.stateToRestore.pagination)!=null&&f.rowCount?h.stateToRestore.pagination.rowCount:ju(t);return t.current.setState(y=>B({},y,{pagination:B({},y.pagination,{rowCount:g})})),u},[t]);gn(t,"exportState",l),gn(t,"restoreState",c),p.useEffect(()=>{},[e.rowCount,e.paginationMode]),p.useEffect(()=>{e.paginationMode==="client"?t.current.setRowCount(s):e.rowCount!=null&&t.current.setRowCount(e.rowCount)},[t,s,e.paginationMode,e.rowCount])},tse=(t,e)=>{var n,r,s,o,i;const a=B({},gj(e.autoPageSize),(n=e.paginationModel)!=null?n:(r=e.initialState)==null||(r=r.pagination)==null?void 0:r.paginationModel);yj(a.pageSize,e.signature);const l=(s=(o=e.rowCount)!=null?o:(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.rowCount)!=null?s:0;return B({},t,{pagination:{paginationModel:a,rowCount:l}})},nse=(t,e)=>{Hre(t,e),ese(t,e)},rse=(t,e)=>{var n,r;return B({},t,{preferencePanel:(n=(r=e.initialState)==null?void 0:r.preferencePanel)!=null?n:{open:!1}})},sse=(t,e)=>{var n;const r=er(t,"useGridPreferencesPanel"),s=p.useRef(),o=p.useRef(),i=p.useCallback(()=>{r.debug("Hiding Preferences Panel");const f=zm(t.current.state);f.openedPanelValue&&t.current.publishEvent("preferencePanelClose",{openedPanelValue:f.openedPanelValue}),t.current.setState(g=>B({},g,{preferencePanel:{open:!1}})),t.current.forceUpdate()},[t,r]),a=p.useCallback(()=>{o.current=setTimeout(()=>clearTimeout(s.current),0)},[]),l=p.useCallback(()=>{s.current=setTimeout(i,100)},[i]),c=p.useCallback((f,g,y)=>{r.debug("Opening Preferences Panel"),a(),t.current.setState(w=>B({},w,{preferencePanel:B({},w.preferencePanel,{open:!0,openedPanelValue:f,panelId:g,labelId:y})})),t.current.publishEvent("preferencePanelOpen",{openedPanelValue:f}),t.current.forceUpdate()},[r,a,t]);rt(t,{showPreferences:c,hidePreferences:l},"public");const u=p.useCallback((f,g)=>{var y;const w=zm(t.current.state);return!g.exportOnlyDirtyModels||((y=e.initialState)==null?void 0:y.preferencePanel)!=null||w.open?B({},f,{preferencePanel:w}):f},[t,(n=e.initialState)==null?void 0:n.preferencePanel]),h=p.useCallback((f,g)=>{const y=g.stateToRestore.preferencePanel;return y!=null&&t.current.setState(w=>B({},w,{preferencePanel:y})),f},[t]);gn(t,"exportState",u),gn(t,"restoreState",h),p.useEffect(()=>()=>{clearTimeout(s.current),clearTimeout(o.current)},[])},ose=["id","field"],ise=["id","field"],ase=Ho(["MUI: A call to `processRowUpdate` threw an error which was not handled because `onProcessRowUpdateError` is missing.","To handle the error pass a callback to the `onProcessRowUpdateError` prop, e.g. `<DataGrid onProcessRowUpdateError={(error) => ...} />`.","For more detail, see http://mui.com/components/data-grid/editing/#server-side-persistence."],"error"),lse=(t,e)=>{const[n,r]=p.useState({}),s=p.useRef(n),o=p.useRef({}),{processRowUpdate:i,onProcessRowUpdateError:a,cellModesModel:l,onCellModesModelChange:c}=e,u=j=>(...R)=>{e.editMode===Bo.Cell&&j(...R)},h=p.useCallback((j,R)=>{const V=t.current.getCellParams(j,R);if(!t.current.isCellEditable(V))throw new Error(`MUI: The cell with id=${j} and field=${R} is not editable.`)},[t]),f=p.useCallback((j,R,V)=>{if(t.current.getCellMode(j,R)!==V)throw new Error(`MUI: The cell with id=${j} and field=${R} is not in ${V} mode.`)},[t]),g=p.useCallback((j,R)=>{if(!j.isEditable||j.cellMode===kt.Edit)return;const V=B({},j,{reason:Ko.cellDoubleClick});t.current.publishEvent("cellEditStart",V,R)},[t]),y=p.useCallback((j,R)=>{if(j.cellMode===kt.View||t.current.getCellMode(j.id,j.field)===kt.View)return;const V=B({},j,{reason:Ds.cellFocusOut});t.current.publishEvent("cellEditStop",V,R)},[t]),w=p.useCallback((j,R)=>{if(j.cellMode===kt.Edit){if(R.which===229)return;let V;if(R.key==="Escape"?V=Ds.escapeKeyDown:R.key==="Enter"?V=Ds.enterKeyDown:R.key==="Tab"&&(V=R.shiftKey?Ds.shiftTabKeyDown:Ds.tabKeyDown,R.preventDefault()),V){const U=B({},j,{reason:V});t.current.publishEvent("cellEditStop",U,R)}}else if(j.isEditable){let V;if(!t.current.unstable_applyPipeProcessors("canStartEditing",!0,{event:R,cellParams:j,editMode:"cell"}))return;if(lj(R)?V=Ko.printableKeyDown:(R.ctrlKey||R.metaKey)&&R.key==="v"?V=Ko.pasteKeyDown:R.key==="Enter"?V=Ko.enterKeyDown:(R.key==="Delete"||R.key==="Backspace")&&(V=Ko.deleteKeyDown),V){const F=B({},j,{reason:V,key:R.key});t.current.publishEvent("cellEditStart",F,R)}}},[t]),v=p.useCallback(j=>{const{id:R,field:V,reason:U}=j,F={id:R,field:V};(U===Ko.printableKeyDown||U===Ko.deleteKeyDown||U===Ko.pasteKeyDown)&&(F.deleteValue=!0),t.current.startCellEditMode(F)},[t]),C=p.useCallback(j=>{const{id:R,field:V,reason:U}=j;t.current.runPendingEditCellValueMutation(R,V);let F;U===Ds.enterKeyDown?F="below":U===Ds.tabKeyDown?F="right":U===Ds.shiftTabKeyDown&&(F="left");const $=U==="escapeKeyDown";t.current.stopCellEditMode({id:R,field:V,ignoreModifications:$,cellToFocusAfter:F})},[t]);ze(t,"cellDoubleClick",u(g)),ze(t,"cellFocusOut",u(y)),ze(t,"cellKeyDown",u(w)),ze(t,"cellEditStart",u(v)),ze(t,"cellEditStop",u(C)),Gt(t,"cellEditStart",e.onCellEditStart),Gt(t,"cellEditStop",e.onCellEditStop);const x=p.useCallback((j,R)=>{const V=gr(t.current.state);return V[j]&&V[j][R]?kt.Edit:kt.View},[t]),A=Ws(j=>{const R=j!==e.cellModesModel;c&&R&&c(j,{}),!(e.cellModesModel&&R)&&(r(j),s.current=j,t.current.publishEvent("cellModesModelChange",j))}),N=p.useCallback((j,R,V)=>{const U=B({},s.current);if(V!==null)U[j]=B({},U[j],{[R]:B({},V)});else{const F=U[j],$=He(F,[R].map(bm));U[j]=$,Object.keys(U[j]).length===0&&delete U[j]}A(U)},[A]),M=p.useCallback((j,R,V)=>{t.current.setState(U=>{const F=B({},U.editRows);return V!==null?F[j]=B({},F[j],{[R]:B({},V)}):(delete F[j][R],Object.keys(F[j]).length===0&&delete F[j]),B({},U,{editRows:F})}),t.current.forceUpdate()},[t]),k=p.useCallback(j=>{const{id:R,field:V}=j,U=He(j,ose);h(R,V),f(R,V,kt.View),N(R,V,B({mode:kt.Edit},U))},[h,f,N]),E=Ws(j=>{const{id:R,field:V,deleteValue:U,initialValue:F}=j;let $=t.current.getCellValue(R,V);(U||F)&&($=U?"":F),M(R,V,{value:$,error:!1,isProcessingProps:!1}),t.current.setCellFocus(R,V)}),b=p.useCallback(j=>{const{id:R,field:V}=j,U=He(j,ise);f(R,V,kt.Edit),N(R,V,B({mode:kt.View},U))},[f,N]),I=Ws(async j=>{const{id:R,field:V,ignoreModifications:U,cellToFocusAfter:F="none"}=j;f(R,V,kt.Edit),t.current.runPendingEditCellValueMutation(R,V);const $=()=>{M(R,V,null),N(R,V,null),F!=="none"&&t.current.moveFocusToRelativeCell(R,V,F)};if(U){$();return}const W=gr(t.current.state),{error:Z,isProcessingProps:Y}=W[R][V];if(Z||Y){o.current[R][V].mode=kt.Edit,N(R,V,{mode:kt.Edit});return}const le=t.current.getRowWithUpdatedValuesFromCellEditing(R,V);if(i){const fe=we=>{o.current[R][V].mode=kt.Edit,N(R,V,{mode:kt.Edit}),a?a(we):ase()};try{const we=t.current.getRow(R);Promise.resolve(i(le,we)).then(Me=>{t.current.updateRows([Me]),$()}).catch(fe)}catch(we){fe(we)}}else t.current.updateRows([le]),$()}),P=p.useCallback(async j=>{var R;const{id:V,field:U,value:F,debounceMs:$,unstable_skipValueParser:W}=j;h(V,U),f(V,U,kt.Edit);const Z=t.current.getColumn(U),Y=t.current.getRow(V);let le=F;Z.valueParser&&!W&&(le=Z.valueParser(F,t.current.getCellParams(V,U)));let fe=gr(t.current.state),we=B({},fe[V][U],{value:le,changeReason:$?"debouncedSetEditCellValue":"setEditCellValue"});if(Z.preProcessEditCellProps){const Me=F!==fe[V][U].value;we=B({},we,{isProcessingProps:!0}),M(V,U,we),we=await Promise.resolve(Z.preProcessEditCellProps({id:V,row:Y,props:we,hasChanged:Me}))}return t.current.getCellMode(V,U)===kt.View?!1:(fe=gr(t.current.state),we=B({},we,{isProcessingProps:!1}),we.value=Z.preProcessEditCellProps?fe[V][U].value:le,M(V,U,we),fe=gr(t.current.state),!((R=fe[V])!=null&&(R=R[U])!=null&&R.error))},[t,h,f,M]),S=p.useCallback((j,R)=>{const V=t.current.getColumn(R),U=gr(t.current.state),F=t.current.getRow(j);if(!U[j]||!U[j][R])return t.current.getRow(j);const{value:$}=U[j][R];return V.valueSetter?V.valueSetter({value:$,row:F}):B({},F,{[R]:$})},[t]),D={getCellMode:x,startCellEditMode:k,stopCellEditMode:b},T={setCellEditingEditCellValue:P,getRowWithUpdatedValuesFromCellEditing:S};rt(t,D,"public"),rt(t,T,"private"),p.useEffect(()=>{l&&A(l)},[l,A]),Yn(()=>{const j=Sw(t),R=o.current;o.current=mj(n),Object.entries(n).forEach(([V,U])=>{Object.entries(U).forEach(([F,$])=>{var W,Z;const Y=((W=R[V])==null||(W=W[F])==null?void 0:W.mode)||kt.View,le=(Z=j[V])!=null?Z:V;$.mode===kt.Edit&&Y===kt.View?E(B({id:le,field:F},$)):$.mode===kt.View&&Y===kt.Edit&&I(B({id:le,field:F},$))})})},[t,n,E,I])},cse=["id"],use=["id"],dse=Ho(["MUI: A call to `processRowUpdate` threw an error which was not handled because `onProcessRowUpdateError` is missing.","To handle the error pass a callback to the `onProcessRowUpdateError` prop, e.g. `<DataGrid onProcessRowUpdateError={(error) => ...} />`.","For more detail, see http://mui.com/components/data-grid/editing/#server-side-persistence."],"error"),hse=(t,e)=>{const[n,r]=p.useState({}),s=p.useRef(n),o=p.useRef({}),i=p.useRef(null),a=p.useRef(null),{processRowUpdate:l,onProcessRowUpdateError:c,rowModesModel:u,onRowModesModelChange:h}=e,f=F=>(...$)=>{e.editMode===Bo.Row&&F(...$)},g=p.useCallback((F,$)=>{const W=t.current.getCellParams(F,$);if(!t.current.isCellEditable(W))throw new Error(`MUI: The cell with id=${F} and field=${$} is not editable.`)},[t]),y=p.useCallback((F,$)=>{if(t.current.getRowMode(F)!==$)throw new Error(`MUI: The row with id=${F} is not in ${$} mode.`)},[t]),w=p.useCallback((F,$)=>{if(!F.isEditable||t.current.getRowMode(F.id)===Vt.Edit)return;const W=t.current.getRowParams(F.id),Z=B({},W,{field:F.field,reason:ea.cellDoubleClick});t.current.publishEvent("rowEditStart",Z,$)},[t]),v=p.useCallback(F=>{a.current=F},[]),C=p.useCallback((F,$)=>{F.isEditable&&t.current.getRowMode(F.id)!==Vt.View&&(a.current=null,i.current=setTimeout(()=>{var W;if(i.current=null,((W=a.current)==null?void 0:W.id)!==F.id){if(!t.current.getRow(F.id)||t.current.getRowMode(F.id)===Vt.View)return;const Z=t.current.getRowParams(F.id),Y=B({},Z,{field:F.field,reason:qo.rowFocusOut});t.current.publishEvent("rowEditStop",Y,$)}}))},[t]);p.useEffect(()=>()=>{clearTimeout(i.current)},[]);const x=p.useCallback((F,$)=>{if(F.cellMode===Vt.Edit){if($.which===229)return;let W;if($.key==="Escape")W=qo.escapeKeyDown;else if($.key==="Enter")W=qo.enterKeyDown;else if($.key==="Tab"){const Z=Qb(t).filter(Y=>t.current.getColumn(Y).type===n0?!0:t.current.isCellEditable(t.current.getCellParams(F.id,Y)));if($.shiftKey?F.field===Z[0]&&(W=qo.shiftTabKeyDown):F.field===Z[Z.length-1]&&(W=qo.tabKeyDown),$.preventDefault(),!W){const Y=Z.findIndex(fe=>fe===F.field),le=Z[$.shiftKey?Y-1:Y+1];t.current.setCellFocus(F.id,le)}}if(W){const Z=B({},t.current.getRowParams(F.id),{reason:W,field:F.field});t.current.publishEvent("rowEditStop",Z,$)}}else if(F.isEditable){let W;if(!t.current.unstable_applyPipeProcessors("canStartEditing",!0,{event:$,cellParams:F,editMode:"row"}))return;if(lj($)||($.ctrlKey||$.metaKey)&&$.key==="v"?W=ea.printableKeyDown:$.key==="Enter"?W=ea.enterKeyDown:($.key==="Delete"||$.key==="Backspace")&&(W=ea.deleteKeyDown),W){const Y=t.current.getRowParams(F.id),le=B({},Y,{field:F.field,reason:W});t.current.publishEvent("rowEditStart",le,$)}}},[t]),A=p.useCallback(F=>{const{id:$,field:W,reason:Z}=F,Y={id:$,fieldToFocus:W};(Z===ea.printableKeyDown||Z===ea.deleteKeyDown)&&(Y.deleteValue=!!W),t.current.startRowEditMode(Y)},[t]),N=p.useCallback(F=>{const{id:$,reason:W,field:Z}=F;t.current.runPendingEditCellValueMutation($);let Y;W===qo.enterKeyDown?Y="below":W===qo.tabKeyDown?Y="right":W===qo.shiftTabKeyDown&&(Y="left");const le=W==="escapeKeyDown";t.current.stopRowEditMode({id:$,ignoreModifications:le,field:Z,cellToFocusAfter:Y})},[t]);ze(t,"cellDoubleClick",f(w)),ze(t,"cellFocusIn",f(v)),ze(t,"cellFocusOut",f(C)),ze(t,"cellKeyDown",f(x)),ze(t,"rowEditStart",f(A)),ze(t,"rowEditStop",f(N)),Gt(t,"rowEditStart",e.onRowEditStart),Gt(t,"rowEditStop",e.onRowEditStop);const M=p.useCallback(F=>{if(e.editMode===Bo.Cell)return Vt.View;const $=gr(t.current.state);return $[F]&&Object.keys($[F]).length>0?Vt.Edit:Vt.View},[t,e.editMode]),k=Ws(F=>{const $=F!==e.rowModesModel;h&&$&&h(F,{}),!(e.rowModesModel&&$)&&(r(F),s.current=F,t.current.publishEvent("rowModesModelChange",F))}),E=p.useCallback((F,$)=>{const W=B({},s.current);$!==null?W[F]=B({},$):delete W[F],k(W)},[k]),b=p.useCallback((F,$)=>{t.current.setState(W=>{const Z=B({},W.editRows);return $!==null?Z[F]=$:delete Z[F],B({},W,{editRows:Z})}),t.current.forceUpdate()},[t]),I=p.useCallback((F,$,W)=>{t.current.setState(Z=>{const Y=B({},Z.editRows);return W!==null?Y[F]=B({},Y[F],{[$]:B({},W)}):(delete Y[F][$],Object.keys(Y[F]).length===0&&delete Y[F]),B({},Z,{editRows:Y})}),t.current.forceUpdate()},[t]),P=p.useCallback(F=>{const{id:$}=F,W=He(F,cse);y($,Vt.View),E($,B({mode:Vt.Edit},W))},[y,E]),S=Ws(F=>{const{id:$,fieldToFocus:W,deleteValue:Z,initialValue:Y}=F,fe=wi(t).reduce((we,Me)=>{if(!t.current.getCellParams($,Me).isEditable)return we;let X=t.current.getCellValue($,Me);return W===Me&&(Z||Y)&&(X=Z?"":Y),we[Me]={value:X,error:!1,isProcessingProps:!1},we},{});b($,fe),W&&t.current.setCellFocus($,W)}),D=p.useCallback(F=>{const{id:$}=F,W=He(F,use);y($,Vt.Edit),E($,B({mode:Vt.View},W))},[y,E]),T=Ws(F=>{const{id:$,ignoreModifications:W,field:Z,cellToFocusAfter:Y="none"}=F;t.current.runPendingEditCellValueMutation($);const le=()=>{Y!=="none"&&Z&&t.current.moveFocusToRelativeCell($,Z,Y),b($,null),E($,null)};if(W){le();return}const fe=gr(t.current.state),we=t.current.getRow($);if(Object.values(fe[$]).some(ue=>ue.isProcessingProps)){o.current[$].mode=Vt.Edit;return}if(Object.values(fe[$]).some(ue=>ue.error)){o.current[$].mode=Vt.Edit,E($,{mode:Vt.Edit});return}const X=t.current.getRowWithUpdatedValuesFromRowEditing($);if(l){const ue=re=>{o.current[$].mode=Vt.Edit,E($,{mode:Vt.Edit}),c?c(re):dse()};try{Promise.resolve(l(X,we)).then(re=>{t.current.updateRows([re]),le()}).catch(ue)}catch(re){ue(re)}}else t.current.updateRows([X]),le()}),j=p.useCallback(F=>{const{id:$,field:W,value:Z,debounceMs:Y,unstable_skipValueParser:le}=F;g($,W);const fe=t.current.getColumn(W),we=t.current.getRow($);let Me=Z;fe.valueParser&&!le&&(Me=fe.valueParser(Z,t.current.getCellParams($,W)));let Ee=gr(t.current.state),X=B({},Ee[$][W],{value:Me,changeReason:Y?"debouncedSetEditCellValue":"setEditCellValue"});return fe.preProcessEditCellProps||I($,W,X),new Promise(ue=>{const re=[];if(fe.preProcessEditCellProps){const ie=X.value!==Ee[$][W].value;X=B({},X,{isProcessingProps:!0}),I($,W,X);const Ce=Ee[$],K=He(Ce,[W].map(bm)),me=Promise.resolve(fe.preProcessEditCellProps({id:$,row:we,props:X,hasChanged:ie,otherFieldsProps:K})).then(Q=>{if(t.current.getRowMode($)===Vt.View){ue(!1);return}Ee=gr(t.current.state),Q=B({},Q,{isProcessingProps:!1}),Q.value=fe.preProcessEditCellProps?Ee[$][W].value:Me,I($,W,Q)});re.push(me)}Object.entries(Ee[$]).forEach(([ie,Ce])=>{if(ie===W)return;const K=t.current.getColumn(ie);if(!K.preProcessEditCellProps)return;Ce=B({},Ce,{isProcessingProps:!0}),I($,ie,Ce),Ee=gr(t.current.state);const me=Ee[$],Q=He(me,[ie].map(bm)),ee=Promise.resolve(K.preProcessEditCellProps({id:$,row:we,props:Ce,hasChanged:!1,otherFieldsProps:Q})).then(de=>{if(t.current.getRowMode($)===Vt.View){ue(!1);return}de=B({},de,{isProcessingProps:!1}),I($,ie,de)});re.push(ee)}),Promise.all(re).then(()=>{t.current.getRowMode($)===Vt.Edit?(Ee=gr(t.current.state),ue(!Ee[$][W].error)):ue(!1)})})},[t,g,I]),R=p.useCallback(F=>{const $=gr(t.current.state),W=t.current.getRow(F);if(!$[F])return t.current.getRow(F);let Z=B({},W);return Object.entries($[F]).forEach(([Y,le])=>{const fe=t.current.getColumn(Y);fe.valueSetter?Z=fe.valueSetter({value:le.value,row:Z}):Z[Y]=le.value}),Z},[t]),V={getRowMode:M,startRowEditMode:P,stopRowEditMode:D},U={setRowEditingEditCellValue:j,getRowWithUpdatedValuesFromRowEditing:R};rt(t,V,"public"),rt(t,U,"private"),p.useEffect(()=>{u&&k(u)},[u,k]),Yn(()=>{const F=Sw(t),$=o.current;o.current=mj(n),Object.entries(n).forEach(([W,Z])=>{var Y,le;const fe=((Y=$[W])==null?void 0:Y.mode)||Vt.View,we=(le=F[W])!=null?le:W;Z.mode===Vt.Edit&&fe===Vt.View?S(B({id:we},Z)):Z.mode===Vt.View&&fe===Vt.Edit&&T(B({id:we},Z))})},[t,n,S,T])},fse=t=>B({},t,{editRows:{}}),mse=(t,e)=>{lse(t,e),hse(t,e);const n=p.useRef({}),{isCellEditable:r}=e,s=p.useCallback(f=>Hm(f.rowNode)||!f.colDef.editable||!f.colDef.renderEditCell?!1:r?r(f):!0,[r]),o=(f,g,y,w)=>{if(!y){w();return}if(n.current[f]||(n.current[f]={}),n.current[f][g]){const[x]=n.current[f][g];clearTimeout(x)}const v=()=>{const[x]=n.current[f][g];clearTimeout(x),w(),delete n.current[f][g]},C=setTimeout(()=>{w(),delete n.current[f][g]},y);n.current[f][g]=[C,v]};p.useEffect(()=>{const f=n.current;return()=>{Object.entries(f).forEach(([g,y])=>{Object.keys(y).forEach(w=>{const[v]=f[g][w];clearTimeout(v),delete f[g][w]})})}},[]);const i=p.useCallback((f,g)=>{if(n.current[f]){if(!g)Object.keys(n.current[f]).forEach(y=>{const[,w]=n.current[f][y];w()});else if(n.current[f][g]){const[,y]=n.current[f][g];y()}}},[]),a=p.useCallback(f=>{const{id:g,field:y,debounceMs:w}=f;return new Promise(v=>{o(g,y,w,async()=>{const C=e.editMode===Bo.Row?t.current.setRowEditingEditCellValue:t.current.setCellEditingEditCellValue;if(t.current.getCellMode(g,y)===kt.Edit){const x=await C(f);v(x)}})})},[t,e.editMode]),l=p.useCallback((f,g)=>e.editMode===Bo.Cell?t.current.getRowWithUpdatedValuesFromCellEditing(f,g):t.current.getRowWithUpdatedValuesFromRowEditing(f),[t,e.editMode]),c=p.useCallback((f,g)=>{var y,w;return(y=(w=gr(t.current.state)[f])==null?void 0:w[g])!=null?y:null},[t]),u={isCellEditable:s,setEditCellValue:a,getRowWithUpdatedValues:l,unstable_getEditCellMeta:c},h={runPendingEditCellValueMutation:i};rt(t,u,"public"),rt(t,h,"private")},pse=(t,e,n)=>(n.current.caches.rows=Ey({rows:e.rows,getRowId:e.getRowId,loading:e.loading,rowCount:e.rowCount}),B({},t,{rows:ej({apiRef:n,rowCountProp:e.rowCount,loadingProp:e.loading,previousTree:null,previousTreeDepths:null})})),gse=(t,e)=>{const n=er(t,"useGridRows"),r=Zc(t,e),s=p.useRef(Date.now()),o=DI(),i=p.useCallback(T=>{const j=mi(t)[T];if(j)return j;const R=t.current.getRowNode(T);return R&&Hm(R)?{[Yu]:T}:null},[t]),a=e.getRowId,l=p.useCallback(T=>Yu in T?T[Yu]:a?a(T):T.id,[a]),c=p.useMemo(()=>r.rows.reduce((T,{id:j},R)=>(T[j]=R,T),{}),[r.rows]),u=p.useCallback(({cache:T,throttle:j})=>{const R=()=>{s.current=Date.now(),t.current.setState(U=>B({},U,{rows:ej({apiRef:t,rowCountProp:e.rowCount,loadingProp:e.loading,previousTree:Us(t),previousTreeDepths:KP(t)})})),t.current.publishEvent("rowsSet"),t.current.forceUpdate()};if(o.clear(),t.current.caches.rows=T,!j){R();return}const V=e.throttleRowsMs-(Date.now()-s.current);if(V>0){o.start(V,R);return}R()},[e.throttleRowsMs,e.rowCount,e.loading,t,o]),h=p.useCallback(T=>{n.debug(`Updating all rows, new length ${T.length}`);const j=Ey({rows:T,getRowId:e.getRowId,loading:e.loading,rowCount:e.rowCount}),R=t.current.caches.rows;j.rowsBeforePartialUpdates=R.rowsBeforePartialUpdates,u({cache:j,throttle:!0})},[n,e.getRowId,e.loading,e.rowCount,u,t]),f=p.useCallback(T=>{if(e.signature===Oo.DataGrid&&T.length>1)throw new Error(["MUI: You can't update several rows at once in `apiRef.current.updateRows` on the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join(`
`));const j=[];T.forEach(V=>{const U=kw(V,e.getRowId,"A row was provided without id when calling updateRows():"),F=t.current.getRowNode(U);if(F?.type==="pinnedRow"){const $=t.current.caches.pinnedRows,W=$.idLookup[U];W&&($.idLookup[U]=B({},W,V))}else j.push(V)});const R=cX({updates:j,getRowId:e.getRowId,previousCache:t.current.caches.rows});u({cache:R,throttle:!0})},[e.signature,e.getRowId,u,t]),g=p.useCallback(()=>{const T=Bf(t),j=mi(t);return new Map(T.map(R=>{var V;return[R,(V=j[R])!=null?V:{}]}))},[t]),y=p.useCallback(()=>Jb(t),[t]),w=p.useCallback(()=>Bf(t),[t]),v=p.useCallback(T=>c[T],[c]),C=p.useCallback((T,j)=>{const R=t.current.getRowNode(T);if(!R)throw new Error(`MUI: No row with id #${T} found`);if(R.type!=="group")throw new Error("MUI: Only group nodes can be expanded or collapsed");const V=B({},R,{childrenExpanded:j});t.current.setState(U=>B({},U,{rows:B({},U.rows,{tree:B({},U.rows.tree,{[T]:V})})})),t.current.forceUpdate(),t.current.publishEvent("rowExpansionChange",V)},[t]),x=p.useCallback(T=>{var j;return(j=Us(t)[T])!=null?j:null},[t]),A=p.useCallback(({skipAutoGeneratedRows:T=!0,groupId:j,applySorting:R,applyFiltering:V})=>{const U=Us(t);let F;if(R){const $=U[j];if(!$)return[];const W=xI(t);F=[];const Z=W.findIndex(Y=>Y===j)+1;for(let Y=Z;Y<W.length&&U[W[Y]].depth>$.depth;Y+=1){const le=W[Y];(!T||!Hm(U[le]))&&F.push(le)}}else F=_I(U,j,T);if(V){const $=KF(t);F=F.filter(W=>$[W]!==!1)}return F},[t]),N=p.useCallback((T,j)=>{const R=t.current.getRowNode(T);if(!R)throw new Error(`MUI: No row with id #${T} found`);if(R.parent!==yr)throw new Error("MUI: The row reordering do not support reordering of grouped rows yet");if(R.type!=="leaf")throw new Error("MUI: The row reordering do not support reordering of footer or grouping rows");t.current.setState(V=>{const U=Us(V,t.current.instanceId)[yr],F=U.children,$=F.findIndex(Z=>Z===T);if($===-1||$===j)return V;n.debug(`Moving row ${T} to index ${j}`);const W=[...F];return W.splice(j,0,W.splice($,1)[0]),B({},V,{rows:B({},V.rows,{tree:B({},V.rows.tree,{[yr]:B({},U,{children:W})})})})}),t.current.publishEvent("rowsSet")},[t,n]),M=p.useCallback((T,j)=>{if(e.signature===Oo.DataGrid&&j.length>1)throw new Error(["MUI: You can't replace rows using `apiRef.current.unstable_replaceRows` on the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join(`
`));if(j.length===0)return;if(Xb(t)>1)throw new Error("`apiRef.current.unstable_replaceRows` is not compatible with tree data and row grouping");const V=B({},Us(t)),U=B({},mi(t)),F=B({},Sw(t)),$=V[yr],W=[...$.children],Z=new Set;for(let le=0;le<j.length;le+=1){const fe=j[le],we=kw(fe,e.getRowId,"A row was provided without id when calling replaceRows()."),[Me]=W.splice(T+le,1,we);Z.has(Me)||(delete U[Me],delete F[Me],delete V[Me]);const Ee={id:we,depth:0,parent:yr,type:"leaf",groupingKey:null};U[we]=fe,F[we]=we,V[we]=Ee,Z.add(we)}V[yr]=B({},$,{children:W});const Y=W.filter(le=>V[le].type==="leaf");t.current.caches.rows.dataRowIdToModelLookup=U,t.current.caches.rows.dataRowIdToIdLookup=F,t.current.setState(le=>B({},le,{rows:B({},le.rows,{dataRowIdToModelLookup:U,dataRowIdToIdLookup:F,dataRowIds:Y,tree:V})})),t.current.publishEvent("rowsSet")},[t,e.signature,e.getRowId]),k={getRow:i,getRowId:l,getRowModels:g,getRowsCount:y,getAllRowIds:w,setRows:h,updateRows:f,getRowNode:x,getRowIndexRelativeToVisibleRows:v,unstable_replaceRows:M},E={setRowIndex:N,setRowChildrenExpansion:C,getRowGroupChildren:A},b=p.useCallback(()=>{n.info("Row grouping pre-processing have changed, regenerating the row tree");let T;t.current.caches.rows.rowsBeforePartialUpdates===e.rows?T=B({},t.current.caches.rows,{updates:{type:"full",rows:Bf(t)}}):T=Ey({rows:e.rows,getRowId:e.getRowId,loading:e.loading,rowCount:e.rowCount}),u({cache:T,throttle:!1})},[n,t,e.rows,e.getRowId,e.loading,e.rowCount,u]),I=p.useCallback(T=>{T==="rowTreeCreation"&&b()},[b]),P=p.useCallback(()=>{t.current.getActiveStrategy("rowTree")!==zJ(t)&&b()},[t,b]);ze(t,"activeStrategyProcessorChange",I),ze(t,"strategyAvailabilityChange",P);const S=p.useCallback(()=>{t.current.setState(T=>{const j=t.current.unstable_applyPipeProcessors("hydrateRows",{tree:Us(T,t.current.instanceId),treeDepths:KP(T,t.current.instanceId),dataRowIds:Bf(T,t.current.instanceId),dataRowIdToModelLookup:mi(T,t.current.instanceId),dataRowIdToIdLookup:Sw(T,t.current.instanceId)});return B({},T,{rows:B({},T.rows,j,{totalTopLevelRowCount:ZF({tree:j.tree,rowCountProp:e.rowCount})})})}),t.current.publishEvent("rowsSet"),t.current.forceUpdate()},[t,e.rowCount]);LI(t,"hydrateRows",S),rt(t,k,"public"),rt(t,E,e.signature===Oo.DataGrid?"private":"public");const D=p.useRef(!0);p.useEffect(()=>{if(D.current){D.current=!1;return}const T=t.current.caches.rows.rowsBeforePartialUpdates===e.rows,j=t.current.caches.rows.loadingPropBeforePartialUpdates===e.loading,R=t.current.caches.rows.rowCountPropBeforePartialUpdates===e.rowCount;if(T){j||(t.current.setState(V=>B({},V,{rows:B({},V.rows,{loading:e.loading})})),t.current.caches.rows.loadingPropBeforePartialUpdates=e.loading,t.current.forceUpdate()),R||(t.current.setState(V=>B({},V,{rows:B({},V.rows,{totalRowCount:Math.max(e.rowCount||0,V.rows.totalRowCount),totalTopLevelRowCount:Math.max(e.rowCount||0,V.rows.totalTopLevelRowCount)})})),t.current.caches.rows.rowCountPropBeforePartialUpdates=e.rowCount,t.current.forceUpdate());return}n.debug(`Updating all rows, new length ${e.rows.length}`),u({cache:Ey({rows:e.rows,getRowId:e.getRowId,loading:e.loading,rowCount:e.rowCount}),throttle:!1})},[e.rows,e.rowCount,e.getRowId,e.loading,n,u,t])},yse=t=>{const e={[yr]:B({},aX(),{children:t})};for(let n=0;n<t.length;n+=1){const r=t[n];e[r]={id:r,depth:0,parent:yr,type:"leaf",groupingKey:null}}return{groupingName:Uc,tree:e,treeDepths:{0:t.length},dataRowIds:t}},wse=({previousTree:t,actions:e})=>{const n=B({},t),r={};for(let i=0;i<e.remove.length;i+=1){const a=e.remove[i];r[a]=!0,delete n[a]}for(let i=0;i<e.insert.length;i+=1){const a=e.insert[i];n[a]={id:a,depth:0,parent:yr,type:"leaf",groupingKey:null}}const s=n[yr];let o=[...s.children,...e.insert];return Object.values(r).length&&(o=o.filter(i=>!r[i])),n[yr]=B({},s,{children:o}),{groupingName:Uc,tree:n,treeDepths:{0:o.length},dataRowIds:o}},bse=t=>t.updates.type==="full"?yse(t.updates.rows):wse({previousTree:t.previousTree,actions:t.updates.actions}),vse=t=>{Fw(t,Uc,"rowTreeCreation",bse)},zj=(t,e)=>t==null||Array.isArray(t)?t:e&&e[0]===t?e:[t],xse=(t,e)=>{var n;return B({},t,{rowSelection:e.rowSelection?(n=zj(e.rowSelectionModel))!=null?n:[]:[]})},Cse=(t,e)=>{const n=er(t,"useGridSelection"),r=j=>(...R)=>{e.rowSelection&&j(...R)},s=p.useMemo(()=>zj(e.rowSelectionModel,ys(t.current.state)),[t,e.rowSelectionModel]),o=p.useRef(null);t.current.registerControlState({stateId:"rowSelection",propModel:s,propOnChange:e.onRowSelectionModelChange,stateSelector:ys,changeEvent:"rowSelectionChange"});const{checkboxSelection:i,disableMultipleRowSelection:a,disableRowSelectionOnClick:l,isRowSelectable:c}=e,u=!a||i,h=Zc(t,e),f=p.useCallback(j=>{var R;let V=j;const U=(R=o.current)!=null?R:j,F=t.current.isRowSelected(j);if(F){const $=mm(t),W=$.findIndex(Y=>Y===U),Z=$.findIndex(Y=>Y===V);if(W===Z)return;W>Z?V=$[Z+1]:V=$[Z-1]}o.current=j,t.current.selectRowRange({startId:U,endId:V},!F)},[t]),g=p.useCallback(j=>{if(e.signature===Oo.DataGrid&&!e.checkboxSelection&&Array.isArray(j)&&j.length>1)throw new Error(["MUI: `rowSelectionModel` can only contain 1 item in DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock multiple selection."].join(`
`));ys(t.current.state)!==j&&(n.debug("Setting selection model"),t.current.setState(V=>B({},V,{rowSelection:e.rowSelection?j:[]})),t.current.forceUpdate())},[t,n,e.rowSelection,e.signature,e.checkboxSelection]),y=p.useCallback(j=>ys(t.current.state).includes(j),[t]),w=p.useCallback(j=>{if(c&&!c(t.current.getRowParams(j)))return!1;const R=t.current.getRowNode(j);return!(R?.type==="footer"||R?.type==="pinnedRow")},[t,c]),v=p.useCallback(()=>fee(t),[t]),C=p.useCallback((j,R=!0,V=!1)=>{if(t.current.isRowSelectable(j))if(o.current=j,V)n.debug(`Setting selection for row ${j}`),t.current.setRowSelectionModel(R?[j]:[]);else{n.debug(`Toggling selection for row ${j}`);const F=ys(t.current.state).filter(W=>W!==j);R&&F.push(j),(F.length<2||u)&&t.current.setRowSelectionModel(F)}},[t,n,u]),x=p.useCallback((j,R=!0,V=!1)=>{n.debug("Setting selection for several rows");const U=j.filter(W=>t.current.isRowSelectable(W));let F;if(V)F=R?U:[];else{const W=B({},Mw(t));U.forEach(Z=>{R?W[Z]=Z:delete W[Z]}),F=Object.values(W)}(F.length<2||u)&&t.current.setRowSelectionModel(F)},[t,n,u]),A=p.useCallback(({startId:j,endId:R},V=!0,U=!1)=>{if(!t.current.getRow(j)||!t.current.getRow(R))return;n.debug(`Expanding selection from row ${j} to row ${R}`);const F=mm(t),$=F.indexOf(j),W=F.indexOf(R),[Z,Y]=$>W?[W,$]:[$,W],le=F.slice(Z,Y+1);t.current.selectRows(le,V,U)},[t,n]),N={selectRow:C,setRowSelectionModel:g,getSelectedRows:v,isRowSelected:y,isRowSelectable:w},M={selectRows:x,selectRowRange:A};rt(t,N,"public"),rt(t,M,e.signature===Oo.DataGrid?"private":"public");const k=p.useCallback(()=>{if(e.keepNonExistentRowsSelected)return;const j=ys(t.current.state),R=mi(t),V=B({},Mw(t));let U=!1;j.forEach(F=>{R[F]||(delete V[F],U=!0)}),U&&t.current.setRowSelectionModel(Object.values(V))},[t,e.keepNonExistentRowsSelected]),E=p.useCallback((j,R)=>{const V=R.metaKey||R.ctrlKey,U=!i&&!V&&!JX(R),F=!u||U,$=t.current.isRowSelected(j);F?t.current.selectRow(j,U?!0:!$,!0):t.current.selectRow(j,!$,!1)},[t,u,i]),b=p.useCallback((j,R)=>{var V;if(l)return;const U=(V=R.target.closest(`.${q.cell}`))==null?void 0:V.getAttribute("data-field");if(U===jh.field||U===MI)return;if(U){const $=t.current.getColumn(U);if($?.type===n0)return}t.current.getRowNode(j.id).type!=="pinnedRow"&&(R.shiftKey&&(u||i)?f(j.id):E(j.id,R))},[l,u,i,t,f,E]),I=p.useCallback((j,R)=>{if(u&&R.shiftKey){var V;(V=window.getSelection())==null||V.removeAllRanges()}},[u]),P=p.useCallback((j,R)=>{R.nativeEvent.shiftKey?f(j.id):t.current.selectRow(j.id,j.value)},[t,f]),S=p.useCallback(j=>{const V=e.checkboxSelectionVisibleOnly&&e.pagination?bj(t):mm(t),U=Ln(t);t.current.selectRows(V,j.value,U?.items.length>0)},[t,e.checkboxSelectionVisibleOnly,e.pagination]),D=p.useCallback((j,R)=>{if(t.current.getCellMode(j.id,j.field)!==kt.Edit&&!Yp(R)){if(Dw(R.key)&&R.shiftKey){const V=Kr(t);if(V&&V.id!==j.id){R.preventDefault();const U=t.current.isRowSelected(V.id);if(!u){t.current.selectRow(V.id,!U,!0);return}const F=t.current.getRowIndexRelativeToVisibleRows(V.id),$=t.current.getRowIndexRelativeToVisibleRows(j.id);let W,Z;F>$?U?(W=$,Z=F-1):(W=$,Z=F):U?(W=F+1,Z=$):(W=F,Z=$);const Y=h.rows.slice(W,Z+1).map(le=>le.id);t.current.selectRows(Y,!U);return}}if(R.key===" "&&R.shiftKey){R.preventDefault(),E(j.id,R);return}R.key==="a"&&(R.ctrlKey||R.metaKey)&&(R.preventDefault(),x(t.current.getAllRowIds(),!0))}},[t,E,x,h.rows,u]);ze(t,"sortedRowsSet",r(k)),ze(t,"rowClick",r(b)),ze(t,"rowSelectionCheckboxChange",r(P)),ze(t,"headerSelectionCheckboxChange",S),ze(t,"cellMouseDown",r(I)),ze(t,"cellKeyDown",r(D)),p.useEffect(()=>{s!==void 0&&t.current.setRowSelectionModel(s)},[t,s,e.rowSelection]),p.useEffect(()=>{e.rowSelection||t.current.setRowSelectionModel([])},[t,e.rowSelection]);const T=s!=null;p.useEffect(()=>{if(T||!e.rowSelection)return;const j=ys(t.current.state);if(w){const R=j.filter(V=>w(V));R.length<j.length&&t.current.setRowSelectionModel(R)}},[t,w,T,e.rowSelection]),p.useEffect(()=>{if(!e.rowSelection||T)return;const j=ys(t.current.state);!u&&j.length>1&&t.current.setRowSelectionModel([])},[t,u,i,T,e.rowSelection])},Ese={noRowsLabel:"No rows",noResultsOverlayLabel:"No results found.",toolbarDensity:"Density",toolbarDensityLabel:"Density",toolbarDensityCompact:"Compact",toolbarDensityStandard:"Standard",toolbarDensityComfortable:"Comfortable",toolbarColumns:"Columns",toolbarColumnsLabel:"Select columns",toolbarFilters:"Filters",toolbarFiltersLabel:"Show filters",toolbarFiltersTooltipHide:"Hide filters",toolbarFiltersTooltipShow:"Show filters",toolbarFiltersTooltipActive:t=>t!==1?`${t} active filters`:`${t} active filter`,toolbarQuickFilterPlaceholder:"Search",toolbarQuickFilterLabel:"Search",toolbarQuickFilterDeleteIconLabel:"Clear",toolbarExport:"Export",toolbarExportLabel:"Export",toolbarExportCSV:"Download as CSV",toolbarExportPrint:"Print",toolbarExportExcel:"Download as Excel",columnsPanelTextFieldLabel:"Find column",columnsPanelTextFieldPlaceholder:"Column title",columnsPanelDragIconLabel:"Reorder column",columnsPanelShowAllButton:"Show all",columnsPanelHideAllButton:"Hide all",filterPanelAddFilter:"Add filter",filterPanelRemoveAll:"Remove all",filterPanelDeleteIconLabel:"Delete",filterPanelLogicOperator:"Logic operator",filterPanelOperator:"Operator",filterPanelOperatorAnd:"And",filterPanelOperatorOr:"Or",filterPanelColumns:"Columns",filterPanelInputLabel:"Value",filterPanelInputPlaceholder:"Filter value",filterOperatorContains:"contains",filterOperatorEquals:"equals",filterOperatorStartsWith:"starts with",filterOperatorEndsWith:"ends with",filterOperatorIs:"is",filterOperatorNot:"is not",filterOperatorAfter:"is after",filterOperatorOnOrAfter:"is on or after",filterOperatorBefore:"is before",filterOperatorOnOrBefore:"is on or before",filterOperatorIsEmpty:"is empty",filterOperatorIsNotEmpty:"is not empty",filterOperatorIsAnyOf:"is any of","filterOperator=":"=","filterOperator!=":"!=","filterOperator>":">","filterOperator>=":">=","filterOperator<":"<","filterOperator<=":"<=",headerFilterOperatorContains:"Contains",headerFilterOperatorEquals:"Equals",headerFilterOperatorStartsWith:"Starts with",headerFilterOperatorEndsWith:"Ends with",headerFilterOperatorIs:"Is",headerFilterOperatorNot:"Is not",headerFilterOperatorAfter:"Is after",headerFilterOperatorOnOrAfter:"Is on or after",headerFilterOperatorBefore:"Is before",headerFilterOperatorOnOrBefore:"Is on or before",headerFilterOperatorIsEmpty:"Is empty",headerFilterOperatorIsNotEmpty:"Is not empty",headerFilterOperatorIsAnyOf:"Is any of","headerFilterOperator=":"Equals","headerFilterOperator!=":"Not equals","headerFilterOperator>":"Greater than","headerFilterOperator>=":"Greater than or equal to","headerFilterOperator<":"Less than","headerFilterOperator<=":"Less than or equal to",filterValueAny:"any",filterValueTrue:"true",filterValueFalse:"false",columnMenuLabel:"Menu",columnMenuShowColumns:"Show columns",columnMenuManageColumns:"Manage columns",columnMenuFilter:"Filter",columnMenuHideColumn:"Hide column",columnMenuUnsort:"Unsort",columnMenuSortAsc:"Sort by ASC",columnMenuSortDesc:"Sort by DESC",columnHeaderFiltersTooltipActive:t=>t!==1?`${t} active filters`:`${t} active filter`,columnHeaderFiltersLabel:"Show filters",columnHeaderSortIconLabel:"Sort",footerRowSelected:t=>t!==1?`${t.toLocaleString()} rows selected`:`${t.toLocaleString()} row selected`,footerTotalRows:"Total Rows:",footerTotalVisibleRows:(t,e)=>`${t.toLocaleString()} of ${e.toLocaleString()}`,checkboxSelectionHeaderName:"Checkbox selection",checkboxSelectionSelectAllRows:"Select all rows",checkboxSelectionUnselectAllRows:"Unselect all rows",checkboxSelectionSelectRow:"Select row",checkboxSelectionUnselectRow:"Unselect row",booleanCellTrueLabel:"yes",booleanCellFalseLabel:"no",actionsCellMore:"more",pinToLeft:"Pin to left",pinToRight:"Pin to right",unpin:"Unpin",treeDataGroupingHeaderName:"Group",treeDataExpand:"see children",treeDataCollapse:"hide children",groupingColumnHeaderName:"Group",groupColumn:t=>`Group by ${t}`,unGroupColumn:t=>`Stop grouping by ${t}`,detailPanelToggle:"Detail panel toggle",expandDetailPanel:"Expand",collapseDetailPanel:"Collapse",MuiTablePagination:{},rowReorderingHeaderName:"Row reordering",aggregationMenuItemHeader:"Aggregation",aggregationFunctionLabelSum:"sum",aggregationFunctionLabelAvg:"avg",aggregationFunctionLabelMin:"min",aggregationFunctionLabelMax:"max",aggregationFunctionLabelSize:"size"},Ise=t=>{const{classes:e}=t;return p.useMemo(()=>ft({cellCheckbox:["cellCheckbox"],columnHeaderCheckbox:["columnHeaderCheckbox"]},pt,e),[e])},_se=(t,e)=>{const n={classes:e.classes},r=Ise(n),s=p.useCallback(o=>{const i=B({},jh,{cellClassName:r.cellCheckbox,headerClassName:r.columnHeaderCheckbox,headerName:t.current.getLocaleText("checkboxSelectionHeaderName")}),a=e.checkboxSelection,l=o.lookup[ta]!=null;return a&&!l?(o.lookup[ta]=i,o.orderedFields=[ta,...o.orderedFields]):!a&&l?(delete o.lookup[ta],o.orderedFields=o.orderedFields.filter(c=>c!==ta)):a&&l&&(o.lookup[ta]=B({},i,o.lookup[ta])),o},[t,r,e.checkboxSelection]);gn(t,"hydrateColumns",s)},Ase=(t,e)=>{var n,r,s;const o=(n=(r=e.sortModel)!=null?r:(s=e.initialState)==null||(s=s.sorting)==null?void 0:s.sortModel)!=null?n:[];return B({},t,{sorting:{sortModel:vj(o,e.disableMultipleColumnsSorting),sortedRows:[]}})},Sse=(t,e)=>{var n;const r=er(t,"useGridSorting");t.current.registerControlState({stateId:"sortModel",propModel:e.sortModel,propOnChange:e.onSortModelChange,stateSelector:ps,changeEvent:"sortModelChange"});const s=p.useCallback((k,E)=>{const b=ps(t),I=b.findIndex(S=>S.field===k);let P=[...b];return I>-1?E?P.splice(I,1,E):P.splice(I,1):P=[...b,E],P},[t]),o=p.useCallback((k,E)=>{var b;const P=ps(t).find(D=>D.field===k.field);if(P){var S;const D=E===void 0?XP((S=k.sortingOrder)!=null?S:e.sortingOrder,P.sort):E;return D==null?void 0:B({},P,{sort:D})}return{field:k.field,sort:E===void 0?XP((b=k.sortingOrder)!=null?b:e.sortingOrder):E}},[t,e.sortingOrder]),i=p.useCallback((k,E)=>E==null||E.sortable===!1?k:(E.sortingOrder||e.sortingOrder).some(I=>!!I)?[...k,"columnMenuSortItem"]:k,[e.sortingOrder]),a=p.useCallback(()=>{t.current.setState(k=>{if(e.sortingMode==="server")return r.debug("Skipping sorting rows as sortingMode = server"),B({},k,{sorting:B({},k.sorting,{sortedRows:_I(Us(t),yr,!1)})});const E=ps(k,t.current.instanceId),b=wee(E,t),I=t.current.applyStrategyProcessor("sorting",{sortRowList:b});return B({},k,{sorting:B({},k.sorting,{sortedRows:I})})}),t.current.publishEvent("sortedRowsSet"),t.current.forceUpdate()},[t,r,e.sortingMode]),l=p.useCallback(k=>{ps(t)!==k&&(r.debug("Setting sort model"),t.current.setState(JP(k,e.disableMultipleColumnsSorting)),t.current.forceUpdate(),t.current.applySorting())},[t,r,e.disableMultipleColumnsSorting]),c=p.useCallback((k,E,b)=>{if(!k.sortable)return;const I=o(k,E);let P;!b||e.disableMultipleColumnsSorting?P=I?[I]:[]:P=s(k.field,I),t.current.setSortModel(P)},[t,s,o,e.disableMultipleColumnsSorting]),u=p.useCallback(()=>ps(t),[t]),h=p.useCallback(()=>CI(t).map(E=>E.model),[t]),f=p.useCallback(()=>xI(t),[t]),g=p.useCallback(k=>t.current.getSortedRowIds()[k],[t]);rt(t,{getSortModel:u,getSortedRows:h,getSortedRowIds:f,getRowIdFromRowIndex:g,setSortModel:l,sortColumn:c,applySorting:a},"public");const w=p.useCallback((k,E)=>{var b;const I=ps(t);return!E.exportOnlyDirtyModels||e.sortModel!=null||((b=e.initialState)==null||(b=b.sorting)==null?void 0:b.sortModel)!=null||I.length>0?B({},k,{sorting:{sortModel:I}}):k},[t,e.sortModel,(n=e.initialState)==null||(n=n.sorting)==null?void 0:n.sortModel]),v=p.useCallback((k,E)=>{var b;const I=(b=E.stateToRestore.sorting)==null?void 0:b.sortModel;return I==null?k:(t.current.setState(JP(I,e.disableMultipleColumnsSorting)),B({},k,{callbacks:[...k.callbacks,t.current.applySorting]}))},[t,e.disableMultipleColumnsSorting]),C=p.useCallback(k=>{const E=Us(t),b=E[yr],I=k.sortRowList?k.sortRowList(b.children.map(P=>E[P])):[...b.children];return b.footerId!=null&&I.push(b.footerId),I},[t]);gn(t,"exportState",w),gn(t,"restoreState",v),Fw(t,Uc,"sorting",C);const x=p.useCallback(({colDef:k},E)=>{const b=E.shiftKey||E.metaKey||E.ctrlKey;c(k,void 0,b)},[c]),A=p.useCallback(({colDef:k},E)=>{KX(E.key)&&!E.ctrlKey&&!E.metaKey&&c(k,void 0,E.shiftKey)},[c]),N=p.useCallback(()=>{const k=ps(t),E=Oh(t);if(k.length>0){const b=k.filter(I=>E[I.field]);b.length<k.length&&t.current.setSortModel(b)}},[t]),M=p.useCallback(k=>{k==="sorting"&&t.current.applySorting()},[t]);gn(t,"columnMenu",i),ze(t,"columnHeaderClick",x),ze(t,"columnHeaderKeyDown",A),ze(t,"rowsSet",t.current.applySorting),ze(t,"columnsChange",N),ze(t,"activeStrategyProcessorChange",M),Jp(()=>{t.current.applySorting()}),Yn(()=>{e.sortModel!==void 0&&t.current.setSortModel(e.sortModel)},[t,e.sortModel])};function Ek(t){const{clientHeight:e,scrollTop:n,offsetHeight:r,offsetTop:s}=t,o=s+r;if(r>e)return s;if(o-e>n)return o-e;if(s<n)return s}const Tse=(t,e)=>{const n=bh(),r=er(t,"useGridScroll"),s=t.current.columnHeadersElementRef,o=t.current.virtualScrollerRef,i=Re(t,il),a=p.useCallback(h=>{const f=Jb(t),g=Qn(t);if(!(h.rowIndex==null)&&f===0||g.length===0)return!1;r.debug(`Scrolling to cell at row ${h.rowIndex}, col: ${h.colIndex} `);let w={};if(h.colIndex!=null){const A=ah(t);let N;if(typeof h.rowIndex<"u"){var v;const M=(v=i[h.rowIndex])==null?void 0:v.id,k=t.current.unstable_getCellColSpanInfo(M,h.colIndex);k&&!k.spannedByColSpan&&(N=k.cellProps.width)}typeof N>"u"&&(N=g[h.colIndex].computedWidth),w.left=Ek({clientHeight:o.current.clientWidth,scrollTop:Math.abs(o.current.scrollLeft),offsetHeight:N,offsetTop:A[h.colIndex]})}if(h.rowIndex!=null){var C,x;const A=Gm(t.current.state),N=cee(t),M=wj(t),k=e.pagination?h.rowIndex-N*M:h.rowIndex,E=A.positions[k+1]?A.positions[k+1]-A.positions[k]:A.currentPageTotalHeight-A.positions[k],b=((C=o.current.querySelector(`.${q["pinnedRows--top"]}`))==null?void 0:C.clientHeight)||0,I=((x=o.current.querySelector(`.${q["pinnedRows--bottom"]}`))==null?void 0:x.clientHeight)||0;w.top=Ek({clientHeight:o.current.clientHeight-b-I,scrollTop:o.current.scrollTop,offsetHeight:E,offsetTop:A.positions[k]})}return w=t.current.unstable_applyPipeProcessors("scrollToIndexes",w,h),typeof w.left!==void 0||typeof w.top!==void 0?(t.current.scroll(w),!0):!1},[r,t,o,e.pagination,i]),l=p.useCallback(h=>{if(o.current&&h.left!=null&&s.current){const f=n.direction==="rtl"?-1:1;s.current.scrollLeft=h.left,o.current.scrollLeft=f*h.left,r.debug(`Scrolling left: ${h.left}`)}o.current&&h.top!=null&&(o.current.scrollTop=h.top,r.debug(`Scrolling top: ${h.top}`)),r.debug("Scrolling, updating container, and viewport")},[o,n.direction,s,r]),c=p.useCallback(()=>o!=null&&o.current?{top:o.current.scrollTop,left:o.current.scrollLeft}:{top:0,left:0},[o]);rt(t,{scroll:l,scrollToIndexes:a,getScrollPosition:c},"public")};function Pse(t,e){Gt(t,"columnHeaderClick",e.onColumnHeaderClick),Gt(t,"columnHeaderDoubleClick",e.onColumnHeaderDoubleClick),Gt(t,"columnHeaderOver",e.onColumnHeaderOver),Gt(t,"columnHeaderOut",e.onColumnHeaderOut),Gt(t,"columnHeaderEnter",e.onColumnHeaderEnter),Gt(t,"columnHeaderLeave",e.onColumnHeaderLeave),Gt(t,"cellClick",e.onCellClick),Gt(t,"cellDoubleClick",e.onCellDoubleClick),Gt(t,"cellKeyDown",e.onCellKeyDown),Gt(t,"preferencePanelClose",e.onPreferencePanelClose),Gt(t,"preferencePanelOpen",e.onPreferencePanelOpen),Gt(t,"menuOpen",e.onMenuOpen),Gt(t,"menuClose",e.onMenuClose),Gt(t,"rowDoubleClick",e.onRowDoubleClick),Gt(t,"rowClick",e.onRowClick),Gt(t,"stateChange",e.onStateChange)}const kse=({content:t,container:e,scrollBarSize:n})=>{const r=t.width>e.width,s=t.height>e.height;let o=!1,i=!1;return(r||s)&&(o=r,i=t.height+(o?n:0)>e.height,i&&(o=t.width+n>e.width)),{hasScrollX:o,hasScrollY:i}};function Rse(t,e){const n=er(t,"useResizeContainer"),r=p.useRef(!1),s=p.useRef(null),o=p.useRef(null),i=Re(t,Gm),a=Re(t,Fh),l=Math.floor(e.rowHeight*a),c=FI(t,e.columnHeaderHeight),u=p.useCallback(()=>{var E;const b=(E=t.current.rootElementRef)==null?void 0:E.current,I=vI(t),P=tj(t);if(!s.current)return;let S;if(e.scrollbarSize!=null)S=e.scrollbarSize;else if(!I||!b)S=0;else{const $=ib(b).createElement("div");$.style.width="99px",$.style.height="99px",$.style.position="absolute",$.style.overflow="scroll",$.className="scrollDiv",b.appendChild($),S=$.offsetWidth-$.clientWidth,b.removeChild($)}let D,T,j;if(e.autoHeight)j=!1,T=Math.round(I)>Math.round(s.current.width),D={width:s.current.width,height:i.currentPageTotalHeight+(T?S:0)};else{D={width:s.current.width,height:Math.max(s.current.height-c,0)};const F=kse({content:{width:Math.round(I),height:i.currentPageTotalHeight},container:{width:Math.round(D.width),height:D.height-P.top-P.bottom},scrollBarSize:S});j=F.hasScrollY,T=F.hasScrollX}const R={width:D.width-(j?S:0),height:D.height-(T?S:0)},V={viewportOuterSize:D,viewportInnerSize:R,hasScrollX:T,hasScrollY:j,scrollBarSize:S},U=o.current;o.current=V,(V.viewportInnerSize.width!==U?.viewportInnerSize.width||V.viewportInnerSize.height!==U?.viewportInnerSize.height)&&t.current.publishEvent("viewportInnerSizeChange",V.viewportInnerSize)},[t,e.scrollbarSize,e.autoHeight,i.currentPageTotalHeight,c]),[h,f]=p.useState(),g=p.useMemo(()=>S2(f,60),[]),y=p.useRef();Yn(()=>{h&&(u(),t.current.publishEvent("debouncedResize",s.current))},[t,h,u]);const w=p.useCallback(()=>{t.current.computeSizeAndPublishResizeEvent()},[t]),v=p.useCallback(()=>o.current,[]),C=p.useCallback(()=>{const E=t.current.getRootDimensions();if(!E)return 0;const b=Ow(t,{pagination:e.pagination,paginationMode:e.paginationMode});if(e.getRowHeight){const P=t.current.getRenderContext(),S=P.lastRowIndex-P.firstRowIndex;return Math.min(S-1,b.rows.length)}const I=Math.floor(E.viewportInnerSize.height/l);return Math.min(I,b.rows.length)},[t,e.pagination,e.paginationMode,e.getRowHeight,l]),x=p.useCallback(()=>{var E,b,I;const P=(E=t.current.mainElementRef)==null?void 0:E.current;if(!P)return;const D=QB(P).getComputedStyle(P),T=parseFloat(D.height)||0,j=parseFloat(D.width)||0,R=T!==((b=y.current)==null?void 0:b.height),V=j!==((I=y.current)==null?void 0:I.width);if(!y.current||R||V){const U={width:j,height:T};t.current.publishEvent("resize",U),y.current=U}},[t]),A={resize:w,getRootDimensions:v},N={getViewportPageSize:C,updateGridDimensionsRef:u,computeSizeAndPublishResizeEvent:x};rt(t,A,"public"),rt(t,N,"private");const M=p.useRef(!0),k=p.useCallback(E=>{s.current=E;const b=/jsdom/.test(window.navigator.userAgent);if(E.height===0&&!r.current&&!e.autoHeight&&!b&&(n.error(["The parent DOM element of the data grid has an empty height.","Please make sure that this element has an intrinsic height.","The grid displays with a height of 0px.","","More details: https://mui.com/r/x-data-grid-no-dimensions."].join(`
`)),r.current=!0),E.width===0&&!r.current&&!b&&(n.error(["The parent DOM element of the data grid has an empty width.","Please make sure that this element has an intrinsic width.","The grid displays with a width of 0px.","","More details: https://mui.com/r/x-data-grid-no-dimensions."].join(`
`)),r.current=!0),M.current){f(E),M.current=!1;return}g(E)},[e.autoHeight,g,n]);Yn(()=>u(),[u]),Gt(t,"sortedRowsSet",u),Gt(t,"paginationModelChange",u),Gt(t,"columnsChange",u),ze(t,"resize",k),Gt(t,"debouncedResize",e.onResize)}const Nse=["style"],Dse=["style"];function ch(t,e,n=0,r=e.length){if(e.length<=0)return-1;if(n>=r)return n;const s=n+Math.floor((r-n)/2),o=e[s];return t<=o?ch(t,e,n,s):ch(t,e,s+1,r)}function Mse(t,e,n){let r=1;for(;n<e.length&&Math.abs(e[n])<t;)n+=r,r*=2;return ch(t,e,Math.floor(n/2),Math.min(n,e.length))}const sa=({firstIndex:t,lastIndex:e,buffer:n,minFirstIndex:r,maxLastIndex:s})=>[lh(t-n,r,s),lh(e+n,r,s)],Gj=(t,e)=>t===e?!0:t.firstRowIndex===e.firstRowIndex&&t.lastRowIndex===e.lastRowIndex&&t.firstColumnIndex===e.firstColumnIndex&&t.lastColumnIndex===e.lastColumnIndex,Ose={maxSize:3},Lse=t=>{const e=ol(),n=$e(),r=Re(e,Qn),s=Re(e,_ee),o=Re(e,_j),{ref:i,onRenderZonePositioning:a,renderZoneMinColumnIndex:l=0,renderZoneMaxColumnIndex:c=r.length,getRowProps:u}=t,h=bh(),f=Re(e,ah),g=Re(e,vI),y=Re(e,Kr),w=Re(e,Pw),v=Re(e,Gm),C=Re(e,Mw),x=Zc(e,n),A=p.useRef(null),N=p.useRef(null),M=Kc(i,N),[k,E]=p.useState(null),b=p.useRef(k),I=p.useRef({top:0,left:0}),[P,S]=p.useState({width:null,height:null}),D=p.useRef(g),[T,j]=p.useState(null),R=p.useRef(Object.create(null)),V=p.useRef(),U=p.useRef(),F=p.useRef(qb((K,me,Q,ee,de,ye)=>{let pe;const _e=K.slice(me,Q);return ye>-1&&(me>ye&&ye>=ee||Q<ye&&ye<de)&&(pe=ye),{focusedCellColumnIndexNotInRange:pe,renderedColumns:_e}},Ose)),$=p.useMemo(()=>y!==null?r.findIndex(K=>K.field===y.field):-1,[y,r]),W=p.useCallback(()=>{if(!s)return{firstRowIndex:0,lastRowIndex:x.rows.length,firstColumnIndex:0,lastColumnIndex:r.length};const{top:K,left:me}=I.current,Q=Math.min(Ik(e,x,v,K),v.positions.length-1),ee=n.autoHeight?Q+x.rows.length:Ik(e,x,v,K+P.height);let de=0,ye=f.length;if(o){let pe=!1;const[_e,qe]=sa({firstIndex:Q,lastIndex:ee,minFirstIndex:0,maxLastIndex:x.rows.length,buffer:n.rowBuffer});for(let Ie=_e;Ie<qe&&!pe;Ie+=1){const be=x.rows[Ie];pe=e.current.rowHasAutoHeight(be.id)}pe||(de=ch(Math.abs(me),f),ye=ch(Math.abs(me)+P.width,f))}return{firstRowIndex:Q,lastRowIndex:ee,firstColumnIndex:de,lastColumnIndex:ye}},[s,o,v,n.autoHeight,n.rowBuffer,x,f,r.length,e,P]);Yn(()=>{s?(N.current.scrollLeft=0,N.current.scrollTop=0):A.current.style.transform="translate3d(0px, 0px, 0px)"},[s]),Yn(()=>{S({width:N.current.clientWidth,height:N.current.clientHeight})},[v.currentPageTotalHeight]);const Z=p.useCallback(()=>{N.current&&S({width:N.current.clientWidth,height:N.current.clientHeight})},[]);ze(e,"debouncedResize",Z);const Y=p.useCallback(K=>{const[me,Q]=sa({firstIndex:K.firstRowIndex,lastIndex:K.lastRowIndex,minFirstIndex:0,maxLastIndex:x.rows.length,buffer:n.rowBuffer}),[ee]=sa({firstIndex:K.firstColumnIndex,lastIndex:K.lastColumnIndex,minFirstIndex:l,maxLastIndex:c,buffer:n.columnBuffer}),de=_C({firstColumnToRender:ee,apiRef:e,firstRowToRender:me,lastRowToRender:Q,visibleRows:x.rows}),ye=h.direction==="ltr"?1:-1,pe=Gm(e.current.state).positions[me],_e=ye*ah(e)[de];A.current.style.transform=`translate3d(${_e}px, ${pe}px, 0px)`,typeof a=="function"&&a({top:pe,left:_e})},[e,x.rows,a,l,c,n.columnBuffer,n.rowBuffer,h.direction]),le=p.useCallback(()=>b.current,[]),fe=p.useCallback(K=>{if(b.current&&Gj(K,b.current)){Y(K);return}E(K),Y(K);const[me,Q]=sa({firstIndex:K.firstRowIndex,lastIndex:K.lastRowIndex,minFirstIndex:0,maxLastIndex:x.rows.length,buffer:n.rowBuffer});e.current.publishEvent("renderedRowsIntervalChange",{firstRowToRender:me,lastRowToRender:Q}),b.current=K},[e,E,b,x.rows.length,n.rowBuffer,Y]);Yn(()=>{if(P.width==null)return;const K=W();fe(K);const{top:me,left:Q}=I.current,ee={top:me,left:Q,renderContext:K};e.current.publishEvent("scrollPositionChange",ee)},[e,W,P.width,fe]);const we=Ws(K=>{const{scrollTop:me,scrollLeft:Q}=K.currentTarget;if(I.current.top=me,I.current.left=Q,!b.current||me<0||h.direction==="ltr"&&Q<0||h.direction==="rtl"&&Q>0)return;const ee=s?W():b.current,de=Math.abs(ee.firstRowIndex-b.current.firstRowIndex),ye=Math.abs(ee.lastRowIndex-b.current.lastRowIndex),pe=Math.abs(ee.firstColumnIndex-b.current.firstColumnIndex),_e=Math.abs(ee.lastColumnIndex-b.current.lastColumnIndex),qe=de>=n.rowThreshold||ye>=n.rowThreshold||pe>=n.columnThreshold||_e>=n.columnThreshold||D.current!==g;e.current.publishEvent("scrollPositionChange",{top:me,left:Q,renderContext:qe?ee:b.current},K),qe&&(T2.flushSync(()=>{fe(ee)}),D.current=g)}),Me=Ws(K=>{e.current.publishEvent("virtualScrollerWheel",{},K)}),Ee=Ws(K=>{e.current.publishEvent("virtualScrollerTouchMove",{},K)}),X=p.useMemo(()=>y!==null?x.rows.findIndex(K=>K.id===y.id):-1,[y,x.rows]);ze(e,"rowMouseOver",(K,me)=>{var Q;me.currentTarget.contains(me.relatedTarget)||j((Q=K.id)!=null?Q:null)}),ze(e,"rowMouseOut",(K,me)=>{me.currentTarget.contains(me.relatedTarget)||j(null)});const ue=(K={renderContext:k})=>{var me;const{onRowRender:Q,renderContext:ee,minFirstColumn:de=l,maxLastColumn:ye=c,availableSpace:pe=P.width,rowIndexOffset:_e=0,position:qe="center"}=K;if(!ee||pe==null)return null;const Ie=s?n.rowBuffer:0,be=s?n.columnBuffer:0,[Se,De]=sa({firstIndex:ee.firstRowIndex,lastIndex:ee.lastRowIndex,minFirstIndex:0,maxLastIndex:x.rows.length,buffer:Ie}),Ye=[];if(K.rows)K.rows.forEach(vn=>{Ye.push(vn),e.current.calculateColSpan({rowId:vn.id,minFirstColumn:de,maxLastColumn:ye,columns:r})});else{if(!x.range)return null;for(let vn=Se;vn<De;vn+=1){const yt=x.rows[vn];Ye.push(yt),e.current.calculateColSpan({rowId:yt.id,minFirstColumn:de,maxLastColumn:ye,columns:r})}}let gt=!1;if(X>-1){const vn=x.rows[X];(Se>X||De<X)&&(gt=!0,X>Se?Ye.push(vn):Ye.unshift(vn),e.current.calculateColSpan({rowId:vn.id,minFirstColumn:de,maxLastColumn:ye,columns:r}))}const[un,Tt]=sa({firstIndex:ee.firstColumnIndex,lastIndex:ee.lastColumnIndex,minFirstIndex:de,maxLastIndex:ye,buffer:be}),_s=_C({firstColumnToRender:un,apiRef:e,firstRowToRender:Se,lastRowToRender:De,visibleRows:x.rows});let ll=!1;(_s>$||Tt<$)&&(ll=!0);const{focusedCellColumnIndexNotInRange:_n,renderedColumns:nn}=F.current(r,_s,Tt,de,ye,ll?$:-1),As=((me=n.slotProps)==null?void 0:me.row)||{},{style:Ss}=As,Ts=He(As,Nse);(V.current!==u||U.current!==Ss)&&(R.current=Object.create(null));const $o=[];let Hh=!1;for(let vn=0;vn<Ye.length;vn+=1){var Oi;const{id:yt,model:$h}=Ye[vn],cl=gt&&y.id===yt,ul=gt?Se+vn===x.rows.length:Se+vn===x.rows.length-1,E0=e.current.rowHasAutoHeight(yt)?"auto":e.current.unstable_getRowHeight(yt);let zh;C[yt]==null?zh=!1:zh=e.current.isRowSelectable(yt),Q&&Q(yt);const zo=y!==null&&y.id===yt?y.field:null,ag=_n!==void 0&&r[_n],I0=ag&&zo?[ag,...nn]:nn;let dl=null;w!==null&&w.id===yt&&(dl=e.current.getCellParams(yt,w.field).cellMode==="view"?w.field:null);const Gh=typeof u=="function"&&u(yt,$h)||{},{style:lg}=Gh,Wh=He(Gh,Dse);if(!R.current[yt]){const cg=B({},lg,Ss);R.current[yt]=cg}let Go=_e+((x==null||(Oi=x.range)==null?void 0:Oi.firstRowIndex)||0)+Se+vn;gt&&y?.id===yt?(Go=X,Hh=!0):Hh&&(Go-=1),$o.push(d.jsx(n.slots.row,B({row:$h,rowId:yt,focusedCellColumnIndexNotInRange:_n,isNotVisible:cl,rowHeight:E0,focusedCell:zo,tabbableCell:dl,renderedColumns:I0,visibleColumns:r,firstColumnToRender:_s,lastColumnToRender:Tt,selected:zh,index:Go,containerWidth:pe,isLastVisible:ul,position:qe},Wh,Ts,{hovered:T===yt,style:R.current[yt]}),yt))}return V.current=u,U.current=Ss,$o},re=P.width&&g>=P.width,ie=p.useMemo(()=>{const K=Math.max(v.currentPageTotalHeight,1);let me=!1;N!=null&&N.current&&K<=N?.current.clientHeight&&(me=!0);const Q={width:re?g:"auto",height:K,minHeight:me?"100%":"auto"};return n.autoHeight&&x.rows.length===0&&(Q.height=nj(e,n.rowHeight)),Q},[e,N,g,v.currentPageTotalHeight,re,n.autoHeight,n.rowHeight,x.rows.length]);p.useEffect(()=>{e.current.publishEvent("virtualScrollerContentSizeChange")},[e,ie]);const Ce=p.useMemo(()=>{const K={};return re||(K.overflowX="hidden"),n.autoHeight&&(K.overflowY="hidden"),K},[re,n.autoHeight]);return e.current.register("private",{getRenderContext:le}),{renderContext:k,updateRenderZonePosition:Y,getRows:ue,getRootProps:(K={})=>B({ref:M,onScroll:we,onWheel:Me,onTouchMove:Ee},K,{style:K.style?B({},K.style,Ce):Ce,role:"presentation"}),getContentProps:({style:K}={})=>({style:K?B({},K,ie):ie,role:"presentation"}),getRenderZoneProps:()=>({ref:A,role:"rowgroup"})}};function Ik(t,e,n,r){var s,o;const i=t.current.getLastMeasuredRowIndex();let a=i===1/0;(s=e.range)!=null&&s.lastRowIndex&&!a&&(a=i>=e.range.lastRowIndex);const l=lh(i-(((o=e.range)==null?void 0:o.firstRowIndex)||0),0,n.positions.length);return a||n.positions[l]>=r?ch(r,n.positions):Mse(r,n.positions,l)}const Fse=t=>{const{classes:e,headerAlign:n,isDragging:r,showColumnBorder:s,groupId:o}=t;return ft({root:["columnHeader",n==="left"&&"columnHeader--alignLeft",n==="center"&&"columnHeader--alignCenter",n==="right"&&"columnHeader--alignRight",r&&"columnHeader--moving",s&&"columnHeader--showColumnBorder",s&&"columnHeader--withRightBorder","withBorderColor",o===null?"columnHeader--emptyGroup":"columnHeader--filledGroup"],draggableContainer:["columnHeaderDraggableContainer"],titleContainer:["columnHeaderTitleContainer","withBorderColor"],titleContainerContent:["columnHeaderTitleContainerContent"]},pt,e)};function jse(t){var e;const{groupId:n,width:r,depth:s,maxDepth:o,fields:i,height:a,colIndex:l,hasFocus:c,tabIndex:u,isLastColumn:h}=t,f=$e(),g=p.useRef(null),y=mt(),w=Re(y,zF),v=n?w[n]:{},{headerName:C=n??"",description:x="",headerAlign:A=void 0}=v;let N;const M=n&&((e=w[n])==null?void 0:e.renderHeaderGroup),k=p.useMemo(()=>({groupId:n,headerName:C,description:x,depth:s,maxDepth:o,fields:i,colIndex:l,isLastColumn:h}),[n,C,x,s,o,i,l,h]);n&&M&&(N=M(k));const E=f.showColumnVerticalBorder,b=B({},t,{classes:f.classes,showColumnBorder:E,headerAlign:A,depth:s,isDragging:!1}),I=C??n,P=En(),S=n===null?`empty-group-cell-${P}`:n,D=Fse(b);p.useLayoutEffect(()=>{if(c){const U=g.current.querySelector('[tabindex="0"]')||g.current;U?.focus()}},[y,c]);const T=p.useCallback(V=>U=>{Yp(U)||y.current.publishEvent(V,k,U)},[y,k]),j=p.useMemo(()=>({onKeyDown:T("columnGroupHeaderKeyDown"),onFocus:T("columnGroupHeaderFocus"),onBlur:T("columnGroupHeaderBlur")}),[T]),R=typeof v.headerClassName=="function"?v.headerClassName(k):v.headerClassName;return d.jsx(hj,B({ref:g,classes:D,columnMenuOpen:!1,colIndex:l,height:a,isResizing:!1,sortDirection:null,hasFocus:!1,tabIndex:u,isDraggable:!1,headerComponent:N,headerClassName:R,description:x,elementId:S,width:r,columnMenuIconButton:null,columnTitleIconButtons:null,resizable:!1,label:I,"aria-colspan":i.length,"data-fields":`|-${i.join("-|-")}-|`},j))}const _k=bn("div",{name:"MuiDataGrid",slot:"ColumnHeaderRow",overridesResolver:(t,e)=>e.columnHeaderRow})(()=>({display:"flex"}));function Vse(t){return!!t.target}const Bse=t=>{const{innerRef:e,minColumnIndex:n=0,visibleColumns:r,sortColumnLookup:s,filterColumnLookup:o,columnPositions:i,columnHeaderTabIndexState:a,columnGroupHeaderTabIndexState:l,columnHeaderFocus:c,columnGroupHeaderFocus:u,densityFactor:h,headerGroupingMaxDepth:f,columnMenuState:g,columnVisibility:y,columnGroupsHeaderStructure:w,hasOtherElementInTabSequence:v}=t,C=bh(),[x,A]=p.useState(""),[N,M]=p.useState(""),k=ol(),E=Re(k,_j),b=$e(),I=p.useRef(null),P=Kc(e,I),[S,D]=p.useState(null),T=p.useRef(S),j=p.useRef(0),R=Zc(k,b),V=FI(k,b.columnHeaderHeight),U=Math.floor(b.columnHeaderHeight*h),F=p.useCallback(re=>{S&&re&&Gj(S,re)||D(re)},[S]);p.useEffect(()=>{var re;(re=k.current.columnHeadersContainerElementRef)!=null&&re.current&&(k.current.columnHeadersContainerElementRef.current.scrollLeft=0)},[k]);const $=p.useRef(qb(Nre,{equalityCheck:(re,ie)=>["firstColumnIndex","minColumnIndex","columnBuffer"].every(Ce=>re[Ce]===ie[Ce])})),W=p.useCallback(re=>{const[ie,Ce]=sa({firstIndex:re.firstRowIndex,lastIndex:re.lastRowIndex,minFirstIndex:0,maxLastIndex:R.rows.length,buffer:b.rowBuffer}),K=$.current({firstColumnIndex:re.firstColumnIndex,minColumnIndex:n,columnBuffer:b.columnBuffer,firstRowToRender:ie,lastRowToRender:Ce,apiRef:k,visibleRows:R.rows}),me=C.direction==="ltr"?1:-1,Q=K>0?j.current-me*i[K]:j.current;I.current.style.transform=`translate3d(${-Q}px, 0px, 0px)`},[i,n,b.columnBuffer,k,R.rows,b.rowBuffer,C.direction]);p.useLayoutEffect(()=>{S&&W(S)},[S,W]);const Z=p.useCallback(({left:re,renderContext:ie=null},Ce)=>{var K,me;if(!I.current||j.current===re&&((K=T.current)==null?void 0:K.firstColumnIndex)===ie?.firstColumnIndex&&((me=T.current)==null?void 0:me.lastColumnIndex)===ie?.lastColumnIndex)return;j.current=re;let Q=!1;ie!==T.current||!T.current?(Vse(Ce)?(T2.flushSync(()=>{F(ie)}),Q=!0):F(ie),T.current=ie):Q=!0,ie&&Q&&W(ie)},[W,F]),Y=p.useCallback(re=>M(re.field),[]),le=p.useCallback(()=>M(""),[]),fe=p.useCallback(re=>A(re.field),[]),we=p.useCallback(()=>A(""),[]);ze(k,"columnResizeStart",Y),ze(k,"columnResizeStop",le),ze(k,"columnHeaderDragStart",fe),ze(k,"columnHeaderDragEnd",we),ze(k,"scrollPositionChange",Z);const Me=re=>{const{renderContext:ie=S,minFirstColumn:Ce=n,maxLastColumn:K=r.length}=re||{};if(!ie)return null;const[me,Q]=sa({firstIndex:ie.firstRowIndex,lastIndex:ie.lastRowIndex,minFirstIndex:0,maxLastIndex:R.rows.length,buffer:b.rowBuffer}),ee=E?$.current({firstColumnIndex:ie.firstColumnIndex,minColumnIndex:Ce,columnBuffer:b.columnBuffer,apiRef:k,firstRowToRender:me,lastRowToRender:Q,visibleRows:R.rows}):0,de=E?Math.min(ie.lastColumnIndex+b.columnBuffer,K):K;return{renderedColumns:r.slice(ee,de),firstColumnToRender:ee,lastColumnToRender:de,minFirstColumn:Ce,maxLastColumn:K}},Ee=(re,ie={})=>{const Ce=Me(re);if(Ce==null)return null;const{renderedColumns:K,firstColumnToRender:me}=Ce,Q=[];for(let ee=0;ee<K.length;ee+=1){const de=K[ee],ye=me+ee,pe=ye===0,_e=a!==null&&a.field===de.field||pe&&!v?0:-1,qe=c!==null&&c.field===de.field,Ie=g.open&&g.field===de.field;Q.push(d.jsx(qZ,B({},s[de.field],{columnMenuOpen:Ie,filterItemsCounter:o[de.field]&&o[de.field].length,headerHeight:U,isDragging:de.field===x,colDef:de,colIndex:ye,isResizing:N===de.field,hasFocus:qe,tabIndex:_e},ie),de.field))}return d.jsx(_k,{role:"row","aria-rowindex":f+1,ownerState:b,children:Q})},X=re=>{if(f===0)return null;const ie=Me(re);if(ie==null||ie.renderedColumns.length===0)return null;const{firstColumnToRender:Ce,lastColumnToRender:K}=ie,me=[],Q=[];for(let ye=0;ye<f;ye+=1){var ee,de;const pe=w[ye],_e=r[Ce].field,qe=(ee=k.current.unstable_getColumnGroupPath(_e)[ye])!=null?ee:null,Ie=pe.findIndex(({groupId:_n,columnFields:nn})=>_n===qe&&nn.includes(_e)),be=r[K-1].field,Se=(de=k.current.unstable_getColumnGroupPath(be)[ye])!=null?de:null,De=pe.findIndex(({groupId:_n,columnFields:nn})=>_n===Se&&nn.includes(be)),Ye=pe.slice(Ie,De+1).map(_n=>B({},_n,{columnFields:_n.columnFields.filter(nn=>y[nn]!==!1)})).filter(_n=>_n.columnFields.length>0),gt=Ye[0].columnFields.indexOf(_e),Tt=Ye[0].columnFields.slice(0,gt).reduce((_n,nn)=>{var As;const Ss=k.current.getColumn(nn);return _n+((As=Ss.computedWidth)!=null?As:0)},0);let _s=Ce;const ll=Ye.map(({groupId:_n,columnFields:nn})=>{const As=u!==null&&u.depth===ye&&nn.includes(u.field),Ss=l!==null&&l.depth===ye&&nn.includes(l.field)?0:-1,Ts={groupId:_n,width:nn.reduce((Uh,$o)=>Uh+k.current.getColumn($o).computedWidth,0),fields:nn,colIndex:_s,hasFocus:As,tabIndex:Ss};return _s+=nn.length,Ts});Q.push({leftOverflow:Tt,elements:ll})}return Q.forEach((ye,pe)=>{me.push(d.jsx(_k,{style:{height:`${U}px`,transform:`translateX(-${ye.leftOverflow}px)`},role:"row","aria-rowindex":pe+1,ownerState:b,children:ye.elements.map(({groupId:_e,width:qe,fields:Ie,colIndex:be,hasFocus:Se,tabIndex:De},Ye)=>d.jsx(jse,{groupId:_e,width:qe,fields:Ie,colIndex:be,depth:pe,isLastColumn:be===r.length-Ie.length,maxDepth:Q.length,height:U,hasFocus:Se,tabIndex:De},Ye))},pe))}),me},ue={minHeight:V,maxHeight:V,lineHeight:`${U}px`};return{renderContext:S,getColumnHeaders:Ee,getColumnsToRender:Me,getColumnGroupHeaders:X,isDragging:!!x,getRootProps:(re={})=>B({style:ue},re),getInnerProps:()=>({ref:P,role:"rowgroup"}),headerHeight:U}},Use=["className"],Hse=t=>{const{classes:e}=t;return ft({root:["columnHeaders","withBorderColor"]},pt,e)},$se=Zn("div",{name:"MuiDataGrid",slot:"ColumnHeaders",overridesResolver:(t,e)=>e.columnHeaders})({position:"relative",overflow:"hidden",display:"flex",alignItems:"center",boxSizing:"border-box",borderBottom:"1px solid",borderTopLeftRadius:"var(--unstable_DataGrid-radius)",borderTopRightRadius:"var(--unstable_DataGrid-radius)"}),zse=p.forwardRef(function(e,n){const{className:r}=e,s=He(e,Use),o=$e(),i=Hse(o);return d.jsx($se,B({ref:n,className:At(r,i.root),ownerState:o},s,{role:"presentation"}))}),Gse=["isDragging","className"],Wse=t=>{const{isDragging:e,hasScrollX:n,classes:r}=t;return ft({root:["columnHeadersInner",e&&"columnHeaderDropZone",n&&"columnHeadersInner--scrollable"]},pt,r)},Kse=Zn("div",{name:"MuiDataGrid",slot:"columnHeadersInner",overridesResolver:(t,e)=>[{[`&.${q.columnHeaderDropZone}`]:e.columnHeaderDropZone},e.columnHeadersInner]})(()=>({display:"flex",alignItems:"flex-start",flexDirection:"column",[`&.${q.columnHeaderDropZone} .${q.columnHeaderDraggableContainer}`]:{cursor:"move"},[`&.${q["columnHeadersInner--scrollable"]} .${q.columnHeader}:last-child`]:{borderRight:"none"}})),qse=p.forwardRef(function(e,n){var r,s;const{isDragging:o,className:i}=e,a=He(e,Gse),l=mt(),c=$e(),u=B({},c,{isDragging:o,hasScrollX:(r=(s=l.current.getRootDimensions())==null?void 0:s.hasScrollX)!=null?r:!1}),h=Wse(u);return d.jsx(Kse,B({ref:n,className:At(i,h.root),ownerState:u},a))}),Qse=["innerRef","className","visibleColumns","sortColumnLookup","filterColumnLookup","columnPositions","columnHeaderTabIndexState","columnGroupHeaderTabIndexState","columnHeaderFocus","columnGroupHeaderFocus","densityFactor","headerGroupingMaxDepth","columnMenuState","columnVisibility","columnGroupsHeaderStructure","hasOtherElementInTabSequence"],Yse=p.forwardRef(function(e,n){const{innerRef:r,visibleColumns:s,sortColumnLookup:o,filterColumnLookup:i,columnPositions:a,columnHeaderTabIndexState:l,columnGroupHeaderTabIndexState:c,columnHeaderFocus:u,columnGroupHeaderFocus:h,densityFactor:f,headerGroupingMaxDepth:g,columnMenuState:y,columnVisibility:w,columnGroupsHeaderStructure:v,hasOtherElementInTabSequence:C}=e,x=He(e,Qse),{isDragging:A,getRootProps:N,getInnerProps:M,getColumnHeaders:k,getColumnGroupHeaders:E}=Bse({innerRef:r,visibleColumns:s,sortColumnLookup:o,filterColumnLookup:i,columnPositions:a,columnHeaderTabIndexState:l,columnGroupHeaderTabIndexState:c,columnHeaderFocus:u,columnGroupHeaderFocus:h,densityFactor:f,headerGroupingMaxDepth:g,columnMenuState:y,columnVisibility:w,columnGroupsHeaderStructure:v,hasOtherElementInTabSequence:C});return d.jsx(zse,B({ref:n},N(x),{children:d.jsxs(qse,B({isDragging:A},M(),{children:[E(),k()]}))}))}),Jse=t0(Yse),Xse=p.forwardRef(function(e,n){const s=mt().current.getLocaleText("noResultsOverlayLabel");return d.jsx(SI,B({ref:n},e,{children:s}))}),Zse=["sortingOrder"],eoe=p.memo(function(e){const{sortingOrder:n}=e,r=He(e,Zse),s=$e(),[o]=n,i=o==="asc"?s.slots.columnSortedAscendingIcon:s.slots.columnSortedDescendingIcon;return i?d.jsx(i,B({},r)):null}),toe=["native"];function noe(t){let{native:e}=t,n=He(t,toe);return e?d.jsx("option",B({},n)):d.jsx(Bn,B({},n))}const roe={BooleanCellTrueIcon:Wee,BooleanCellFalseIcon:kv,ColumnMenuIcon:Hee,OpenFilterButtonIcon:Oee,FilterPanelDeleteIcon:kv,ColumnFilteredIcon:rk,ColumnSelectorIcon:Fee,ColumnUnsortedIcon:eoe,ColumnSortedAscendingIcon:ZP,ColumnSortedDescendingIcon:ek,ColumnResizeIcon:jee,DensityCompactIcon:Vee,DensityStandardIcon:Bee,DensityComfortableIcon:Uee,ExportIcon:Gee,MoreActionsIcon:Kee,TreeDataCollapseIcon:nk,TreeDataExpandIcon:tk,GroupingCriteriaCollapseIcon:nk,GroupingCriteriaExpandIcon:tk,DetailPanelExpandIcon:sk,DetailPanelCollapseIcon:$ee,RowReorderIcon:ok,QuickFilterIcon:Lee,QuickFilterClearIcon:kv,ColumnMenuHideIcon:qee,ColumnMenuSortAscendingIcon:ZP,ColumnMenuSortDescendingIcon:ek,ColumnMenuFilterIcon:rk,ColumnMenuManageColumnsIcon:Qee,ColumnMenuClearIcon:Yee,LoadIcon:zee,FilterPanelAddIcon:sk,FilterPanelRemoveAllIcon:Jee,ColumnReorderIcon:ok},soe=B({},roe,{BaseCheckbox:e5,BaseTextField:ZB,BaseFormControl:R2,BaseSelect:k2,BaseSwitch:XB,BaseButton:Tn,BaseIconButton:Bd,BaseInputAdornment:JB,BaseTooltip:YB,BasePopper:d1,BaseInputLabel:P2,BaseSelectOption:noe,BaseChip:Ic}),ooe=B({},soe,{Cell:wC,SkeletonCell:mZ,ColumnHeaderFilterIconButton:See,ColumnMenu:hte,ColumnHeaders:Jse,Footer:bne,FooterRowCount:Tne,Toolbar:null,PreferencesPanel:Vte,LoadingOverlay:xne,NoResultsOverlay:Xse,NoRowsOverlay:Cne,Pagination:Ine,FilterPanel:ine,ColumnsPanel:Dte,Panel:jte,Row:qne}),Wj=t=>{if(t!==void 0)return Object.keys(t).reduce((e,n)=>B({},e,{[`${n.charAt(0).toLowerCase()}${n.slice(1)}`]:t[n]}),{})};function ioe({defaultSlots:t,slots:e,components:n}){const r=e??(n?Wj(n):null);if(!r||Object.keys(r).length===0)return t;const s=B({},t);return Object.keys(r).forEach(o=>{const i=o;r[i]!==void 0&&(s[i]=r[i])}),s}const aoe=["components","componentsProps"];function loe(t){var e;const n=Object.keys(t);if(!n.some(o=>o.startsWith("aria-")||o.startsWith("data-")))return t;const r={},s=(e=t.forwardedProps)!=null?e:{};for(let o=0;o<n.length;o+=1){const i=n[o];i.startsWith("aria-")||i.startsWith("data-")?s[i]=t[i]:r[i]=t[i]}return r.forwardedProps=s,r}function coe(t){return p.useMemo(()=>{const{components:e,componentsProps:n}=t,r=He(t,aoe);return[e,n,loe(r)]},[t])}const uoe={disableMultipleColumnsFiltering:!0,disableMultipleColumnsSorting:!0,disableMultipleRowSelection:!0,throttleRowsMs:void 0,hideFooterRowCount:!1,pagination:!0,checkboxSelectionVisibleOnly:!1,disableColumnReorder:!0,disableColumnResize:!0,keepColumnPositionIfDraggedOutside:!1,signature:"DataGrid"},r0={autoHeight:!1,autoPageSize:!1,checkboxSelection:!1,checkboxSelectionVisibleOnly:!1,columnBuffer:3,rowBuffer:3,columnThreshold:3,rowThreshold:3,rowSelection:!0,density:"standard",disableColumnFilter:!1,disableColumnMenu:!1,disableColumnSelector:!1,disableDensitySelector:!1,disableEval:!1,disableMultipleColumnsFiltering:!1,disableMultipleRowSelection:!1,disableMultipleColumnsSorting:!1,disableRowSelectionOnClick:!1,disableVirtualization:!1,editMode:Bo.Cell,filterMode:"client",filterDebounceMs:150,columnHeaderHeight:56,hideFooter:!1,hideFooterPagination:!1,hideFooterRowCount:!1,hideFooterSelectedRowCount:!1,ignoreDiacritics:!1,logger:console,logLevel:"error",pagination:!1,paginationMode:"client",rowHeight:52,pageSizeOptions:[25,50,100],rowSpacingType:"margin",showCellVerticalBorder:!1,showColumnVerticalBorder:!1,sortingOrder:["asc","desc",null],sortingMode:"client",throttleRowsMs:0,disableColumnReorder:!1,disableColumnResize:!1,keepNonExistentRowsSelected:!1,keepColumnPositionIfDraggedOutside:!1,unstable_ignoreValueFormatterDuringExport:!1,clipboardCopyCellDelimiter:"	",rowPositionsDebounceMs:166},doe=Wj(ooe),hoe=t=>{const[e,n,r]=coe(t5({props:t,name:"MuiDataGrid"})),s=p.useMemo(()=>B({},Ese,r.localeText),[r.localeText]),o=p.useMemo(()=>ioe({defaultSlots:doe,slots:r.slots,components:e}),[e,r.slots]);return p.useMemo(()=>{var i;return B({},r0,r,{localeText:s,slots:o,slotProps:(i=r.slotProps)!=null?i:n},uoe)},[r,s,o,n])},foe=t=>B({},t,{rowsMeta:{currentPageTotalHeight:0,positions:[]}}),Ak=(t,e,n)=>typeof t=="number"&&t>0?t:e,moe=(t,e)=>{const{getRowHeight:n,getRowSpacing:r,getEstimatedRowHeight:s}=e,o=p.useRef(Object.create(null)),i=p.useRef(-1),a=p.useRef(!1),l=Re(t,Fh),c=Re(t,Ln),u=Re(t,PI),h=Re(t,ps),f=Zc(t,e),g=Re(t,Lh),y=Ak(e.rowHeight,r0.rowHeight),w=Math.floor(y*l),v=p.useCallback(()=>{var D,T;a.current=!1;const j=U=>{o.current[U.id]||(o.current[U.id]={sizes:{baseCenter:w},isResized:!1,autoHeight:!1,needsFirstMeasurement:!0});const{isResized:F,needsFirstMeasurement:$,sizes:W}=o.current[U.id];let Z=typeof w=="number"&&w>0?w:52;const Y=W.baseCenter;if(F)Z=Y;else if(n){const Ee=n(B({},U,{densityFactor:l}));if(Ee==="auto"){if($){const X=s?s(B({},U,{densityFactor:l})):w;Z=X??w}else Z=Y;a.current=!0,o.current[U.id].autoHeight=!0}else Z=Ak(Ee,w),o.current[U.id].needsFirstMeasurement=!1,o.current[U.id].autoHeight=!1}else o.current[U.id].needsFirstMeasurement=!1;const le={};for(const Ee in W)/^base[A-Z]/.test(Ee)&&(le[Ee]=W[Ee]);if(le.baseCenter=Z,r){var fe,we;const Ee=t.current.getRowIndexRelativeToVisibleRows(U.id),X=r(B({},U,{isFirstVisible:Ee===0,isLastVisible:Ee===f.rows.length-1,indexRelativeToCurrentPage:Ee}));le.spacingTop=(fe=X.top)!=null?fe:0,le.spacingBottom=(we=X.bottom)!=null?we:0}const Me=t.current.unstable_applyPipeProcessors("rowHeight",le,U);return o.current[U.id].sizes=Me,Me},R=[],V=f.rows.reduce((U,F)=>{R.push(U);let $=0,W=0;const Z=j(F);for(const Y in Z){const le=Z[Y];/^base[A-Z]/.test(Y)?$=le>$?le:$:W+=le}return U+$+W},0);g==null||(D=g.top)==null||D.forEach(U=>{j(U)}),g==null||(T=g.bottom)==null||T.forEach(U=>{j(U)}),t.current.setState(U=>B({},U,{rowsMeta:{currentPageTotalHeight:V,positions:R}})),a.current||(i.current=1/0),t.current.forceUpdate()},[t,f.rows,w,n,r,s,g,l]),C=p.useCallback(D=>{const T=o.current[D];return T?T.sizes.baseCenter:w},[w]),x=D=>{var T;return(T=o.current[D])==null?void 0:T.sizes},A=p.useCallback((D,T)=>{o.current[D].sizes.baseCenter=T,o.current[D].isResized=!0,o.current[D].needsFirstMeasurement=!1,v()},[v]),N=p.useMemo(()=>S2(v,e.rowPositionsDebounceMs),[v,e.rowPositionsDebounceMs]),M=p.useCallback((D,T,j)=>{if(!o.current[D]||!o.current[D].autoHeight)return;const R=o.current[D].sizes[`base${Ec(j)}`]!==T;o.current[D].needsFirstMeasurement=!1,o.current[D].sizes[`base${Ec(j)}`]=T,R&&N()},[N]),k=p.useCallback(D=>{var T;return((T=o.current[D])==null?void 0:T.autoHeight)||!1},[]),E=p.useCallback(()=>i.current,[]),b=p.useCallback(D=>{a.current&&D>i.current&&(i.current=D)},[]),I=p.useCallback(()=>{o.current={},v()},[v]);p.useEffect(()=>{v()},[w,c,u,h,v]),LI(t,"rowHeight",v);const P={unstable_setLastMeasuredRowIndex:b,unstable_getRowHeight:C,unstable_getRowInternalSizes:x,unstable_setRowHeight:A,unstable_storeRowHeightMeasurement:M,resetRowHeights:I},S={getLastMeasuredRowIndex:E,rowHasAutoHeight:k};rt(t,P,"public"),rt(t,S,"private")},poe=t=>{const e=p.useCallback((s={})=>t.current.unstable_applyPipeProcessors("exportState",{},s),[t]),n=p.useCallback(s=>{t.current.unstable_applyPipeProcessors("restoreState",{callbacks:[]},{stateToRestore:s}).callbacks.forEach(i=>{i()}),t.current.forceUpdate()},[t]);rt(t,{exportState:e,restoreState:n},"public")},goe=t=>{const e=p.useRef({}),n=p.useCallback((c,u,h)=>{const f=e.current;f[c]||(f[c]={}),f[c][u]=h},[]),r=p.useCallback((c,u)=>{var h;return(h=e.current[c])==null?void 0:h[u]},[]),s=p.useCallback(c=>{const{columnIndex:u,rowId:h,minFirstColumnIndex:f,maxLastColumnIndex:g,columns:y}=c,w=y.length,v=y[u],C=typeof v.colSpan=="function"?v.colSpan(t.current.getCellParams(h,v.field)):v.colSpan;if(!C||C===1)return n(h,u,{spannedByColSpan:!1,cellProps:{colSpan:1,width:v.computedWidth}}),{colSpan:1};let x=v.computedWidth;for(let A=1;A<C;A+=1){const N=u+A;if(N>=f&&N<g){const M=y[N];x+=M.computedWidth,n(h,u+A,{spannedByColSpan:!0,rightVisibleCellIndex:Math.min(u+C,w-1),leftVisibleCellIndex:u})}n(h,u,{spannedByColSpan:!1,cellProps:{colSpan:C,width:x}})}return{colSpan:C}},[t,n]),o=p.useCallback(({rowId:c,minFirstColumn:u,maxLastColumn:h,columns:f})=>{for(let g=u;g<h;g+=1){const y=s({columnIndex:g,rowId:c,minFirstColumnIndex:u,maxLastColumnIndex:h,columns:f});y.colSpan>1&&(g+=y.colSpan-1)}},[s]),i={unstable_getCellColSpanInfo:r},a={calculateColSpan:o};rt(t,i,"public"),rt(t,a,"private");const l=p.useCallback(()=>{e.current={}},[]);ze(t,"columnOrderChange",l)},Kj=(t,e,n)=>{if(rj(t)){if(n[t.field]!==void 0)throw new Error(["MUI: columnGroupingModel contains duplicated field",`column field ${t.field} occurs two times in the grouping model:`,`- ${n[t.field].join(" > ")}`,`- ${e.join(" > ")}`].join(`
`));n[t.field]=e;return}const{groupId:r,children:s}=t;s.forEach(o=>{Kj(o,[...e,r],n)})},AC=t=>{if(!t)return{};const e={};return t.forEach(n=>{Kj(n,[],e)}),e},SC=(t,e,n)=>{const r=l=>{var c;return(c=e[l])!=null?c:[]},s=[],o=Math.max(...t.map(l=>r(l).length)),i=(l,c,u)=>vc(r(l).slice(0,u+1),r(c).slice(0,u+1)),a=(l,c)=>!!(n!=null&&n.left&&n.left.includes(l)&&!n.left.includes(c)||n!=null&&n.right&&!n.right.includes(l)&&n.right.includes(c));for(let l=0;l<o;l+=1){const c=t.reduce((u,h)=>{var f;const g=(f=r(h)[l])!=null?f:null;if(u.length===0)return[{columnFields:[h],groupId:g}];const y=u[u.length-1],w=y.columnFields[y.columnFields.length-1];return y.groupId!==g||!i(w,h,l)||a(w,h)?[...u,{columnFields:[h],groupId:g}]:[...u.slice(0,u.length-1),{columnFields:[...y.columnFields,h],groupId:g}]},[]);s.push(c)}return s},yoe=["groupId","children"],jI=t=>{let e={};return t.forEach(n=>{if(rj(n))return;const{groupId:r,children:s}=n,o=He(n,yoe);if(!r)throw new Error("MUI: An element of the columnGroupingModel does not have either `field` or `groupId`.");s||console.warn(`MUI: group groupId=${r} has no children.`);const i=B({},o,{groupId:r}),a=jI(s);if(a[r]!==void 0||e[r]!==void 0)throw new Error(`MUI: The groupId ${r} is used multiple times in the columnGroupingModel.`);e=B({},e,a,{[r]:i})}),B({},e)},woe=(t,e,n)=>{var r,s,o,i;if(!((r=e.experimentalFeatures)!=null&&r.columnGrouping))return t;const a=wi(n),l=Qb(n),c=jI((s=e.columnGroupingModel)!=null?s:[]),u=AC((o=e.columnGroupingModel)!=null?o:[]),h=SC(a,u,(i=n.current.state.pinnedColumns)!=null?i:{}),f=l.length===0?0:Math.max(...l.map(g=>{var y,w;return(y=(w=u[g])==null?void 0:w.length)!=null?y:0}));return B({},t,{columnGrouping:{lookup:c,unwrappedGroupingModel:u,headerStructure:h,maxDepth:f}})},boe=(t,e)=>{var n;const r=p.useCallback(l=>{var c;return(c=BJ(t)[l])!=null?c:[]},[t]),s=p.useCallback(()=>zF(t),[t]);rt(t,{unstable_getColumnGroupPath:r,unstable_getAllGroupDetails:s},"public");const i=p.useCallback(()=>{var l;const c=AC((l=e.columnGroupingModel)!=null?l:[]);t.current.setState(u=>{var h,f,g;const y=(h=(f=u.columns)==null?void 0:f.orderedFields)!=null?h:[],w=(g=u.pinnedColumns)!=null?g:{},v=SC(y,c,w);return B({},u,{columnGrouping:B({},u.columnGrouping,{headerStructure:v})})})},[t,e.columnGroupingModel]),a=p.useCallback(l=>{var c,u,h,f;if(!((c=e.experimentalFeatures)!=null&&c.columnGrouping))return;const g=(u=(h=(f=t.current).getPinnedColumns)==null?void 0:h.call(f))!=null?u:{},y=wi(t),w=Qb(t),v=jI(l??[]),C=AC(l??[]),x=SC(y,C,g),A=w.length===0?0:Math.max(...w.map(N=>{var M,k;return(M=(k=C[N])==null?void 0:k.length)!=null?M:0}));t.current.setState(N=>B({},N,{columnGrouping:{lookup:v,unwrappedGroupingModel:C,headerStructure:x,maxDepth:A}}))},[t,(n=e.experimentalFeatures)==null?void 0:n.columnGrouping]);ze(t,"columnIndexChange",i),ze(t,"columnsChange",()=>{a(e.columnGroupingModel)}),ze(t,"columnVisibilityModelChange",()=>{a(e.columnGroupingModel)}),p.useEffect(()=>{a(e.columnGroupingModel)},[a,e.columnGroupingModel])},voe=(t,e)=>{const n=lre(t,e);return _se(n,e),vse(n),_r(xse,n,e),_r(Dre,n,e),_r(pse,n,e),_r(fse,n,e),_r(Yre,n,e),_r(Ase,n,e),_r(rse,n,e),_r(Wre,n,e),_r(Fre,n,e),_r(tse,n,e),_r(foe,n,e),_r(Tre,n,e),_r(woe,n,e),_r(Eee,n,e),Zre(n,e),Cse(n,e),Mre(n,e),gse(n,e),xX(n,e),goe(n),boe(n,e),mse(n,e),Jre(n,e),sse(n,e),Qre(n,e),Sse(n,e),jre(n,e),nse(n,e),moe(n,e),Tse(n,e),Pre(n),Ure(n,e),Gre(n,e),Sre(n,e),Rse(n,e),Pse(n,e),poe(n),Iee(n,e),n},xoe=t=>{const{classes:e}=t;return ft({root:["virtualScroller"]},pt,e)},Coe=Zn("div",{name:"MuiDataGrid",slot:"VirtualScroller",overridesResolver:(t,e)=>e.virtualScroller})({overflow:"auto",height:"100%",position:"relative","@media print":{overflow:"hidden"},zIndex:0}),Eoe=p.forwardRef(function(e,n){const r=$e(),s=xoe(r);return d.jsx(Coe,B({ref:n},e,{className:At(s.root,e.className),ownerState:r}))}),Ioe=(t,e)=>{const{classes:n}=t;return ft({root:["virtualScrollerContent",e&&"virtualScrollerContent--overflowed"]},pt,n)},_oe=Zn("div",{name:"MuiDataGrid",slot:"VirtualScrollerContent",overridesResolver:(t,e)=>e.virtualScrollerContent})({}),Aoe=p.forwardRef(function(e,n){var r;const s=$e(),o=!s.autoHeight&&((r=e.style)==null?void 0:r.minHeight)==="auto",i=Ioe(s,o);return d.jsx(_oe,B({ref:n},e,{ownerState:s,className:At(i.root,e.className)}))}),Soe=["className"],Toe=t=>{const{classes:e}=t;return ft({root:["virtualScrollerRenderZone"]},pt,e)},Poe=Zn("div",{name:"MuiDataGrid",slot:"VirtualScrollerRenderZone",overridesResolver:(t,e)=>e.virtualScrollerRenderZone})({position:"absolute",display:"flex",flexDirection:"column"}),koe=p.forwardRef(function(e,n){const{className:r}=e,s=He(e,Soe),o=$e(),i=Toe(o);return d.jsx(Poe,B({ref:n,className:At(i.root,r),ownerState:o},s))}),Roe=["className"],Noe=p.forwardRef(function(e,n){const{className:r}=e,s=He(e,Roe),{getRootProps:o,getContentProps:i,getRenderZoneProps:a,getRows:l}=Lse({ref:n});return d.jsxs(Eoe,B({className:r},o(s),{children:[d.jsx(mX,{}),d.jsx(Aoe,B({},i(),{children:d.jsx(koe,B({},a(),{children:l()}))}))]}))}),qj=p.forwardRef(function(e,n){const r=hoe(e),s=voe(r.apiRef,r);return d.jsx(Qne,{privateApiRef:s,props:r,children:d.jsxs(bZ,B({className:r.className,style:r.style,sx:r.sx,ref:n},r.forwardedProps,{children:[d.jsx(vne,{}),d.jsx(oX,{VirtualScrollerComponent:Noe}),d.jsx(iX,{})]}))})}),Qj=p.memo(qj);r0.filterDebounceMs;r0.filterDebounceMs;qj.propTypes={apiRef:ne.shape({current:ne.object.isRequired}),"aria-label":ne.string,"aria-labelledby":ne.string,autoHeight:ne.bool,autoPageSize:ne.bool,cellModesModel:ne.object,checkboxSelection:ne.bool,classes:ne.object,clipboardCopyCellDelimiter:ne.string,columnBuffer:ne.number,columnGroupingModel:ne.arrayOf(ne.object),columnHeaderHeight:ne.number,columns:n5(ne.array.isRequired),columnThreshold:ne.number,columnVisibilityModel:ne.object,components:ne.object,componentsProps:ne.object,density:ne.oneOf(["comfortable","compact","standard"]),disableColumnFilter:ne.bool,disableColumnMenu:ne.bool,disableColumnSelector:ne.bool,disableDensitySelector:ne.bool,disableEval:ne.bool,disableRowSelectionOnClick:ne.bool,disableVirtualization:ne.bool,editMode:ne.oneOf(["cell","row"]),experimentalFeatures:ne.shape({ariaV7:ne.bool,columnGrouping:ne.bool,warnIfFocusStateIsNotSynced:ne.bool}),filterDebounceMs:ne.number,filterMode:ne.oneOf(["client","server"]),filterModel:ne.shape({items:ne.arrayOf(ne.shape({field:ne.string.isRequired,id:ne.oneOfType([ne.number,ne.string]),operator:ne.string.isRequired,value:ne.any})).isRequired,logicOperator:ne.oneOf(["and","or"]),quickFilterExcludeHiddenColumns:ne.bool,quickFilterLogicOperator:ne.oneOf(["and","or"]),quickFilterValues:ne.array}),forwardedProps:ne.object,getCellClassName:ne.func,getDetailPanelContent:ne.func,getEstimatedRowHeight:ne.func,getRowClassName:ne.func,getRowHeight:ne.func,getRowId:ne.func,getRowSpacing:ne.func,hideFooter:ne.bool,hideFooterPagination:ne.bool,hideFooterSelectedRowCount:ne.bool,ignoreDiacritics:ne.bool,initialState:ne.object,isCellEditable:ne.func,isRowSelectable:ne.func,keepNonExistentRowsSelected:ne.bool,loading:ne.bool,localeText:ne.object,logger:ne.shape({debug:ne.func.isRequired,error:ne.func.isRequired,info:ne.func.isRequired,warn:ne.func.isRequired}),logLevel:ne.oneOf(["debug","error","info","warn",!1]),nonce:ne.string,onCellClick:ne.func,onCellDoubleClick:ne.func,onCellEditStart:ne.func,onCellEditStop:ne.func,onCellKeyDown:ne.func,onCellModesModelChange:ne.func,onClipboardCopy:ne.func,onColumnHeaderClick:ne.func,onColumnHeaderDoubleClick:ne.func,onColumnHeaderEnter:ne.func,onColumnHeaderLeave:ne.func,onColumnHeaderOut:ne.func,onColumnHeaderOver:ne.func,onColumnOrderChange:ne.func,onColumnVisibilityModelChange:ne.func,onFilterModelChange:ne.func,onMenuClose:ne.func,onMenuOpen:ne.func,onPaginationModelChange:ne.func,onPreferencePanelClose:ne.func,onPreferencePanelOpen:ne.func,onProcessRowUpdateError:ne.func,onResize:ne.func,onRowClick:ne.func,onRowCountChange:ne.func,onRowDoubleClick:ne.func,onRowEditStart:ne.func,onRowEditStop:ne.func,onRowModesModelChange:ne.func,onRowSelectionModelChange:ne.func,onSortModelChange:ne.func,onStateChange:ne.func,pageSizeOptions:ne.arrayOf(ne.oneOfType([ne.number,ne.shape({label:ne.string.isRequired,value:ne.number.isRequired})]).isRequired),pagination:t=>t.pagination===!1?new Error(["MUI: `<DataGrid pagination={false} />` is not a valid prop.","Infinite scrolling is not available in the MIT version.","","You need to upgrade to DataGridPro or DataGridPremium component to disable the pagination."].join(`
`)):null,paginationMode:ne.oneOf(["client","server"]),paginationModel:ne.shape({page:ne.number.isRequired,pageSize:ne.number.isRequired}),processRowUpdate:ne.func,rowBuffer:ne.number,rowCount:ne.number,rowHeight:ne.number,rowModesModel:ne.object,rowPositionsDebounceMs:ne.number,rows:ne.arrayOf(ne.object).isRequired,rowSelection:ne.bool,rowSelectionModel:ne.oneOfType([ne.arrayOf(ne.oneOfType([ne.number,ne.string]).isRequired),ne.number,ne.string]),rowSpacingType:ne.oneOf(["border","margin"]),rowThreshold:ne.number,scrollbarSize:ne.number,showCellVerticalBorder:ne.bool,showColumnVerticalBorder:ne.bool,slotProps:ne.object,slots:ne.object,sortingMode:ne.oneOf(["client","server"]),sortingOrder:ne.arrayOf(ne.oneOf(["asc","desc"])),sortModel:ne.arrayOf(ne.shape({field:ne.string.isRequired,sort:ne.oneOf(["asc","desc"])})),sx:ne.oneOfType([ne.arrayOf(ne.oneOfType([ne.func,ne.object,ne.bool])),ne.func,ne.object]),unstable_ignoreValueFormatterDuringExport:ne.oneOfType([ne.shape({clipboardExport:ne.bool,csvExport:ne.bool}),ne.bool])};const Doe=ct(d.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack"),Moe=ct(d.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel"),TC=ct(d.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),Ooe=ct(d.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Loe=ct(d.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),Foe=ct(d.jsx("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2zm10 14.5V20H8v-3.5l4-4zm-4-5-4-4V4h8v3.5z"}),"HourglassEmpty"),joe=ct(d.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"MyLocation"),Voe=ct(d.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M7 13.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m5 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m5 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"Pending"),Boe=ct(d.jsx("path",{d:"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3m1-4.3h-2V7h2z"}),"Report"),Uoe=ct(d.jsx("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send"),Ay=ct(d.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning"),Hoe=p.lazy(()=>Kb(()=>import("./ComplaintsMap-DoU8CrKq.js"),__vite__mapDeps([0,1,2,3]))),$oe=()=>d.jsx(We,{sx:{height:"400px",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"background.paper",borderRadius:1,boxShadow:1},children:d.jsxs(We,{textAlign:"center",children:[d.jsx(vh,{}),d.jsx(wt,{variant:"body2",color:"text.secondary",sx:{mt:2},children:"Loading map..."})]})}),zoe=()=>{const[t,e]=p.useState([]),[n,r]=p.useState(!1),[s,o]=p.useState({}),[i,a]=p.useState(!0),[l,c]=p.useState(null),[u,h]=p.useState("all"),[f,g]=p.useState("newest"),[y,w]=p.useState("all"),[v,C]=p.useState(null),[x,A]=p.useState(!1),[N,M]=p.useState(null),k=!!v,E=(X,ue)=>{C(X.currentTarget),M(ue)},b=()=>{C(null),M(null)},I=async X=>{if(N)try{A(!0);const ue=tt(Oe,"complaints",N.id);await Ii(ue,{status:X}),e(re=>re.map(ie=>ie.id===N.id?{...ie,status:X}:ie)),b()}catch(ue){console.error("Error updating status:",ue)}finally{A(!1)}};p.useEffect(()=>{let X=!0;const ue=pI(re=>{X&&(P(re),a(!1))},"official");return()=>{X=!1,ue&&typeof ue=="function"&&ue()}},[]);const P=X=>{const ue=ie=>{if(ie.priority!=null){const Q=String(ie.priority).toLowerCase();if(Q.includes("high")||Q==="2"||Q==="3"||Q==="urgent")return"High";if(Q.includes("medium")||Q==="1")return"Medium";if(Q.includes("low")||Q==="0")return"Low"}const Ce=`${ie.reason||""} ${ie.description||""}`.toLowerCase(),K=["urgent","emergency","accident","fire","flood","collapsed","contaminated","gas leak","electric shock","blocked road"],me=["traffic","signal","garbage","pothole","water leak","sewage","overflow","streetlight"];return K.some(Q=>Ce.includes(Q))?"High":me.some(Q=>Ce.includes(Q))?"Medium":"Low"},re=X.map(ie=>{if(typeof ie.location=="string")try{ie.location=JSON.parse(ie.location)}catch{console.warn("Failed to parse location string:",ie.location),ie.location=null}ie.location?.coordinates&&(ie.location.coordinates.latitude!==void 0?ie.location={...ie.location,lat:parseFloat(ie.location.coordinates.latitude),lng:parseFloat(ie.location.coordinates.longitude)}:Array.isArray(ie.location.coordinates)&&(ie.location={...ie.location,lat:parseFloat(ie.location.coordinates[1]),lng:parseFloat(ie.location.coordinates[0])}));const Ce=ue(ie);return{...ie,priority:Ce}});e(re)},S=p.useCallback(X=>{const ue=t.find(re=>re.id===X);if(ue){const re=T(ue);o(re),c(X),r(!0)}},[t]),D=X=>{const ue=T(X.row);if(o(ue),c(X.row.id),typeof document<"u"&&document.activeElement)try{document.activeElement.blur()}catch{}r(!0)},T=X=>{const ue=X.mediaUrl||X.mediaPath||X.imageUrl||"",re=X.audioUrl||X.audioPath||"";return{...X,mediaUrl:ue,audioUrl:re}},j=async(X,ue)=>{if(X)try{A(!0);const re=tt(Oe,"complaints",X);await Ii(re,{status:ue}),e(ie=>ie.map(Ce=>Ce.id===X?{...Ce,status:ue}:Ce)),o(ie=>ie?.id===X?{...ie,status:ue}:ie)}catch(re){console.error("Error updating status from modal:",re)}finally{A(!1)}},R=[{field:"locate",headerName:"Locate",width:80,sortable:!1,filterable:!1,align:"center",headerAlign:"center",renderCell:X=>d.jsx(Bd,{"aria-label":"Locate on map",size:"small",onClick:ue=>{ue.stopPropagation(),V(X.row?.id)},children:d.jsx(joe,{fontSize:"small"})})},{field:"reason",headerName:"Complaint Reason",width:300,headerClassName:""},{field:"department",headerName:"Department",width:180,headerAlign:"center",align:"center",sortable:!0,valueGetter:X=>F(X.row),renderCell:X=>d.jsx(Ic,{size:"small",label:X.value||"Other",variant:"outlined"})},{field:"dueBy",headerName:"Due By",width:140,headerAlign:"center",align:"center",sortable:!1,valueGetter:X=>fe(X.row),renderCell:X=>{const ue=X.row,re=fe(ue);if(!re)return d.jsx("span",{className:"text-gray-400",children:"N/A"});const Ce=we(ue)?"bg-red-50 text-red-700 border-red-200":"bg-amber-50 text-amber-700 border-amber-200";return d.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full border ${Ce}`,children:Z(re)})}},{field:"priority",headerName:"Priority",width:120,headerAlign:"center",align:"center",sortable:!0,renderCell:X=>{const ue=X.value||"Low",re={High:"error",Medium:"warning",Low:"success"};return d.jsx(Ic,{size:"small",label:ue,color:re[ue]||"default",variant:"outlined"})}},{field:"author",headerName:"Reported By",width:150},{field:"location",headerName:"Reported Location",width:200,valueGetter:X=>`${X.row.location?.name||"N/A"}`},{field:"timestamp",headerName:"Reported Date & Time",width:200,valueGetter:X=>{if(!X.row.timestamp)return"N/A";let ue=new Date(X.row.timestamp),re=ue.toLocaleDateString(),ie=ue.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});return re+" , "+ie}},{field:"status",headerName:"Status",width:200,headerClassName:"",headerAlign:"center",align:"center",renderCell:X=>{const ue=X.value||"pending",re=ue.charAt(0).toUpperCase()+ue.slice(1),ie={pending:"#3b82f6",inProgress:"#f59e0b",solved:"#10b981",rejected:"#ef4444"}[ue]||"#9ca3af";return d.jsx("div",{className:"flex items-center justify-center w-full",children:d.jsxs(Tn,{variant:"outlined",size:"small",onClick:Ce=>{Ce.stopPropagation(),E(Ce,X.row)},sx:{textTransform:"none",borderColor:ie,color:ie,"&:hover":{borderColor:ie,backgroundColor:`${ie}10`},width:"100%",maxWidth:"180px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 12px"},disabled:x,children:[d.jsx("span",{className:"truncate",children:re}),x&&N?.id===X.row.id?d.jsx(vh,{size:16,sx:{ml:1}}):d.jsx("span",{className:"ml-1",children:""})]})})}},{field:"actions",headerName:"Actions",width:120,align:"center",headerAlign:"center",sortable:!1,filterable:!1,renderCell:X=>d.jsx(Bd,{"aria-label":"Escalate",size:"small",onClick:ue=>{ue.stopPropagation(),Me(X.row)},title:"Escalate via email",children:d.jsx(Uoe,{fontSize:"small"})})}],V=X=>{if(X)try{window.dispatchEvent(new CustomEvent("focus-complaint",{detail:X}));const ue=document.getElementById("complaints-map");ue&&ue.scrollIntoView({behavior:"smooth",block:"start"})}catch(ue){console.error("Failed to focus complaint on map",ue)}},U=X=>{const ue=X.issueType||X.category||X.type;if(ue&&String(ue).trim())return String(ue).trim();const re=`${X.reason||""} ${X.description||""}`.toLowerCase(),ie=[{name:"Garbage",kws:["garbage","trash","waste","dump","litter"]},{name:"Roads & Potholes",kws:["pothole","road","street","asphalt"]},{name:"Water Supply",kws:["water leak","water supply","pipe","pipeline","tap"]},{name:"Sewage/Drainage",kws:["sewage","drain","overflow","manhole"]},{name:"Street Lights",kws:["streetlight","street light","lamp","light not working"]},{name:"Electricity",kws:["electric","power","transformer","wire","shock"]},{name:"Traffic/Signals",kws:["traffic","signal","jam","congestion"]},{name:"Public Safety",kws:["accident","crime","safety","harassment","fire","flood"]},{name:"Health & Sanitation",kws:["sanitation","cleanliness","mosquito","dengue"]}];for(const Ce of ie)if(Ce.kws.some(K=>re.includes(K)))return Ce.name;return"Other"},F=X=>{const ue=String(X.reason||"").toLowerCase(),re=String(X.description||"").toLowerCase();return ue.includes("pothole")||ue.includes("road damage")?"Roads & Potholes":ue.includes("garbage")||ue.includes("illegal dumping")?"Sanitation":ue.includes("street light")?"Street Lights":ue.includes("water leakage")?"Water Supply":ue.includes("drainage")?"Sewage/Drainage":/(fire|accident|crime|safety|harassment|flood)/i.test(re)?"Public Safety":"Other"},$=["Sanitation","Roads & Potholes","Water Supply","Sewage/Drainage","Street Lights","Public Safety","Other"],W=X=>{const ue=String(X.priority||"").toLowerCase(),re=U(X);return/water/i.test(re)?1:/sewage|drain/i.test(re)||/garbage/i.test(re)?2:/roads|pothole/i.test(re)?7:/street/i.test(re)?5:ue.includes("high")?2:ue.includes("medium")?5:ue.includes("low")?10:5},Z=X=>{try{return X?.toLocaleDateString?.(void 0,{month:"short",day:"numeric"})||""}catch{return""}},Y=X=>{try{return X?.toDate?X.toDate():new Date(X)}catch{return new Date(NaN)}},le=X=>!!(X.mediaPath||X.mediaUrl||X.imageUrl),fe=X=>{const ue=Y(X.timestamp),re=W(X);if(isNaN(ue))return null;const ie=new Date(ue);return ie.setDate(ie.getDate()+re),ie},we=X=>{if((X.status||"").toLowerCase()==="solved")return!1;const ue=fe(X);return ue?new Date>ue:!1},Me=X=>{const ue=U(X),re=encodeURIComponent(`[Escalation] ${ue} - ${X.reason||"Complaint"} (#${X.id})`),ie=encodeURIComponent(`Hello Team,

This complaint appears overdue or near due based on SLA.

Details:
- ID: ${X.id}
- Issue: ${ue}
- Priority: ${X.priority||"N/A"}
- Status: ${X.status||"N/A"}
- Reported: ${Y(X.timestamp)?.toLocaleString?.()||"N/A"}
- Due By: ${Z(fe(X))}
- Location: ${X.location?.name||X.location?.address||"N/A"}

Please review and take action.

Thanks.`),Ce=`mailto:?subject=${re}&body=${ie}`;try{window.open(Ce,"_blank")}catch{}},Ee=p.useMemo(()=>{let X=[...t||[]];return y!=="all"&&(X=X.filter(ue=>F(ue)===y)),u!=="all"&&(u==="overdue"?X=X.filter(ue=>we(ue)):X=X.filter(ue=>(ue.status||"").toLowerCase()===u.toLowerCase())),X.sort((ue,re)=>{if(f==="newest")return Y(re.timestamp)-Y(ue.timestamp);if(f==="oldest")return Y(ue.timestamp)-Y(re.timestamp);if(f==="status")return(ue.status||"").localeCompare(re.status||"");if(f==="hasMedia")return(le(re)?1:0)-(le(ue)?1:0);if(f==="dueSoon"){const ie=fe(ue),Ce=fe(re),K=me=>!me||isNaN(me);return K(ie)&&K(Ce)?0:K(ie)?1:K(Ce)?-1:ie-Ce}return 0}),X},[t,u,f,y]);return d.jsxs("div",{className:"min-h-screen w-full p-4 md:p-8 bg-gray-50",children:[d.jsx(qp,{visible:i}),d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Complaints Dashboard"}),d.jsx(Tn,{variant:"contained",color:"warning",startIcon:d.jsx(Ay,{}),onClick:()=>window.location.href="/reported-issues",sx:{textTransform:"none",fontWeight:600,borderRadius:"8px",px:3,py:1,boxShadow:"0 2px 4px rgba(0,0,0,0.1)","&:hover":{boxShadow:"0 4px 8px rgba(0,0,0,0.15)"}},children:"View Supicious Reports"})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:[d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Complaints Map"}),d.jsx(p.Suspense,{fallback:d.jsx($oe,{}),children:d.jsx("div",{id:"complaints-map",className:"h-[400px] w-full rounded-md overflow-hidden",children:d.jsx(Hoe,{complaints:Ee,onMarkerClick:S,className:"h-full"})})}),d.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm text-gray-600",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500 mr-2"}),d.jsx("span",{children:"Pending"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500 mr-2"}),d.jsx("span",{children:"In Progress"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500 mr-2"}),d.jsx("span",{children:"Solved"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500 mr-2"}),d.jsx("span",{children:"Rejected"})]})]})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"All Complaints"}),d.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[d.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[d.jsx("span",{className:"text-gray-600",children:"Filter:"}),["all","pending","inProgress","solved","rejected","overdue"].map(X=>d.jsx("button",{onClick:()=>h(X),className:`px-2.5 py-1 rounded-full border text-xs ${u===X?"bg-emerald-600 text-white border-emerald-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:X==="all"?"All":X},X))]}),d.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[d.jsx("span",{className:"text-gray-600",children:"Department:"}),d.jsx("button",{onClick:()=>w("all"),className:`px-2.5 py-1 rounded-full border text-xs ${y==="all"?"bg-emerald-600 text-white border-emerald-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"All"}),$.map(X=>d.jsx("button",{onClick:()=>w(X),className:`px-2.5 py-1 rounded-full border text-xs ${y===X?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:X,children:X},X))]}),d.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[d.jsx("span",{className:"text-gray-600",children:"Sort:"}),[{k:"newest",label:"Newest"},{k:"oldest",label:"Oldest"},{k:"status",label:"Status"},{k:"hasMedia",label:"Has Media"},{k:"dueSoon",label:"Due Soon"}].map(X=>d.jsx("button",{onClick:()=>g(X.k),className:`px-2.5 py-1 rounded-full border text-xs ${f===X.k?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:X.label},X.k))]})]}),d.jsx("div",{className:"h-[500px] w-full",children:d.jsx(Qj,{rows:Ee,columns:R,pageSize:10,rowsPerPageOptions:[10],onRowClick:D,getRowId:X=>X.id,disableSelectionOnClick:!0,className:"border-0",loading:i,sx:{"& .MuiDataGrid-cell:hover":{cursor:"pointer"},"& .MuiDataGrid-row:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"},"& .overdue-row":{backgroundColor:"rgba(239, 68, 68, 0.05)"},"& .StatusCol.inProgress":{color:pr.inProgress,fontWeight:600},"& .StatusCol.Solved":{color:pr.solved,fontWeight:600},"& .StatusCol.Rejected":{color:pr.rejected,fontWeight:600}},getRowClassName:X=>we(X.row)?"overdue-row":""})})]}),d.jsx(Wb,{open:n,onClose:()=>r(!1),complaint:s,onStatusUpdate:j}),d.jsxs(r5,{anchorEl:v,open:k,onClose:b,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[d.jsxs(Bn,{onClick:()=>I("pending"),selected:N?.status==="pending",disabled:x,children:[d.jsx(vo,{children:d.jsx(Foe,{fontSize:"small",style:{color:pr.pending}})}),d.jsx(xo,{children:"Pending"})]}),d.jsxs(Bn,{onClick:()=>I("inProgress"),selected:N?.status==="inProgress",disabled:x,children:[d.jsx(vo,{children:d.jsx(Voe,{fontSize:"small",style:{color:pr.inProgress}})}),d.jsx(xo,{children:"In Progress"})]}),d.jsxs(Bn,{onClick:()=>I("solved"),selected:N?.status==="solved",disabled:x,children:[d.jsx(vo,{children:d.jsx(TC,{fontSize:"small",style:{color:pr.solved}})}),d.jsx(xo,{children:"Solved"})]}),d.jsxs(Bn,{onClick:()=>I("rejected"),selected:N?.status==="rejected",disabled:x,children:[d.jsx(vo,{children:d.jsx(Moe,{fontSize:"small",style:{color:pr.rejected}})}),d.jsx(xo,{children:"Rejected"})]})]})]})},Yj=6048e5,Goe=864e5,Jj=6e4,Xj=36e5,Sk=Symbol.for("constructDateFrom");function Ys(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&Sk in t?t[Sk](e):t instanceof Date?new t.constructor(e):new Date(e)}function jr(t,e){return Ys(e||t,t)}function Woe(t,e,n){const r=jr(t,n?.in);return isNaN(e)?Ys(t,NaN):(e&&r.setDate(r.getDate()+e),r)}let Koe={};function s0(){return Koe}function Wm(t,e){const n=s0(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=jr(t,e?.in),o=s.getDay(),i=(o<r?7:0)+o-r;return s.setDate(s.getDate()-i),s.setHours(0,0,0,0),s}function jw(t,e){return Wm(t,{...e,weekStartsOn:1})}function Zj(t,e){const n=jr(t,e?.in),r=n.getFullYear(),s=Ys(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const o=jw(s),i=Ys(n,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const a=jw(i);return n.getTime()>=o.getTime()?r+1:n.getTime()>=a.getTime()?r:r-1}function Tk(t){const e=jr(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function eV(t,...e){const n=Ys.bind(null,e.find(r=>typeof r=="object"));return e.map(n)}function Pk(t,e){const n=jr(t,e?.in);return n.setHours(0,0,0,0),n}function qoe(t,e,n){const[r,s]=eV(n?.in,t,e),o=Pk(r),i=Pk(s),a=+o-Tk(o),l=+i-Tk(i);return Math.round((a-l)/Goe)}function Qoe(t,e){const n=Zj(t,e),r=Ys(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),jw(r)}function Yoe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Joe(t){return!(!Yoe(t)&&typeof t!="number"||isNaN(+jr(t)))}function Xoe(t,e){const[n,r]=eV(t,e.start,e.end);return{start:n,end:r}}function Zoe(t,e){const{start:n,end:r}=Xoe(e?.in,t);let s=+n>+r;const o=s?+n:+r,i=s?r:n;i.setHours(0,0,0,0);let a=1;const l=[];for(;+i<=o;)l.push(Ys(n,i)),i.setDate(i.getDate()+a),i.setHours(0,0,0,0);return s?l.reverse():l}function eie(t,e){const n=jr(t,e?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const tie={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},nie=(t,e,n)=>{let r;const s=tie[t];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Dv(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const rie={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},sie={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},oie={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},iie={date:Dv({formats:rie,defaultWidth:"full"}),time:Dv({formats:sie,defaultWidth:"full"}),dateTime:Dv({formats:oie,defaultWidth:"full"})},aie={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},lie=(t,e,n,r)=>aie[t];function gf(t){return(e,n)=>{const r=n?.context?String(n.context):"standalone";let s;if(r==="formatting"&&t.formattingValues){const i=t.defaultFormattingWidth||t.defaultWidth,a=n?.width?String(n.width):i;s=t.formattingValues[a]||t.formattingValues[i]}else{const i=t.defaultWidth,a=n?.width?String(n.width):t.defaultWidth;s=t.values[a]||t.values[i]}const o=t.argumentCallback?t.argumentCallback(e):e;return s[o]}}const cie={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},uie={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},die={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},hie={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},fie={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},mie={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},pie=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},gie={ordinalNumber:pie,era:gf({values:cie,defaultWidth:"wide"}),quarter:gf({values:uie,defaultWidth:"wide",argumentCallback:t=>t-1}),month:gf({values:die,defaultWidth:"wide"}),day:gf({values:hie,defaultWidth:"wide"}),dayPeriod:gf({values:fie,defaultWidth:"wide",formattingValues:mie,defaultFormattingWidth:"wide"})};function yf(t){return(e,n={})=>{const r=n.width,s=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],o=e.match(s);if(!o)return null;const i=o[0],a=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?wie(a,h=>h.test(i)):yie(a,h=>h.test(i));let c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=e.slice(i.length);return{value:c,rest:u}}}function yie(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function wie(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function bie(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const s=r[0],o=e.match(t.parsePattern);if(!o)return null;let i=t.valueCallback?t.valueCallback(o[0]):o[0];i=n.valueCallback?n.valueCallback(i):i;const a=e.slice(s.length);return{value:i,rest:a}}}const vie=/^(\d+)(th|st|nd|rd)?/i,xie=/\d+/i,Cie={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Eie={any:[/^b/i,/^(a|c)/i]},Iie={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},_ie={any:[/1/i,/2/i,/3/i,/4/i]},Aie={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Sie={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Tie={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Pie={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},kie={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Rie={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Nie={ordinalNumber:bie({matchPattern:vie,parsePattern:xie,valueCallback:t=>parseInt(t,10)}),era:yf({matchPatterns:Cie,defaultMatchWidth:"wide",parsePatterns:Eie,defaultParseWidth:"any"}),quarter:yf({matchPatterns:Iie,defaultMatchWidth:"wide",parsePatterns:_ie,defaultParseWidth:"any",valueCallback:t=>t+1}),month:yf({matchPatterns:Aie,defaultMatchWidth:"wide",parsePatterns:Sie,defaultParseWidth:"any"}),day:yf({matchPatterns:Tie,defaultMatchWidth:"wide",parsePatterns:Pie,defaultParseWidth:"any"}),dayPeriod:yf({matchPatterns:kie,defaultMatchWidth:"any",parsePatterns:Rie,defaultParseWidth:"any"})},Die={code:"en-US",formatDistance:nie,formatLong:iie,formatRelative:lie,localize:gie,match:Nie,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Mie(t,e){const n=jr(t,e?.in);return qoe(n,eie(n))+1}function Oie(t,e){const n=jr(t,e?.in),r=+jw(n)-+Qoe(n);return Math.round(r/Yj)+1}function tV(t,e){const n=jr(t,e?.in),r=n.getFullYear(),s=s0(),o=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,i=Ys(e?.in||t,0);i.setFullYear(r+1,0,o),i.setHours(0,0,0,0);const a=Wm(i,e),l=Ys(e?.in||t,0);l.setFullYear(r,0,o),l.setHours(0,0,0,0);const c=Wm(l,e);return+n>=+a?r+1:+n>=+c?r:r-1}function Lie(t,e){const n=s0(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,s=tV(t,e),o=Ys(e?.in||t,0);return o.setFullYear(s,0,r),o.setHours(0,0,0,0),Wm(o,e)}function Fie(t,e){const n=jr(t,e?.in),r=+Wm(n,e)-+Lie(n,e);return Math.round(r/Yj)+1}function Rt(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const Ki={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return Rt(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):Rt(n+1,2)},d(t,e){return Rt(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return Rt(t.getHours()%12||12,e.length)},H(t,e){return Rt(t.getHours(),e.length)},m(t,e){return Rt(t.getMinutes(),e.length)},s(t,e){return Rt(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return Rt(s,e.length)}},gu={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},kk={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Ki.y(t,e)},Y:function(t,e,n,r){const s=tV(t,r),o=s>0?s:1-s;if(e==="YY"){const i=o%100;return Rt(i,2)}return e==="Yo"?n.ordinalNumber(o,{unit:"year"}):Rt(o,e.length)},R:function(t,e){const n=Zj(t);return Rt(n,e.length)},u:function(t,e){const n=t.getFullYear();return Rt(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return Rt(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return Rt(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return Ki.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return Rt(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const s=Fie(t,r);return e==="wo"?n.ordinalNumber(s,{unit:"week"}):Rt(s,e.length)},I:function(t,e,n){const r=Oie(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):Rt(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Ki.d(t,e)},D:function(t,e,n){const r=Mie(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Rt(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const s=t.getDay(),o=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return Rt(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const s=t.getDay(),o=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return Rt(o,e.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return Rt(s,e.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let s;switch(r===12?s=gu.noon:r===0?s=gu.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let s;switch(r>=17?s=gu.evening:r>=12?s=gu.afternoon:r>=4?s=gu.morning:s=gu.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Ki.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Ki.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Rt(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):Rt(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Ki.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Ki.s(t,e)},S:function(t,e){return Ki.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return Nk(r);case"XXXX":case"XX":return Sl(r);case"XXXXX":case"XXX":default:return Sl(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return Nk(r);case"xxxx":case"xx":return Sl(r);case"xxxxx":case"xxx":default:return Sl(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Rk(r,":");case"OOOO":default:return"GMT"+Sl(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Rk(r,":");case"zzzz":default:return"GMT"+Sl(r,":")}},t:function(t,e,n){const r=Math.trunc(+t/1e3);return Rt(r,e.length)},T:function(t,e,n){return Rt(+t,e.length)}};function Rk(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=Math.trunc(r/60),o=r%60;return o===0?n+String(s):n+String(s)+e+Rt(o,2)}function Nk(t,e){return t%60===0?(t>0?"-":"+")+Rt(Math.abs(t)/60,2):Sl(t,e)}function Sl(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=Rt(Math.trunc(r/60),2),o=Rt(r%60,2);return n+s+e+o}const Dk=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},nV=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},jie=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return Dk(t,e);let o;switch(r){case"P":o=e.dateTime({width:"short"});break;case"PP":o=e.dateTime({width:"medium"});break;case"PPP":o=e.dateTime({width:"long"});break;case"PPPP":default:o=e.dateTime({width:"full"});break}return o.replace("{{date}}",Dk(r,e)).replace("{{time}}",nV(s,e))},Vie={p:nV,P:jie},Bie=/^D+$/,Uie=/^Y+$/,Hie=["D","DD","YY","YYYY"];function $ie(t){return Bie.test(t)}function zie(t){return Uie.test(t)}function Gie(t,e,n){const r=Wie(t,e,n);if(console.warn(r),Hie.includes(t))throw new RangeError(r)}function Wie(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Kie=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,qie=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Qie=/^'([^]*?)'?$/,Yie=/''/g,Jie=/[a-zA-Z]/;function ks(t,e,n){const r=s0(),s=r.locale??Die,o=r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,i=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=jr(t,n?.in);if(!Joe(a))throw new RangeError("Invalid time value");let l=e.match(qie).map(u=>{const h=u[0];if(h==="p"||h==="P"){const f=Vie[h];return f(u,s.formatLong)}return u}).join("").match(Kie).map(u=>{if(u==="''")return{isToken:!1,value:"'"};const h=u[0];if(h==="'")return{isToken:!1,value:Xie(u)};if(kk[h])return{isToken:!0,value:u};if(h.match(Jie))throw new RangeError("Format string contains an unescaped latin alphabet character `"+h+"`");return{isToken:!1,value:u}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const c={firstWeekContainsDate:o,weekStartsOn:i,locale:s};return l.map(u=>{if(!u.isToken)return u.value;const h=u.value;(zie(h)||$ie(h))&&Gie(h,e,String(t));const f=kk[h[0]];return f(a,h,s.localize,c)}).join("")}function Xie(t){const e=t.match(Qie);return e?e[1].replace(Yie,"'"):t}function wf(t,e,n){return Woe(t,-e,n)}function Zie(t,e){const n=()=>Ys(e?.in,NaN),s=rae(t);let o;if(s.date){const c=sae(s.date,2);o=oae(c.restDateString,c.year)}if(!o||isNaN(+o))return n();const i=+o;let a=0,l;if(s.time&&(a=iae(s.time),isNaN(a)))return n();if(s.timezone){if(l=aae(s.timezone),isNaN(l))return n()}else{const c=new Date(i+a),u=jr(0,e?.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return jr(i+a+l,e?.in)}const $g={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},eae=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,tae=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,nae=/^([+-])(\d{2})(?::?(\d{2}))?$/;function rae(t){const e={},n=t.split($g.dateTimeDelimiter);let r;if(n.length>2)return e;if(/:/.test(n[0])?r=n[0]:(e.date=n[0],r=n[1],$g.timeZoneDelimiter.test(e.date)&&(e.date=t.split($g.timeZoneDelimiter)[0],r=t.substr(e.date.length,t.length))),r){const s=$g.timezone.exec(r);s?(e.time=r.replace(s[1],""),e.timezone=s[1]):e.time=r}return e}function sae(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=t.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?s:o*100,restDateString:t.slice((r[1]||r[2]).length)}}function oae(t,e){if(e===null)return new Date(NaN);const n=t.match(eae);if(!n)return new Date(NaN);const r=!!n[4],s=bf(n[1]),o=bf(n[2])-1,i=bf(n[3]),a=bf(n[4]),l=bf(n[5])-1;if(r)return hae(e,a,l)?lae(e,a,l):new Date(NaN);{const c=new Date(0);return!uae(e,o,i)||!dae(e,s)?new Date(NaN):(c.setUTCFullYear(e,o,Math.max(s,i)),c)}}function bf(t){return t?parseInt(t):1}function iae(t){const e=t.match(tae);if(!e)return NaN;const n=Mv(e[1]),r=Mv(e[2]),s=Mv(e[3]);return fae(n,r,s)?n*Xj+r*Jj+s*1e3:NaN}function Mv(t){return t&&parseFloat(t.replace(",","."))||0}function aae(t){if(t==="Z")return 0;const e=t.match(nae);if(!e)return 0;const n=e[1]==="+"?-1:1,r=parseInt(e[2]),s=e[3]&&parseInt(e[3])||0;return mae(r,s)?n*(r*Xj+s*Jj):NaN}function lae(t,e,n){const r=new Date(0);r.setUTCFullYear(t,0,4);const s=r.getUTCDay()||7,o=(e-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+o),r}const cae=[31,null,31,30,31,30,31,31,30,31,30,31];function rV(t){return t%400===0||t%4===0&&t%100!==0}function uae(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(cae[e]||(rV(t)?29:28))}function dae(t,e){return e>=1&&e<=(rV(t)?366:365)}function hae(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function fae(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function mae(t,e){return e>=0&&e<=59}var Sy={exports:{}},pae=Sy.exports,Mk;function gae(){return Mk||(Mk=1,(function(t,e){(function(n,r){r()})(pae,function(){function n(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function r(c,u,h){var f=new XMLHttpRequest;f.open("GET",c),f.responseType="blob",f.onload=function(){l(f.response,u,h)},f.onerror=function(){console.error("could not download file")},f.send()}function s(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function o(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof bg=="object"&&bg.global===bg?bg:void 0,a=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(c,u,h){var f=i.URL||i.webkitURL,g=document.createElement("a");u=u||c.name||"download",g.download=u,g.rel="noopener",typeof c=="string"?(g.href=c,g.origin===location.origin?o(g):s(g.href)?r(c,u,h):o(g,g.target="_blank")):(g.href=f.createObjectURL(c),setTimeout(function(){f.revokeObjectURL(g.href)},4e4),setTimeout(function(){o(g)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,h){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(n(c,h),u);else if(s(c))r(c,u,h);else{var f=document.createElement("a");f.href=c,f.target="_blank",setTimeout(function(){o(f)})}}:function(c,u,h,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof c=="string")return r(c,u,h);var g=c.type==="application/octet-stream",y=/constructor/i.test(i.HTMLElement)||i.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||g&&y||a)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var A=v.result;A=w?A:A.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=A:location=A,f=null},v.readAsDataURL(c)}else{var C=i.URL||i.webkitURL,x=C.createObjectURL(c);f?f.location=x:location.href=x,f=null,setTimeout(function(){C.revokeObjectURL(x)},4e4)}});i.saveAs=l.saveAs=l,t.exports=l})})(Sy)),Sy.exports}var yae=gae(),vf={},Ov={};const wae=s5(o5);var Ok;function eg(){return Ok||(Ok=1,(function(t){"use client";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return e.createSvgIcon}});var e=wae})(Ov)),Ov}var Lk;function bae(){if(Lk)return vf;Lk=1;var t=yp();Object.defineProperty(vf,"__esModule",{value:!0}),vf.default=void 0;var e=t(eg()),n=wp();return vf.default=(0,e.default)((0,n.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh"),vf}var vae=bae();const Lv=wh(vae);var xf={},Fk;function xae(){if(Fk)return xf;Fk=1;var t=yp();Object.defineProperty(xf,"__esModule",{value:!0}),xf.default=void 0;var e=t(eg()),n=wp();return xf.default=(0,e.default)((0,n.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}),"Description"),xf}var Cae=xae();const Eae=wh(Cae);var Cf={},jk;function Iae(){if(jk)return Cf;jk=1;var t=yp();Object.defineProperty(Cf,"__esModule",{value:!0}),Cf.default=void 0;var e=t(eg()),n=wp();return Cf.default=(0,e.default)((0,n.jsx)("path",{d:"M17 12c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m1.65 7.35L16.5 17.2V14h1v2.79l1.85 1.85zM18 3h-3.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H6c-1.1 0-2 .9-2 2v15c0 1.1.9 2 2 2h6.11c-.59-.57-1.07-1.25-1.42-2H6V5h2v3h8V5h2v5.08c.71.1 1.38.31 2 .6V5c0-1.1-.9-2-2-2m-6 2c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"PendingActions"),Cf}var _ae=Iae();const Aae=wh(_ae);var Ef={},Vk;function Sae(){if(Vk)return Ef;Vk=1;var t=yp();Object.defineProperty(Ef,"__esModule",{value:!0}),Ef.default=void 0;var e=t(eg()),n=wp();return Ef.default=(0,e.default)((0,n.jsx)("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2zm10 14.5V20H8v-3.5l4-4zm-4-5-4-4V4h8v3.5z"}),"HourglassEmpty"),Ef}var Tae=Sae();const Bk=wh(Tae);var If={},Uk;function Pae(){if(Uk)return If;Uk=1;var t=yp();Object.defineProperty(If,"__esModule",{value:!0}),If.default=void 0;var e=t(eg()),n=wp();return If.default=(0,e.default)((0,n.jsx)("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"CheckCircleOutline"),If}var kae=Pae();const Rae=wh(kae),zg=({title:t,value:e,color:n,icon:r,isLoading:s=!1})=>d.jsx(ab,{sx:{height:"100%",borderRadius:2,boxShadow:1},children:d.jsx(lb,{children:d.jsxs(We,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[d.jsxs(We,{children:[d.jsx(wt,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:t}),s?d.jsx(We,{height:36,display:"flex",alignItems:"center",children:d.jsx(vh,{size:24})}):d.jsx(wt,{variant:"h4",component:"div",fontWeight:"bold",color:n,children:e})]}),r&&d.jsx(We,{sx:{backgroundColor:`${n}15`,width:48,height:48,borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",color:n},children:d.jsx(r,{fontSize:"medium"})})]})})}),yu=({title:t,subtitle:e,children:n,action:r,sx:s={}})=>d.jsx(ab,{sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:2,boxShadow:1,...s},children:d.jsxs(lb,{sx:{flexGrow:1,p:3},children:[d.jsxs(We,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,children:[d.jsxs(We,{children:[d.jsx(wt,{variant:"h6",component:"h2",gutterBottom:!e,children:t}),e&&d.jsx(wt,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:e})]}),r&&d.jsx(We,{children:r})]}),d.jsx(We,{sx:{height:"100%",minHeight:300},children:n})]})}),wu={primary:"#4361ee",success:"#4cc9f0",info:"#4895ef"},Gg=({active:t,payload:e,label:n})=>t&&e&&e.length?d.jsxs(wm,{elevation:3,sx:{p:2,backgroundColor:"rgba(255, 255, 255, 0.95)"},children:[d.jsx(wt,{variant:"body2",color:"textSecondary",children:n}),e.map((r,s)=>d.jsxs(We,{sx:{display:"flex",alignItems:"center",mt:.5},children:[d.jsx(We,{sx:{width:12,height:12,backgroundColor:r.color,mr:1,borderRadius:"2px"}}),d.jsxs(wt,{variant:"body2",children:[r.name,": ",d.jsx("strong",{children:r.value})]})]},`tooltip-${s}`))]}):null,Nae=()=>{bh();const{currentUser:t,isOfficial:e}=$p(),n=ts(),[r,s]=p.useState([]),[o,i]=p.useState(!0),[a,l]=p.useState("30"),[c,u]=p.useState(null),[h,f]=p.useState(!1),[g,y]=p.useState(new Date),[w,v]=p.useState(!0),C=p.useMemo(()=>{if(!r.length)return[];const I=new Date;let P;switch(a){case"7":P=wf(I,7);break;case"30":P=wf(I,30);break;case"90":P=wf(I,90);break;case"365":P=wf(I,365);break;default:P=new Date(0)}return r.filter(S=>{if(!S?.timestamp)return!1;const D=S.timestamp?.toDate?S.timestamp.toDate():new Date(S.timestamp);return!isNaN(D)&&D>=P})},[r,a]);p.useEffect(()=>{let I=null;const P=async()=>{if(w)try{i(!0),u(null),console.log("Fetching complaints...");const D=await mw();if(!w)return;const T=D.filter(j=>{try{return j?.id&&j?.timestamp&&j?.status&&(j.timestamp instanceof Date||!isNaN(new Date(j.timestamp).getTime()))}catch(R){return console.warn("Invalid complaint data:",j,R),!1}});console.log(`Loaded ${T.length} valid complaints out of ${D.length}`),s(T),y(new Date)}catch(D){console.error("Error loading complaints:",D),w&&u("Failed to load complaints. Please refresh the page or try again later.")}finally{w&&i(!1)}},S=async()=>{try{console.log("Setting up real-time updates..."),I=kO(D=>{if(!w)return;const T=D.filter(j=>j?.id&&j?.timestamp&&j?.status);console.log("Received real-time update with",T.length,"valid complaints"),s(T),y(new Date)})}catch(D){console.error("Error setting up real-time updates:",D),w&&u("Failed to set up real-time updates. Some data may be outdated.")}};return P(),S(),()=>{v(!1),I&&typeof I=="function"&&(console.log("Cleaning up real-time listener"),I())}},[w]);const x=I=>{const P=I.issueType||I.category||I.type;if(P&&String(P).trim())return String(P).trim();const S=`${I.reason||""} ${I.description||""}`.toLowerCase(),D=[{name:"Garbage",kws:["garbage","trash","waste","dump","litter"]},{name:"Roads & Potholes",kws:["pothole","road","street","asphalt"]},{name:"Water Supply",kws:["water leak","water supply","pipe","pipeline","tap"]},{name:"Sewage/Drainage",kws:["sewage","drain","overflow","manhole"]},{name:"Street Lights",kws:["streetlight","street light","lamp","light not working"]},{name:"Electricity",kws:["electric","power","transformer","wire","shock"]},{name:"Traffic/Signals",kws:["traffic","signal","jam","congestion"]},{name:"Public Safety",kws:["accident","crime","safety","harassment","fire","flood"]},{name:"Health & Sanitation",kws:["sanitation","cleanliness","mosquito","dengue"]}];for(const T of D)if(T.kws.some(j=>S.includes(j)))return T.name;return"Other"},A=p.useMemo(()=>{if(!C.length)return{};const I=new Date,P=parseInt(a,10)||30,S=C.reduce((re,ie)=>(re[ie.status]=(re[ie.status]||0)+1,re),{}),D=Object.entries(Es).map(([re,ie])=>({name:ie,value:S[re]||0,color:pr[re]||wu.info,key:re})),T=S.solved||0,j=S.pending||0,R=Math.max(0,C.length-j),V=R>0?Math.round(T/R*100):0,U={},F=Zoe({start:wf(I,P-1),end:I});F.forEach(re=>{const ie=ks(re,"MMM dd");U[ie]=0}),C.forEach(re=>{const ie=ks(new Date(re.timestamp),"MMM dd");U[ie]!==void 0&&U[ie]++});const $=Object.entries(U).map(([re,ie])=>({date:re,count:ie})),W=["pending","inProgress","solved","rejected"],Z={};F.forEach(re=>{const ie=ks(re,"MMM dd");Z[ie]=Object.fromEntries(W.map(Ce=>[Ce,0]))}),C.forEach(re=>{const ie=ks(new Date(re.timestamp),"MMM dd");if(Z[ie]){const Ce=re.status||"pending";W.includes(Ce)&&(Z[ie][Ce]+=1)}});const Y=Object.entries(Z).map(([re,ie])=>({date:re,...ie})),le=C.reduce((re,ie)=>{const Ce=x(ie);return re[Ce]=(re[Ce]||0)+1,re},{}),fe=Object.entries(le).sort((re,ie)=>ie[1]-re[1]).slice(0,8).map(([re,ie])=>({name:re.length>15?`${re.substring(0,15)}...`:re,value:ie,fullName:re})),we={};C.forEach(re=>{const ie=x(re);we[ie]||(we[ie]={}),we[ie][re.status]=(we[ie][re.status]||0)+1});const Me=Object.entries(we).map(([re,ie])=>({name:re,...Object.entries(Es).reduce((Ce,[K,me])=>(Ce[me]=ie[K]||0,Ce),{})})),Ee=C.reduce((re,ie)=>{const Ce=ie.location?.name||ie.location?.address||"Unknown";return re[Ce]=(re[Ce]||0)+1,re},{}),X=Object.entries(Ee).sort((re,ie)=>ie[1]-re[1]).slice(0,8).map(([re,ie])=>({name:re,count:ie})),ue=[...C].sort((re,ie)=>new Date(ie.timestamp)-new Date(re.timestamp)).slice(0,5);return{statusData:D,timeSeriesData:$,statusOverTime:Y,issueTypeData:fe,statusByIssueData:Me,topLocations:X,recentComplaints:ue,stats:{pending:S.pending||0,inProgress:S.inProgress||0,solved:S.solved||0,rejected:S.rejected||0,total:C.length,resolutionRate:V}}},[C,a]),N=async()=>{try{i(!0);const I=await mw();s(I),y(new Date),ge.success("Data refreshed successfully")}catch(I){console.error("Error refreshing data:",I),ge.error("Failed to refresh data")}finally{i(!1)}};if(p.useEffect(()=>{t?e||(f(!0),ge.error("You do not have permission to access this page"),n("/")):(f(!0),ge.error("Please log in to access the analytics dashboard"),n("/official-login"))},[t,e,n]),h)return d.jsxs(N2,{maxWidth:"md",sx:{mt:8,textAlign:"center"},children:[d.jsx(D2,{severity:"error",sx:{mb:3},children:"You do not have permission to access the analytics dashboard."}),d.jsx(Tn,{variant:"contained",color:"primary",onClick:()=>n("/"),children:"Return to Home"})]});if(o)return d.jsxs(We,{p:3,children:[d.jsxs(We,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,children:[d.jsxs(We,{children:[d.jsx(We,{width:300,height:48,bgcolor:"#f0f2f5",borderRadius:1,mb:1}),d.jsx(We,{width:200,height:24,bgcolor:"#f0f2f5",borderRadius:1})]}),d.jsxs(We,{display:"flex",gap:2,children:[d.jsx(We,{width:150,height:40,bgcolor:"#f0f2f5",borderRadius:1}),d.jsx(We,{width:120,height:40,bgcolor:"#f0f2f5",borderRadius:1})]})]}),d.jsx(Bt,{container:!0,spacing:3,mb:4,children:[1,2,3,4].map(I=>d.jsx(Bt,{item:!0,xs:12,sm:6,md:3,children:d.jsxs(We,{bgcolor:"#fff",p:3,borderRadius:2,boxShadow:"0 2px 12px rgba(0,0,0,0.05)",children:[d.jsx(We,{width:"60%",height:24,bgcolor:"#f0f2f5",mb:2,borderRadius:1}),d.jsx(We,{width:"40%",height:40,bgcolor:"#f0f2f5",borderRadius:1})]})},I))}),d.jsx(Bt,{container:!0,spacing:3,children:[1,2].map(I=>d.jsx(Bt,{item:!0,xs:12,md:6,children:d.jsxs(We,{bgcolor:"#fff",p:3,borderRadius:2,boxShadow:"0 2px 12px rgba(0,0,0,0.05)",height:400,children:[d.jsx(We,{width:200,height:28,bgcolor:"#f0f2f5",mb:3,borderRadius:1}),d.jsx(We,{width:"100%",height:"calc(100% - 60px)",bgcolor:"#f8f9fa",borderRadius:1})]})},I))})]});if(c)return d.jsx(We,{p:3,children:d.jsxs(We,{maxWidth:800,mx:"auto",textAlign:"center",mt:8,p:4,bgcolor:"#fff",borderRadius:2,boxShadow:"0 2px 12px rgba(0,0,0,0.05)",children:[d.jsx(We,{fontSize:64,color:"error.main",mb:2,sx:{animation:"bounce 2s infinite","@keyframes bounce":{"0%, 100%":{transform:"translateY(0)"},"50%":{transform:"translateY(-10px)"}}},children:""}),d.jsx(wt,{variant:"h5",color:"error",gutterBottom:!0,children:"Oops! Something went wrong"}),d.jsx(wt,{color:"text.secondary",paragraph:!0,sx:{maxWidth:600,mx:"auto"},children:c}),d.jsxs(We,{display:"flex",gap:2,justifyContent:"center",mt:3,children:[d.jsx(Tn,{variant:"contained",color:"primary",onClick:N,startIcon:d.jsx(Lv,{}),sx:{textTransform:"none",px:3,py:1,boxShadow:"0 2px 8px rgba(67, 97, 238, 0.3)","&:hover":{boxShadow:"0 4px 12px rgba(67, 97, 238, 0.4)"}},children:"Try Again"}),d.jsx(Tn,{variant:"outlined",onClick:()=>window.location.reload(),sx:{textTransform:"none",borderColor:"rgba(0, 0, 0, 0.1)","&:hover":{borderColor:"primary.main",bgcolor:"rgba(67, 97, 238, 0.04)"}},children:"Reload Page"})]})]})});const{issueTypeData:M=[],statusData:k=[],stats:E={total:0,solved:0,inProgress:0,rejected:0,resolutionRate:0}}=A,b=async()=>{try{if(!C.length){ge.warn("No data to export");return}const I=await Kb(()=>import("./exceljs.min-CATl1nQT.js").then(j=>j.e),__vite__mapDeps([4,1,5])),P=new I.Workbook,S=P.addWorksheet("Complaints"),D=C.map(j=>({"Issue Type":j.issueType||"N/A",Status:j.status||"N/A",Date:j.timestamp?.toDate?ks(j.timestamp.toDate(),"yyyy-MM-dd HH:mm"):ks(new Date(j.timestamp),"yyyy-MM-dd HH:mm"),Location:j.location?.address||"N/A",Description:j.description||"",ID:j.id||"N/A",Author:j.author||"Unknown"}));S.addRow(Object.keys(D[0])),D.forEach(j=>S.addRow(Object.values(j)));const T=await P.xlsx.writeBuffer();yae.saveAs(new Blob([T]),`complaints_${ks(new Date,"yyyyMMdd_HHmm")}.xlsx`),ge.success("Export completed!")}catch(I){console.error(I),ge.error("Export failed")}};return o?d.jsxs(We,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:[d.jsx(vh,{size:60,thickness:4,sx:{mb:2}}),d.jsx(wt,{variant:"h6",color:"textSecondary",children:"Loading analytics data..."})]}):c?d.jsxs(We,{p:3,textAlign:"center",children:[d.jsx(wt,{variant:"h5",color:"error",gutterBottom:!0,children:"Error Loading Data"}),d.jsx(wt,{color:"textSecondary",paragraph:!0,children:c}),d.jsx(Tn,{variant:"outlined",onClick:()=>window.location.reload(),startIcon:d.jsx(Lv,{}),children:"Retry"})]}):C.length?d.jsxs(We,{p:3,children:[d.jsxs(We,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[d.jsxs(We,{children:[d.jsx(wt,{variant:"h4",children:"Analytics Dashboard"}),d.jsx(wt,{variant:"subtitle1",color:"textSecondary",children:a==="all"?"All Time Data":`Last ${a} days`})]}),d.jsxs(We,{display:"flex",alignItems:"center",gap:2,children:[d.jsxs(R2,{size:"small",sx:{minWidth:150},children:[d.jsx(P2,{children:"Time Range"}),d.jsxs(k2,{value:a,onChange:I=>l(I.target.value),label:"Time Range",children:[d.jsx(Bn,{value:"7",children:"Last 7 days"}),d.jsx(Bn,{value:"30",children:"Last 30 days"}),d.jsx(Bn,{value:"90",children:"Last 90 days"}),d.jsx(Bn,{value:"365",children:"Last year"}),d.jsx(Bn,{value:"all",children:"All time"})]})]}),d.jsx(Tn,{variant:"contained",onClick:b,children:"Export Data"})]})]}),E&&d.jsxs(Bt,{container:!0,spacing:3,mb:4,children:[d.jsx(Bt,{item:!0,xs:12,sm:6,md:3,children:d.jsx(zg,{title:"Total Complaints",value:E.total,color:wu.primary,icon:Eae})}),d.jsx(Bt,{item:!0,xs:12,sm:6,md:3,children:d.jsx(zg,{title:"Resolved",value:E.solved,color:pr.solved||"#10b981",icon:Rae})}),d.jsx(Bt,{item:!0,xs:12,sm:6,md:3,children:d.jsx(zg,{title:"In Progress",value:E.inProgress,color:pr.inProgress||"#f59e0b",icon:Aae})}),d.jsx(Bt,{item:!0,xs:12,sm:6,md:3,children:d.jsx(zg,{title:"Resolution Rate",value:`${E.resolutionRate||0}%`,color:wu.success,icon:Bk})})]}),d.jsxs(Bt,{container:!0,spacing:3,children:[d.jsx(Bt,{item:!0,xs:12,md:6,children:d.jsx(yu,{title:"Complaints by Status",action:d.jsx(Tn,{size:"small",onClick:()=>b(),children:"Export"}),children:d.jsx(xg,{width:"100%",height:300,children:d.jsxs(m5,{children:[d.jsx(p5,{data:k,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:I,percent:P})=>`${I}: ${(P*100).toFixed(0)}%`,children:k.map((I,P)=>d.jsx(g5,{fill:I.color||wu.primary},`cell-${P}`))}),d.jsx(Cg,{content:d.jsx(Gg,{})}),d.jsx(V0,{})]})})})}),d.jsx(Bt,{item:!0,xs:12,md:6,children:d.jsx(yu,{title:"Complaints by Issue Type",action:d.jsx(Tn,{size:"small",onClick:()=>b(),children:"Export"}),children:d.jsx(xg,{width:"100%",height:300,children:d.jsxs(y5,{data:M,layout:"vertical",margin:{top:5,right:30,left:20,bottom:5},children:[d.jsx(B0,{strokeDasharray:"3 3"}),d.jsx(U0,{type:"number"}),d.jsx(H0,{dataKey:"name",type:"category",width:100}),d.jsx(Cg,{content:d.jsx(Gg,{})}),d.jsx(w5,{dataKey:"value",fill:wu.primary,name:"Count"})]})})})}),d.jsx(Bt,{item:!0,xs:12,children:d.jsx(yu,{title:"Complaints Over Time",subtitle:`Last ${a} days`,action:d.jsx(Tn,{size:"small",onClick:()=>b(),children:"Export"}),children:d.jsx(xg,{width:"100%",height:400,children:d.jsxs(b5,{data:A.timeSeriesData||[],margin:{top:5,right:30,left:20,bottom:5},children:[d.jsx(B0,{strokeDasharray:"3 3"}),d.jsx(U0,{dataKey:"date"}),d.jsx(H0,{}),d.jsx(Cg,{content:d.jsx(Gg,{})}),d.jsx(V0,{}),d.jsx(v5,{type:"monotone",dataKey:"count",name:"Number of Complaints",stroke:wu.primary,activeDot:{r:8}})]})})})}),d.jsx(Bt,{item:!0,xs:12,children:d.jsx(yu,{title:"Status Over Time",subtitle:`Stacked distribution across ${a==="all"?"all time":`last ${a} days`}`,children:d.jsx(xg,{width:"100%",height:360,children:d.jsxs(x5,{data:A.statusOverTime||[],margin:{top:5,right:30,left:20,bottom:5},children:[d.jsx(B0,{strokeDasharray:"3 3"}),d.jsx(U0,{dataKey:"date"}),d.jsx(H0,{}),d.jsx(Cg,{content:d.jsx(Gg,{})}),d.jsx(V0,{}),d.jsx(Eg,{type:"monotone",dataKey:"pending",stackId:"1",name:"Pending",fill:"#3b82f6",stroke:"#3b82f6"}),d.jsx(Eg,{type:"monotone",dataKey:"inProgress",stackId:"1",name:"In Progress",fill:"#f59e0b",stroke:"#f59e0b"}),d.jsx(Eg,{type:"monotone",dataKey:"solved",stackId:"1",name:"Solved",fill:"#10b981",stroke:"#10b981"}),d.jsx(Eg,{type:"monotone",dataKey:"rejected",stackId:"1",name:"Rejected",fill:"#ef4444",stroke:"#ef4444"})]})})})}),d.jsx(Bt,{item:!0,xs:12,md:6,children:d.jsx(yu,{title:"Top Locations by Complaints",children:d.jsx(Z_,{component:wm,children:d.jsxs(eA,{size:"small",children:[d.jsx(tA,{children:d.jsxs(vg,{children:[d.jsx(ns,{children:"Location"}),d.jsx(ns,{align:"right",children:"Complaints"})]})}),d.jsx(nA,{children:(A.topLocations||[]).map(I=>d.jsxs(vg,{children:[d.jsx(ns,{children:I.name}),d.jsx(ns,{align:"right",children:I.count})]},I.name))})]})})})}),d.jsx(Bt,{item:!0,xs:12,md:6,children:d.jsx(yu,{title:"Recent Complaints",action:d.jsx(Tn,{size:"small",onClick:()=>b(),children:"Export"}),children:d.jsx(Z_,{component:wm,children:d.jsxs(eA,{size:"small",children:[d.jsx(tA,{children:d.jsxs(vg,{children:[d.jsx(ns,{children:"Date"}),d.jsx(ns,{children:"Issue Type"}),d.jsx(ns,{children:"Status"}),d.jsx(ns,{children:"Location"})]})}),d.jsx(nA,{children:A.recentComplaints?.slice(0,5).map(I=>d.jsxs(vg,{hover:!0,children:[d.jsx(ns,{children:ks(new Date(I.timestamp),"MMM dd, yyyy")}),d.jsx(ns,{children:I.issueType||"N/A"}),d.jsx(ns,{children:d.jsx(Ic,{label:I.status,size:"small",color:I.status==="solved"?"success":I.status==="inProgress"?"warning":"default"})}),d.jsx(ns,{children:I.location?.name||"N/A"})]},I.id))})]})})})})]})]}):d.jsx(We,{p:3,children:d.jsxs(We,{maxWidth:600,mx:"auto",textAlign:"center",mt:8,p:4,bgcolor:"#fff",borderRadius:2,boxShadow:"0 2px 12px rgba(0,0,0,0.05)",children:[d.jsx(We,{fontSize:64,color:"text.secondary",mb:2,sx:{opacity:.8,transform:"scale(1.2)",transition:"all 0.3s ease","&:hover":{transform:"scale(1.3) rotate(5deg)",opacity:1}},children:""}),d.jsx(wt,{variant:"h5",gutterBottom:!0,fontWeight:600,children:"No Data Available"}),d.jsx(wt,{color:"text.secondary",paragraph:!0,sx:{maxWidth:500,mx:"auto",mb:3},children:"We couldn't find any complaints for the selected time period. Try adjusting the time range or check back later."}),d.jsxs(We,{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap",children:[d.jsx(Tn,{variant:"contained",onClick:()=>l("all"),startIcon:d.jsx(Bk,{}),sx:{textTransform:"none",px:3,py:1,boxShadow:"0 2px 8px rgba(67, 97, 238, 0.3)","&:hover":{boxShadow:"0 4px 12px rgba(67, 97, 238, 0.4)"}},children:"View All Time"}),d.jsx(Tn,{variant:"outlined",onClick:N,startIcon:d.jsx(Lv,{}),sx:{textTransform:"none",borderColor:"rgba(0, 0, 0, 0.1)","&:hover":{borderColor:"primary.main",bgcolor:"rgba(67, 97, 238, 0.04)"}},children:"Refresh Data"})]}),d.jsx(We,{mt:4,pt:3,borderTop:"1px solid",borderColor:"divider",children:d.jsxs(wt,{variant:"caption",color:"text.secondary",children:["Last updated: ",ks(g,"MMM d, yyyy h:mm a")]})})]})})},Dae=()=>{const[t,e]=p.useState([]),[n,r]=p.useState(!1),[s,o]=p.useState(null),[i,a]=p.useState(!1);p.useEffect(()=>{let y=!0;const w=pI(v=>{if(!y)return;const C=(v||[]).map(x=>({...x,priority:l(x)}));e(C)},"official");return()=>{y=!1,w&&w()}},[]);const l=y=>{if(y.priority!=null){const x=String(y.priority).toLowerCase();if(x.includes("high")||x==="2"||x==="3"||x==="urgent")return"High";if(x.includes("medium")||x==="1")return"Medium";if(x.includes("low")||x==="0")return"Low"}const w=`${y.reason||""} ${y.description||""}`.toLowerCase(),v=["urgent","emergency","accident","fire","flood","collapsed","contaminated","gas leak","electric shock","blocked road"],C=["traffic","signal","garbage","pothole","water leak","sewage","overflow","streetlight"];return v.some(x=>w.includes(x))?"High":C.some(x=>w.includes(x))?"Medium":"Low"},c=p.useCallback(y=>{o(y),r(!0)},[]),u=async(y,w)=>{if(y)try{a(!0);const v=tt(Oe,"complaints",y);await Ii(v,{status:w}),e(C=>C.map(x=>x.id===y?{...x,status:w}:x)),o(C=>C?.id===y?{...C,status:w}:C)}catch(v){console.error("Error updating status from modal:",v)}finally{a(!1)}},h={High:[],Medium:[],Low:[]};(t||[]).forEach(y=>{const w=y.priority||"Low";h[w]=h[w]||[],h[w].push(y)});const f=["High","Medium","Low"],g={High:"error",Medium:"warning",Low:"success"};return d.jsxs("div",{className:"min-h-screen w-full p-4 md:p-8 bg-gray-50",children:[d.jsx("div",{className:"flex justify-between items-center mb-6",children:d.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Priority Overview"})}),d.jsx(Bt,{container:!0,spacing:2,children:f.map(y=>d.jsxs(Bt,{item:!0,xs:12,md:4,children:[d.jsxs(We,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[d.jsxs(wt,{variant:"h6",children:[y," Priority"]}),d.jsx(Ic,{label:`${h[y]?.length||0}`,color:g[y],size:"small"})]}),d.jsxs(Bt,{container:!0,spacing:2,children:[(h[y]||[]).slice(0,12).map(w=>d.jsx(Bt,{item:!0,xs:12,children:d.jsxs(ab,{variant:"outlined",sx:{borderLeft:"4px solid",borderLeftColor:y==="High"?"error.main":y==="Medium"?"warning.main":"success.main",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:2}},children:[d.jsxs(lb,{sx:{pb:1},children:[d.jsx(wt,{variant:"subtitle1",fontWeight:600,noWrap:!0,children:w.reason||"Issue"}),d.jsx(wt,{variant:"body2",color:"text.secondary",noWrap:!0,children:w.description||""}),d.jsxs(We,{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1,children:[d.jsx(wt,{variant:"caption",color:"text.secondary",children:w.author||"Unknown"}),d.jsx(wt,{variant:"caption",color:"text.secondary",children:(()=>{try{return new Date(w.timestamp).toLocaleDateString()}catch{return"N/A"}})()})]})]}),d.jsx(M2,{sx:{pt:0,pb:1,px:2},children:d.jsx(Tn,{size:"small",onClick:()=>c(w),children:"View"})})]})},w.id)),(h[y]||[]).length===0&&d.jsx(Bt,{item:!0,xs:12,children:d.jsx(We,{py:4,textAlign:"center",color:"text.secondary",children:"No items"})})]})]},y))}),d.jsx(Wb,{open:n,onClose:()=>r(!1),complaint:s||{},onStatusUpdate:u})]})},Mae=({onRecordingComplete:t,onClearRecording:e})=>{const[n,r]=p.useState(!1),[s,o]=p.useState(0),[i,a]=p.useState(null),[l,c]=p.useState(null),[u,h]=p.useState(""),f=p.useRef(null),g=p.useRef([]),y=async()=>{try{u&&URL.revokeObjectURL(u),c(null),h(""),o(0),g.current=[];const M=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(E=>{throw console.error("Microphone access denied:",E),new Error("Microphone access was denied. Please allow microphone access to record audio.")}),k=new MediaRecorder(M);k.ondataavailable=E=>{E.data.size>0&&g.current.push(E.data)},k.onstart=()=>{console.log("Recording started"),C()},k.onstop=()=>{console.log("Recording stopped"),x();try{const E=new Blob(g.current,{type:"audio/wav"});if(console.log("Audio blob created, size:",E.size),E.size===0)throw new Error("Recording produced no audio data");const b=URL.createObjectURL(E);console.log("Audio URL created"),c(E),h(b),t?.(E)}catch(E){console.error("Error creating audio blob:",E),alert("Failed to process recording. Please try again.")}finally{M.getTracks().forEach(E=>E.stop())}},k.start(100),a(k),r(!0)}catch(M){throw console.error("Error in startRecording:",M),alert(M.message||"Could not start recording. Please try again."),M}},w=()=>{if(i&&n){console.log("Stopping recording...");try{i.state!=="inactive"&&(i.requestData(),i.stop()),r(!1)}catch(M){console.error("Error stopping recording:",M),i.stream?.getTracks().forEach(k=>k.stop()),r(!1),x()}}},v=()=>{if(i)try{i.state!=="inactive"&&i.stop()}catch(M){console.warn("Error stopping media recorder:",M)}u&&URL.revokeObjectURL(u),c(null),h(""),o(0),g.current=[],e?.()},C=()=>{x();const M=Date.now()-s*1e3,k=()=>{const E=Math.floor((Date.now()-M)/1e3);o(E)};k(),f.current=setInterval(k,1e3)},x=()=>{f.current&&(clearInterval(f.current),f.current=null)},A=M=>{const k=Math.floor(M/60),E=M%60;return`${k.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`},N=M=>{if(M===0)return"0 Bytes";const k=1024,E=["Bytes","KB","MB","GB"],b=Math.floor(Math.log(M)/Math.log(k));return parseFloat((M/Math.pow(k,b)).toFixed(2))+" "+E[b]};return p.useEffect(()=>()=>{if(x(),i&&i.state!=="inactive")try{i.stop()}catch(M){console.warn("Error stopping media recorder:",M)}if(u)try{URL.revokeObjectURL(u)}catch(M){console.warn("Error revoking object URL:",M)}},[i,u]),p.useEffect(()=>{const M=()=>{u&&URL.revokeObjectURL(u)};return window.addEventListener("beforeunload",M),()=>{window.removeEventListener("beforeunload",M)}},[u]),d.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-white shadow-sm",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[!n&&!u&&d.jsxs(Vn,{type:"button",variant:"outline",size:"sm",onClick:y,className:"gap-2",children:[d.jsx(YG,{className:"h-4 w-4"}),"Record Voice Note"]}),n&&d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsxs("span",{className:"flex items-center text-sm text-red-600",children:[d.jsx("span",{className:"w-2 h-2 rounded-full bg-red-600 mr-2 animate-pulse"}),"Recording... ",A(s)]}),d.jsxs(Vn,{type:"button",variant:"destructive",size:"sm",onClick:w,className:"gap-2",children:[d.jsx(c7,{className:"h-4 w-4"}),"Stop"]})]})]}),u&&l&&d.jsx("div",{className:"mt-4 space-y-2",children:d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"flex items-center bg-gray-50 rounded-lg p-2",children:d.jsx("audio",{src:u,controls:!0,className:"h-8 w-full",controlsList:"nodownload",onError:M=>{if(console.error("Error playing audio:",M),l)try{const k=URL.createObjectURL(l);M.target.src=k,URL.revokeObjectURL(u),h(k)}catch(k){console.error("Error recovering audio URL:",k)}}})}),d.jsx("p",{className:"text-xs text-gray-500 mt-1 text-right",children:N(l.size)})]}),d.jsx(Vn,{type:"button",variant:"ghost",size:"sm",onClick:v,className:"text-red-500 hover:bg-red-50 hover:text-red-600 flex-shrink-0",title:"Delete recording",children:d.jsx(f7,{className:"h-4 w-4"})})]})}),!n&&!u&&d.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Click the record button to record a voice note (max 5 minutes)"})]})},sV=({value:t,onChange:e,options:n=[],placeholder:r="Select",className:s="",...o})=>{const[i,a]=p.useState(!1),l=p.useRef(null);p.useEffect(()=>{const u=h=>{l.current&&(l.current.contains(h.target)||a(!1))};return document.addEventListener("click",u),()=>document.removeEventListener("click",u)},[]);const c=n.find(u=>u.value===t);return d.jsxs("div",{ref:l,className:"relative",children:[d.jsxs("button",{type:"button",className:`w-full text-left appearance-none pl-3 pr-10 h-10 sm:h-11 md:h-12 text-sm sm:text-base border rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition ${s}`,onClick:()=>a(u=>!u),"aria-haspopup":"listbox","aria-expanded":i,...o,children:[d.jsx("span",{className:`block truncate ${c?"text-gray-900":"text-gray-400"}`,children:c?c.label:r}),d.jsx("svg",{className:`pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500 transition-transform ${i?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:d.jsx("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.172l3.71-3.94a.75.75 0 111.08 1.04l-4.24 4.5a.75.75 0 01-1.08 0l-4.24-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"})})]}),i&&d.jsx("ul",{role:"listbox",className:"absolute z-20 mt-1 max-h-60 w-full overflow-auto rounded-md border border-gray-200 bg-white py-1 text-sm shadow-lg",children:n.map(u=>{const h=u.value===t;return d.jsx("li",{role:"option","aria-selected":h,onClick:()=>{e?.(u.value),a(!1)},className:`cursor-pointer select-none px-3 py-1.5 hover:bg-gray-50 ${h?"bg-emerald-50 text-emerald-700":"text-gray-900"}`,children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("svg",{className:`h-4 w-4 transition-opacity ${h?"opacity-100 text-emerald-600":"opacity-0 text-transparent"}`,viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:d.jsx("path",{fillRule:"evenodd",d:"M16.704 5.29a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25A1 1 0 116.204 9.54l2.543 2.543 6.543-6.543a1 1 0 011.414 0z",clipRule:"evenodd"})}),d.jsx("span",{className:"truncate",children:u.label})]})},u.value)})})]})},Oae="6.15.0";function Lae(t,e,n){const r=e.split("|").map(o=>o.trim());for(let o=0;o<r.length;o++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${n}`,s.value=t,s}async function mr(t){const e=Object.keys(t);return(await Promise.all(e.map(r=>Promise.resolve(t[r])))).reduce((r,s,o)=>(r[e[o]]=s,r),{})}function Je(t,e,n){for(let r in e){let s=e[r];const o=n?n[r]:null;o&&Lae(s,o,r),Object.defineProperty(t,r,{enumerable:!0,value:s,writable:!1})}}function Vu(t,e){if(t==null)return"null";if(e==null&&(e=new Set),typeof t=="object"){if(e.has(t))return"[Circular]";e.add(t)}if(Array.isArray(t))return"[ "+t.map(n=>Vu(n,e)).join(", ")+" ]";if(t instanceof Uint8Array){const n="0123456789abcdef";let r="0x";for(let s=0;s<t.length;s++)r+=n[t[s]>>4],r+=n[t[s]&15];return r}if(typeof t=="object"&&typeof t.toJSON=="function")return Vu(t.toJSON(),e);switch(typeof t){case"boolean":case"number":case"symbol":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const n=Object.keys(t);return n.sort(),"{ "+n.map(r=>`${Vu(r,e)}: ${Vu(t[r],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function qn(t,e){return t&&t.code===e}function VI(t){return qn(t,"CALL_EXCEPTION")}function qt(t,e,n){let r=t;{const o=[];if(n){if("message"in n||"code"in n||"name"in n)throw new Error(`value will overwrite populated values: ${Vu(n)}`);for(const i in n){if(i==="shortMessage")continue;const a=n[i];o.push(i+"="+Vu(a))}}o.push(`code=${e}`),o.push(`version=${Oae}`),o.length&&(t+=" ("+o.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(t);break;default:s=new Error(t)}return Je(s,{code:e}),n&&Object.assign(s,n),s.shortMessage==null&&Je(s,{shortMessage:r}),s}function xe(t,e,n,r){if(!t)throw qt(e,n,r)}function J(t,e,n,r){xe(t,e,"INVALID_ARGUMENT",{argument:n,value:r})}function oV(t,e,n){n==null&&(n=""),n&&(n=": "+n),xe(t>=e,"missing argument"+n,"MISSING_ARGUMENT",{count:t,expectedCount:e}),xe(t<=e,"too many arguments"+n,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"".normalize("NFD")!=="e")throw new Error("broken");t.push(e)}catch{}return t},[]);function o0(t,e,n){if(n==null&&(n=""),t!==e){let r=n,s="new";n&&(r+=".",s+=" "+n),xe(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function iV(t,e,n){if(t instanceof Uint8Array)return n?new Uint8Array(t):t;if(typeof t=="string"&&t.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const r=new Uint8Array((t.length-2)/2);let s=2;for(let o=0;o<r.length;o++)r[o]=parseInt(t.substring(s,s+2),16),s+=2;return r}J(!1,"invalid BytesLike value",e||"value",t)}function dt(t,e){return iV(t,e,!1)}function wr(t,e){return iV(t,e,!0)}function Ht(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&t.length!==2+2*e||e===!0&&t.length%2!==0)}function BI(t){return Ht(t,!0)||t instanceof Uint8Array}const Hk="0123456789abcdef";function Ne(t){const e=dt(t);let n="0x";for(let r=0;r<e.length;r++){const s=e[r];n+=Hk[(s&240)>>4]+Hk[s&15]}return n}function cn(t){return"0x"+t.map(e=>Ne(e).substring(2)).join("")}function Ju(t){return Ht(t,!0)?(t.length-2)/2:dt(t).length}function on(t,e,n){const r=dt(t);return n!=null&&n>r.length&&xe(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n}),Ne(r.slice(e??0,n??r.length))}function aV(t,e,n){const r=dt(t);xe(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),n?s.set(r,e-r.length):s.set(r,0),Ne(s)}function Ti(t,e){return aV(t,e,!0)}function Fae(t,e){return aV(t,e,!1)}const i0=BigInt(0),$s=BigInt(1),Bu=9007199254740991;function jae(t,e){const n=a0(t,"value"),r=BigInt(ht(e,"width"));if(xe(n>>r===i0,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),n>>r-$s){const s=($s<<r)-$s;return-((~n&s)+$s)}return n}function lV(t,e){let n=Ve(t,"value");const r=BigInt(ht(e,"width")),s=$s<<r-$s;if(n<i0){n=-n,xe(n<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});const o=($s<<r)-$s;return(~n&o)+$s}else xe(n<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});return n}function Hf(t,e){const n=a0(t,"value"),r=BigInt(ht(e,"bits"));return n&($s<<r)-$s}function Ve(t,e){switch(typeof t){case"bigint":return t;case"number":return J(Number.isInteger(t),"underflow",e||"value",t),J(t>=-Bu&&t<=Bu,"overflow",e||"value",t),BigInt(t);case"string":try{if(t==="")throw new Error("empty string");return t[0]==="-"&&t[1]!=="-"?-BigInt(t.substring(1)):BigInt(t)}catch(n){J(!1,`invalid BigNumberish string: ${n.message}`,e||"value",t)}}J(!1,"invalid BigNumberish value",e||"value",t)}function a0(t,e){const n=Ve(t,e);return xe(n>=i0,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),n}const $k="0123456789abcdef";function UI(t){if(t instanceof Uint8Array){let e="0x0";for(const n of t)e+=$k[n>>4],e+=$k[n&15];return BigInt(e)}return Ve(t)}function ht(t,e){switch(typeof t){case"bigint":return J(t>=-Bu&&t<=Bu,"overflow",e||"value",t),Number(t);case"number":return J(Number.isInteger(t),"underflow",e||"value",t),J(t>=-Bu&&t<=Bu,"overflow",e||"value",t),t;case"string":try{if(t==="")throw new Error("empty string");return ht(BigInt(t),e)}catch(n){J(!1,`invalid numeric string: ${n.message}`,e||"value",t)}}J(!1,"invalid numeric value",e||"value",t)}function Vae(t){return ht(UI(t))}function Ga(t,e){let r=a0(t,"value").toString(16);if(e==null)r.length%2&&(r="0"+r);else{const s=ht(e,"width");for(xe(s*2>=r.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});r.length<s*2;)r="0"+r}return"0x"+r}function kn(t){const e=a0(t,"value");if(e===i0)return new Uint8Array([]);let n=e.toString(16);n.length%2&&(n="0"+n);const r=new Uint8Array(n.length/2);for(let s=0;s<r.length;s++){const o=s*2;r[s]=parseInt(n.substring(o,o+2),16)}return r}function Hs(t){let e=Ne(BI(t)?t:kn(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const zk="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const Gk=BigInt(58);function Bae(t){const e=dt(t);let n=UI(e),r="";for(;n;)r=zk[Number(n%Gk)]+r,n/=Gk;for(let s=0;s<e.length&&!e[s];s++)r=zk[0]+r;return r}function Uae(t){t=atob(t);const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return dt(e)}function Hae(t){const e=dt(t);let n="";for(let r=0;r<e.length;r++)n+=String.fromCharCode(e[r]);return btoa(n)}var ed;class cV{constructor(e,n,r){oe(this,"filter");oe(this,"emitter");ce(this,ed);G(this,ed,n),Je(this,{emitter:e,filter:r})}async removeListener(){H(this,ed)!=null&&await this.emitter.off(this.filter,H(this,ed))}}ed=new WeakMap;function $ae(t,e,n,r,s){J(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",n)}function uV(t,e,n,r,s){if(t==="BAD_PREFIX"||t==="UNEXPECTED_CONTINUE"){let o=0;for(let i=e+1;i<n.length&&n[i]>>6===2;i++)o++;return o}return t==="OVERRUN"?n.length-e-1:0}function zae(t,e,n,r,s){return t==="OVERLONG"?(J(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),r.push(s),0):(r.push(65533),uV(t,e,n))}const Gae=Object.freeze({error:$ae,ignore:uV,replace:zae});function Wae(t,e){e==null&&(e=Gae.error);const n=dt(t,"bytes"),r=[];let s=0;for(;s<n.length;){const o=n[s++];if(o>>7===0){r.push(o);continue}let i=null,a=null;if((o&224)===192)i=1,a=127;else if((o&240)===224)i=2,a=2047;else if((o&248)===240)i=3,a=65535;else{(o&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,n,r):s+=e("BAD_PREFIX",s-1,n,r);continue}if(s-1+i>=n.length){s+=e("OVERRUN",s-1,n,r);continue}let l=o&(1<<8-i-1)-1;for(let c=0;c<i;c++){let u=n[s];if((u&192)!=128){s+=e("MISSING_CONTINUE",s,n,r),l=null;break}l=l<<6|u&63,s++}if(l!==null){if(l>1114111){s+=e("OUT_OF_RANGE",s-1-i,n,r,l);continue}if(l>=55296&&l<=57343){s+=e("UTF16_SURROGATE",s-1-i,n,r,l);continue}if(l<=a){s+=e("OVERLONG",s-1-i,n,r,l);continue}r.push(l)}}return r}function Lo(t,e){J(typeof t=="string","invalid string value","str",t);let n=[];for(let r=0;r<t.length;r++){const s=t.charCodeAt(r);if(s<128)n.push(s);else if(s<2048)n.push(s>>6|192),n.push(s&63|128);else if((s&64512)==55296){r++;const o=t.charCodeAt(r);J(r<t.length&&(o&64512)===56320,"invalid surrogate pair","str",t);const i=65536+((s&1023)<<10)+(o&1023);n.push(i>>18|240),n.push(i>>12&63|128),n.push(i>>6&63|128),n.push(i&63|128)}else n.push(s>>12|224),n.push(s>>6&63|128),n.push(s&63|128)}return new Uint8Array(n)}function Kae(t){return t.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function Vw(t,e){return Kae(Wae(t,e))}function dV(t){async function e(n,r){xe(r==null||!r.cancelled,"request cancelled before sending","CANCELLED");const s=n.url.split(":")[0].toLowerCase();xe(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),xe(s==="https"||!n.credentials||n.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let o=null;const i=new AbortController,a=setTimeout(()=>{o=qt("request timeout","TIMEOUT"),i.abort()},n.timeout);r&&r.addListener(()=>{o=qt("request cancelled","CANCELLED"),i.abort()});const l=Object.assign({},t,{method:n.method,headers:new Headers(Array.from(n)),body:n.body||void 0,signal:i.signal});let c;try{c=await fetch(n.url,l)}catch(g){throw clearTimeout(a),o||g}clearTimeout(a);const u={};c.headers.forEach((g,y)=>{u[y.toLowerCase()]=g});const h=await c.arrayBuffer(),f=h==null?null:new Uint8Array(h);return{statusCode:c.status,statusMessage:c.statusText,headers:u,body:f}}return e}const qae=12,Qae=250;let Wk=dV();const Yae=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Jae=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let Fv=!1;async function hV(t,e){try{const n=t.match(Yae);if(!n)throw new Error("invalid data");return new La(200,"OK",{"content-type":n[1]||"text/plain"},n[2]?Uae(n[3]):Zae(n[3]))}catch{return new La(599,"BAD REQUEST (invalid data: URI)",{},null,new Wa(t))}}function fV(t){async function e(n,r){try{const s=n.match(Jae);if(!s)throw new Error("invalid link");return new Wa(`${t}${s[2]}`)}catch{return new La(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Wa(n))}}return e}const Wg={data:hV,ipfs:fV("https://gateway.ipfs.io/ipfs/")},mV=new WeakMap;var zl,da;class Xae{constructor(e){ce(this,zl);ce(this,da);G(this,zl,[]),G(this,da,!1),mV.set(e,()=>{if(!H(this,da)){G(this,da,!0);for(const n of H(this,zl))setTimeout(()=>{n()},0);G(this,zl,[])}})}addListener(e){xe(!H(this,da),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),H(this,zl).push(e)}get cancelled(){return H(this,da)}checkSignal(){xe(!this.cancelled,"cancelled","CANCELLED",{})}}zl=new WeakMap,da=new WeakMap;function Kg(t){if(t==null)throw new Error("missing signal; should not happen");return t.checkSignal(),t}var td,nd,Os,Xo,rd,sd,On,$r,Zo,Gl,Wl,Kl,io,Ls,ha,ql,$f;const Zw=class Zw{constructor(e){ce(this,ql);ce(this,td);ce(this,nd);ce(this,Os);ce(this,Xo);ce(this,rd);ce(this,sd);ce(this,On);ce(this,$r);ce(this,Zo);ce(this,Gl);ce(this,Wl);ce(this,Kl);ce(this,io);ce(this,Ls);ce(this,ha);G(this,sd,String(e)),G(this,td,!1),G(this,nd,!0),G(this,Os,{}),G(this,Xo,""),G(this,rd,3e5),G(this,Ls,{slotInterval:Qae,maxAttempts:qae}),G(this,ha,null)}get url(){return H(this,sd)}set url(e){G(this,sd,String(e))}get body(){return H(this,On)==null?null:new Uint8Array(H(this,On))}set body(e){if(e==null)G(this,On,void 0),G(this,$r,void 0);else if(typeof e=="string")G(this,On,Lo(e)),G(this,$r,"text/plain");else if(e instanceof Uint8Array)G(this,On,e),G(this,$r,"application/octet-stream");else if(typeof e=="object")G(this,On,Lo(JSON.stringify(e))),G(this,$r,"application/json");else throw new Error("invalid body")}hasBody(){return H(this,On)!=null}get method(){return H(this,Xo)?H(this,Xo):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),G(this,Xo,String(e).toUpperCase())}get headers(){const e=Object.assign({},H(this,Os));return H(this,Zo)&&(e.authorization=`Basic ${Hae(Lo(H(this,Zo)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&H(this,$r)&&(e["content-type"]=H(this,$r)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,n){H(this,Os)[String(e).toLowerCase()]=String(n)}clearHeaders(){G(this,Os,{})}[Symbol.iterator](){const e=this.headers,n=Object.keys(e);let r=0;return{next:()=>{if(r<n.length){const s=n[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return H(this,Zo)||null}setCredentials(e,n){J(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),G(this,Zo,`${e}:${n}`)}get allowGzip(){return H(this,nd)}set allowGzip(e){G(this,nd,!!e)}get allowInsecureAuthentication(){return!!H(this,td)}set allowInsecureAuthentication(e){G(this,td,!!e)}get timeout(){return H(this,rd)}set timeout(e){J(e>=0,"timeout must be non-zero","timeout",e),G(this,rd,e)}get preflightFunc(){return H(this,Gl)||null}set preflightFunc(e){G(this,Gl,e)}get processFunc(){return H(this,Wl)||null}set processFunc(e){G(this,Wl,e)}get retryFunc(){return H(this,Kl)||null}set retryFunc(e){G(this,Kl,e)}get getUrlFunc(){return H(this,ha)||Wk}set getUrlFunc(e){G(this,ha,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${H(this,On)?Ne(H(this,On)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(H(this,Ls).slotInterval=e.slotInterval),e.maxAttempts!=null&&(H(this,Ls).maxAttempts=e.maxAttempts)}send(){return xe(H(this,io)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),G(this,io,new Xae(this)),ke(this,ql,$f).call(this,0,Kk()+this.timeout,0,this,new La(0,"",{},null,this))}cancel(){xe(H(this,io)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=mV.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const n=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();xe(this.method==="GET"&&(n!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new Zw(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,G(s,Os,Object.assign({},H(this,Os))),H(this,On)&&G(s,On,new Uint8Array(H(this,On))),G(s,$r,H(this,$r)),s}clone(){const e=new Zw(this.url);return G(e,Xo,H(this,Xo)),H(this,On)&&G(e,On,H(this,On)),G(e,$r,H(this,$r)),G(e,Os,Object.assign({},H(this,Os))),G(e,Zo,H(this,Zo)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),G(e,Gl,H(this,Gl)),G(e,Wl,H(this,Wl)),G(e,Kl,H(this,Kl)),G(e,Ls,Object.assign({},H(this,Ls))),G(e,ha,H(this,ha)),e}static lockConfig(){Fv=!0}static getGateway(e){return Wg[e.toLowerCase()]||null}static registerGateway(e,n){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(Fv)throw new Error("gateways locked");Wg[e]=n}static registerGetUrl(e){if(Fv)throw new Error("gateways locked");Wk=e}static createGetUrlFunc(e){return dV(e)}static createDataGateway(){return hV}static createIpfsGatewayFunc(e){return fV(e)}};td=new WeakMap,nd=new WeakMap,Os=new WeakMap,Xo=new WeakMap,rd=new WeakMap,sd=new WeakMap,On=new WeakMap,$r=new WeakMap,Zo=new WeakMap,Gl=new WeakMap,Wl=new WeakMap,Kl=new WeakMap,io=new WeakMap,Ls=new WeakMap,ha=new WeakMap,ql=new WeakSet,$f=async function(e,n,r,s,o){var u,h,f;if(e>=H(this,Ls).maxAttempts)return o.makeServerError("exceeded maximum retry limit");xe(Kk()<=n,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),r>0&&await ele(r);let i=this.clone();const a=(i.url.split(":")[0]||"").toLowerCase();if(a in Wg){const g=await Wg[a](i.url,Kg(H(s,io)));if(g instanceof La){let y=g;if(this.processFunc){Kg(H(s,io));try{y=await this.processFunc(i,y)}catch(w){(w.throttle==null||typeof w.stall!="number")&&y.makeServerError("error in post-processing function",w).assertOk()}}return y}i=g}this.preflightFunc&&(i=await this.preflightFunc(i));const l=await this.getUrlFunc(i,Kg(H(s,io)));let c=new La(l.statusCode,l.statusMessage,l.headers,l.body,s);if(c.statusCode===301||c.statusCode===302){try{const g=c.headers.location||"";return ke(u=i.redirect(g),ql,$f).call(u,e+1,n,0,s,c)}catch{}return c}else if(c.statusCode===429&&(this.retryFunc==null||await this.retryFunc(i,c,e))){const g=c.headers["retry-after"];let y=H(this,Ls).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof g=="string"&&g.match(/^[1-9][0-9]*$/)&&(y=parseInt(g)),ke(h=i.clone(),ql,$f).call(h,e+1,n,y,s,c)}if(this.processFunc){Kg(H(s,io));try{c=await this.processFunc(i,c)}catch(g){(g.throttle==null||typeof g.stall!="number")&&c.makeServerError("error in post-processing function",g).assertOk();let y=H(this,Ls).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return g.stall>=0&&(y=g.stall),ke(f=i.clone(),ql,$f).call(f,e+1,n,y,s,c)}}return c};let Wa=Zw;var sp,op,ip,zr,od,Ql;const d_=class d_{constructor(e,n,r,s,o){ce(this,sp);ce(this,op);ce(this,ip);ce(this,zr);ce(this,od);ce(this,Ql);G(this,sp,e),G(this,op,n),G(this,ip,Object.keys(r).reduce((i,a)=>(i[a.toLowerCase()]=String(r[a]),i),{})),G(this,zr,s==null?null:new Uint8Array(s)),G(this,od,o||null),G(this,Ql,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${H(this,zr)?Ne(H(this,zr)):"null"}>`}get statusCode(){return H(this,sp)}get statusMessage(){return H(this,op)}get headers(){return Object.assign({},H(this,ip))}get body(){return H(this,zr)==null?null:new Uint8Array(H(this,zr))}get bodyText(){try{return H(this,zr)==null?"":Vw(H(this,zr))}catch{xe(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{xe(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,n=Object.keys(e);let r=0;return{next:()=>{if(r<n.length){const s=n[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,n){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new d_(599,r,this.headers,this.body,H(this,od)||void 0);return G(s,Ql,{message:e,error:n}),s}throwThrottleError(e,n){n==null?n=-1:J(Number.isInteger(n)&&n>=0,"invalid stall timeout","stall",n);const r=new Error(e||"throttling requests");throw Je(r,{stall:n,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return H(this,zr)!=null}get request(){return H(this,od)}ok(){return H(this,Ql).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:n}=H(this,Ql);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let s=null;try{H(this,zr)&&(s=Vw(H(this,zr)))}catch{}xe(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:n,info:{requestUrl:r,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};sp=new WeakMap,op=new WeakMap,ip=new WeakMap,zr=new WeakMap,od=new WeakMap,Ql=new WeakMap;let La=d_;function Kk(){return new Date().getTime()}function Zae(t){return Lo(t.replace(/%([0-9a-f][0-9a-f])/gi,(e,n)=>String.fromCharCode(parseInt(n,16))))}function ele(t){return new Promise(e=>setTimeout(e,t))}function tle(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function qk(t,e,n){let r=0;for(let s=0;s<n;s++)r=r*256+t[e+s];return r}function Qk(t,e,n,r){const s=[];for(;n<e+1+r;){const o=pV(t,n);s.push(o.result),n+=o.consumed,xe(n<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:t,length:r,offset:e})}return{consumed:1+r,result:s}}function pV(t,e){xe(t.length!==0,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const n=r=>{xe(r<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:r})};if(t[e]>=248){const r=t[e]-247;n(e+1+r);const s=qk(t,e+1,r);return n(e+1+r+s),Qk(t,e,e+1+r,r+s)}else if(t[e]>=192){const r=t[e]-192;return n(e+1+r),Qk(t,e,e+1,r)}else if(t[e]>=184){const r=t[e]-183;n(e+1+r);const s=qk(t,e+1,r);n(e+1+r+s);const o=Ne(t.slice(e+1+r,e+1+r+s));return{consumed:1+r+s,result:o}}else if(t[e]>=128){const r=t[e]-128;n(e+1+r);const s=Ne(t.slice(e+1,e+1+r));return{consumed:1+r,result:s}}return{consumed:1,result:tle(t[e])}}function tg(t){const e=dt(t,"data"),n=pV(e,0);return J(n.consumed===e.length,"unexpected junk after rlp payload","data",t),n.result}function Yk(t){const e=[];for(;t;)e.unshift(t&255),t>>=8;return e}function gV(t){if(Array.isArray(t)){let r=[];if(t.forEach(function(o){r=r.concat(gV(o))}),r.length<=55)return r.unshift(192+r.length),r;const s=Yk(r.length);return s.unshift(247+s.length),s.concat(r)}const e=Array.prototype.slice.call(dt(t,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const n=Yk(e.length);return n.unshift(183+n.length),n.concat(e)}const Jk="0123456789abcdef";function Ka(t){let e="0x";for(const n of gV(t))e+=Jk[n>>4],e+=Jk[n&15];return e}const vr=32,PC=new Uint8Array(vr),nle=["then"],qg={},yV=new WeakMap;function Dl(t){return yV.get(t)}function Xk(t,e){yV.set(t,e)}function _f(t,e){const n=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw n.error=e,n}function kC(t,e,n){return t.indexOf(null)>=0?e.map((r,s)=>r instanceof uh?kC(Dl(r),r,n):r):t.reduce((r,s,o)=>{let i=e.getValue(s);return s in r||(n&&i instanceof uh&&(i=kC(Dl(i),i,n)),r[s]=i),r},{})}var id;const Uu=class Uu extends Array{constructor(...n){const r=n[0];let s=n[1],o=(n[2]||[]).slice(),i=!0;r!==qg&&(s=n,o=[],i=!1);super(s.length);ce(this,id);s.forEach((c,u)=>{this[u]=c});const a=o.reduce((c,u)=>(typeof u=="string"&&c.set(u,(c.get(u)||0)+1),c),new Map);if(Xk(this,Object.freeze(s.map((c,u)=>{const h=o[u];return h!=null&&a.get(h)===1?h:null}))),G(this,id,[]),H(this,id)==null&&H(this,id),!i)return;Object.freeze(this);const l=new Proxy(this,{get:(c,u,h)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const g=ht(u,"%index");if(g<0||g>=this.length)throw new RangeError("out of result range");const y=c[g];return y instanceof Error&&_f(`index ${g}`,y),y}if(nle.indexOf(u)>=0)return Reflect.get(c,u,h);const f=c[u];if(f instanceof Function)return function(...g){return f.apply(this===h?c:this,g)};if(!(u in c))return c.getValue.apply(this===h?c:this,[u])}return Reflect.get(c,u,h)}});return Xk(l,Dl(this)),l}toArray(n){const r=[];return this.forEach((s,o)=>{s instanceof Error&&_f(`index ${o}`,s),n&&s instanceof Uu&&(s=s.toArray(n)),r.push(s)}),r}toObject(n){const r=Dl(this);return r.reduce((s,o,i)=>(xe(o!=null,`value at index ${i} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),kC(r,this,n)),{})}slice(n,r){n==null&&(n=0),n<0&&(n+=this.length,n<0&&(n=0)),r==null&&(r=this.length),r<0&&(r+=this.length,r<0&&(r=0)),r>this.length&&(r=this.length);const s=Dl(this),o=[],i=[];for(let a=n;a<r;a++)o.push(this[a]),i.push(s[a]);return new Uu(qg,o,i)}filter(n,r){const s=Dl(this),o=[],i=[];for(let a=0;a<this.length;a++){const l=this[a];l instanceof Error&&_f(`index ${a}`,l),n.call(r,l,a,this)&&(o.push(l),i.push(s[a]))}return new Uu(qg,o,i)}map(n,r){const s=[];for(let o=0;o<this.length;o++){const i=this[o];i instanceof Error&&_f(`index ${o}`,i),s.push(n.call(r,i,o,this))}return s}getValue(n){const r=Dl(this).indexOf(n);if(r===-1)return;const s=this[r];return s instanceof Error&&_f(`property ${JSON.stringify(n)}`,s.error),s}static fromItems(n,r){return new Uu(qg,n,r)}};id=new WeakMap;let uh=Uu;function Zk(t){let e=kn(t);return xe(e.length<=vr,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:vr,offset:e.length}),e.length!==vr&&(e=wr(cn([PC.slice(e.length%vr),e]))),e}class Di{constructor(e,n,r,s){oe(this,"name");oe(this,"type");oe(this,"localName");oe(this,"dynamic");Je(this,{name:e,type:n,localName:r,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,n){J(!1,e,this.localName,n)}}var ei,Yl,ad,Ty;class RC{constructor(){ce(this,ad);ce(this,ei);ce(this,Yl);G(this,ei,[]),G(this,Yl,0)}get data(){return cn(H(this,ei))}get length(){return H(this,Yl)}appendWriter(e){return ke(this,ad,Ty).call(this,wr(e.data))}writeBytes(e){let n=wr(e);const r=n.length%vr;return r&&(n=wr(cn([n,PC.slice(r)]))),ke(this,ad,Ty).call(this,n)}writeValue(e){return ke(this,ad,Ty).call(this,Zk(e))}writeUpdatableValue(){const e=H(this,ei).length;return H(this,ei).push(PC),G(this,Yl,H(this,Yl)+vr),n=>{H(this,ei)[e]=Zk(n)}}}ei=new WeakMap,Yl=new WeakMap,ad=new WeakSet,Ty=function(e){return H(this,ei).push(e),G(this,Yl,H(this,Yl)+e.length),e.length};var Ar,Gr,Jl,Xl,fa,Wc,DC,wV;const h_=class h_{constructor(e,n,r){ce(this,Wc);oe(this,"allowLoose");ce(this,Ar);ce(this,Gr);ce(this,Jl);ce(this,Xl);ce(this,fa);Je(this,{allowLoose:!!n}),G(this,Ar,wr(e)),G(this,Jl,0),G(this,Xl,null),G(this,fa,r??1024),G(this,Gr,0)}get data(){return Ne(H(this,Ar))}get dataLength(){return H(this,Ar).length}get consumed(){return H(this,Gr)}get bytes(){return new Uint8Array(H(this,Ar))}subReader(e){const n=new h_(H(this,Ar).slice(H(this,Gr)+e),this.allowLoose,H(this,fa));return G(n,Xl,this),n}readBytes(e,n){let r=ke(this,Wc,wV).call(this,0,e,!!n);return ke(this,Wc,DC).call(this,e),G(this,Gr,H(this,Gr)+r.length),r.slice(0,e)}readValue(){return UI(this.readBytes(vr))}readIndex(){return Vae(this.readBytes(vr))}};Ar=new WeakMap,Gr=new WeakMap,Jl=new WeakMap,Xl=new WeakMap,fa=new WeakMap,Wc=new WeakSet,DC=function(e){var n;if(H(this,Xl))return ke(n=H(this,Xl),Wc,DC).call(n,e);G(this,Jl,H(this,Jl)+e),xe(H(this,fa)<1||H(this,Jl)<=H(this,fa)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${H(this,fa)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:wr(H(this,Ar)),offset:H(this,Gr),length:e,info:{bytesRead:H(this,Jl),dataLength:this.dataLength}})},wV=function(e,n,r){let s=Math.ceil(n/vr)*vr;return H(this,Gr)+s>H(this,Ar).length&&(this.allowLoose&&r&&H(this,Gr)+n<=H(this,Ar).length?s=n:xe(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:wr(H(this,Ar)),length:H(this,Ar).length,offset:H(this,Gr)+s})),H(this,Ar).slice(H(this,Gr),H(this,Gr)+s)};let NC=h_;function Bw(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function HI(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function rle(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Bw(t.outputLen),Bw(t.blockLen)}function dh(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function bV(t,e){HI(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const jv=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const vV=t=>t instanceof Uint8Array,sle=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Vv=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),no=(t,e)=>t<<32-e|t>>>e,ole=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ole)throw new Error("Non little-endian hardware is not supported");function ile(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function l0(t){if(typeof t=="string"&&(t=ile(t)),!vV(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function ale(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;return t.forEach(r=>{if(!vV(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}class $I{clone(){return this._cloneInto()}}function zI(t){const e=r=>t().update(l0(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function lle(t=32){if(jv&&typeof jv.getRandomValues=="function")return jv.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class xV extends $I{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,rle(e);const r=l0(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(r.length>s?e.create().update(r).digest():r);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=e.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),o.fill(0)}update(e){return dh(this),this.iHash.update(e),this}digestInto(e){dh(this),HI(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:o,blockLen:i,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=o,e.blockLen=i,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const CV=(t,e,n)=>new xV(t,e).update(n).digest();CV.create=(t,e)=>new xV(t,e);function cle(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),a=Number(n&o),l=r?4:0,c=r?0:4;t.setUint32(e+l,i,r),t.setUint32(e+c,a,r)}class EV extends $I{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Vv(this.buffer)}update(e){dh(this);const{view:n,buffer:r,blockLen:s}=this;e=l0(e);const o=e.length;for(let i=0;i<o;){const a=Math.min(s-this.pos,o-i);if(a===s){const l=Vv(e);for(;s<=o-i;i+=s)this.process(l,i);continue}r.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){dh(this),bV(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:o}=this;let{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let h=i;h<s;h++)n[h]=0;cle(r,s-8,BigInt(this.length*8),o),this.process(r,0);const a=Vv(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=l/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)a.setUint32(4*h,u[h],o)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:a}=this;return e.length=s,e.pos=a,e.finished=o,e.destroyed=i,s%n&&e.buffer.set(r),e}}const ule=(t,e,n)=>t&e^~t&n,dle=(t,e,n)=>t&e^t&n^e&n,hle=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qi=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qi=new Uint32Array(64);class fle extends EV{constructor(){super(64,32,8,!1),this.A=qi[0]|0,this.B=qi[1]|0,this.C=qi[2]|0,this.D=qi[3]|0,this.E=qi[4]|0,this.F=qi[5]|0,this.G=qi[6]|0,this.H=qi[7]|0}get(){const{A:e,B:n,C:r,D:s,E:o,F:i,G:a,H:l}=this;return[e,n,r,s,o,i,a,l]}set(e,n,r,s,o,i,a,l){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=a|0,this.H=l|0}process(e,n){for(let h=0;h<16;h++,n+=4)Qi[h]=e.getUint32(n,!1);for(let h=16;h<64;h++){const f=Qi[h-15],g=Qi[h-2],y=no(f,7)^no(f,18)^f>>>3,w=no(g,17)^no(g,19)^g>>>10;Qi[h]=w+Qi[h-7]+y+Qi[h-16]|0}let{A:r,B:s,C:o,D:i,E:a,F:l,G:c,H:u}=this;for(let h=0;h<64;h++){const f=no(a,6)^no(a,11)^no(a,25),g=u+f+ule(a,l,c)+hle[h]+Qi[h]|0,w=(no(r,2)^no(r,13)^no(r,22))+dle(r,s,o)|0;u=c,c=l,l=a,a=i+g|0,i=o,o=s,s=r,r=g+w|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,a=a+this.E|0,l=l+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,s,o,i,a,l,c,u)}roundClean(){Qi.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const IV=zI(()=>new fle),Qg=BigInt(2**32-1),MC=BigInt(32);function _V(t,e=!1){return e?{h:Number(t&Qg),l:Number(t>>MC&Qg)}:{h:Number(t>>MC&Qg)|0,l:Number(t&Qg)|0}}function AV(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:o,l:i}=_V(t[s],e);[n[s],r[s]]=[o,i]}return[n,r]}const mle=(t,e)=>BigInt(t>>>0)<<MC|BigInt(e>>>0),ple=(t,e,n)=>t>>>n,gle=(t,e,n)=>t<<32-n|e>>>n,yle=(t,e,n)=>t>>>n|e<<32-n,wle=(t,e,n)=>t<<32-n|e>>>n,ble=(t,e,n)=>t<<64-n|e>>>n-32,vle=(t,e,n)=>t>>>n-32|e<<64-n,xle=(t,e)=>e,Cle=(t,e)=>t,SV=(t,e,n)=>t<<n|e>>>32-n,TV=(t,e,n)=>e<<n|t>>>32-n,PV=(t,e,n)=>e<<n-32|t>>>64-n,kV=(t,e,n)=>t<<n-32|e>>>64-n;function Ele(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Ile=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),_le=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,Ale=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),Sle=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,Tle=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),Ple=(t,e,n,r,s,o)=>e+n+r+s+o+(t/2**32|0)|0,ot={fromBig:_V,split:AV,toBig:mle,shrSH:ple,shrSL:gle,rotrSH:yle,rotrSL:wle,rotrBH:ble,rotrBL:vle,rotr32H:xle,rotr32L:Cle,rotlSH:SV,rotlSL:TV,rotlBH:PV,rotlBL:kV,add:Ele,add3L:Ile,add3H:_le,add4L:Ale,add4H:Sle,add5H:Ple,add5L:Tle},[kle,Rle]=ot.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Yi=new Uint32Array(80),Ji=new Uint32Array(80);class Nle extends EV{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:o,Cl:i,Dh:a,Dl:l,Eh:c,El:u,Fh:h,Fl:f,Gh:g,Gl:y,Hh:w,Hl:v}=this;return[e,n,r,s,o,i,a,l,c,u,h,f,g,y,w,v]}set(e,n,r,s,o,i,a,l,c,u,h,f,g,y,w,v){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=o|0,this.Cl=i|0,this.Dh=a|0,this.Dl=l|0,this.Eh=c|0,this.El=u|0,this.Fh=h|0,this.Fl=f|0,this.Gh=g|0,this.Gl=y|0,this.Hh=w|0,this.Hl=v|0}process(e,n){for(let A=0;A<16;A++,n+=4)Yi[A]=e.getUint32(n),Ji[A]=e.getUint32(n+=4);for(let A=16;A<80;A++){const N=Yi[A-15]|0,M=Ji[A-15]|0,k=ot.rotrSH(N,M,1)^ot.rotrSH(N,M,8)^ot.shrSH(N,M,7),E=ot.rotrSL(N,M,1)^ot.rotrSL(N,M,8)^ot.shrSL(N,M,7),b=Yi[A-2]|0,I=Ji[A-2]|0,P=ot.rotrSH(b,I,19)^ot.rotrBH(b,I,61)^ot.shrSH(b,I,6),S=ot.rotrSL(b,I,19)^ot.rotrBL(b,I,61)^ot.shrSL(b,I,6),D=ot.add4L(E,S,Ji[A-7],Ji[A-16]),T=ot.add4H(D,k,P,Yi[A-7],Yi[A-16]);Yi[A]=T|0,Ji[A]=D|0}let{Ah:r,Al:s,Bh:o,Bl:i,Ch:a,Cl:l,Dh:c,Dl:u,Eh:h,El:f,Fh:g,Fl:y,Gh:w,Gl:v,Hh:C,Hl:x}=this;for(let A=0;A<80;A++){const N=ot.rotrSH(h,f,14)^ot.rotrSH(h,f,18)^ot.rotrBH(h,f,41),M=ot.rotrSL(h,f,14)^ot.rotrSL(h,f,18)^ot.rotrBL(h,f,41),k=h&g^~h&w,E=f&y^~f&v,b=ot.add5L(x,M,E,Rle[A],Ji[A]),I=ot.add5H(b,C,N,k,kle[A],Yi[A]),P=b|0,S=ot.rotrSH(r,s,28)^ot.rotrBH(r,s,34)^ot.rotrBH(r,s,39),D=ot.rotrSL(r,s,28)^ot.rotrBL(r,s,34)^ot.rotrBL(r,s,39),T=r&o^r&a^o&a,j=s&i^s&l^i&l;C=w|0,x=v|0,w=g|0,v=y|0,g=h|0,y=f|0,{h,l:f}=ot.add(c|0,u|0,I|0,P|0),c=a|0,u=l|0,a=o|0,l=i|0,o=r|0,i=s|0;const R=ot.add3L(P,D,j);r=ot.add3H(R,I,S,T),s=R|0}({h:r,l:s}=ot.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:o,l:i}=ot.add(this.Bh|0,this.Bl|0,o|0,i|0),{h:a,l}=ot.add(this.Ch|0,this.Cl|0,a|0,l|0),{h:c,l:u}=ot.add(this.Dh|0,this.Dl|0,c|0,u|0),{h,l:f}=ot.add(this.Eh|0,this.El|0,h|0,f|0),{h:g,l:y}=ot.add(this.Fh|0,this.Fl|0,g|0,y|0),{h:w,l:v}=ot.add(this.Gh|0,this.Gl|0,w|0,v|0),{h:C,l:x}=ot.add(this.Hh|0,this.Hl|0,C|0,x|0),this.set(r,s,o,i,a,l,c,u,h,f,g,y,w,v,C,x)}roundClean(){Yi.fill(0),Ji.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Dle=zI(()=>new Nle);function Mle(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const eR=Mle();eR.crypto||eR.msCrypto;function Ole(t){switch(t){case"sha256":return IV.create();case"sha512":return Dle.create()}J(!1,"invalid hashing algorithm name","algorithm",t)}const[RV,NV,DV]=[[],[],[]],Lle=BigInt(0),Af=BigInt(1),Fle=BigInt(2),jle=BigInt(7),Vle=BigInt(256),Ble=BigInt(113);for(let t=0,e=Af,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],RV.push(2*(5*r+n)),NV.push((t+1)*(t+2)/2%64);let s=Lle;for(let o=0;o<7;o++)e=(e<<Af^(e>>jle)*Ble)%Vle,e&Fle&&(s^=Af<<(Af<<BigInt(o))-Af);DV.push(s)}const[Ule,Hle]=AV(DV,!0),tR=(t,e,n)=>n>32?PV(t,e,n):SV(t,e,n),nR=(t,e,n)=>n>32?kV(t,e,n):TV(t,e,n);function $le(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let i=0;i<10;i++)n[i]=t[i]^t[i+10]^t[i+20]^t[i+30]^t[i+40];for(let i=0;i<10;i+=2){const a=(i+8)%10,l=(i+2)%10,c=n[l],u=n[l+1],h=tR(c,u,1)^n[a],f=nR(c,u,1)^n[a+1];for(let g=0;g<50;g+=10)t[i+g]^=h,t[i+g+1]^=f}let s=t[2],o=t[3];for(let i=0;i<24;i++){const a=NV[i],l=tR(s,o,a),c=nR(s,o,a),u=RV[i];s=t[u],o=t[u+1],t[u]=l,t[u+1]=c}for(let i=0;i<50;i+=10){for(let a=0;a<10;a++)n[a]=t[i+a];for(let a=0;a<10;a++)t[i+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Ule[r],t[1]^=Hle[r]}n.fill(0)}class GI extends $I{constructor(e,n,r,s=!1,o=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Bw(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=sle(this.state)}keccak(){$le(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){dh(this);const{blockLen:n,state:r}=this;e=l0(e);const s=e.length;for(let o=0;o<s;){const i=Math.min(n-this.pos,s-o);for(let a=0;a<i;a++)r[this.pos++]^=e[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){dh(this,!1),HI(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,o=e.length;s<o;){this.posOut>=r&&this.keccak();const i=Math.min(r-this.posOut,o-s);e.set(n.subarray(this.posOut,this.posOut+i),s),this.posOut+=i,s+=i}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Bw(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(bV(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:o,enableXOF:i}=this;return e||(e=new GI(n,r,s,i,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=r,e.outputLen=s,e.enableXOF=i,e.destroyed=this.destroyed,e}}const zle=(t,e,n)=>zI(()=>new GI(e,t,n)),Gle=zle(1,136,256/8);let MV=!1;const OV=function(t){return Gle(t)};let LV=OV;function pn(t){const e=dt(t,"data");return Ne(LV(e))}pn._=OV;pn.lock=function(){MV=!0};pn.register=function(t){if(MV)throw new TypeError("keccak256 is locked");LV=t};Object.freeze(pn);const FV=function(t){return Ole("sha256").update(t).digest()};let jV=FV,VV=!1;function Vh(t){const e=dt(t,"data");return Ne(jV(e))}Vh._=FV;Vh.lock=function(){VV=!0};Vh.register=function(t){if(VV)throw new Error("sha256 is locked");jV=t};Object.freeze(Vh);Object.freeze(Vh);const BV=BigInt(0),c0=BigInt(1),Wle=BigInt(2),u0=t=>t instanceof Uint8Array,Kle=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function hh(t){if(!u0(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Kle[t[n]];return e}function UV(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function WI(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function fh(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const s=r*2,o=t.slice(s,s+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function xc(t){return WI(hh(t))}function KI(t){if(!u0(t))throw new Error("Uint8Array expected");return WI(hh(Uint8Array.from(t).reverse()))}function mh(t,e){return fh(t.toString(16).padStart(e*2,"0"))}function qI(t,e){return mh(t,e).reverse()}function qle(t){return fh(UV(t))}function Ms(t,e,n){let r;if(typeof e=="string")try{r=fh(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(u0(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(`${t} expected ${n} bytes, got ${s}`);return r}function Km(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;return t.forEach(r=>{if(!u0(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function Qle(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Yle(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Jle(t){let e;for(e=0;t>BV;t>>=c0,e+=1);return e}function Xle(t,e){return t>>BigInt(e)&c0}const Zle=(t,e,n)=>t|(n?c0:BV)<<BigInt(e),QI=t=>(Wle<<BigInt(t-1))-c0,Bv=t=>new Uint8Array(t),rR=t=>Uint8Array.from(t);function HV(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=Bv(t),s=Bv(t),o=0;const i=()=>{r.fill(1),s.fill(0),o=0},a=(...h)=>n(s,r,...h),l=(h=Bv())=>{s=a(rR([0]),h),r=a(),h.length!==0&&(s=a(rR([1]),h),r=a())},c=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){r=a();const g=r.slice();f.push(g),h+=r.length}return Km(...f)};return(h,f)=>{i(),l(h);let g;for(;!(g=f(c()));)l();return i(),g}}const ece={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ng(t,e,n={}){const r=(s,o,i)=>{const a=ece[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);const l=t[s];if(!(i&&l===void 0)&&!a(l,t))throw new Error(`Invalid param ${String(s)}=${l} (${typeof l}), expected ${o}`)};for(const[s,o]of Object.entries(e))r(s,o,!1);for(const[s,o]of Object.entries(n))r(s,o,!0);return t}const tce=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Xle,bitLen:Jle,bitMask:QI,bitSet:Zle,bytesToHex:hh,bytesToNumberBE:xc,bytesToNumberLE:KI,concatBytes:Km,createHmacDrbg:HV,ensureBytes:Ms,equalBytes:Qle,hexToBytes:fh,hexToNumber:WI,numberToBytesBE:mh,numberToBytesLE:qI,numberToHexUnpadded:UV,numberToVarBytesBE:qle,utf8ToBytes:Yle,validateObject:ng},Symbol.toStringTag,{value:"Module"}));const Un=BigInt(0),fn=BigInt(1),Ml=BigInt(2),nce=BigInt(3),OC=BigInt(4),sR=BigInt(5),oR=BigInt(8);BigInt(9);BigInt(16);function Pr(t,e){const n=t%e;return n>=Un?n:e+n}function rce(t,e,n){if(n<=Un||e<Un)throw new Error("Expected power/modulo > 0");if(n===fn)return Un;let r=fn;for(;e>Un;)e&fn&&(r=r*t%n),t=t*t%n,e>>=fn;return r}function ss(t,e,n){let r=t;for(;e-- >Un;)r*=r,r%=n;return r}function LC(t,e){if(t===Un||e<=Un)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=Pr(t,e),r=e,s=Un,o=fn;for(;n!==Un;){const a=r/n,l=r%n,c=s-o*a;r=n,n=l,s=o,o=c}if(r!==fn)throw new Error("invert: does not exist");return Pr(s,e)}function sce(t){const e=(t-fn)/Ml;let n,r,s;for(n=t-fn,r=0;n%Ml===Un;n/=Ml,r++);for(s=Ml;s<t&&rce(s,e,t)!==t-fn;s++);if(r===1){const i=(t+fn)/OC;return function(l,c){const u=l.pow(c,i);if(!l.eql(l.sqr(u),c))throw new Error("Cannot find square root");return u}}const o=(n+fn)/Ml;return function(a,l){if(a.pow(l,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let c=r,u=a.pow(a.mul(a.ONE,s),n),h=a.pow(l,o),f=a.pow(l,n);for(;!a.eql(f,a.ONE);){if(a.eql(f,a.ZERO))return a.ZERO;let g=1;for(let w=a.sqr(f);g<c&&!a.eql(w,a.ONE);g++)w=a.sqr(w);const y=a.pow(u,fn<<BigInt(c-g-1));u=a.sqr(y),h=a.mul(h,y),f=a.mul(f,u),c=g}return h}}function oce(t){if(t%OC===nce){const e=(t+fn)/OC;return function(r,s){const o=r.pow(s,e);if(!r.eql(r.sqr(o),s))throw new Error("Cannot find square root");return o}}if(t%oR===sR){const e=(t-sR)/oR;return function(r,s){const o=r.mul(s,Ml),i=r.pow(o,e),a=r.mul(s,i),l=r.mul(r.mul(a,Ml),i),c=r.mul(a,r.sub(l,r.ONE));if(!r.eql(r.sqr(c),s))throw new Error("Cannot find square root");return c}}return sce(t)}const ice=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ace(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=ice.reduce((r,s)=>(r[s]="function",r),e);return ng(t,n)}function lce(t,e,n){if(n<Un)throw new Error("Expected power > 0");if(n===Un)return t.ONE;if(n===fn)return e;let r=t.ONE,s=e;for(;n>Un;)n&fn&&(r=t.mul(r,s)),s=t.sqr(s),n>>=fn;return r}function cce(t,e){const n=new Array(e.length),r=e.reduce((o,i,a)=>t.is0(i)?o:(n[a]=o,t.mul(o,i)),t.ONE),s=t.inv(r);return e.reduceRight((o,i,a)=>t.is0(i)?o:(n[a]=t.mul(o,n[a]),t.mul(o,i)),s),n}function $V(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function uce(t,e,n=!1,r={}){if(t<=Un)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:o}=$V(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const i=oce(t),a=Object.freeze({ORDER:t,BITS:s,BYTES:o,MASK:QI(s),ZERO:Un,ONE:fn,create:l=>Pr(l,t),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return Un<=l&&l<t},is0:l=>l===Un,isOdd:l=>(l&fn)===fn,neg:l=>Pr(-l,t),eql:(l,c)=>l===c,sqr:l=>Pr(l*l,t),add:(l,c)=>Pr(l+c,t),sub:(l,c)=>Pr(l-c,t),mul:(l,c)=>Pr(l*c,t),pow:(l,c)=>lce(a,l,c),div:(l,c)=>Pr(l*LC(c,t),t),sqrN:l=>l*l,addN:(l,c)=>l+c,subN:(l,c)=>l-c,mulN:(l,c)=>l*c,inv:l=>LC(l,t),sqrt:r.sqrt||(l=>i(a,l)),invertBatch:l=>cce(a,l),cmov:(l,c,u)=>u?c:l,toBytes:l=>n?qI(l,o):mh(l,o),fromBytes:l=>{if(l.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${l.length}`);return n?KI(l):xc(l)}});return Object.freeze(a)}function zV(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function GV(t){const e=zV(t);return e+Math.ceil(e/2)}function dce(t,e,n=!1){const r=t.length,s=zV(e),o=GV(e);if(r<16||r<o||r>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${r}`);const i=n?xc(t):KI(t),a=Pr(i,e-fn)+fn;return n?qI(a,s):mh(a,s)}const hce=BigInt(0),Uv=BigInt(1);function fce(t,e){const n=(s,o)=>{const i=o.negate();return s?i:o},r=s=>{const o=Math.ceil(e/s)+1,i=2**(s-1);return{windows:o,windowSize:i}};return{constTimeNegate:n,unsafeLadder(s,o){let i=t.ZERO,a=s;for(;o>hce;)o&Uv&&(i=i.add(a)),a=a.double(),o>>=Uv;return i},precomputeWindow(s,o){const{windows:i,windowSize:a}=r(o),l=[];let c=s,u=c;for(let h=0;h<i;h++){u=c,l.push(u);for(let f=1;f<a;f++)u=u.add(c),l.push(u);c=u.double()}return l},wNAF(s,o,i){const{windows:a,windowSize:l}=r(s);let c=t.ZERO,u=t.BASE;const h=BigInt(2**s-1),f=2**s,g=BigInt(s);for(let y=0;y<a;y++){const w=y*l;let v=Number(i&h);i>>=g,v>l&&(v-=f,i+=Uv);const C=w,x=w+Math.abs(v)-1,A=y%2!==0,N=v<0;v===0?u=u.add(n(A,o[C])):c=c.add(n(N,o[x]))}return{p:c,f:u}},wNAFCached(s,o,i,a){const l=s._WINDOW_SIZE||1;let c=o.get(s);return c||(c=this.precomputeWindow(s,l),l!==1&&o.set(s,a(c))),this.wNAF(l,c,i)}}}function WV(t){return ace(t.Fp),ng(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...$V(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function mce(t){const e=WV(t);ng(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:pce,hexToBytes:gce}=tce,Ul={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=Ul;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:pce(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=Ul,n=typeof t=="string"?gce(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:o}=Ul._parseInt(n.subarray(2)),{d:i,l:a}=Ul._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:i}},hexFromSig(t){const e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,n=c=>{const u=c.toString(16);return u.length&1?`0${u}`:u},r=e(n(t.s)),s=e(n(t.r)),o=r.length/2,i=s.length/2,a=n(o),l=n(i);return`30${n(i+o+4)}02${l}${s}02${a}${r}`}},ci=BigInt(0),ws=BigInt(1);BigInt(2);const iR=BigInt(3);BigInt(4);function yce(t){const e=mce(t),{Fp:n}=e,r=e.toBytes||((y,w,v)=>{const C=w.toAffine();return Km(Uint8Array.from([4]),n.toBytes(C.x),n.toBytes(C.y))}),s=e.fromBytes||(y=>{const w=y.subarray(1),v=n.fromBytes(w.subarray(0,n.BYTES)),C=n.fromBytes(w.subarray(n.BYTES,2*n.BYTES));return{x:v,y:C}});function o(y){const{a:w,b:v}=e,C=n.sqr(y),x=n.mul(C,y);return n.add(n.add(x,n.mul(y,w)),v)}if(!n.eql(n.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function i(y){return typeof y=="bigint"&&ci<y&&y<e.n}function a(y){if(!i(y))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(y){const{allowedPrivateKeyLengths:w,nByteLength:v,wrapPrivateKey:C,n:x}=e;if(w&&typeof y!="bigint"){if(y instanceof Uint8Array&&(y=hh(y)),typeof y!="string"||!w.includes(y.length))throw new Error("Invalid key");y=y.padStart(v*2,"0")}let A;try{A=typeof y=="bigint"?y:xc(Ms("private key",y,v))}catch{throw new Error(`private key must be ${v} bytes, hex or bigint, not ${typeof y}`)}return C&&(A=Pr(A,x)),a(A),A}const c=new Map;function u(y){if(!(y instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(w,v,C){if(this.px=w,this.py=v,this.pz=C,w==null||!n.isValid(w))throw new Error("x required");if(v==null||!n.isValid(v))throw new Error("y required");if(C==null||!n.isValid(C))throw new Error("z required")}static fromAffine(w){const{x:v,y:C}=w||{};if(!w||!n.isValid(v)||!n.isValid(C))throw new Error("invalid affine point");if(w instanceof h)throw new Error("projective point not allowed");const x=A=>n.eql(A,n.ZERO);return x(v)&&x(C)?h.ZERO:new h(v,C,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(w){const v=n.invertBatch(w.map(C=>C.pz));return w.map((C,x)=>C.toAffine(v[x])).map(h.fromAffine)}static fromHex(w){const v=h.fromAffine(s(Ms("pointHex",w)));return v.assertValidity(),v}static fromPrivateKey(w){return h.BASE.multiply(l(w))}_setWindowSize(w){this._WINDOW_SIZE=w,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:w,y:v}=this.toAffine();if(!n.isValid(w)||!n.isValid(v))throw new Error("bad point: x or y not FE");const C=n.sqr(v),x=o(w);if(!n.eql(C,x))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:w}=this.toAffine();if(n.isOdd)return!n.isOdd(w);throw new Error("Field doesn't support isOdd")}equals(w){u(w);const{px:v,py:C,pz:x}=this,{px:A,py:N,pz:M}=w,k=n.eql(n.mul(v,M),n.mul(A,x)),E=n.eql(n.mul(C,M),n.mul(N,x));return k&&E}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:w,b:v}=e,C=n.mul(v,iR),{px:x,py:A,pz:N}=this;let M=n.ZERO,k=n.ZERO,E=n.ZERO,b=n.mul(x,x),I=n.mul(A,A),P=n.mul(N,N),S=n.mul(x,A);return S=n.add(S,S),E=n.mul(x,N),E=n.add(E,E),M=n.mul(w,E),k=n.mul(C,P),k=n.add(M,k),M=n.sub(I,k),k=n.add(I,k),k=n.mul(M,k),M=n.mul(S,M),E=n.mul(C,E),P=n.mul(w,P),S=n.sub(b,P),S=n.mul(w,S),S=n.add(S,E),E=n.add(b,b),b=n.add(E,b),b=n.add(b,P),b=n.mul(b,S),k=n.add(k,b),P=n.mul(A,N),P=n.add(P,P),b=n.mul(P,S),M=n.sub(M,b),E=n.mul(P,I),E=n.add(E,E),E=n.add(E,E),new h(M,k,E)}add(w){u(w);const{px:v,py:C,pz:x}=this,{px:A,py:N,pz:M}=w;let k=n.ZERO,E=n.ZERO,b=n.ZERO;const I=e.a,P=n.mul(e.b,iR);let S=n.mul(v,A),D=n.mul(C,N),T=n.mul(x,M),j=n.add(v,C),R=n.add(A,N);j=n.mul(j,R),R=n.add(S,D),j=n.sub(j,R),R=n.add(v,x);let V=n.add(A,M);return R=n.mul(R,V),V=n.add(S,T),R=n.sub(R,V),V=n.add(C,x),k=n.add(N,M),V=n.mul(V,k),k=n.add(D,T),V=n.sub(V,k),b=n.mul(I,R),k=n.mul(P,T),b=n.add(k,b),k=n.sub(D,b),b=n.add(D,b),E=n.mul(k,b),D=n.add(S,S),D=n.add(D,S),T=n.mul(I,T),R=n.mul(P,R),D=n.add(D,T),T=n.sub(S,T),T=n.mul(I,T),R=n.add(R,T),S=n.mul(D,R),E=n.add(E,S),S=n.mul(V,R),k=n.mul(j,k),k=n.sub(k,S),S=n.mul(j,D),b=n.mul(V,b),b=n.add(b,S),new h(k,E,b)}subtract(w){return this.add(w.negate())}is0(){return this.equals(h.ZERO)}wNAF(w){return g.wNAFCached(this,c,w,v=>{const C=n.invertBatch(v.map(x=>x.pz));return v.map((x,A)=>x.toAffine(C[A])).map(h.fromAffine)})}multiplyUnsafe(w){const v=h.ZERO;if(w===ci)return v;if(a(w),w===ws)return this;const{endo:C}=e;if(!C)return g.unsafeLadder(this,w);let{k1neg:x,k1:A,k2neg:N,k2:M}=C.splitScalar(w),k=v,E=v,b=this;for(;A>ci||M>ci;)A&ws&&(k=k.add(b)),M&ws&&(E=E.add(b)),b=b.double(),A>>=ws,M>>=ws;return x&&(k=k.negate()),N&&(E=E.negate()),E=new h(n.mul(E.px,C.beta),E.py,E.pz),k.add(E)}multiply(w){a(w);let v=w,C,x;const{endo:A}=e;if(A){const{k1neg:N,k1:M,k2neg:k,k2:E}=A.splitScalar(v);let{p:b,f:I}=this.wNAF(M),{p:P,f:S}=this.wNAF(E);b=g.constTimeNegate(N,b),P=g.constTimeNegate(k,P),P=new h(n.mul(P.px,A.beta),P.py,P.pz),C=b.add(P),x=I.add(S)}else{const{p:N,f:M}=this.wNAF(v);C=N,x=M}return h.normalizeZ([C,x])[0]}multiplyAndAddUnsafe(w,v,C){const x=h.BASE,A=(M,k)=>k===ci||k===ws||!M.equals(x)?M.multiplyUnsafe(k):M.multiply(k),N=A(this,v).add(A(w,C));return N.is0()?void 0:N}toAffine(w){const{px:v,py:C,pz:x}=this,A=this.is0();w==null&&(w=A?n.ONE:n.inv(x));const N=n.mul(v,w),M=n.mul(C,w),k=n.mul(x,w);if(A)return{x:n.ZERO,y:n.ZERO};if(!n.eql(k,n.ONE))throw new Error("invZ was invalid");return{x:N,y:M}}isTorsionFree(){const{h:w,isTorsionFree:v}=e;if(w===ws)return!0;if(v)return v(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:w,clearCofactor:v}=e;return w===ws?this:v?v(h,this):this.multiplyUnsafe(e.h)}toRawBytes(w=!0){return this.assertValidity(),r(h,this,w)}toHex(w=!0){return hh(this.toRawBytes(w))}}h.BASE=new h(e.Gx,e.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const f=e.nBitLength,g=fce(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:l,weierstrassEquation:o,isWithinCurveOrder:i}}function wce(t){const e=WV(t);return ng(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function bce(t){const e=wce(t),{Fp:n,n:r}=e,s=n.BYTES+1,o=2*n.BYTES+1;function i(R){return ci<R&&R<n.ORDER}function a(R){return Pr(R,r)}function l(R){return LC(R,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:f}=yce({...e,toBytes(R,V,U){const F=V.toAffine(),$=n.toBytes(F.x),W=Km;return U?W(Uint8Array.from([V.hasEvenY()?2:3]),$):W(Uint8Array.from([4]),$,n.toBytes(F.y))},fromBytes(R){const V=R.length,U=R[0],F=R.subarray(1);if(V===s&&(U===2||U===3)){const $=xc(F);if(!i($))throw new Error("Point is not on curve");const W=h($);let Z=n.sqrt(W);const Y=(Z&ws)===ws;return(U&1)===1!==Y&&(Z=n.neg(Z)),{x:$,y:Z}}else if(V===o&&U===4){const $=n.fromBytes(F.subarray(0,n.BYTES)),W=n.fromBytes(F.subarray(n.BYTES,2*n.BYTES));return{x:$,y:W}}else throw new Error(`Point of length ${V} was invalid. Expected ${s} compressed bytes or ${o} uncompressed bytes`)}}),g=R=>hh(mh(R,e.nByteLength));function y(R){const V=r>>ws;return R>V}function w(R){return y(R)?a(-R):R}const v=(R,V,U)=>xc(R.slice(V,U));class C{constructor(V,U,F){this.r=V,this.s=U,this.recovery=F,this.assertValidity()}static fromCompact(V){const U=e.nByteLength;return V=Ms("compactSignature",V,U*2),new C(v(V,0,U),v(V,U,2*U))}static fromDER(V){const{r:U,s:F}=Ul.toSig(Ms("DER",V));return new C(U,F)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(V){return new C(this.r,this.s,V)}recoverPublicKey(V){const{r:U,s:F,recovery:$}=this,W=E(Ms("msgHash",V));if($==null||![0,1,2,3].includes($))throw new Error("recovery id invalid");const Z=$===2||$===3?U+e.n:U;if(Z>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const Y=($&1)===0?"02":"03",le=c.fromHex(Y+g(Z)),fe=l(Z),we=a(-W*fe),Me=a(F*fe),Ee=c.BASE.multiplyAndAddUnsafe(le,we,Me);if(!Ee)throw new Error("point at infinify");return Ee.assertValidity(),Ee}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new C(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return fh(this.toDERHex())}toDERHex(){return Ul.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return fh(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}const x={isValidPrivateKey(R){try{return u(R),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const R=GV(e.n);return dce(e.randomBytes(R),e.n)},precompute(R=8,V=c.BASE){return V._setWindowSize(R),V.multiply(BigInt(3)),V}};function A(R,V=!0){return c.fromPrivateKey(R).toRawBytes(V)}function N(R){const V=R instanceof Uint8Array,U=typeof R=="string",F=(V||U)&&R.length;return V?F===s||F===o:U?F===2*s||F===2*o:R instanceof c}function M(R,V,U=!0){if(N(R))throw new Error("first arg must be private key");if(!N(V))throw new Error("second arg must be public key");return c.fromHex(V).multiply(u(R)).toRawBytes(U)}const k=e.bits2int||function(R){const V=xc(R),U=R.length*8-e.nBitLength;return U>0?V>>BigInt(U):V},E=e.bits2int_modN||function(R){return a(k(R))},b=QI(e.nBitLength);function I(R){if(typeof R!="bigint")throw new Error("bigint expected");if(!(ci<=R&&R<b))throw new Error(`bigint expected < 2^${e.nBitLength}`);return mh(R,e.nByteLength)}function P(R,V,U=S){if(["recovered","canonical"].some(ue=>ue in U))throw new Error("sign() legacy options not supported");const{hash:F,randomBytes:$}=e;let{lowS:W,prehash:Z,extraEntropy:Y}=U;W==null&&(W=!0),R=Ms("msgHash",R),Z&&(R=Ms("prehashed msgHash",F(R)));const le=E(R),fe=u(V),we=[I(fe),I(le)];if(Y!=null){const ue=Y===!0?$(n.BYTES):Y;we.push(Ms("extraEntropy",ue))}const Me=Km(...we),Ee=le;function X(ue){const re=k(ue);if(!f(re))return;const ie=l(re),Ce=c.BASE.multiply(re).toAffine(),K=a(Ce.x);if(K===ci)return;const me=a(ie*a(Ee+K*fe));if(me===ci)return;let Q=(Ce.x===K?0:2)|Number(Ce.y&ws),ee=me;return W&&y(me)&&(ee=w(me),Q^=1),new C(K,ee,Q)}return{seed:Me,k2sig:X}}const S={lowS:e.lowS,prehash:!1},D={lowS:e.lowS,prehash:!1};function T(R,V,U=S){const{seed:F,k2sig:$}=P(R,V,U),W=e;return HV(W.hash.outputLen,W.nByteLength,W.hmac)(F,$)}c.BASE._setWindowSize(8);function j(R,V,U,F=D){const $=R;if(V=Ms("msgHash",V),U=Ms("publicKey",U),"strict"in F)throw new Error("options.strict was renamed to lowS");const{lowS:W,prehash:Z}=F;let Y,le;try{if(typeof $=="string"||$ instanceof Uint8Array)try{Y=C.fromDER($)}catch(Ce){if(!(Ce instanceof Ul.Err))throw Ce;Y=C.fromCompact($)}else if(typeof $=="object"&&typeof $.r=="bigint"&&typeof $.s=="bigint"){const{r:Ce,s:K}=$;Y=new C(Ce,K)}else throw new Error("PARSE");le=c.fromHex(U)}catch(Ce){if(Ce.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(W&&Y.hasHighS())return!1;Z&&(V=e.hash(V));const{r:fe,s:we}=Y,Me=E(V),Ee=l(we),X=a(Me*Ee),ue=a(fe*Ee),re=c.BASE.multiplyAndAddUnsafe(le,X,ue)?.toAffine();return re?a(re.x)===fe:!1}return{CURVE:e,getPublicKey:A,getSharedSecret:M,sign:T,verify:j,ProjectivePoint:c,Signature:C,utils:x}}function vce(t){return{hash:t,hmac:(e,...n)=>CV(t,e,ale(...n)),randomBytes:lle}}function xce(t,e){const n=r=>bce({...t,...vce(r)});return Object.freeze({...n(e),create:n})}const KV=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),aR=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Cce=BigInt(1),FC=BigInt(2),lR=(t,e)=>(t+e/FC)/e;function Ece(t){const e=KV,n=BigInt(3),r=BigInt(6),s=BigInt(11),o=BigInt(22),i=BigInt(23),a=BigInt(44),l=BigInt(88),c=t*t*t%e,u=c*c*t%e,h=ss(u,n,e)*u%e,f=ss(h,n,e)*u%e,g=ss(f,FC,e)*c%e,y=ss(g,s,e)*g%e,w=ss(y,o,e)*y%e,v=ss(w,a,e)*w%e,C=ss(v,l,e)*v%e,x=ss(C,a,e)*w%e,A=ss(x,n,e)*u%e,N=ss(A,i,e)*y%e,M=ss(N,r,e)*c%e,k=ss(M,FC,e);if(!jC.eql(jC.sqr(k),t))throw new Error("Cannot find square root");return k}const jC=uce(KV,void 0,void 0,{sqrt:Ece}),na=xce({a:BigInt(0),b:BigInt(7),Fp:jC,n:aR,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=aR,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Cce*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,i=BigInt("0x100000000000000000000000000000000"),a=lR(o*t,e),l=lR(-r*t,e);let c=Pr(t-a*n-l*s,e),u=Pr(-a*r-l*o,e);const h=c>i,f=u>i;if(h&&(c=e-c),f&&(u=e-u),c>i||u>i)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:f,k2:u}}}},IV);BigInt(0);na.ProjectivePoint;const qm="0x0000000000000000000000000000000000000000",cR="0x0000000000000000000000000000000000000000000000000000000000000000",uR=BigInt(0),dR=BigInt(1),hR=BigInt(2),fR=BigInt(27),mR=BigInt(28),Yg=BigInt(35),bu={};function pR(t){return Ti(kn(t),32)}var ld,ao,cd,Zl;const Ns=class Ns{constructor(e,n,r,s){ce(this,ld);ce(this,ao);ce(this,cd);ce(this,Zl);o0(e,bu,"Signature"),G(this,ld,n),G(this,ao,r),G(this,cd,s),G(this,Zl,null)}get r(){return H(this,ld)}set r(e){J(Ju(e)===32,"invalid r","value",e),G(this,ld,Ne(e))}get s(){return J(parseInt(H(this,ao).substring(0,3))<8,"non-canonical s; use ._s","s",H(this,ao)),H(this,ao)}set s(e){J(Ju(e)===32,"invalid s","value",e),G(this,ao,Ne(e))}get _s(){return H(this,ao)}isValid(){return parseInt(H(this,ao).substring(0,3))<8}get v(){return H(this,cd)}set v(e){const n=ht(e,"value");J(n===27||n===28,"invalid v","v",e),G(this,cd,n)}get networkV(){return H(this,Zl)}get legacyChainId(){const e=this.networkV;return e==null?null:Ns.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=dt(this.s);return this.yParity&&(e[0]|=128),Ne(e)}get compactSerialized(){return cn([this.r,this.yParityAndS])}get serialized(){return cn([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Ns(bu,this.r,this._s,this.v);return this.networkV&&G(e,Zl,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const n=Ve(e,"v");return n==fR||n==mR?uR:(J(n>=Yg,"invalid EIP-155 v","v",e),(n-Yg)/hR)}static getChainIdV(e,n){return Ve(e)*hR+BigInt(35+n-27)}static getNormalizedV(e){const n=Ve(e);return n===uR||n===fR?27:n===dR||n===mR?28:(J(n>=Yg,"invalid v","v",e),n&dR?27:28)}static from(e){function n(c,u){J(c,u,"signature",e)}if(e==null)return new Ns(bu,cR,cR,27);if(typeof e=="string"){const c=dt(e,"signature");if(c.length===64){const u=Ne(c.slice(0,32)),h=c.slice(32,64),f=h[0]&128?28:27;return h[0]&=127,new Ns(bu,u,Ne(h),f)}if(c.length===65){const u=Ne(c.slice(0,32)),h=Ne(c.slice(32,64)),f=Ns.getNormalizedV(c[64]);return new Ns(bu,u,h,f)}n(!1,"invalid raw signature length")}if(e instanceof Ns)return e.clone();const r=e.r;n(r!=null,"missing r");const s=pR(r),o=(function(c,u){if(c!=null)return pR(c);if(u!=null){n(Ht(u,32),"invalid yParityAndS");const h=dt(u);return h[0]&=127,Ne(h)}n(!1,"missing s")})(e.s,e.yParityAndS),{networkV:i,v:a}=(function(c,u,h){if(c!=null){const f=Ve(c);return{networkV:f>=Yg?f:void 0,v:Ns.getNormalizedV(f)}}if(u!=null)return n(Ht(u,32),"invalid yParityAndS"),{v:dt(u)[0]&128?28:27};if(h!=null){switch(ht(h,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}n(!1,"invalid yParity")}n(!1,"missing v")})(e.v,e.yParityAndS,e.yParity),l=new Ns(bu,s,o,a);return i&&G(l,Zl,i),n(e.yParity==null||ht(e.yParity,"sig.yParity")===l.yParity,"yParity mismatch"),n(e.yParityAndS==null||e.yParityAndS===l.yParityAndS,"yParityAndS mismatch"),l}};ld=new WeakMap,ao=new WeakMap,cd=new WeakMap,Zl=new WeakMap;let Fr=Ns;var ti;const Ol=class Ol{constructor(e){ce(this,ti);J(Ju(e)===32,"invalid private key","privateKey","[REDACTED]"),G(this,ti,Ne(e))}get privateKey(){return H(this,ti)}get publicKey(){return Ol.computePublicKey(H(this,ti))}get compressedPublicKey(){return Ol.computePublicKey(H(this,ti),!0)}sign(e){J(Ju(e)===32,"invalid digest length","digest",e);const n=na.sign(wr(e),wr(H(this,ti)),{lowS:!0});return Fr.from({r:Ga(n.r,32),s:Ga(n.s,32),v:n.recovery?28:27})}computeSharedSecret(e){const n=Ol.computePublicKey(e);return Ne(na.getSharedSecret(wr(H(this,ti)),dt(n),!1))}static computePublicKey(e,n){let r=dt(e,"key");if(r.length===32){const o=na.getPublicKey(r,!!n);return Ne(o)}if(r.length===64){const o=new Uint8Array(65);o[0]=4,o.set(r,1),r=o}const s=na.ProjectivePoint.fromHex(r);return Ne(s.toRawBytes(n))}static recoverPublicKey(e,n){J(Ju(e)===32,"invalid digest length","digest",e);const r=Fr.from(n);let s=na.Signature.fromCompact(wr(cn([r.r,r.s])));s=s.addRecoveryBit(r.yParity);const o=s.recoverPublicKey(wr(e));return J(o!=null,"invalid signature for digest","signature",n),"0x"+o.toHex(!1)}static addPoints(e,n,r){const s=na.ProjectivePoint.fromHex(Ol.computePublicKey(e).substring(2)),o=na.ProjectivePoint.fromHex(Ol.computePublicKey(n).substring(2));return"0x"+s.add(o).toHex(!!r)}};ti=new WeakMap;let Qm=Ol;const Ice=BigInt(0),_ce=BigInt(36);function gR(t){t=t.toLowerCase();const e=t.substring(2).split(""),n=new Uint8Array(40);for(let s=0;s<40;s++)n[s]=e[s].charCodeAt(0);const r=dt(pn(n));for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(r[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const YI={};for(let t=0;t<10;t++)YI[String(t)]=String(t);for(let t=0;t<26;t++)YI[String.fromCharCode(65+t)]=String(10+t);const yR=15;function Ace(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(r=>YI[r]).join("");for(;e.length>=yR;){let r=e.substring(0,yR);e=parseInt(r,10)%97+e.substring(r.length)}let n=String(98-parseInt(e,10)%97);for(;n.length<2;)n="0"+n;return n}const Sce=(function(){const t={};for(let e=0;e<36;e++){const n="0123456789abcdefghijklmnopqrstuvwxyz"[e];t[n]=BigInt(e)}return t})();function Tce(t){t=t.toLowerCase();let e=Ice;for(let n=0;n<t.length;n++)e=e*_ce+Sce[t[n]];return e}function Pt(t){if(J(typeof t=="string","invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=gR(t);return J(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){J(t.substring(2,4)===Ace(t),"bad icap checksum","address",t);let e=Tce(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return gR("0x"+e)}J(!1,"invalid address","address",t)}function Pce(t){const e=Pt(t.from);let r=Ve(t.nonce,"tx.nonce").toString(16);return r==="0"?r="0x":r.length%2?r="0x0"+r:r="0x"+r,Pt(on(pn(Ka([e,r])),12))}function qV(t){return t&&typeof t.getAddress=="function"}async function Hv(t,e){const n=await e;return(n==null||n==="0x0000000000000000000000000000000000000000")&&(xe(typeof t!="string","unconfigured name","UNCONFIGURED_NAME",{value:t}),J(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),Pt(n)}function xr(t,e){if(typeof t=="string")return t.match(/^0x[0-9a-f]{40}$/i)?Pt(t):(xe(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),Hv(t,e.resolveName(t)));if(qV(t))return Hv(t,t.getAddress());if(t&&typeof t.then=="function")return Hv(t,t);J(!1,"unsupported addressable value","target",t)}const Qo={};function Le(t,e){let n=!1;return e<0&&(n=!0,e*=-1),new dr(Qo,`${n?"":"u"}int${e}`,t,{signed:n,width:e})}function It(t,e){return new dr(Qo,`bytes${e||""}`,t,{size:e})}const wR=Symbol.for("_ethers_typed");var ec;const Yo=class Yo{constructor(e,n,r,s){oe(this,"type");oe(this,"value");ce(this,ec);oe(this,"_typedSymbol");s==null&&(s=null),o0(Qo,e,"Typed"),Je(this,{_typedSymbol:wR,type:n,value:r}),G(this,ec,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return H(this,ec)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return H(this,ec)===!0?-1:H(this,ec)===!1?this.value.length:null}static from(e,n){return new Yo(Qo,e,n)}static uint8(e){return Le(e,8)}static uint16(e){return Le(e,16)}static uint24(e){return Le(e,24)}static uint32(e){return Le(e,32)}static uint40(e){return Le(e,40)}static uint48(e){return Le(e,48)}static uint56(e){return Le(e,56)}static uint64(e){return Le(e,64)}static uint72(e){return Le(e,72)}static uint80(e){return Le(e,80)}static uint88(e){return Le(e,88)}static uint96(e){return Le(e,96)}static uint104(e){return Le(e,104)}static uint112(e){return Le(e,112)}static uint120(e){return Le(e,120)}static uint128(e){return Le(e,128)}static uint136(e){return Le(e,136)}static uint144(e){return Le(e,144)}static uint152(e){return Le(e,152)}static uint160(e){return Le(e,160)}static uint168(e){return Le(e,168)}static uint176(e){return Le(e,176)}static uint184(e){return Le(e,184)}static uint192(e){return Le(e,192)}static uint200(e){return Le(e,200)}static uint208(e){return Le(e,208)}static uint216(e){return Le(e,216)}static uint224(e){return Le(e,224)}static uint232(e){return Le(e,232)}static uint240(e){return Le(e,240)}static uint248(e){return Le(e,248)}static uint256(e){return Le(e,256)}static uint(e){return Le(e,256)}static int8(e){return Le(e,-8)}static int16(e){return Le(e,-16)}static int24(e){return Le(e,-24)}static int32(e){return Le(e,-32)}static int40(e){return Le(e,-40)}static int48(e){return Le(e,-48)}static int56(e){return Le(e,-56)}static int64(e){return Le(e,-64)}static int72(e){return Le(e,-72)}static int80(e){return Le(e,-80)}static int88(e){return Le(e,-88)}static int96(e){return Le(e,-96)}static int104(e){return Le(e,-104)}static int112(e){return Le(e,-112)}static int120(e){return Le(e,-120)}static int128(e){return Le(e,-128)}static int136(e){return Le(e,-136)}static int144(e){return Le(e,-144)}static int152(e){return Le(e,-152)}static int160(e){return Le(e,-160)}static int168(e){return Le(e,-168)}static int176(e){return Le(e,-176)}static int184(e){return Le(e,-184)}static int192(e){return Le(e,-192)}static int200(e){return Le(e,-200)}static int208(e){return Le(e,-208)}static int216(e){return Le(e,-216)}static int224(e){return Le(e,-224)}static int232(e){return Le(e,-232)}static int240(e){return Le(e,-240)}static int248(e){return Le(e,-248)}static int256(e){return Le(e,-256)}static int(e){return Le(e,-256)}static bytes1(e){return It(e,1)}static bytes2(e){return It(e,2)}static bytes3(e){return It(e,3)}static bytes4(e){return It(e,4)}static bytes5(e){return It(e,5)}static bytes6(e){return It(e,6)}static bytes7(e){return It(e,7)}static bytes8(e){return It(e,8)}static bytes9(e){return It(e,9)}static bytes10(e){return It(e,10)}static bytes11(e){return It(e,11)}static bytes12(e){return It(e,12)}static bytes13(e){return It(e,13)}static bytes14(e){return It(e,14)}static bytes15(e){return It(e,15)}static bytes16(e){return It(e,16)}static bytes17(e){return It(e,17)}static bytes18(e){return It(e,18)}static bytes19(e){return It(e,19)}static bytes20(e){return It(e,20)}static bytes21(e){return It(e,21)}static bytes22(e){return It(e,22)}static bytes23(e){return It(e,23)}static bytes24(e){return It(e,24)}static bytes25(e){return It(e,25)}static bytes26(e){return It(e,26)}static bytes27(e){return It(e,27)}static bytes28(e){return It(e,28)}static bytes29(e){return It(e,29)}static bytes30(e){return It(e,30)}static bytes31(e){return It(e,31)}static bytes32(e){return It(e,32)}static address(e){return new Yo(Qo,"address",e)}static bool(e){return new Yo(Qo,"bool",!!e)}static bytes(e){return new Yo(Qo,"bytes",e)}static string(e){return new Yo(Qo,"string",e)}static array(e,n){throw new Error("not implemented yet")}static tuple(e,n){throw new Error("not implemented yet")}static overrides(e){return new Yo(Qo,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===wR}static dereference(e,n){if(Yo.isTyped(e)){if(e.type!==n)throw new Error(`invalid type: expecetd ${n}, got ${e.type}`);return e.value}return e}};ec=new WeakMap;let dr=Yo;class kce extends Di{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,n){let r=dr.dereference(n,"string");try{r=Pt(r)}catch(s){return this._throwError(s.message,n)}return e.writeValue(r)}decode(e){return Pt(Ga(e.readValue(),20))}}class Rce extends Di{constructor(n){super(n.name,n.type,"_",n.dynamic);oe(this,"coder");this.coder=n}defaultValue(){return this.coder.defaultValue()}encode(n,r){return this.coder.encode(n,r)}decode(n){return this.coder.decode(n)}}function QV(t,e,n){let r=[];if(Array.isArray(n))r=n;else if(n&&typeof n=="object"){let l={};r=e.map(c=>{const u=c.localName;return xe(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:c},value:n}),xe(!l[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:c},value:n}),l[u]=!0,n[u]})}else J(!1,"invalid tuple value","tuple",n);J(e.length===r.length,"types/value length mismatch","tuple",n);let s=new RC,o=new RC,i=[];e.forEach((l,c)=>{let u=r[c];if(l.dynamic){let h=o.length;l.encode(o,u);let f=s.writeUpdatableValue();i.push(g=>{f(g+h)})}else l.encode(s,u)}),i.forEach(l=>{l(s.length)});let a=t.appendWriter(s);return a+=t.appendWriter(o),a}function YV(t,e){let n=[],r=[],s=t.subReader(0);return e.forEach(o=>{let i=null;if(o.dynamic){let a=t.readIndex(),l=s.subReader(a);try{i=o.decode(l)}catch(c){if(qn(c,"BUFFER_OVERRUN"))throw c;i=c,i.baseType=o.name,i.name=o.localName,i.type=o.type}}else try{i=o.decode(t)}catch(a){if(qn(a,"BUFFER_OVERRUN"))throw a;i=a,i.baseType=o.name,i.name=o.localName,i.type=o.type}if(i==null)throw new Error("investigate");n.push(i),r.push(o.localName||null)}),uh.fromItems(n,r)}class Nce extends Di{constructor(n,r,s){const o=n.type+"["+(r>=0?r:"")+"]",i=r===-1||n.dynamic;super("array",o,s,i);oe(this,"coder");oe(this,"length");Je(this,{coder:n,length:r})}defaultValue(){const n=this.coder.defaultValue(),r=[];for(let s=0;s<this.length;s++)r.push(n);return r}encode(n,r){const s=dr.dereference(r,"array");Array.isArray(s)||this._throwError("expected array value",s);let o=this.length;o===-1&&(o=s.length,n.writeValue(s.length)),oV(s.length,o,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let a=0;a<s.length;a++)i.push(this.coder);return QV(n,i,s)}decode(n){let r=this.length;r===-1&&(r=n.readIndex(),xe(r*vr<=n.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:n.bytes,offset:r*vr,length:n.dataLength}));let s=[];for(let o=0;o<r;o++)s.push(new Rce(this.coder));return YV(n,s)}}class Dce extends Di{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,n){const r=dr.dereference(n,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}}class JV extends Di{constructor(e,n){super(e,e,n,!0)}defaultValue(){return"0x"}encode(e,n){n=wr(n);let r=e.writeValue(n.length);return r+=e.writeBytes(n),r}decode(e){return e.readBytes(e.readIndex(),!0)}}class Mce extends JV{constructor(e){super("bytes",e)}decode(e){return Ne(super.decode(e))}}class Oce extends Di{constructor(n,r){let s="bytes"+String(n);super(s,s,r,!1);oe(this,"size");Je(this,{size:n},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(n,r){let s=wr(dr.dereference(r,this.type));return s.length!==this.size&&this._throwError("incorrect data length",r),n.writeBytes(s)}decode(n){return Ne(n.readBytes(this.size))}}const Lce=new Uint8Array([]);class Fce extends Di{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,n){return n!=null&&this._throwError("not null",n),e.writeBytes(Lce)}decode(e){return e.readBytes(0),null}}const jce=BigInt(0),Vce=BigInt(1),Bce=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class Uce extends Di{constructor(n,r,s){const o=(r?"int":"uint")+n*8;super(o,o,s,!1);oe(this,"size");oe(this,"signed");Je(this,{size:n,signed:r},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(n,r){let s=Ve(dr.dereference(r,this.type)),o=Hf(Bce,vr*8);if(this.signed){let i=Hf(o,this.size*8-1);(s>i||s<-(i+Vce))&&this._throwError("value out-of-bounds",r),s=lV(s,8*vr)}else(s<jce||s>Hf(o,this.size*8))&&this._throwError("value out-of-bounds",r);return n.writeValue(s)}decode(n){let r=Hf(n.readValue(),this.size*8);return this.signed&&(r=jae(r,this.size*8)),r}}class Hce extends JV{constructor(e){super("string",e)}defaultValue(){return""}encode(e,n){return super.encode(e,Lo(dr.dereference(n,"string")))}decode(e){return Vw(super.decode(e))}}class Jg extends Di{constructor(n,r){let s=!1;const o=[];n.forEach(a=>{a.dynamic&&(s=!0),o.push(a.type)});const i="tuple("+o.join(",")+")";super("tuple",i,r,s);oe(this,"coders");Je(this,{coders:Object.freeze(n.slice())})}defaultValue(){const n=[];this.coders.forEach(s=>{n.push(s.defaultValue())});const r=this.coders.reduce((s,o)=>{const i=o.localName;return i&&(s[i]||(s[i]=0),s[i]++),s},{});return this.coders.forEach((s,o)=>{let i=s.localName;!i||r[i]!==1||(i==="length"&&(i="_length"),n[i]==null&&(n[i]=n[o]))}),Object.freeze(n)}encode(n,r){const s=dr.dereference(r,"tuple");return QV(n,this.coders,s)}decode(n){return YV(n,this.coders)}}function $v(t,e){return{address:Pt(t),storageKeys:e.map((n,r)=>(J(Ht(n,32),"invalid slot",`storageKeys[${r}]`,n),n.toLowerCase()))}}function eu(t){if(Array.isArray(t))return t.map((n,r)=>Array.isArray(n)?(J(n.length===2,"invalid slot set",`value[${r}]`,n),$v(n[0],n[1])):(J(n!=null&&typeof n=="object","invalid address-slot set","value",t),$v(n.address,n.storageKeys)));J(t!=null&&typeof t=="object","invalid access list","value",t);const e=Object.keys(t).map(n=>{const r=t[n].reduce((s,o)=>(s[o]=!0,s),{});return $v(n,Object.keys(r).sort())});return e.sort((n,r)=>n.address.localeCompare(r.address)),e}function XV(t){return{address:Pt(t.address),nonce:Ve(t.nonce!=null?t.nonce:0),chainId:Ve(t.chainId!=null?t.chainId:0),signature:Fr.from(t.signature)}}function $ce(t){let e;return typeof t=="string"?e=Qm.computePublicKey(t,!1):e=t.publicKey,Pt(pn("0x"+e.substring(4)).substring(26))}function zce(t,e){return $ce(Qm.recoverPublicKey(t,e))}const jn=BigInt(0),Gce=BigInt(2),Wce=BigInt(27),Kce=BigInt(28),qce=BigInt(35),Qce=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),zv=4096*32;function Yce(t){return{blobToKzgCommitment:r=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return dt(t.blobToKzgCommitment(Ne(r)))}else if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return dt(t.blobToKzgCommitment(r));if("blobToKZGCommitment"in t&&typeof t.blobToKZGCommitment=="function")return dt(t.blobToKZGCommitment(Ne(r)));J(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(r,s)=>{if("computeBlobProof"in t&&typeof t.computeBlobProof=="function")return dt(t.computeBlobProof(Ne(r),Ne(s)));if("computeBlobKzgProof"in t&&typeof t.computeBlobKzgProof=="function")return t.computeBlobKzgProof(r,s);if("computeBlobKZGProof"in t&&typeof t.computeBlobKZGProof=="function")return dt(t.computeBlobKZGProof(Ne(r),Ne(s)));J(!1,"unsupported KZG library","kzg",t)}}}function bR(t,e){let n=t.toString(16);for(;n.length<2;)n="0"+n;return n+=Vh(e).substring(4),"0x"+n}function Bh(t){return t==="0x"?null:Pt(t)}function d0(t,e){try{return eu(t)}catch(n){J(!1,n.message,e,t)}}function Jce(t,e){try{if(!Array.isArray(t))throw new Error("authorizationList: invalid array");const n=[];for(let r=0;r<t.length;r++){const s=t[r];if(!Array.isArray(s))throw new Error(`authorization[${r}]: invalid array`);if(s.length!==6)throw new Error(`authorization[${r}]: wrong length`);if(!s[1])throw new Error(`authorization[${r}]: null address`);n.push({address:Bh(s[1]),nonce:Ot(s[2],"nonce"),chainId:Ot(s[0],"chainId"),signature:Fr.from({yParity:tu(s[3],"yParity"),r:Ti(s[4],32),s:Ti(s[5],32)})})}return n}catch(n){J(!1,n.message,e,t)}}function tu(t,e){return t==="0x"?0:ht(t,e)}function Ot(t,e){if(t==="0x")return jn;const n=Ve(t,e);return J(n<=Qce,"value exceeds uint size",e,n),n}function Ct(t,e){const n=Ve(t,"value"),r=kn(n);return J(r.length<=32,"value too large",`tx.${e}`,n),r}function h0(t){return eu(t).map(e=>[e.address,e.storageKeys])}function Xce(t){return t.map(e=>[Ct(e.chainId,"chainId"),e.address,Ct(e.nonce,"nonce"),Ct(e.signature.yParity,"yParity"),kn(e.signature.r),kn(e.signature.s)])}function Zce(t,e){J(Array.isArray(t),`invalid ${e}`,"value",t);for(let n=0;n<t.length;n++)J(Ht(t[n],32),"invalid ${ param } hash",`value[${n}]`,t[n]);return t}function eue(t){const e=tg(t);J(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",t);const n={type:0,nonce:tu(e[0],"nonce"),gasPrice:Ot(e[1],"gasPrice"),gasLimit:Ot(e[2],"gasLimit"),to:Bh(e[3]),value:Ot(e[4],"value"),data:Ne(e[5]),chainId:jn};if(e.length===6)return n;const r=Ot(e[6],"v"),s=Ot(e[7],"r"),o=Ot(e[8],"s");if(s===jn&&o===jn)n.chainId=r;else{let i=(r-qce)/Gce;i<jn&&(i=jn),n.chainId=i,J(i!==jn||r===Wce||r===Kce,"non-canonical legacy v","v",e[6]),n.signature=Fr.from({r:Ti(e[7],32),s:Ti(e[8],32),v:r})}return n}function tue(t,e){const n=[Ct(t.nonce,"nonce"),Ct(t.gasPrice||0,"gasPrice"),Ct(t.gasLimit,"gasLimit"),t.to||"0x",Ct(t.value,"value"),t.data];let r=jn;if(t.chainId!=jn)r=Ve(t.chainId,"tx.chainId"),J(!e||e.networkV==null||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const o=t.signature.legacyChainId;o!=null&&(r=o)}if(!e)return r!==jn&&(n.push(kn(r)),n.push("0x"),n.push("0x")),Ka(n);let s=BigInt(27+e.yParity);return r!==jn?s=Fr.getChainIdV(r,e.v):BigInt(e.v)!==s&&J(!1,"tx.chainId/sig.v mismatch","sig",e),n.push(kn(s)),n.push(kn(e.r)),n.push(kn(e.s)),Ka(n)}function f0(t,e){let n;try{if(n=tu(e[0],"yParity"),n!==0&&n!==1)throw new Error("bad yParity")}catch{J(!1,"invalid yParity","yParity",e[0])}const r=Ti(e[1],32),s=Ti(e[2],32),o=Fr.from({r,s,yParity:n});t.signature=o}function nue(t){const e=tg(dt(t).slice(1));J(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",Ne(t));const n={type:2,chainId:Ot(e[0],"chainId"),nonce:tu(e[1],"nonce"),maxPriorityFeePerGas:Ot(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Ot(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Ot(e[4],"gasLimit"),to:Bh(e[5]),value:Ot(e[6],"value"),data:Ne(e[7]),accessList:d0(e[8],"accessList")};return e.length===9||f0(n,e.slice(9)),n}function rue(t,e){const n=[Ct(t.chainId,"chainId"),Ct(t.nonce,"nonce"),Ct(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Ct(t.maxFeePerGas||0,"maxFeePerGas"),Ct(t.gasLimit,"gasLimit"),t.to||"0x",Ct(t.value,"value"),t.data,h0(t.accessList||[])];return e&&(n.push(Ct(e.yParity,"yParity")),n.push(kn(e.r)),n.push(kn(e.s))),cn(["0x02",Ka(n)])}function sue(t){const e=tg(dt(t).slice(1));J(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",Ne(t));const n={type:1,chainId:Ot(e[0],"chainId"),nonce:tu(e[1],"nonce"),gasPrice:Ot(e[2],"gasPrice"),gasLimit:Ot(e[3],"gasLimit"),to:Bh(e[4]),value:Ot(e[5],"value"),data:Ne(e[6]),accessList:d0(e[7],"accessList")};return e.length===8||f0(n,e.slice(8)),n}function oue(t,e){const n=[Ct(t.chainId,"chainId"),Ct(t.nonce,"nonce"),Ct(t.gasPrice||0,"gasPrice"),Ct(t.gasLimit,"gasLimit"),t.to||"0x",Ct(t.value,"value"),t.data,h0(t.accessList||[])];return e&&(n.push(Ct(e.yParity,"recoveryParam")),n.push(kn(e.r)),n.push(kn(e.s))),cn(["0x01",Ka(n)])}function iue(t){let e=tg(dt(t).slice(1)),n="3",r=null;if(e.length===4&&Array.isArray(e[0])){n="3 (network format)";const o=e[1],i=e[2],a=e[3];J(Array.isArray(o),"invalid network format: blobs not an array","fields[1]",o),J(Array.isArray(i),"invalid network format: commitments not an array","fields[2]",i),J(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),J(o.length===i.length,"invalid network format: blobs/commitments length mismatch","fields",e),J(o.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),r=[];for(let l=0;l<e[1].length;l++)r.push({data:o[l],commitment:i[l],proof:a[l]});e=e[0]}J(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${n}`,"data",Ne(t));const s={type:3,chainId:Ot(e[0],"chainId"),nonce:tu(e[1],"nonce"),maxPriorityFeePerGas:Ot(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Ot(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Ot(e[4],"gasLimit"),to:Bh(e[5]),value:Ot(e[6],"value"),data:Ne(e[7]),accessList:d0(e[8],"accessList"),maxFeePerBlobGas:Ot(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};r&&(s.blobs=r),J(s.to!=null,`invalid address for transaction type: ${n}`,"data",t),J(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let o=0;o<s.blobVersionedHashes.length;o++)J(Ht(s.blobVersionedHashes[o],32),`invalid blobVersionedHash at index ${o}: must be length 32`,"data",t);return e.length===11||f0(s,e.slice(11)),s}function aue(t,e,n){const r=[Ct(t.chainId,"chainId"),Ct(t.nonce,"nonce"),Ct(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Ct(t.maxFeePerGas||0,"maxFeePerGas"),Ct(t.gasLimit,"gasLimit"),t.to||qm,Ct(t.value,"value"),t.data,h0(t.accessList||[]),Ct(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),Zce(t.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(r.push(Ct(e.yParity,"yParity")),r.push(kn(e.r)),r.push(kn(e.s)),n)?cn(["0x03",Ka([r,n.map(s=>s.data),n.map(s=>s.commitment),n.map(s=>s.proof)])]):cn(["0x03",Ka(r)])}function lue(t){const e=tg(dt(t).slice(1));J(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",Ne(t));const n={type:4,chainId:Ot(e[0],"chainId"),nonce:tu(e[1],"nonce"),maxPriorityFeePerGas:Ot(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Ot(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Ot(e[4],"gasLimit"),to:Bh(e[5]),value:Ot(e[6],"value"),data:Ne(e[7]),accessList:d0(e[8],"accessList"),authorizationList:Jce(e[9],"authorizationList")};return e.length===10||f0(n,e.slice(10)),n}function cue(t,e){const n=[Ct(t.chainId,"chainId"),Ct(t.nonce,"nonce"),Ct(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Ct(t.maxFeePerGas||0,"maxFeePerGas"),Ct(t.gasLimit,"gasLimit"),t.to||"0x",Ct(t.value,"value"),t.data,h0(t.accessList||[]),Xce(t.authorizationList||[])];return e&&(n.push(Ct(e.yParity,"yParity")),n.push(kn(e.r)),n.push(kn(e.s))),cn(["0x04",Ka(n)])}var Fs,ud,dd,hd,fd,md,pd,gd,yd,wd,bd,vd,tc,ma,lo,pa,xd,Cd,Py;const so=class so{constructor(){ce(this,Cd);ce(this,Fs);ce(this,ud);ce(this,dd);ce(this,hd);ce(this,fd);ce(this,md);ce(this,pd);ce(this,gd);ce(this,yd);ce(this,wd);ce(this,bd);ce(this,vd);ce(this,tc);ce(this,ma);ce(this,lo);ce(this,pa);ce(this,xd);G(this,Fs,null),G(this,ud,null),G(this,hd,0),G(this,fd,jn),G(this,md,null),G(this,pd,null),G(this,gd,null),G(this,dd,"0x"),G(this,yd,jn),G(this,wd,jn),G(this,bd,null),G(this,vd,null),G(this,tc,null),G(this,ma,null),G(this,lo,null),G(this,pa,null),G(this,xd,null)}get type(){return H(this,Fs)}set type(e){switch(e){case null:G(this,Fs,null);break;case 0:case"legacy":G(this,Fs,0);break;case 1:case"berlin":case"eip-2930":G(this,Fs,1);break;case 2:case"london":case"eip-1559":G(this,Fs,2);break;case 3:case"cancun":case"eip-4844":G(this,Fs,3);break;case 4:case"pectra":case"eip-7702":G(this,Fs,4);break;default:J(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=H(this,ud);return e==null&&this.type===3?qm:e}set to(e){G(this,ud,e==null?null:Pt(e))}get nonce(){return H(this,hd)}set nonce(e){G(this,hd,ht(e,"value"))}get gasLimit(){return H(this,fd)}set gasLimit(e){G(this,fd,Ve(e))}get gasPrice(){const e=H(this,md);return e==null&&(this.type===0||this.type===1)?jn:e}set gasPrice(e){G(this,md,e==null?null:Ve(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=H(this,pd);return e??(this.type===2||this.type===3?jn:null)}set maxPriorityFeePerGas(e){G(this,pd,e==null?null:Ve(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=H(this,gd);return e??(this.type===2||this.type===3?jn:null)}set maxFeePerGas(e){G(this,gd,e==null?null:Ve(e,"maxFeePerGas"))}get data(){return H(this,dd)}set data(e){G(this,dd,Ne(e))}get value(){return H(this,yd)}set value(e){G(this,yd,Ve(e,"value"))}get chainId(){return H(this,wd)}set chainId(e){G(this,wd,Ve(e))}get signature(){return H(this,bd)||null}set signature(e){G(this,bd,e==null?null:Fr.from(e))}get accessList(){const e=H(this,vd)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){G(this,vd,e==null?null:eu(e))}get authorizationList(){const e=H(this,xd)||null;return e==null&&this.type===4?[]:e}set authorizationList(e){G(this,xd,e==null?null:e.map(n=>XV(n)))}get maxFeePerBlobGas(){const e=H(this,tc);return e==null&&this.type===3?jn:e}set maxFeePerBlobGas(e){G(this,tc,e==null?null:Ve(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=H(this,ma);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){J(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let n=0;n<e.length;n++)J(Ht(e[n],32),"invalid blobVersionedHash",`value[${n}]`,e[n])}G(this,ma,e)}get blobs(){return H(this,pa)==null?null:H(this,pa).map(e=>Object.assign({},e))}set blobs(e){if(e==null){G(this,pa,null);return}const n=[],r=[];for(let s=0;s<e.length;s++){const o=e[s];if(BI(o)){xe(H(this,lo),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let i=dt(o);if(J(i.length<=zv,"blob is too large",`blobs[${s}]`,o),i.length!==zv){const c=new Uint8Array(zv);c.set(i),i=c}const a=H(this,lo).blobToKzgCommitment(i),l=Ne(H(this,lo).computeBlobKzgProof(i,a));n.push({data:Ne(i),commitment:Ne(a),proof:l}),r.push(bR(1,a))}else{const i=Ne(o.commitment);n.push({data:Ne(o.data),commitment:i,proof:Ne(o.proof)}),r.push(bR(1,i))}}G(this,pa,n),G(this,ma,r)}get kzg(){return H(this,lo)}set kzg(e){e==null?G(this,lo,null):G(this,lo,Yce(e))}get hash(){return this.signature==null?null:pn(ke(this,Cd,Py).call(this,!0,!1))}get unsignedHash(){return pn(this.unsignedSerialized)}get from(){return this.signature==null?null:zce(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:Qm.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return ke(this,Cd,Py).call(this,!0,!0)}get unsignedSerialized(){return ke(this,Cd,Py).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,n=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,r=this.accessList!=null,s=H(this,tc)!=null||H(this,ma);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&xe(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),xe(!n||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),xe(this.type!==0||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const o=[];return this.type!=null?o.push(this.type):this.authorizationList&&this.authorizationList.length?o.push(4):n?o.push(2):e?(o.push(1),r||o.push(0)):r?(o.push(1),o.push(2)):(s&&this.to||(o.push(0),o.push(1),o.push(2)),o.push(3)),o.sort(),o}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return so.from(this)}toJSON(){const e=n=>n==null?null:n.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new so;if(typeof e=="string"){const r=dt(e);if(r[0]>=127)return so.from(eue(r));switch(r[0]){case 1:return so.from(sue(r));case 2:return so.from(nue(r));case 3:return so.from(iue(r));case 4:return so.from(lue(r))}xe(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const n=new so;return e.type!=null&&(n.type=e.type),e.to!=null&&(n.to=e.to),e.nonce!=null&&(n.nonce=e.nonce),e.gasLimit!=null&&(n.gasLimit=e.gasLimit),e.gasPrice!=null&&(n.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(n.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(n.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(n.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(n.data=e.data),e.value!=null&&(n.value=e.value),e.chainId!=null&&(n.chainId=e.chainId),e.signature!=null&&(n.signature=Fr.from(e.signature)),e.accessList!=null&&(n.accessList=e.accessList),e.authorizationList!=null&&(n.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(n.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(n.kzg=e.kzg),e.blobs!=null&&(n.blobs=e.blobs),e.hash!=null&&(J(n.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),J(n.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(J(n.isSigned(),"unsigned transaction cannot define '.from'","tx",e),J(n.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),n}};Fs=new WeakMap,ud=new WeakMap,dd=new WeakMap,hd=new WeakMap,fd=new WeakMap,md=new WeakMap,pd=new WeakMap,gd=new WeakMap,yd=new WeakMap,wd=new WeakMap,bd=new WeakMap,vd=new WeakMap,tc=new WeakMap,ma=new WeakMap,lo=new WeakMap,pa=new WeakMap,xd=new WeakMap,Cd=new WeakSet,Py=function(e,n){xe(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const r=e?this.signature:null;switch(this.inferType()){case 0:return tue(this,r);case 1:return oue(this,r);case 2:return rue(this,r);case 3:return aue(this,r,n?this.blobs:null);case 4:return cue(this,r)}xe(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let Uw=so;function Hc(t){return pn(Lo(t))}var uue="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const vR=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),xR=4;function due(t){let e=0;function n(){return t[e++]<<8|t[e++]}let r=n(),s=1,o=[0,1];for(let M=1;M<r;M++)o.push(s+=n());let i=n(),a=e;e+=i;let l=0,c=0;function u(){return l==0&&(c=c<<8|t[e++],l=8),c>>--l&1}const h=31,f=2**h,g=f>>>1,y=g>>1,w=f-1;let v=0;for(let M=0;M<h;M++)v=v<<1|u();let C=[],x=0,A=f;for(;;){let M=Math.floor(((v-x+1)*s-1)/A),k=0,E=r;for(;E-k>1;){let P=k+E>>>1;M<o[P]?E=P:k=P}if(k==0)break;C.push(k);let b=x+Math.floor(A*o[k]/s),I=x+Math.floor(A*o[k+1]/s)-1;for(;((b^I)&g)==0;)v=v<<1&w|u(),b=b<<1&w,I=I<<1&w|1;for(;b&~I&y;)v=v&g|v<<1&w>>>1|u(),b=b<<1^g,I=(I^g)<<1|g|1;x=b,A=1+I-b}let N=r-4;return C.map(M=>{switch(M-N){case 3:return N+65792+(t[a++]<<16|t[a++]<<8|t[a++]);case 2:return N+256+(t[a++]<<8|t[a++]);case 1:return N+t[a++];default:return M-1}})}function hue(t){let e=0;return()=>t[e++]}function ZV(t){return hue(due(fue(t)))}function fue(t){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,o)=>e[s.charCodeAt(0)]=o);let n=t.length,r=new Uint8Array(6*n>>3);for(let s=0,o=0,i=0,a=0;s<n;s++)a=a<<6|e[t.charCodeAt(s)],i+=6,i>=8&&(r[o++]=a>>(i-=8));return r}function mue(t){return t&1?~t>>1:t>>1}function pue(t,e){let n=Array(t);for(let r=0,s=0;r<t;r++)n[r]=s+=mue(e());return n}function Ym(t,e=0){let n=[];for(;;){let r=t(),s=t();if(!s)break;e+=r;for(let o=0;o<s;o++)n.push(e+o);e+=s+1}return n}function e4(t){return Jm(()=>{let e=Ym(t);if(e.length)return e})}function t4(t){let e=[];for(;;){let n=t();if(n==0)break;e.push(gue(n,t))}for(;;){let n=t()-1;if(n<0)break;e.push(yue(n,t))}return e.flat()}function Jm(t){let e=[];for(;;){let n=t(e.length);if(!n)break;e.push(n)}return e}function n4(t,e,n){let r=Array(t).fill().map(()=>[]);for(let s=0;s<e;s++)pue(t,n).forEach((o,i)=>r[i].push(o));return r}function gue(t,e){let n=1+e(),r=e(),s=Jm(e);return n4(s.length,1+t,e).flatMap((i,a)=>{let[l,...c]=i;return Array(s[a]).fill().map((u,h)=>{let f=h*r;return[l+h*n,c.map(g=>g+f)]})})}function yue(t,e){let n=1+e();return n4(n,1+t,e).map(s=>[s[0],s.slice(1)])}function wue(t){let e=[],n=Ym(t);return s(r([]),[]),e;function r(o){let i=t(),a=Jm(()=>{let l=Ym(t).map(c=>n[c]);if(l.length)return r(l)});return{S:i,B:a,Q:o}}function s({S:o,B:i},a,l){if(!(o&4&&l===a[a.length-1])){o&2&&(l=a[a.length-1]),o&1&&e.push(a);for(let c of i)for(let u of c.Q)s(c,[...a,u],l)}}}function bue(t){return t.toString(16).toUpperCase().padStart(2,"0")}function r4(t){return`{${bue(t)}}`}function vue(t){let e=[];for(let n=0,r=t.length;n<r;){let s=t.codePointAt(n);n+=s<65536?1:2,e.push(s)}return e}function ph(t){let n=t.length;if(n<4096)return String.fromCodePoint(...t);let r=[];for(let s=0;s<n;)r.push(String.fromCodePoint(...t.slice(s,s+=4096)));return r.join("")}function xue(t,e){let n=t.length,r=n-e.length;for(let s=0;r==0&&s<n;s++)r=t[s]-e[s];return r}var Cue="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const Xm=44032,Hw=4352,$w=4449,zw=4519,s4=19,o4=21,gh=28,Gw=o4*gh,Eue=s4*Gw,Iue=Xm+Eue,_ue=Hw+s4,Aue=$w+o4,Sue=zw+gh;function zf(t){return t>>24&255}function i4(t){return t&16777215}let VC,CR,BC,ky;function Tue(){let t=ZV(Cue);VC=new Map(e4(t).flatMap((e,n)=>e.map(r=>[r,n+1<<24]))),CR=new Set(Ym(t)),BC=new Map,ky=new Map;for(let[e,n]of t4(t)){if(!CR.has(e)&&n.length==2){let[r,s]=n,o=ky.get(r);o||(o=new Map,ky.set(r,o)),o.set(s,e)}BC.set(e,n.reverse())}}function a4(t){return t>=Xm&&t<Iue}function Pue(t,e){if(t>=Hw&&t<_ue&&e>=$w&&e<Aue)return Xm+(t-Hw)*Gw+(e-$w)*gh;if(a4(t)&&e>zw&&e<Sue&&(t-Xm)%gh==0)return t+(e-zw);{let n=ky.get(t);return n&&(n=n.get(e),n)?n:-1}}function l4(t){VC||Tue();let e=[],n=[],r=!1;function s(o){let i=VC.get(o);i&&(r=!0,o|=i),e.push(o)}for(let o of t)for(;;){if(o<128)e.push(o);else if(a4(o)){let i=o-Xm,a=i/Gw|0,l=i%Gw/gh|0,c=i%gh;s(Hw+a),s($w+l),c>0&&s(zw+c)}else{let i=BC.get(o);i?n.push(...i):s(o)}if(!n.length)break;o=n.pop()}if(r&&e.length>1){let o=zf(e[0]);for(let i=1;i<e.length;i++){let a=zf(e[i]);if(a==0||o<=a){o=a;continue}let l=i-1;for(;;){let c=e[l+1];if(e[l+1]=e[l],e[l]=c,!l||(o=zf(e[--l]),o<=a))break}o=zf(e[i])}}return e}function kue(t){let e=[],n=[],r=-1,s=0;for(let o of t){let i=zf(o),a=i4(o);if(r==-1)i==0?r=a:e.push(a);else if(s>0&&s>=i)i==0?(e.push(r,...n),n.length=0,r=a):n.push(a),s=i;else{let l=Pue(r,a);l>=0?r=l:s==0&&i==0?(e.push(r),r=a):(n.push(a),s=i)}}return r>=0&&e.push(r,...n),e}function c4(t){return l4(t).map(i4)}function Rue(t){return kue(l4(t))}const ER=45,u4=".",d4=65039,h4=1,Ww=t=>Array.from(t);function Zm(t,e){return t.P.has(e)||t.Q.has(e)}class Nue extends Array{get is_emoji(){return!0}}let UC,f4,Hl,HC,m4,Xu,Gv,Tu,Tl,IR,$C;function JI(){if(UC)return;let t=ZV(uue);const e=()=>Ym(t),n=()=>new Set(e()),r=(u,h)=>h.forEach(f=>u.add(f));UC=new Map(t4(t)),f4=n(),Hl=e(),HC=new Set(e().map(u=>Hl[u])),Hl=new Set(Hl),m4=n(),n();let s=e4(t),o=t();const i=()=>{let u=new Set;return e().forEach(h=>r(u,s[h])),r(u,e()),u};Xu=Jm(u=>{let h=Jm(t).map(f=>f+96);if(h.length){let f=u>=o;h[0]-=32,h=ph(h),f&&(h=`Restricted[${h}]`);let g=i(),y=i(),w=!t();return{N:h,P:g,Q:y,M:w,R:f}}}),Gv=n(),Tu=new Map;let a=e().concat(Ww(Gv)).sort((u,h)=>u-h);a.forEach((u,h)=>{let f=t(),g=a[h]=f?a[h-f]:{V:[],M:new Map};g.V.push(u),Gv.has(u)||Tu.set(u,g)});for(let{V:u,M:h}of new Set(Tu.values())){let f=[];for(let y of u){let w=Xu.filter(C=>Zm(C,y)),v=f.find(({G:C})=>w.some(x=>C.has(x)));v||(v={G:new Set,V:[]},f.push(v)),v.V.push(y),r(v.G,w)}let g=f.flatMap(y=>Ww(y.G));for(let{G:y,V:w}of f){let v=new Set(g.filter(C=>!y.has(C)));for(let C of w)h.set(C,v)}}Tl=new Set;let l=new Set;const c=u=>Tl.has(u)?l.add(u):Tl.add(u);for(let u of Xu){for(let h of u.P)c(h);for(let h of u.Q)c(h)}for(let u of Tl)!Tu.has(u)&&!l.has(u)&&Tu.set(u,h4);r(Tl,c4(Tl)),IR=wue(t).map(u=>Nue.from(u)).sort(xue),$C=new Map;for(let u of IR){let h=[$C];for(let f of u){let g=h.map(y=>{let w=y.get(f);return w||(w=new Map,y.set(f,w)),w});f===d4?h.push(...g):h=g}for(let f of h)f.V=u}}function XI(t){return(p4(t)?"":`${ZI(m0([t]))} `)+r4(t)}function ZI(t){return`"${t}"`}function Due(t){if(t.length>=4&&t[2]==ER&&t[3]==ER)throw new Error(`invalid label extension: "${ph(t.slice(0,4))}"`)}function Mue(t){for(let n=t.lastIndexOf(95);n>0;)if(t[--n]!==95)throw new Error("underscore allowed only at start")}function Oue(t){let e=t[0],n=vR.get(e);if(n)throw pm(`leading ${n}`);let r=t.length,s=-1;for(let o=1;o<r;o++){e=t[o];let i=vR.get(e);if(i){if(s==o)throw pm(`${n} + ${i}`);s=o+1,n=i}}if(s==r)throw pm(`trailing ${n}`)}function m0(t,e=1/0,n=r4){let r=[];Lue(t[0])&&r.push(""),t.length>e&&(e>>=1,t=[...t.slice(0,e),8230,...t.slice(-e)]);let s=0,o=t.length;for(let i=0;i<o;i++){let a=t[i];p4(a)&&(r.push(ph(t.slice(s,i))),r.push(n(a)),s=i+1)}return r.push(ph(t.slice(s,o))),r.join("")}function Lue(t){return JI(),Hl.has(t)}function p4(t){return JI(),m4.has(t)}function Fue(t){return Uue(jue(t,Rue,zue))}function jue(t,e,n){if(!t)return[];JI();let r=0;return t.split(u4).map(s=>{let o=vue(s),i={input:o,offset:r};r+=o.length+1;try{let a=i.tokens=$ue(o,e,n),l=a.length,c;if(!l)throw new Error("empty label");let u=i.output=a.flat();if(Mue(u),!(i.emoji=l>1||a[0].is_emoji)&&u.every(f=>f<128))Due(u),c="ASCII";else{let f=a.flatMap(g=>g.is_emoji?[]:g);if(!f.length)c="Emoji";else{if(Hl.has(u[0]))throw pm("leading combining mark");for(let w=1;w<l;w++){let v=a[w];if(!v.is_emoji&&Hl.has(v[0]))throw pm(`emoji + combining mark: "${ph(a[w-1])} + ${m0([v[0]])}"`)}Oue(u);let g=Ww(new Set(f)),[y]=Bue(g);Hue(y,f),Vue(y,g),c=y.N}}i.type=c}catch(a){i.error=a}return i})}function Vue(t,e){let n,r=[];for(let s of e){let o=Tu.get(s);if(o===h4)return;if(o){let i=o.M.get(s);if(n=n?n.filter(a=>i.has(a)):Ww(i),!n.length)return}else r.push(s)}if(n){for(let s of n)if(r.every(o=>Zm(s,o)))throw new Error(`whole-script confusable: ${t.N}/${s.N}`)}}function Bue(t){let e=Xu;for(let n of t){let r=e.filter(s=>Zm(s,n));if(!r.length)throw Xu.some(s=>Zm(s,n))?y4(e[0],n):g4(n);if(e=r,r.length==1)break}return e}function Uue(t){return t.map(({input:e,error:n,output:r})=>{if(n){let s=n.message;throw new Error(t.length==1?s:`Invalid label ${ZI(m0(e,63))}: ${s}`)}return ph(r)}).join(u4)}function g4(t){return new Error(`disallowed character: ${XI(t)}`)}function y4(t,e){let n=XI(e),r=Xu.find(s=>s.P.has(e));return r&&(n=`${r.N} ${n}`),new Error(`illegal mixture: ${t.N} + ${n}`)}function pm(t){return new Error(`illegal placement: ${t}`)}function Hue(t,e){for(let n of e)if(!Zm(t,n))throw y4(t,n);if(t.M){let n=c4(e);for(let r=1,s=n.length;r<s;r++)if(HC.has(n[r])){let o=r+1;for(let i;o<s&&HC.has(i=n[o]);o++)for(let a=r;a<o;a++)if(n[a]==i)throw new Error(`duplicate non-spacing marks: ${XI(i)}`);if(o-r>xR)throw new Error(`excessive non-spacing marks: ${ZI(m0(n.slice(r-1,o)))} (${o-r}/${xR})`);r=o}}}function $ue(t,e,n){let r=[],s=[];for(t=t.slice().reverse();t.length;){let o=Gue(t);if(o)s.length&&(r.push(e(s)),s=[]),r.push(n(o));else{let i=t.pop();if(Tl.has(i))s.push(i);else{let a=UC.get(i);if(a)s.push(...a);else if(!f4.has(i))throw g4(i)}}}return s.length&&r.push(e(s)),r}function zue(t){return t.filter(e=>e!=d4)}function Gue(t,e){let n=$C,r,s=t.length;for(;s&&(n=n.get(t[--s]),!!n);){let{V:o}=n;o&&(r=o,t.length=s)}return r}const w4=new Uint8Array(32);w4.fill(0);function _R(t){return J(t.length!==0,"invalid ENS name; empty component","comp",t),t}function b4(t){const e=Lo(Wue(t)),n=[];if(t.length===0)return n;let r=0;for(let s=0;s<e.length;s++)e[s]===46&&(n.push(_R(e.slice(r,s))),r=s+1);return J(r<e.length,"invalid ENS name; empty component","name",t),n.push(_R(e.slice(r))),n}function Wue(t){try{if(t.length===0)throw new Error("empty label");return Fue(t)}catch(e){J(!1,`invalid ENS name (${e.message})`,"name",t)}}function zC(t){J(typeof t=="string","invalid ENS name; not a string","name",t),J(t.length,"invalid ENS name (empty label)","name",t);let e=w4;const n=b4(t);for(;n.length;)e=pn(cn([e,pn(n.pop())]));return Ne(e)}function Kue(t,e){const n=e;return J(n<=255,"DNS encoded label cannot exceed 255","length",n),Ne(cn(b4(t).map(r=>{J(r.length<=n,`label ${JSON.stringify(t)} exceeds ${n} bytes`,"name",t);const s=new Uint8Array(r.length+1);return s.set(r,1),s[0]=s.length-1,s})))+"00"}const v4=new Uint8Array(32);v4.fill(0);const que=BigInt(-1),x4=BigInt(0),C4=BigInt(1),Que=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Yue(t){const e=dt(t),n=e.length%32;return n?cn([e,v4.slice(n)]):Ne(e)}const Jue=Ga(C4,32),Xue=Ga(x4,32),AR={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},Wv=["name","version","chainId","verifyingContract","salt"];function SR(t){return function(e){return J(typeof e=="string",`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const Zue={name:SR("name"),version:SR("version"),chainId:function(t){const e=Ve(t,"domain.chainId");return J(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):Hs(e)},verifyingContract:function(t){try{return Pt(t).toLowerCase()}catch{}J(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=dt(t,"domain.salt");return J(e.length===32,'invalid domain value "salt"',"domain.salt",t),Ne(e)}};function Kv(t){{const e=t.match(/^(u?)int(\d+)$/);if(e){const n=e[1]==="",r=parseInt(e[2]);J(r%8===0&&r!==0&&r<=256&&e[2]===String(r),"invalid numeric width","type",t);const s=Hf(Que,n?r-1:r),o=n?(s+C4)*que:x4;return function(i){const a=Ve(i,"value");return J(a>=o&&a<=s,`value out-of-bounds for ${t}`,"value",a),Ga(n?lV(a,256):a,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const n=parseInt(e[1]);return J(n!==0&&n<=32&&e[1]===String(n),"invalid bytes width","type",t),function(r){const s=dt(r);return J(s.length===n,`invalid length for ${t}`,"value",r),Yue(r)}}}switch(t){case"address":return function(e){return Ti(Pt(e),32)};case"bool":return function(e){return e?Jue:Xue};case"bytes":return function(e){return pn(e)};case"string":return function(e){return Hc(e)}}return null}function TR(t,e){return`${t}(${e.map(({name:n,type:r})=>r+" "+n).join(",")})`}function Xg(t){const e=t.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:t}}var ap,ni,Ed,eb,E4;const cs=class cs{constructor(e){ce(this,eb);oe(this,"primaryType");ce(this,ap);ce(this,ni);ce(this,Ed);G(this,ni,new Map),G(this,Ed,new Map);const n=new Map,r=new Map,s=new Map,o={};Object.keys(e).forEach(l=>{o[l]=e[l].map(({name:c,type:u})=>{let{base:h,index:f}=Xg(u);return h==="int"&&!e.int&&(h="int256"),h==="uint"&&!e.uint&&(h="uint256"),{name:c,type:h+(f||"")}}),n.set(l,new Set),r.set(l,[]),s.set(l,new Set)}),G(this,ap,JSON.stringify(o));for(const l in o){const c=new Set;for(const u of o[l]){J(!c.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(l)}`,"types",e),c.add(u.name);const h=Xg(u.type).base;J(h!==l,`circular type reference to ${JSON.stringify(h)}`,"types",e),!Kv(h)&&(J(r.has(h),`unknown type ${JSON.stringify(h)}`,"types",e),r.get(h).push(l),n.get(l).add(h))}}const i=Array.from(r.keys()).filter(l=>r.get(l).length===0);J(i.length!==0,"missing primary type","types",e),J(i.length===1,`ambiguous primary types or unused types: ${i.map(l=>JSON.stringify(l)).join(", ")}`,"types",e),Je(this,{primaryType:i[0]});function a(l,c){J(!c.has(l),`circular type reference to ${JSON.stringify(l)}`,"types",e),c.add(l);for(const u of n.get(l))if(r.has(u)){a(u,c);for(const h of c)s.get(h).add(u)}c.delete(l)}a(this.primaryType,new Set);for(const[l,c]of s){const u=Array.from(c);u.sort(),H(this,ni).set(l,TR(l,o[l])+u.map(h=>TR(h,o[h])).join(""))}}get types(){return JSON.parse(H(this,ap))}getEncoder(e){let n=H(this,Ed).get(e);return n||(n=ke(this,eb,E4).call(this,e),H(this,Ed).set(e,n)),n}encodeType(e){const n=H(this,ni).get(e);return J(n,`unknown type: ${JSON.stringify(e)}`,"name",e),n}encodeData(e,n){return this.getEncoder(e)(n)}hashStruct(e,n){return pn(this.encodeData(e,n))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,n,r){if(Kv(e))return r(e,n);const s=Xg(e).array;if(s)return J(s.count===-1||s.count===n.length,`array length mismatch; expected length ${s.count}`,"value",n),n.map(i=>this._visit(s.prefix,i,r));const o=this.types[e];if(o)return o.reduce((i,{name:a,type:l})=>(i[a]=this._visit(l,n[a],r),i),{});J(!1,`unknown type: ${e}`,"type",e)}visit(e,n){return this._visit(this.primaryType,e,n)}static from(e){return new cs(e)}static getPrimaryType(e){return cs.from(e).primaryType}static hashStruct(e,n,r){return cs.from(n).hashStruct(e,r)}static hashDomain(e){const n=[];for(const r in e){if(e[r]==null)continue;const s=AR[r];J(s,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),n.push({name:r,type:s})}return n.sort((r,s)=>Wv.indexOf(r.name)-Wv.indexOf(s.name)),cs.hashStruct("EIP712Domain",{EIP712Domain:n},e)}static encode(e,n,r){return cn(["0x1901",cs.hashDomain(e),cs.from(n).hash(r)])}static hash(e,n,r){return pn(cs.encode(e,n,r))}static async resolveNames(e,n,r,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const o={};e.verifyingContract&&!Ht(e.verifyingContract,20)&&(o[e.verifyingContract]="0x");const i=cs.from(n);i.visit(r,(a,l)=>(a==="address"&&!Ht(l,20)&&(o[l]="0x"),l));for(const a in o)o[a]=await s(a);return e.verifyingContract&&o[e.verifyingContract]&&(e.verifyingContract=o[e.verifyingContract]),r=i.visit(r,(a,l)=>a==="address"&&o[l]?o[l]:l),{domain:e,value:r}}static getPayload(e,n,r){cs.hashDomain(e);const s={},o=[];Wv.forEach(l=>{const c=e[l];c!=null&&(s[l]=Zue[l](c),o.push({name:l,type:AR[l]}))});const i=cs.from(n);n=i.types;const a=Object.assign({},n);return J(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",n),a.EIP712Domain=o,i.encode(r),{types:a,domain:s,primaryType:i.primaryType,message:i.visit(r,(l,c)=>{if(l.match(/^bytes(\d*)/))return Ne(dt(c));if(l.match(/^u?int/))return Ve(c).toString();switch(l){case"address":return c.toLowerCase();case"bool":return!!c;case"string":return J(typeof c=="string","invalid string","value",c),c}J(!1,"unsupported type","type",l)})}}};ap=new WeakMap,ni=new WeakMap,Ed=new WeakMap,eb=new WeakSet,E4=function(e){{const s=Kv(e);if(s)return s}const n=Xg(e).array;if(n){const s=n.prefix,o=this.getEncoder(s);return i=>{J(n.count===-1||n.count===i.length,`array length mismatch; expected length ${n.count}`,"value",i);let a=i.map(o);return H(this,ni).has(s)&&(a=a.map(pn)),pn(cn(a))}}const r=this.types[e];if(r){const s=Hc(H(this,ni).get(e));return o=>{const i=r.map(({name:a,type:l})=>{const c=this.getEncoder(l)(o[a]);return H(this,ni).has(l)?pn(c):c});return i.unshift(s),cn(i)}}J(!1,`unknown type: ${e}`,"type",e)};let Kw=cs;function Cr(t){const e=new Set;return t.forEach(n=>e.add(n)),Object.freeze(e)}const ede="external public payable override",tde=Cr(ede.split(" ")),I4="constant external internal payable private public pure view override",nde=Cr(I4.split(" ")),_4="constructor error event fallback function receive struct",A4=Cr(_4.split(" ")),S4="calldata memory storage payable indexed",rde=Cr(S4.split(" ")),sde="tuple returns",ode=[_4,S4,sde,I4].join(" "),ide=Cr(ode.split(" ")),ade={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},lde=new RegExp("^(\\s*)"),cde=new RegExp("^([0-9]+)"),ude=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),T4=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),P4=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var $n,js,lp,GC;const tb=class tb{constructor(e){ce(this,lp);ce(this,$n);ce(this,js);G(this,$n,0),G(this,js,e.slice())}get offset(){return H(this,$n)}get length(){return H(this,js).length-H(this,$n)}clone(){return new tb(H(this,js))}reset(){G(this,$n,0)}popKeyword(e){const n=this.peek();if(n.type!=="KEYWORD"||!e.has(n.text))throw new Error(`expected keyword ${n.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const n=this.peek();throw new Error(`expected ${e}; got ${n.type} ${JSON.stringify(n.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const n=ke(this,lp,GC).call(this,H(this,$n)+1,e.match+1);return G(this,$n,e.match+1),n}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const n=[];for(;H(this,$n)<e.match-1;){const r=this.peek().linkNext;n.push(ke(this,lp,GC).call(this,H(this,$n)+1,r)),G(this,$n,r)}return G(this,$n,e.match+1),n}peek(){if(H(this,$n)>=H(this,js).length)throw new Error("out-of-bounds");return H(this,js)[H(this,$n)]}peekKeyword(e){const n=this.peekType("KEYWORD");return n!=null&&e.has(n)?n:null}peekType(e){if(this.length===0)return null;const n=this.peek();return n.type===e?n.text:null}pop(){const e=this.peek();return rf(this,$n)._++,e}toString(){const e=[];for(let n=H(this,$n);n<H(this,js).length;n++){const r=H(this,js)[n];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}};$n=new WeakMap,js=new WeakMap,lp=new WeakSet,GC=function(e=0,n=0){return new tb(H(this,js).slice(e,n).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))};let Js=tb;function al(t){const e=[],n=i=>{const a=o<t.length?JSON.stringify(t[o]):"$EOI";throw new Error(`invalid token ${a} at ${o}: ${i}`)};let r=[],s=[],o=0;for(;o<t.length;){let i=t.substring(o),a=i.match(lde);a&&(o+=a[1].length,i=t.substring(o));const l={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:o,value:-1};e.push(l);let c=ade[i[0]]||"";if(c){if(l.type=c,l.text=i[0],o++,c==="OPEN_PAREN")r.push(e.length-1),s.push(e.length-1);else if(c=="CLOSE_PAREN")r.length===0&&n("no matching open bracket"),l.match=r.pop(),e[l.match].match=e.length-1,l.depth--,l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1;else if(c==="COMMA")l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(c==="OPEN_BRACKET")l.type="BRACKET";else if(c==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const h=e.pop().text;u=h+u,e[e.length-1].value=ht(h)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=i.match(ude),a){if(l.text=a[1],o+=l.text.length,ide.has(l.text)){l.type="KEYWORD";continue}if(l.text.match(P4)){l.type="TYPE";continue}l.type="ID";continue}if(a=i.match(cde),a){l.text=a[1],l.type="NUMBER",o+=l.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(i[0])} at position ${o}`)}return new Js(e.map(i=>Object.freeze(i)))}function PR(t,e){let n=[];for(const r in e.keys())t.has(r)&&n.push(r);if(n.length>1)throw new Error(`conflicting types: ${n.join(", ")}`)}function p0(t,e){if(e.peekKeyword(A4)){const n=e.pop().text;if(n!==t)throw new Error(`expected ${t}, got ${n}`)}return e.popType("ID")}function Pi(t,e){const n=new Set;for(;;){const r=t.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(t.pop(),n.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);n.add(r)}return Object.freeze(n)}function k4(t){let e=Pi(t,nde);return PR(e,Cr("constant payable nonpayable".split(" "))),PR(e,Cr("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function bi(t,e){return t.popParams().map(n=>Jn.from(n,e))}function R4(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return Ve(t.pop().text);throw new Error("invalid gas")}return null}function $c(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const dde=new RegExp(/^(.*)\[([0-9]*)\]$/);function kR(t){const e=t.match(P4);if(J(e,"invalid type","type",t),t==="uint")return"uint256";if(t==="int")return"int256";if(e[2]){const n=parseInt(e[2]);J(n!==0&&n<=32,"invalid bytes length","type",t)}else if(e[3]){const n=parseInt(e[3]);J(n!==0&&n<=256&&n%8===0,"invalid numeric width","type",t)}return t}const Xt={},Vr=Symbol.for("_ethers_internal"),RR="_ParamTypeInternal",NR="_ErrorInternal",DR="_EventInternal",MR="_ConstructorInternal",OR="_FallbackInternal",LR="_FunctionInternal",FR="_StructInternal";var Id,Ry;const us=class us{constructor(e,n,r,s,o,i,a,l){ce(this,Id);oe(this,"name");oe(this,"type");oe(this,"baseType");oe(this,"indexed");oe(this,"components");oe(this,"arrayLength");oe(this,"arrayChildren");if(o0(e,Xt,"ParamType"),Object.defineProperty(this,Vr,{value:RR}),i&&(i=Object.freeze(i.slice())),s==="array"){if(a==null||l==null)throw new Error("")}else if(a!=null||l!=null)throw new Error("");if(s==="tuple"){if(i==null)throw new Error("")}else if(i!=null)throw new Error("");Je(this,{name:n,type:r,baseType:s,indexed:o,components:i,arrayLength:a,arrayChildren:l})}format(e){if(e==null&&(e="sighash"),e==="json"){const r=this.name||"";if(this.isArray()){const o=JSON.parse(this.arrayChildren.format("json"));return o.name=r,o.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(o)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(o=>JSON.parse(o.format(e)))),JSON.stringify(s)}let n="";return this.isArray()?(n+=this.arrayChildren.format(e),n+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?n+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":n+=this.type,e!=="sighash"&&(this.indexed===!0&&(n+=" indexed"),e==="full"&&this.name&&(n+=" "+this.name)),n}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,n){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return e.map(s=>r.arrayChildren.walk(s,n))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const r=this;return e.map((s,o)=>r.components[o].walk(s,n))}return n(this.type,e)}async walkAsync(e,n){const r=[],s=[e];return ke(this,Id,Ry).call(this,r,e,n,o=>{s[0]=o}),r.length&&await Promise.all(r),s[0]}static from(e,n){if(us.isParamType(e))return e;if(typeof e=="string")try{return us.from(al(e),n)}catch{J(!1,"invalid param type","obj",e)}else if(e instanceof Js){let a="",l="",c=null;Pi(e,Cr(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(l="tuple",c=e.popParams().map(w=>us.from(w)),a=`tuple(${c.map(w=>w.format()).join(",")})`):(a=kR(e.popType("TYPE")),l=a);let u=null,h=null;for(;e.length&&e.peekType("BRACKET");){const w=e.pop();u=new us(Xt,"",a,l,null,c,h,u),h=w.value,a+=w.text,l="array",c=null}let f=null;if(Pi(e,rde).has("indexed")){if(!n)throw new Error("");f=!0}const y=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new us(Xt,y,a,l,f,c,h,u)}const r=e.name;J(!r||typeof r=="string"&&r.match(T4),"invalid name","obj.name",r);let s=e.indexed;s!=null&&(J(n,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let o=e.type,i=o.match(dde);if(i){const a=parseInt(i[2]||"-1"),l=us.from({type:i[1],components:e.components});return new us(Xt,r||"",o,"array",s,null,a,l)}if(o==="tuple"||o.startsWith("tuple(")||o.startsWith("(")){const a=e.components!=null?e.components.map(c=>us.from(c)):null;return new us(Xt,r||"",o,"tuple",s,a,null,null)}return o=kR(e.type),new us(Xt,r||"",o,o,s,null,null,null)}static isParamType(e){return e&&e[Vr]===RR}};Id=new WeakSet,Ry=function(e,n,r,s){if(this.isArray()){if(!Array.isArray(n))throw new Error("invalid array value");if(this.arrayLength!==-1&&n.length!==this.arrayLength)throw new Error("array is wrong length");const i=this.arrayChildren,a=n.slice();a.forEach((l,c)=>{var u;ke(u=i,Id,Ry).call(u,e,l,r,h=>{a[c]=h})}),s(a);return}if(this.isTuple()){const i=this.components;let a;if(Array.isArray(n))a=n.slice();else{if(n==null||typeof n!="object")throw new Error("invalid tuple value");a=i.map(l=>{if(!l.name)throw new Error("cannot use object value with unnamed components");if(!(l.name in n))throw new Error(`missing value for component ${l.name}`);return n[l.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((l,c)=>{var u;ke(u=i[c],Id,Ry).call(u,e,l,r,h=>{a[c]=h})}),s(a);return}const o=r(this.type,n);o.then?e.push((async function(){s(await o)})()):s(o)};let Jn=us;class zc{constructor(e,n,r){oe(this,"type");oe(this,"inputs");o0(e,Xt,"Fragment"),r=Object.freeze(r.slice()),Je(this,{type:n,inputs:r})}static from(e){if(typeof e=="string"){try{zc.from(JSON.parse(e))}catch{}return zc.from(al(e))}if(e instanceof Js)switch(e.peekKeyword(A4)){case"constructor":return pi.from(e);case"error":return kr.from(e);case"event":return wo.from(e);case"fallback":case"receive":return Jo.from(e);case"function":return bo.from(e);case"struct":return Cc.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return pi.from(e);case"error":return kr.from(e);case"event":return wo.from(e);case"fallback":case"receive":return Jo.from(e);case"function":return bo.from(e);case"struct":return Cc.from(e)}xe(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}J(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return pi.isFragment(e)}static isError(e){return kr.isFragment(e)}static isEvent(e){return wo.isFragment(e)}static isFunction(e){return bo.isFragment(e)}static isStruct(e){return Cc.isFragment(e)}}class g0 extends zc{constructor(n,r,s,o){super(n,r,o);oe(this,"name");J(typeof s=="string"&&s.match(T4),"invalid identifier","name",s),o=Object.freeze(o.slice()),Je(this,{name:s})}}function ep(t,e){return"("+e.map(n=>n.format(t)).join(t==="full"?", ":",")+")"}class kr extends g0{constructor(e,n,r){super(e,"error",n,r),Object.defineProperty(this,Vr,{value:NR})}get selector(){return Hc(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const n=[];return e!=="sighash"&&n.push("error"),n.push(this.name+ep(e,this.inputs)),n.join(" ")}static from(e){if(kr.isFragment(e))return e;if(typeof e=="string")return kr.from(al(e));if(e instanceof Js){const n=p0("error",e),r=bi(e);return $c(e),new kr(Xt,n,r)}return new kr(Xt,e.name,e.inputs?e.inputs.map(Jn.from):[])}static isFragment(e){return e&&e[Vr]===NR}}class wo extends g0{constructor(n,r,s,o){super(n,"event",r,s);oe(this,"anonymous");Object.defineProperty(this,Vr,{value:DR}),Je(this,{anonymous:o})}get topicHash(){return Hc(this.format("sighash"))}format(n){if(n==null&&(n="sighash"),n==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(n)))});const r=[];return n!=="sighash"&&r.push("event"),r.push(this.name+ep(n,this.inputs)),n!=="sighash"&&this.anonymous&&r.push("anonymous"),r.join(" ")}static getTopicHash(n,r){return r=(r||[]).map(o=>Jn.from(o)),new wo(Xt,n,r,!1).topicHash}static from(n){if(wo.isFragment(n))return n;if(typeof n=="string")try{return wo.from(al(n))}catch{J(!1,"invalid event fragment","obj",n)}else if(n instanceof Js){const r=p0("event",n),s=bi(n,!0),o=!!Pi(n,Cr(["anonymous"])).has("anonymous");return $c(n),new wo(Xt,r,s,o)}return new wo(Xt,n.name,n.inputs?n.inputs.map(r=>Jn.from(r,!0)):[],!!n.anonymous)}static isFragment(n){return n&&n[Vr]===DR}}class pi extends zc{constructor(n,r,s,o,i){super(n,r,s);oe(this,"payable");oe(this,"gas");Object.defineProperty(this,Vr,{value:MR}),Je(this,{payable:o,gas:i})}format(n){if(xe(n!=null&&n!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),n==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(n)))});const r=[`constructor${ep(n,this.inputs)}`];return this.payable&&r.push("payable"),this.gas!=null&&r.push(`@${this.gas.toString()}`),r.join(" ")}static from(n){if(pi.isFragment(n))return n;if(typeof n=="string")try{return pi.from(al(n))}catch{J(!1,"invalid constuctor fragment","obj",n)}else if(n instanceof Js){Pi(n,Cr(["constructor"]));const r=bi(n),s=!!Pi(n,tde).has("payable"),o=R4(n);return $c(n),new pi(Xt,"constructor",r,s,o)}return new pi(Xt,"constructor",n.inputs?n.inputs.map(Jn.from):[],!!n.payable,n.gas!=null?n.gas:null)}static isFragment(n){return n&&n[Vr]===MR}}class Jo extends zc{constructor(n,r,s){super(n,"fallback",r);oe(this,"payable");Object.defineProperty(this,Vr,{value:OR}),Je(this,{payable:s})}format(n){const r=this.inputs.length===0?"receive":"fallback";if(n==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:r,stateMutability:s})}return`${r}()${this.payable?" payable":""}`}static from(n){if(Jo.isFragment(n))return n;if(typeof n=="string")try{return Jo.from(al(n))}catch{J(!1,"invalid fallback fragment","obj",n)}else if(n instanceof Js){const r=n.toString(),s=n.peekKeyword(Cr(["fallback","receive"]));if(J(s,"type must be fallback or receive","obj",r),n.popKeyword(Cr(["fallback","receive"]))==="receive"){const l=bi(n);return J(l.length===0,"receive cannot have arguments","obj.inputs",l),Pi(n,Cr(["payable"])),$c(n),new Jo(Xt,[],!0)}let i=bi(n);i.length?J(i.length===1&&i[0].type==="bytes","invalid fallback inputs","obj.inputs",i.map(l=>l.format("minimal")).join(", ")):i=[Jn.from("bytes")];const a=k4(n);if(J(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),Pi(n,Cr(["returns"])).has("returns")){const l=bi(n);J(l.length===1&&l[0].type==="bytes","invalid fallback outputs","obj.outputs",l.map(c=>c.format("minimal")).join(", "))}return $c(n),new Jo(Xt,i,a==="payable")}if(n.type==="receive")return new Jo(Xt,[],!0);if(n.type==="fallback"){const r=[Jn.from("bytes")],s=n.stateMutability==="payable";return new Jo(Xt,r,s)}J(!1,"invalid fallback description","obj",n)}static isFragment(n){return n&&n[Vr]===OR}}class bo extends g0{constructor(n,r,s,o,i,a){super(n,"function",r,o);oe(this,"constant");oe(this,"outputs");oe(this,"stateMutability");oe(this,"payable");oe(this,"gas");Object.defineProperty(this,Vr,{value:LR}),i=Object.freeze(i.slice()),Je(this,{constant:s==="view"||s==="pure",gas:a,outputs:i,payable:s==="payable",stateMutability:s})}get selector(){return Hc(this.format("sighash")).substring(0,10)}format(n){if(n==null&&(n="sighash"),n==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(n))),outputs:this.outputs.map(s=>JSON.parse(s.format(n)))});const r=[];return n!=="sighash"&&r.push("function"),r.push(this.name+ep(n,this.inputs)),n!=="sighash"&&(this.stateMutability!=="nonpayable"&&r.push(this.stateMutability),this.outputs&&this.outputs.length&&(r.push("returns"),r.push(ep(n,this.outputs))),this.gas!=null&&r.push(`@${this.gas.toString()}`)),r.join(" ")}static getSelector(n,r){return r=(r||[]).map(o=>Jn.from(o)),new bo(Xt,n,"view",r,[],null).selector}static from(n){if(bo.isFragment(n))return n;if(typeof n=="string")try{return bo.from(al(n))}catch{J(!1,"invalid function fragment","obj",n)}else if(n instanceof Js){const s=p0("function",n),o=bi(n),i=k4(n);let a=[];Pi(n,Cr(["returns"])).has("returns")&&(a=bi(n));const l=R4(n);return $c(n),new bo(Xt,s,i,o,a,l)}let r=n.stateMutability;return r==null&&(r="payable",typeof n.constant=="boolean"?(r="view",n.constant||(r="payable",typeof n.payable=="boolean"&&!n.payable&&(r="nonpayable"))):typeof n.payable=="boolean"&&!n.payable&&(r="nonpayable")),new bo(Xt,n.name,r,n.inputs?n.inputs.map(Jn.from):[],n.outputs?n.outputs.map(Jn.from):[],n.gas!=null?n.gas:null)}static isFragment(n){return n&&n[Vr]===LR}}class Cc extends g0{constructor(e,n,r){super(e,"struct",n,r),Object.defineProperty(this,Vr,{value:FR})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Cc.from(al(e))}catch{J(!1,"invalid struct fragment","obj",e)}else if(e instanceof Js){const n=p0("struct",e),r=bi(e);return $c(e),new Cc(Xt,n,r)}return new Cc(Xt,e.name,e.inputs?e.inputs.map(Jn.from):[])}static isFragment(e){return e&&e[Vr]===FR}}const Zs=new Map;Zs.set(0,"GENERIC_PANIC");Zs.set(1,"ASSERT_FALSE");Zs.set(17,"OVERFLOW");Zs.set(18,"DIVIDE_BY_ZERO");Zs.set(33,"ENUM_RANGE_ERROR");Zs.set(34,"BAD_STORAGE_DATA");Zs.set(49,"STACK_UNDERFLOW");Zs.set(50,"ARRAY_RANGE_ERROR");Zs.set(65,"OUT_OF_MEMORY");Zs.set(81,"UNINITIALIZED_FUNCTION_CALL");const hde=new RegExp(/^bytes([0-9]*)$/),fde=new RegExp(/^(u?int)([0-9]*)$/);let qv=null,jR=1024;function mde(t,e,n,r){let s="missing revert data",o=null;const i=null;let a=null;if(n){s="execution reverted";const c=dt(n);if(n=Ne(n),c.length===0)s+=" (no data present; likely require(false) occurred",o="require(false)";else if(c.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(Ne(c.slice(0,4))==="0x08c379a0")try{o=r.decode(["string"],c.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[o]},s+=`: ${JSON.stringify(o)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(Ne(c.slice(0,4))==="0x4e487b71")try{const u=Number(r.decode(["uint256"],c.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},o=`Panic due to ${Zs.get(u)||"UNKNOWN"}(${u})`,s+=`: ${o}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const l={to:e.to?Pt(e.to):null,data:e.data||"0x"};return e.from&&(l.from=Pt(e.from)),qt(s,"CALL_EXCEPTION",{action:t,data:n,reason:o,transaction:l,invocation:i,revert:a})}var ga,Pu;const nb=class nb{constructor(){ce(this,ga)}getDefaultValue(e){const n=e.map(s=>ke(this,ga,Pu).call(this,Jn.from(s)));return new Jg(n,"_").defaultValue()}encode(e,n){oV(n.length,e.length,"types/values length mismatch");const r=e.map(i=>ke(this,ga,Pu).call(this,Jn.from(i))),s=new Jg(r,"_"),o=new RC;return s.encode(o,n),o.data}decode(e,n,r){const s=e.map(i=>ke(this,ga,Pu).call(this,Jn.from(i)));return new Jg(s,"_").decode(new NC(n,r,jR))}static _setDefaultMaxInflation(e){J(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),jR=e}static defaultAbiCoder(){return qv==null&&(qv=new nb),qv}static getBuiltinCallException(e,n,r){return mde(e,n,r,nb.defaultAbiCoder())}};ga=new WeakSet,Pu=function(e){if(e.isArray())return new Nce(ke(this,ga,Pu).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new Jg(e.components.map(r=>ke(this,ga,Pu).call(this,r)),e.name);switch(e.baseType){case"address":return new kce(e.name);case"bool":return new Dce(e.name);case"string":return new Hce(e.name);case"bytes":return new Mce(e.name);case"":return new Fce(e.name)}let n=e.type.match(fde);if(n){let r=parseInt(n[2]||"256");return J(r!==0&&r<=256&&r%8===0,"invalid "+n[1]+" bit length","param",e),new Uce(r/8,n[1]==="int",e.name)}if(n=e.type.match(hde),n){let r=parseInt(n[1]);return J(r!==0&&r<=32,"invalid bytes length","param",e),new Oce(r,e.name)}J(!1,"invalid type","type",e.type)};let tp=nb;class pde{constructor(e,n,r){oe(this,"fragment");oe(this,"name");oe(this,"signature");oe(this,"topic");oe(this,"args");const s=e.name,o=e.format();Je(this,{fragment:e,name:s,signature:o,topic:n,args:r})}}class gde{constructor(e,n,r,s){oe(this,"fragment");oe(this,"name");oe(this,"args");oe(this,"signature");oe(this,"selector");oe(this,"value");const o=e.name,i=e.format();Je(this,{fragment:e,name:o,args:r,signature:i,selector:n,value:s})}}class yde{constructor(e,n,r){oe(this,"fragment");oe(this,"name");oe(this,"args");oe(this,"signature");oe(this,"selector");const s=e.name,o=e.format();Je(this,{fragment:e,name:s,args:r,signature:o,selector:n})}}class VR{constructor(e){oe(this,"hash");oe(this,"_isIndexed");Je(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const BR={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},UR={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&BR[t.toString()]&&(e=BR[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};var co,uo,ho,nr,Fo,Ny,Dy;const Ll=class Ll{constructor(e){ce(this,Fo);oe(this,"fragments");oe(this,"deploy");oe(this,"fallback");oe(this,"receive");ce(this,co);ce(this,uo);ce(this,ho);ce(this,nr);let n=[];typeof e=="string"?n=JSON.parse(e):n=e,G(this,ho,new Map),G(this,co,new Map),G(this,uo,new Map);const r=[];for(const i of n)try{r.push(zc.from(i))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(i)}:`,a.message)}Je(this,{fragments:Object.freeze(r)});let s=null,o=!1;G(this,nr,this.getAbiCoder()),this.fragments.forEach((i,a)=>{let l;switch(i.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}Je(this,{deploy:i});return;case"fallback":i.inputs.length===0?o=!0:(J(!s||i.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,i),s=i,o=s.payable);return;case"function":l=H(this,ho);break;case"event":l=H(this,uo);break;case"error":l=H(this,co);break;default:return}const c=i.format();l.has(c)||l.set(c,i)}),this.deploy||Je(this,{deploy:pi.from("constructor()")}),Je(this,{fallback:s,receive:o})}format(e){const n=e?"minimal":"full";return this.fragments.map(s=>s.format(n))}formatJson(){const e=this.fragments.map(n=>n.format("json"));return JSON.stringify(e.map(n=>JSON.parse(n)))}getAbiCoder(){return tp.defaultAbiCoder()}getFunctionName(e){const n=ke(this,Fo,Ny).call(this,e,null,!1);return J(n,"no matching function","key",e),n.name}hasFunction(e){return!!ke(this,Fo,Ny).call(this,e,null,!1)}getFunction(e,n){return ke(this,Fo,Ny).call(this,e,n||null,!0)}forEachFunction(e){const n=Array.from(H(this,ho).keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(H(this,ho).get(s),r)}}getEventName(e){const n=ke(this,Fo,Dy).call(this,e,null,!1);return J(n,"no matching event","key",e),n.name}hasEvent(e){return!!ke(this,Fo,Dy).call(this,e,null,!1)}getEvent(e,n){return ke(this,Fo,Dy).call(this,e,n||null,!0)}forEachEvent(e){const n=Array.from(H(this,uo).keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(H(this,uo).get(s),r)}}getError(e,n){if(Ht(e)){const s=e.toLowerCase();if(UR[s])return kr.from(UR[s].signature);for(const o of H(this,co).values())if(s===o.selector)return o;return null}if(e.indexOf("(")===-1){const s=[];for(const[o,i]of H(this,co))o.split("(")[0]===e&&s.push(i);if(s.length===0)return e==="Error"?kr.from("error Error(string)"):e==="Panic"?kr.from("error Panic(uint256)"):null;if(s.length>1){const o=s.map(i=>JSON.stringify(i.format())).join(", ");J(!1,`ambiguous error description (i.e. ${o})`,"name",e)}return s[0]}if(e=kr.from(e).format(),e==="Error(string)")return kr.from("error Error(string)");if(e==="Panic(uint256)")return kr.from("error Panic(uint256)");const r=H(this,co).get(e);return r||null}forEachError(e){const n=Array.from(H(this,co).keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(H(this,co).get(s),r)}}_decodeParams(e,n){return H(this,nr).decode(e,n)}_encodeParams(e,n){return H(this,nr).encode(e,n)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,n){if(typeof e=="string"){const r=this.getError(e);J(r,"unknown error","fragment",e),e=r}return J(on(n,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",n),this._decodeParams(e.inputs,on(n,4))}encodeErrorResult(e,n){if(typeof e=="string"){const r=this.getError(e);J(r,"unknown error","fragment",e),e=r}return cn([e.selector,this._encodeParams(e.inputs,n||[])])}decodeFunctionData(e,n){if(typeof e=="string"){const r=this.getFunction(e);J(r,"unknown function","fragment",e),e=r}return J(on(n,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",n),this._decodeParams(e.inputs,on(n,4))}encodeFunctionData(e,n){if(typeof e=="string"){const r=this.getFunction(e);J(r,"unknown function","fragment",e),e=r}return cn([e.selector,this._encodeParams(e.inputs,n||[])])}decodeFunctionResult(e,n){if(typeof e=="string"){const o=this.getFunction(e);J(o,"unknown function","fragment",e),e=o}let r="invalid length for result data";const s=wr(n);if(s.length%32===0)try{return H(this,nr).decode(e.outputs,s)}catch{r="could not decode result data"}xe(!1,r,"BAD_DATA",{value:Ne(s),info:{method:e.name,signature:e.format()}})}makeError(e,n){const r=dt(e,"data"),s=tp.getBuiltinCallException("call",n,r);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=Ne(r.slice(0,4)),l=this.getError(a);if(l)try{const c=H(this,nr).decode(l.inputs,r.slice(4));s.revert={name:l.name,signature:l.format(),args:c},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const i=this.parseTransaction(n);return i&&(s.invocation={method:i.name,signature:i.signature,args:i.args}),s}encodeFunctionResult(e,n){if(typeof e=="string"){const r=this.getFunction(e);J(r,"unknown function","fragment",e),e=r}return Ne(H(this,nr).encode(e.outputs,n||[]))}encodeFilterTopics(e,n){if(typeof e=="string"){const o=this.getEvent(e);J(o,"unknown event","eventFragment",e),e=o}xe(n.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:n.length,expectedCount:e.inputs.length});const r=[];e.anonymous||r.push(e.topicHash);const s=(o,i)=>o.type==="string"?Hc(i):o.type==="bytes"?pn(Ne(i)):(o.type==="bool"&&typeof i=="boolean"?i=i?"0x01":"0x00":o.type.match(/^u?int/)?i=Ga(i):o.type.match(/^bytes/)?i=Fae(i,32):o.type==="address"&&H(this,nr).encode(["address"],[i]),Ti(Ne(i),32));for(n.forEach((o,i)=>{const a=e.inputs[i];if(!a.indexed){J(o==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,o);return}o==null?r.push(null):a.baseType==="array"||a.baseType==="tuple"?J(!1,"filtering with tuples or arrays not supported","contract."+a.name,o):Array.isArray(o)?r.push(o.map(l=>s(a,l))):r.push(s(a,o))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,n){if(typeof e=="string"){const i=this.getEvent(e);J(i,"unknown event","eventFragment",e),e=i}const r=[],s=[],o=[];return e.anonymous||r.push(e.topicHash),J(n.length===e.inputs.length,"event arguments/values mismatch","values",n),e.inputs.forEach((i,a)=>{const l=n[a];if(i.indexed)if(i.type==="string")r.push(Hc(l));else if(i.type==="bytes")r.push(pn(l));else{if(i.baseType==="tuple"||i.baseType==="array")throw new Error("not implemented");r.push(H(this,nr).encode([i.type],[l]))}else s.push(i),o.push(l)}),{data:H(this,nr).encode(s,o),topics:r}}decodeEventLog(e,n,r){if(typeof e=="string"){const g=this.getEvent(e);J(g,"unknown event","eventFragment",e),e=g}if(r!=null&&!e.anonymous){const g=e.topicHash;J(Ht(r[0],32)&&r[0].toLowerCase()===g,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const s=[],o=[],i=[];e.inputs.forEach((g,y)=>{g.indexed?g.type==="string"||g.type==="bytes"||g.baseType==="tuple"||g.baseType==="array"?(s.push(Jn.from({type:"bytes32",name:g.name})),i.push(!0)):(s.push(g),i.push(!1)):(o.push(g),i.push(!1))});const a=r!=null?H(this,nr).decode(s,cn(r)):null,l=H(this,nr).decode(o,n,!0),c=[],u=[];let h=0,f=0;return e.inputs.forEach((g,y)=>{let w=null;if(g.indexed)if(a==null)w=new VR(null);else if(i[y])w=new VR(a[f++]);else try{w=a[f++]}catch(v){w=v}else try{w=l[h++]}catch(v){w=v}c.push(w),u.push(g.name||null)}),uh.fromItems(c,u)}parseTransaction(e){const n=dt(e.data,"tx.data"),r=Ve(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(Ne(n.slice(0,4)));if(!s)return null;const o=H(this,nr).decode(s.inputs,n.slice(4));return new gde(s,s.selector,o,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const n=this.getEvent(e.topics[0]);return!n||n.anonymous?null:new pde(n,n.topicHash,this.decodeEventLog(n,e.data,e.topics))}parseError(e){const n=Ne(e),r=this.getError(on(n,0,4));if(!r)return null;const s=H(this,nr).decode(r.inputs,on(n,4));return new yde(r,r.selector,s)}static from(e){return e instanceof Ll?e:typeof e=="string"?new Ll(JSON.parse(e)):typeof e.formatJson=="function"?new Ll(e.formatJson()):typeof e.format=="function"?new Ll(e.format("json")):new Ll(e)}};co=new WeakMap,uo=new WeakMap,ho=new WeakMap,nr=new WeakMap,Fo=new WeakSet,Ny=function(e,n,r){if(Ht(e)){const o=e.toLowerCase();for(const i of H(this,ho).values())if(o===i.selector)return i;return null}if(e.indexOf("(")===-1){const o=[];for(const[i,a]of H(this,ho))i.split("(")[0]===e&&o.push(a);if(n){const i=n.length>0?n[n.length-1]:null;let a=n.length,l=!0;dr.isTyped(i)&&i.type==="overrides"&&(l=!1,a--);for(let c=o.length-1;c>=0;c--){const u=o[c].inputs.length;u!==a&&(!l||u!==a-1)&&o.splice(c,1)}for(let c=o.length-1;c>=0;c--){const u=o[c].inputs;for(let h=0;h<n.length;h++)if(dr.isTyped(n[h])){if(h>=u.length){if(n[h].type==="overrides")continue;o.splice(c,1);break}if(n[h].type!==u[h].baseType){o.splice(c,1);break}}}}if(o.length===1&&n&&n.length!==o[0].inputs.length){const i=n[n.length-1];(i==null||Array.isArray(i)||typeof i!="object")&&o.splice(0,1)}if(o.length===0)return null;if(o.length>1&&r){const i=o.map(a=>JSON.stringify(a.format())).join(", ");J(!1,`ambiguous function description (i.e. matches ${i})`,"key",e)}return o[0]}const s=H(this,ho).get(bo.from(e).format());return s||null},Dy=function(e,n,r){if(Ht(e)){const o=e.toLowerCase();for(const i of H(this,uo).values())if(o===i.topicHash)return i;return null}if(e.indexOf("(")===-1){const o=[];for(const[i,a]of H(this,uo))i.split("(")[0]===e&&o.push(a);if(n){for(let i=o.length-1;i>=0;i--)o[i].inputs.length<n.length&&o.splice(i,1);for(let i=o.length-1;i>=0;i--){const a=o[i].inputs;for(let l=0;l<n.length;l++)if(dr.isTyped(n[l])&&n[l].type!==a[l].baseType){o.splice(i,1);break}}}if(o.length===0)return null;if(o.length>1&&r){const i=o.map(a=>JSON.stringify(a.format())).join(", ");J(!1,`ambiguous event description (i.e. matches ${i})`,"key",e)}return o[0]}const s=H(this,uo).get(wo.from(e).format());return s||null};let WC=Ll;const N4=BigInt(0);function Zu(t){return t??null}function hn(t){return t==null?null:t.toString()}class HR{constructor(e,n,r){oe(this,"gasPrice");oe(this,"maxFeePerGas");oe(this,"maxPriorityFeePerGas");Je(this,{gasPrice:Zu(e),maxFeePerGas:Zu(n),maxPriorityFeePerGas:Zu(r)})}toJSON(){const{gasPrice:e,maxFeePerGas:n,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:hn(e),maxFeePerGas:hn(n),maxPriorityFeePerGas:hn(r)}}}function qw(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=Ne(t.data));const n="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of n)!(s in t)||t[s]==null||(e[s]=Ve(t[s],`request.${s}`));const r="type,nonce".split(/,/);for(const s of r)!(s in t)||t[s]==null||(e[s]=ht(t[s],`request.${s}`));return t.accessList&&(e.accessList=eu(t.accessList)),t.authorizationList&&(e.authorizationList=t.authorizationList.slice()),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map(s=>BI(s)?Ne(s):Object.assign({},s))),e}var ri;class wde{constructor(e,n){oe(this,"provider");oe(this,"number");oe(this,"hash");oe(this,"timestamp");oe(this,"parentHash");oe(this,"parentBeaconBlockRoot");oe(this,"nonce");oe(this,"difficulty");oe(this,"gasLimit");oe(this,"gasUsed");oe(this,"stateRoot");oe(this,"receiptsRoot");oe(this,"blobGasUsed");oe(this,"excessBlobGas");oe(this,"miner");oe(this,"prevRandao");oe(this,"extraData");oe(this,"baseFeePerGas");ce(this,ri);G(this,ri,e.transactions.map(r=>typeof r!="string"?new np(r,n):r)),Je(this,{provider:n,hash:Zu(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:Zu(e.prevRandao),extraData:e.extraData,baseFeePerGas:Zu(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return H(this,ri).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=H(this,ri).slice();return e.length===0?[]:(xe(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:n,extraData:r,gasLimit:s,gasUsed:o,hash:i,miner:a,prevRandao:l,nonce:c,number:u,parentHash:h,parentBeaconBlockRoot:f,stateRoot:g,receiptsRoot:y,timestamp:w,transactions:v}=this;return{_type:"Block",baseFeePerGas:hn(e),difficulty:hn(n),extraData:r,gasLimit:hn(s),gasUsed:hn(o),blobGasUsed:hn(this.blobGasUsed),excessBlobGas:hn(this.excessBlobGas),hash:i,miner:a,prevRandao:l,nonce:c,number:u,parentHash:h,timestamp:w,parentBeaconBlockRoot:f,stateRoot:g,receiptsRoot:y,transactions:v}}[Symbol.iterator](){let e=0;const n=this.transactions;return{next:()=>e<this.length?{value:n[e++],done:!1}:{value:void 0,done:!0}}}get length(){return H(this,ri).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let n;if(typeof e=="number")n=H(this,ri)[e];else{const r=e.toLowerCase();for(const s of H(this,ri))if(typeof s=="string"){if(s!==r)continue;n=s;break}else{if(s.hash!==r)continue;n=s;break}}if(n==null)throw new Error("no such tx");return typeof n=="string"?await this.provider.getTransaction(n):n}getPrefetchedTransaction(e){const n=this.prefetchedTransactions;if(typeof e=="number")return n[e];e=e.toLowerCase();for(const r of n)if(r.hash===e)return r;J(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return bde(this)}}ri=new WeakMap;class rg{constructor(e,n){oe(this,"provider");oe(this,"transactionHash");oe(this,"blockHash");oe(this,"blockNumber");oe(this,"removed");oe(this,"address");oe(this,"data");oe(this,"topics");oe(this,"index");oe(this,"transactionIndex");this.provider=n;const r=Object.freeze(e.topics.slice());Je(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:n,blockNumber:r,data:s,index:o,removed:i,topics:a,transactionHash:l,transactionIndex:c}=this;return{_type:"log",address:e,blockHash:n,blockNumber:r,data:s,index:o,removed:i,topics:a,transactionHash:l,transactionIndex:c}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return xe(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return xe(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return xe(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return vde(this)}}var cp;class D4{constructor(e,n){oe(this,"provider");oe(this,"to");oe(this,"from");oe(this,"contractAddress");oe(this,"hash");oe(this,"index");oe(this,"blockHash");oe(this,"blockNumber");oe(this,"logsBloom");oe(this,"gasUsed");oe(this,"blobGasUsed");oe(this,"cumulativeGasUsed");oe(this,"gasPrice");oe(this,"blobGasPrice");oe(this,"type");oe(this,"status");oe(this,"root");ce(this,cp);G(this,cp,Object.freeze(e.logs.map(s=>new rg(s,n))));let r=N4;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),Je(this,{provider:n,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return H(this,cp)}toJSON(){const{to:e,from:n,contractAddress:r,hash:s,index:o,blockHash:i,blockNumber:a,logsBloom:l,logs:c,status:u,root:h}=this;return{_type:"TransactionReceipt",blockHash:i,blockNumber:a,contractAddress:r,cumulativeGasUsed:hn(this.cumulativeGasUsed),from:n,gasPrice:hn(this.gasPrice),blobGasUsed:hn(this.blobGasUsed),blobGasPrice:hn(this.blobGasPrice),gasUsed:hn(this.gasUsed),hash:s,index:o,logs:c,logsBloom:l,root:h,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return O4(this)}reorderedEvent(e){return xe(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),M4(this,e)}}cp=new WeakMap;var ya;const f_=class f_{constructor(e,n){oe(this,"provider");oe(this,"blockNumber");oe(this,"blockHash");oe(this,"index");oe(this,"hash");oe(this,"type");oe(this,"to");oe(this,"from");oe(this,"nonce");oe(this,"gasLimit");oe(this,"gasPrice");oe(this,"maxPriorityFeePerGas");oe(this,"maxFeePerGas");oe(this,"maxFeePerBlobGas");oe(this,"data");oe(this,"value");oe(this,"chainId");oe(this,"signature");oe(this,"accessList");oe(this,"blobVersionedHashes");oe(this,"authorizationList");ce(this,ya);this.provider=n,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,G(this,ya,-1)}toJSON(){const{blockNumber:e,blockHash:n,index:r,hash:s,type:o,to:i,from:a,nonce:l,data:c,signature:u,accessList:h,blobVersionedHashes:f}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:e,blockHash:n,blobVersionedHashes:f,chainId:hn(this.chainId),data:c,from:a,gasLimit:hn(this.gasLimit),gasPrice:hn(this.gasPrice),hash:s,maxFeePerGas:hn(this.maxFeePerGas),maxPriorityFeePerGas:hn(this.maxPriorityFeePerGas),maxFeePerBlobGas:hn(this.maxFeePerBlobGas),nonce:l,signature:u,to:i,index:r,type:o,value:hn(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;const n=this.provider.getBlock(e);if(n==null)throw new Error("TODO");return n}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:n,blockNumber:r}=await mr({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return n==null||n.blockNumber==null?0:r-n.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,n){const r=e??1,s=n??0;let o=H(this,ya),i=-1,a=o===-1;const l=async()=>{if(a)return null;const{blockNumber:f,nonce:g}=await mr({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(g<this.nonce){o=f;return}if(a)return null;const y=await this.getTransaction();if(!(y&&y.blockNumber!=null))for(i===-1&&(i=o-3,i<H(this,ya)&&(i=H(this,ya)));i<=f;){if(a)return null;const w=await this.provider.getBlock(i,!0);if(w==null)return;for(const v of w)if(v===this.hash)return;for(let v=0;v<w.length;v++){const C=await w.getTransaction(v);if(C.from===this.from&&C.nonce===this.nonce){if(a)return null;const x=await this.provider.getTransactionReceipt(C.hash);if(x==null||f-x.blockNumber+1<r)return;let A="replaced";C.data===this.data&&C.to===this.to&&C.value===this.value?A="repriced":C.data==="0x"&&C.from===C.to&&C.value===N4&&(A="cancelled"),xe(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:A==="replaced"||A==="cancelled",reason:A,replacement:C.replaceableTransaction(o),hash:C.hash,receipt:x})}}i++}},c=f=>{if(f==null||f.status!==0)return f;xe(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:f.to,from:f.from,data:""},receipt:f})},u=await this.provider.getTransactionReceipt(this.hash);if(r===0)return c(u);if(u){if(r===1||await u.confirmations()>=r)return c(u)}else if(await l(),r===0)return null;return await new Promise((f,g)=>{const y=[],w=()=>{y.forEach(C=>C())};if(y.push(()=>{a=!0}),s>0){const C=setTimeout(()=>{w(),g(qt("wait for transaction timeout","TIMEOUT"))},s);y.push(()=>{clearTimeout(C)})}const v=async C=>{if(await C.confirmations()>=r){w();try{f(c(C))}catch(x){g(x)}}};if(y.push(()=>{this.provider.off(this.hash,v)}),this.provider.on(this.hash,v),o>=0){const C=async()=>{try{await l()}catch(x){if(qn(x,"TRANSACTION_REPLACED")){w(),g(x);return}}a||this.provider.once("block",C)};y.push(()=>{this.provider.off("block",C)}),this.provider.once("block",C)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return xe(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),O4(this)}reorderedEvent(e){return xe(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),xe(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),M4(this,e)}replaceableTransaction(e){J(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const n=new f_(this,this.provider);return G(n,ya,e),n}};ya=new WeakMap;let np=f_;function bde(t){return{orphan:"drop-block",hash:t.hash,number:t.number}}function M4(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function O4(t){return{orphan:"drop-transaction",tx:t}}function vde(t){return{orphan:"drop-log",log:{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}}}class e_ extends rg{constructor(n,r,s){super(n,n.provider);oe(this,"interface");oe(this,"fragment");oe(this,"args");const o=r.decodeEventLog(s,n.data,n.topics);Je(this,{args:o,fragment:s,interface:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class L4 extends rg{constructor(n,r){super(n,n.provider);oe(this,"error");Je(this,{error:r})}}var _d;class xde extends D4{constructor(n,r,s){super(s,r);ce(this,_d);G(this,_d,n)}get logs(){return super.logs.map(n=>{const r=n.topics.length?H(this,_d).getEvent(n.topics[0]):null;if(r)try{return new e_(n,H(this,_d),r)}catch(s){return new L4(n,s)}return n})}}_d=new WeakMap;var up;class t_ extends np{constructor(n,r,s){super(s,r);ce(this,up);G(this,up,n)}async wait(n,r){const s=await super.wait(n,r);return s==null?null:new xde(H(this,up),this.provider,s)}}up=new WeakMap;class F4 extends cV{constructor(n,r,s,o){super(n,r,s);oe(this,"log");Je(this,{log:o})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Cde extends F4{constructor(e,n,r,s,o){super(e,n,r,new e_(o,e.interface,s));const i=e.interface.decodeEventLog(s,this.log.data,this.log.topics);Je(this,{args:i,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const $R=BigInt(0);function j4(t){return t&&typeof t.call=="function"}function V4(t){return t&&typeof t.estimateGas=="function"}function y0(t){return t&&typeof t.resolveName=="function"}function B4(t){return t&&typeof t.sendTransaction=="function"}function U4(t){if(t!=null){if(y0(t))return t;if(t.provider)return t.provider}}var dp;class Ede{constructor(e,n,r){ce(this,dp);oe(this,"fragment");if(Je(this,{fragment:n}),n.inputs.length<r.length)throw new Error("too many arguments");const s=Gc(e.runner,"resolveName"),o=y0(s)?s:null;G(this,dp,(async function(){const i=await Promise.all(n.inputs.map((a,l)=>r[l]==null?null:a.walkAsync(r[l],(u,h)=>u==="address"?Array.isArray(h)?Promise.all(h.map(f=>xr(f,o))):xr(h,o):h)));return e.interface.encodeFilterTopics(n,i)})())}getTopicFilter(){return H(this,dp)}}dp=new WeakMap;function Gc(t,e){return t==null?null:typeof t[e]=="function"?t:t.provider&&typeof t.provider[e]=="function"?t.provider:null}function $l(t){return t==null?null:t.provider||null}async function H4(t,e){const n=dr.dereference(t,"overrides");J(typeof n=="object","invalid overrides parameter","overrides",t);const r=qw(n);return J(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),J(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function Ide(t,e,n){const r=Gc(t,"resolveName"),s=y0(r)?r:null;return await Promise.all(e.map((o,i)=>o.walkAsync(n[i],(a,l)=>(l=dr.dereference(l,a),a==="address"?xr(l,s):l))))}function _de(t){const e=async function(i){const a=await H4(i,["data"]);a.to=await t.getAddress(),a.from&&(a.from=await xr(a.from,U4(t.runner)));const l=t.interface,c=Ve(a.value||$R,"overrides.value")===$R,u=(a.data||"0x")==="0x";l.fallback&&!l.fallback.payable&&l.receive&&!u&&!c&&J(!1,"cannot send data to receive or send value to non-payable fallback","overrides",i),J(l.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const h=l.receive||l.fallback&&l.fallback.payable;return J(h||c,"cannot send value to non-payable fallback","overrides.value",a.value),J(l.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},n=async function(i){const a=Gc(t.runner,"call");xe(j4(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const l=await e(i);try{return await a.call(l)}catch(c){throw VI(c)&&c.data?t.interface.makeError(c.data,l):c}},r=async function(i){const a=t.runner;xe(B4(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const l=await a.sendTransaction(await e(i)),c=$l(t.runner);return new t_(t.interface,c,l)},s=async function(i){const a=Gc(t.runner,"estimateGas");return xe(V4(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(i))},o=async i=>await r(i);return Je(o,{_contract:t,estimateGas:s,populateTransaction:e,send:r,staticCall:n}),o}function Ade(t,e){const n=function(...c){const u=t.interface.getFunction(e,c);return xe(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:c}}),u},r=async function(...c){const u=n(...c);let h={};if(u.inputs.length+1===c.length&&(h=await H4(c.pop()),h.from&&(h.from=await xr(h.from,U4(t.runner)))),u.inputs.length!==c.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const f=await Ide(t.runner,u.inputs,c);return Object.assign({},h,await mr({to:t.getAddress(),data:t.interface.encodeFunctionData(u,f)}))},s=async function(...c){const u=await a(...c);return u.length===1?u[0]:u},o=async function(...c){const u=t.runner;xe(B4(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await u.sendTransaction(await r(...c)),f=$l(t.runner);return new t_(t.interface,f,h)},i=async function(...c){const u=Gc(t.runner,"estimateGas");return xe(V4(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await r(...c))},a=async function(...c){const u=Gc(t.runner,"call");xe(j4(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await r(...c);let f="0x";try{f=await u.call(h)}catch(y){throw VI(y)&&y.data?t.interface.makeError(y.data,h):y}const g=n(...c);return t.interface.decodeFunctionResult(g,f)},l=async(...c)=>n(...c).constant?await s(...c):await o(...c);return Je(l,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:n,estimateGas:i,populateTransaction:r,send:o,staticCall:s,staticCallResult:a}),Object.defineProperty(l,"fragment",{configurable:!1,enumerable:!0,get:()=>{const c=t.interface.getFunction(e);return xe(c,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),c}}),l}function Sde(t,e){const n=function(...s){const o=t.interface.getEvent(e,s);return xe(o,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),o},r=function(...s){return new Ede(t,n(...s),s)};return Je(r,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:n}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=t.interface.getEvent(e);return xe(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),r}const Qw=Symbol.for("_ethersInternal_contract"),$4=new WeakMap;function Tde(t,e){$4.set(t[Qw],e)}function Hr(t){return $4.get(t[Qw])}function Pde(t){return t&&typeof t=="object"&&"getTopicFilter"in t&&typeof t.getTopicFilter=="function"&&t.fragment}async function n_(t,e){let n,r=null;if(Array.isArray(e)){const o=function(i){if(Ht(i,32))return i;const a=t.interface.getEvent(i);return J(a,"unknown fragment","name",i),a.topicHash};n=e.map(i=>i==null?null:Array.isArray(i)?i.map(o):o(i))}else e==="*"?n=[null]:typeof e=="string"?Ht(e,32)?n=[e]:(r=t.interface.getEvent(e),J(r,"unknown fragment","event",e),n=[r.topicHash]):Pde(e)?n=await e.getTopicFilter():"fragment"in e?(r=e.fragment,n=[r.topicHash]):J(!1,"unknown event name","event",e);n=n.map(o=>{if(o==null)return null;if(Array.isArray(o)){const i=Array.from(new Set(o.map(a=>a.toLowerCase())).values());return i.length===1?i[0]:(i.sort(),i)}return o.toLowerCase()});const s=n.map(o=>o==null?"null":Array.isArray(o)?o.join("|"):o).join("&");return{fragment:r,tag:s,topics:n}}async function Gf(t,e){const{subs:n}=Hr(t);return n.get((await n_(t,e)).tag)||null}async function zR(t,e,n){const r=$l(t.runner);xe(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:o,topics:i}=await n_(t,n),{addr:a,subs:l}=Hr(t);let c=l.get(o);if(!c){const h={address:a||t,topics:i},f=v=>{let C=s;if(C==null)try{C=t.interface.getEvent(v.topics[0])}catch{}if(C){const x=C,A=s?t.interface.decodeEventLog(s,v.data,v.topics):[];qC(t,n,A,N=>new Cde(t,N,n,x,v))}else qC(t,n,[],x=>new F4(t,x,n,v))};let g=[];c={tag:o,listeners:[],start:()=>{g.length||g.push(r.on(h,f))},stop:async()=>{if(g.length==0)return;let v=g;g=[],await Promise.all(v),r.off(h,f)}},l.set(o,c)}return c}let KC=Promise.resolve();async function kde(t,e,n,r){await KC;const s=await Gf(t,e);if(!s)return!1;const o=s.listeners.length;return s.listeners=s.listeners.filter(({listener:i,once:a})=>{const l=Array.from(n);r&&l.push(r(a?null:i));try{i.call(t,...l)}catch{}return!a}),s.listeners.length===0&&(s.stop(),Hr(t).subs.delete(s.tag)),o>0}async function qC(t,e,n,r){try{await KC}catch{}const s=kde(t,e,n,r);return KC=s,await s}const Zg=["then"];var w2;w2=Qw;const ym=class ym{constructor(e,n,r,s){oe(this,"target");oe(this,"interface");oe(this,"runner");oe(this,"filters");oe(this,w2);oe(this,"fallback");J(typeof e=="string"||qV(e),"invalid value for Contract target","target",e),r==null&&(r=null);const o=WC.from(n);Je(this,{target:e,runner:r,interface:o}),Object.defineProperty(this,Qw,{value:{}});let i,a=null,l=null;if(s){const h=$l(r);l=new t_(this.interface,h,s)}let c=new Map;if(typeof e=="string")if(Ht(e))a=e,i=Promise.resolve(e);else{const h=Gc(r,"resolveName");if(!y0(h))throw qt("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});i=h.resolveName(e).then(f=>{if(f==null)throw qt("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Hr(this).addr=f,f})}else i=e.getAddress().then(h=>{if(h==null)throw new Error("TODO");return Hr(this).addr=h,h});Tde(this,{addrPromise:i,addr:a,deployTx:l,subs:c});const u=new Proxy({},{get:(h,f,g)=>{if(typeof f=="symbol"||Zg.indexOf(f)>=0)return Reflect.get(h,f,g);try{return this.getEvent(f)}catch(y){if(!qn(y,"INVALID_ARGUMENT")||y.argument!=="key")throw y}},has:(h,f)=>Zg.indexOf(f)>=0?Reflect.has(h,f):Reflect.has(h,f)||this.interface.hasEvent(String(f))});return Je(this,{filters:u}),Je(this,{fallback:o.receive||o.fallback?_de(this):null}),new Proxy(this,{get:(h,f,g)=>{if(typeof f=="symbol"||f in h||Zg.indexOf(f)>=0)return Reflect.get(h,f,g);try{return h.getFunction(f)}catch(y){if(!qn(y,"INVALID_ARGUMENT")||y.argument!=="key")throw y}},has:(h,f)=>typeof f=="symbol"||f in h||Zg.indexOf(f)>=0?Reflect.has(h,f):h.interface.hasFunction(f)})}connect(e){return new ym(this.target,this.interface,e)}attach(e){return new ym(e,this.interface,this.runner)}async getAddress(){return await Hr(this).addrPromise}async getDeployedCode(){const e=$l(this.runner);xe(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const n=await e.getCode(await this.getAddress());return n==="0x"?null:n}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const r=$l(this.runner);return xe(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,o)=>{const i=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);r.once("block",i)}catch(a){o(a)}};i()})}deploymentTransaction(){return Hr(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),Ade(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),Sde(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,n,r){n==null&&(n=0),r==null&&(r="latest");const{addr:s,addrPromise:o}=Hr(this),i=s||await o,{fragment:a,topics:l}=await n_(this,e),c={address:i,topics:l,fromBlock:n,toBlock:r},u=$l(this.runner);return xe(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(c)).map(h=>{let f=a;if(f==null)try{f=this.interface.getEvent(h.topics[0])}catch{}if(f)try{return new e_(h,this.interface,f)}catch(g){return new L4(h,g)}return new rg(h,u)})}async on(e,n){const r=await zR(this,"on",e);return r.listeners.push({listener:n,once:!1}),r.start(),this}async once(e,n){const r=await zR(this,"once",e);return r.listeners.push({listener:n,once:!0}),r.start(),this}async emit(e,...n){return await qC(this,e,n,null)}async listenerCount(e){if(e){const s=await Gf(this,e);return s?s.listeners.length:0}const{subs:n}=Hr(this);let r=0;for(const{listeners:s}of n.values())r+=s.length;return r}async listeners(e){if(e){const s=await Gf(this,e);return s?s.listeners.map(({listener:o})=>o):[]}const{subs:n}=Hr(this);let r=[];for(const{listeners:s}of n.values())r=r.concat(s.map(({listener:o})=>o));return r}async off(e,n){const r=await Gf(this,e);if(!r)return this;if(n){const s=r.listeners.map(({listener:o})=>o).indexOf(n);s>=0&&r.listeners.splice(s,1)}return(n==null||r.listeners.length===0)&&(r.stop(),Hr(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){const n=await Gf(this,e);if(!n)return this;n.stop(),Hr(this).subs.delete(n.tag)}else{const{subs:n}=Hr(this);for(const{tag:r,stop:s}of n.values())s(),n.delete(r)}return this}async addListener(e,n){return await this.on(e,n)}async removeListener(e,n){return await this.off(e,n)}static buildClass(e){class n extends ym{constructor(s,o=null){super(s,e,o)}}return n}static from(e,n,r){return r==null&&(r=null),new this(e,n,r)}};let QC=ym;function Rde(){return QC}class gm extends Rde(){}function Qv(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):J(!1,"unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}class Nde{constructor(e){oe(this,"name");Je(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,n){throw new Error("unsupported coin")}async decodeAddress(e,n){throw new Error("unsupported coin")}}const z4=new RegExp("^(ipfs)://(.*)$","i"),GR=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),z4,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var wa,nc,ba,ku,rb,G4;const Hu=class Hu{constructor(e,n,r){ce(this,ba);oe(this,"provider");oe(this,"address");oe(this,"name");ce(this,wa);ce(this,nc);Je(this,{provider:e,address:n,name:r}),G(this,wa,null),G(this,nc,new gm(n,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return H(this,wa)==null&&G(this,wa,(async()=>{try{return await H(this,nc).supportsInterface("0x9061b923")}catch(e){if(qn(e,"CALL_EXCEPTION"))return!1;throw G(this,wa,null),e}})()),await H(this,wa)}async getAddress(e){if(e==null&&(e=60),e===60)try{const o=await ke(this,ba,ku).call(this,"addr(bytes32)");return o==null||o===qm?null:o}catch(o){if(qn(o,"CALL_EXCEPTION"))return null;throw o}if(e>=0&&e<2147483648){let o=e+2147483648;const i=await ke(this,ba,ku).call(this,"addr(bytes32,uint)",[o]);if(Ht(i,20))return Pt(i)}let n=null;for(const o of this.provider.plugins)if(o instanceof Nde&&o.supportsCoinType(e)){n=o;break}if(n==null)return null;const r=await ke(this,ba,ku).call(this,"addr(bytes32,uint)",[e]);if(r==null||r==="0x")return null;const s=await n.decodeAddress(e,r);if(s!=null)return s;xe(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:r}})}async getText(e){const n=await ke(this,ba,ku).call(this,"text(bytes32,string)",[e]);return n==null||n==="0x"?null:n}async getContentHash(){const e=await ke(this,ba,ku).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const n=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(n){const s=n[1]==="e3010170"?"ipfs":"ipns",o=parseInt(n[4],16);if(n[5].length===o*2)return`${s}://${Bae("0x"+n[2])}`}const r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&r[1].length===64)return`bzz://${r[1]}`;xe(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const n=await this.getText("avatar");if(n==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:n});for(let r=0;r<GR.length;r++){const s=n.match(GR[r]);if(s==null)continue;const o=s[1].toLowerCase();switch(o){case"https":case"data":return e.push({type:"url",value:n}),{linkage:e,url:n};case"ipfs":{const i=Qv(n);return e.push({type:"ipfs",value:n}),e.push({type:"url",value:i}),{linkage:e,url:i}}case"erc721":case"erc1155":{const i=o==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:o,value:n});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const l=(s[2]||"").split("/");if(l.length!==2)return e.push({type:`!${o}caip`,value:s[2]||""}),{url:null,linkage:e};const c=l[1],u=new gm(l[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(o==="erc721"){const w=await u.ownerOf(c);if(a!==w)return e.push({type:"!owner",value:w}),{url:null,linkage:e};e.push({type:"owner",value:w})}else if(o==="erc1155"){const w=await u.balanceOf(a,c);if(!w)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:w.toString()})}let h=await u[i](c);if(h==null||h==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:h}),o==="erc1155"&&(h=h.replace("{id}",Ga(c,32).substring(2)),e.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=Qv(h)),e.push({type:"metadata-url",value:h});let f={};const g=await new Wa(h).send();g.assertOk();try{f=g.bodyJson}catch{try{e.push({type:"!metadata",value:g.bodyText})}catch{const C=g.body;return C&&e.push({type:"!metadata",value:Ne(C)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!f)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(f)});let y=f.image;if(typeof y!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!y.match(/^(https:\/\/|data:)/i)){if(y.match(z4)==null)return e.push({type:"!imageUrl-ipfs",value:y}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:y}),y=Qv(y)}return e.push({type:"url",value:y}),{linkage:e,url:y}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const n=await e.getNetwork(),r=n.getPlugin("org.ethers.plugins.network.Ens");return xe(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:n}}),r.address}static async fromName(e,n){var s;let r=n;for(;;){if(r===""||r==="."||n!=="eth"&&r==="eth")return null;const o=await ke(s=Hu,rb,G4).call(s,e,r);if(o!=null){const i=new Hu(e,o,n);return r!==n&&!await i.supportsWildcard()?null:i}r=r.split(".").slice(1).join(".")}}};wa=new WeakMap,nc=new WeakMap,ba=new WeakSet,ku=async function(e,n){n=(n||[]).slice();const r=H(this,nc).interface;n.unshift(zC(this.name));let s=null;await this.supportsWildcard()&&(s=r.getFunction(e),xe(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),n=[Kue(this.name,255),r.encodeFunctionData(s,n)],e="resolve(bytes,bytes)"),n.push({enableCcipRead:!0});try{const o=await H(this,nc)[e](...n);return s?r.decodeFunctionResult(s,o)[0]:o}catch(o){if(!qn(o,"CALL_EXCEPTION"))throw o}return null},rb=new WeakSet,G4=async function(e,n){const r=await Hu.getEnsAddress(e);try{const o=await new gm(r,["function resolver(bytes32) view returns (address)"],e).resolver(zC(n),{enableCcipRead:!0});return o===qm?null:o}catch(s){throw s}return null},ce(Hu,rb);let Yw=Hu;const WR=BigInt(0);function xt(t,e){return(function(n){return n==null?e:t(n)})}function rp(t,e){return(n=>{if(e&&n==null)return null;if(!Array.isArray(n))throw new Error("not an array");return n.map(r=>t(r))})}function sg(t,e){return(n=>{const r={};for(const s in t){let o=s;if(e&&s in e&&!(o in n)){for(const i of e[s])if(i in n){o=i;break}}try{const i=t[s](n[o]);i!==void 0&&(r[s]=i)}catch(i){const a=i instanceof Error?i.message:"not-an-error";xe(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:n})}}return r})}function Dde(t){switch(t){case!0:case"true":return!0;case!1:case"false":return!1}J(!1,`invalid boolean; ${JSON.stringify(t)}`,"value",t)}function yh(t){return J(Ht(t,!0),"invalid data","value",t),t}function Kn(t){return J(Ht(t,32),"invalid hash","value",t),t}const Mde=sg({address:Pt,blockHash:Kn,blockNumber:ht,data:yh,index:ht,removed:xt(Dde,!1),topics:rp(Kn),transactionHash:Kn,transactionIndex:ht},{index:["logIndex"]});function Ode(t){return Mde(t)}const Lde=sg({hash:xt(Kn),parentHash:Kn,parentBeaconBlockRoot:xt(Kn,null),number:ht,timestamp:ht,nonce:xt(yh),difficulty:Ve,gasLimit:Ve,gasUsed:Ve,stateRoot:xt(Kn,null),receiptsRoot:xt(Kn,null),blobGasUsed:xt(Ve,null),excessBlobGas:xt(Ve,null),miner:xt(Pt),prevRandao:xt(Kn,null),extraData:yh,baseFeePerGas:xt(Ve)},{prevRandao:["mixHash"]});function Fde(t){const e=Lde(t);return e.transactions=t.transactions.map(n=>typeof n=="string"?n:W4(n)),e}const jde=sg({transactionIndex:ht,blockNumber:ht,transactionHash:Kn,address:Pt,topics:rp(Kn),data:yh,index:ht,blockHash:Kn},{index:["logIndex"]});function Vde(t){return jde(t)}const Bde=sg({to:xt(Pt,null),from:xt(Pt,null),contractAddress:xt(Pt,null),index:ht,root:xt(Ne),gasUsed:Ve,blobGasUsed:xt(Ve,null),logsBloom:xt(yh),blockHash:Kn,hash:Kn,logs:rp(Vde),blockNumber:ht,cumulativeGasUsed:Ve,effectiveGasPrice:xt(Ve),blobGasPrice:xt(Ve,null),status:xt(ht),type:xt(ht,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function Ude(t){return Bde(t)}function W4(t){t.to&&Ve(t.to)===WR&&(t.to="0x0000000000000000000000000000000000000000");const e=sg({hash:Kn,index:xt(ht,void 0),type:n=>n==="0x"||n==null?0:ht(n),accessList:xt(eu,null),blobVersionedHashes:xt(rp(Kn,!0),null),authorizationList:xt(rp(n=>{let r;if(n.signature)r=n.signature;else{let s=n.yParity;s==="0x1b"?s=0:s==="0x1c"&&(s=1),r=Object.assign({},n,{yParity:s})}return{address:Pt(n.address),chainId:Ve(n.chainId),nonce:Ve(n.nonce),signature:Fr.from(r)}},!1),null),blockHash:xt(Kn,null),blockNumber:xt(ht,null),transactionIndex:xt(ht,null),from:Pt,gasPrice:xt(Ve),maxPriorityFeePerGas:xt(Ve),maxFeePerGas:xt(Ve),maxFeePerBlobGas:xt(Ve,null),gasLimit:Ve,to:xt(Pt,null),value:Ve,nonce:ht,data:yh,creates:xt(Pt,null),chainId:xt(Ve,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(t);if(e.to==null&&e.creates==null&&(e.creates=Pce(e)),(t.type===1||t.type===2)&&t.accessList==null&&(e.accessList=[]),t.signature?e.signature=Fr.from(t.signature):e.signature=Fr.from(t),e.chainId==null){const n=e.signature.legacyChainId;n!=null&&(e.chainId=n)}return e.blockHash&&Ve(e.blockHash)===WR&&(e.blockHash=null),e}const Hde="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class og{constructor(e){oe(this,"name");Je(this,{name:e})}clone(){return new og(this.name)}}class w0 extends og{constructor(n,r){n==null&&(n=0);super(`org.ethers.network.plugins.GasCost#${n||0}`);oe(this,"effectiveBlock");oe(this,"txBase");oe(this,"txCreate");oe(this,"txDataZero");oe(this,"txDataNonzero");oe(this,"txAccessListStorageKey");oe(this,"txAccessListAddress");const s={effectiveBlock:n};function o(i,a){let l=(r||{})[i];l==null&&(l=a),J(typeof l=="number",`invalud value for ${i}`,"costs",r),s[i]=l}o("txBase",21e3),o("txCreate",32e3),o("txDataZero",4),o("txDataNonzero",16),o("txAccessListStorageKey",1900),o("txAccessListAddress",2400),Je(this,s)}clone(){return new w0(this.effectiveBlock,this)}}class b0 extends og{constructor(n,r){super("org.ethers.plugins.network.Ens");oe(this,"address");oe(this,"targetNetwork");Je(this,{address:n||Hde,targetNetwork:r??1})}clone(){return new b0(this.address,this.targetNetwork)}}var hp,fp;class $de extends og{constructor(n,r){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");ce(this,hp);ce(this,fp);G(this,hp,n),G(this,fp,r)}get url(){return H(this,hp)}get processFunc(){return H(this,fp)}clone(){return this}}hp=new WeakMap,fp=new WeakMap;const Yv=new Map;var Ad,Sd,va;const $u=class $u{constructor(e,n){ce(this,Ad);ce(this,Sd);ce(this,va);G(this,Ad,e),G(this,Sd,Ve(n)),G(this,va,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return H(this,Ad)}set name(e){G(this,Ad,e)}get chainId(){return H(this,Sd)}set chainId(e){G(this,Sd,Ve(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===Ve(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===Ve(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===Ve(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(H(this,va).values())}attachPlugin(e){if(H(this,va).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return H(this,va).set(e.name,e.clone()),this}getPlugin(e){return H(this,va).get(e)||null}getPlugins(e){return this.plugins.filter(n=>n.name.split("#")[0]===e)}clone(){const e=new $u(this.name,this.chainId);return this.plugins.forEach(n=>{e.attachPlugin(n.clone())}),e}computeIntrinsicGas(e){const n=this.getPlugin("org.ethers.plugins.network.GasCost")||new w0;let r=n.txBase;if(e.to==null&&(r+=n.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?r+=n.txDataZero:r+=n.txDataNonzero;if(e.accessList){const s=eu(e.accessList);for(const o in s)r+=n.txAccessListAddress+n.txAccessListStorageKey*s[o].storageKeys.length}return r}static from(e){if(zde(),e==null)return $u.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const n=Yv.get(e);if(n)return n();if(typeof e=="bigint")return new $u("unknown",e);J(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){J(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const n=new $u(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&n.attachPlugin(new b0(e.ensAddress,e.ensNetwork)),n}J(!1,"invalid network","network",e)}static register(e,n){typeof e=="number"&&(e=BigInt(e));const r=Yv.get(e);r&&J(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",e),Yv.set(e,n)}};Ad=new WeakMap,Sd=new WeakMap,va=new WeakMap;let _o=$u;function KR(t,e){const n=String(t);if(!n.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${t}`);const r=n.split(".");if(r.length===1&&r.push(""),r.length!==2)throw new Error(`invalid gwei value: ${t}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let s=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||s++,r[1]=s.toString()}return BigInt(r[0]+r[1])}function qR(t){return new $de(t,async(e,n,r)=>{r.setHeader("User-Agent","ethers");let s;try{const[o,i]=await Promise.all([r.send(),e()]);s=o;const a=s.bodyJson.standard;return{gasPrice:i.gasPrice,maxFeePerGas:KR(a.maxFee,9),maxPriorityFeePerGas:KR(a.maxPriorityFee,9)}}catch(o){xe(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:s,error:o})}})}let QR=!1;function zde(){if(QR)return;QR=!0;function t(e,n,r){const s=function(){const o=new _o(e,n);return r.ensNetwork!=null&&o.attachPlugin(new b0(null,r.ensNetwork)),o.attachPlugin(new w0),(r.plugins||[]).forEach(i=>{o.attachPlugin(i)}),o};_o.register(e,s),_o.register(n,s),r.altNames&&r.altNames.forEach(o=>{_o.register(o,s)})}t("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),t("ropsten",3,{ensNetwork:3}),t("rinkeby",4,{ensNetwork:4}),t("goerli",5,{ensNetwork:5}),t("kovan",42,{ensNetwork:42}),t("sepolia",11155111,{ensNetwork:11155111}),t("holesky",17e3,{ensNetwork:17e3}),t("classic",61,{}),t("classicKotti",6,{}),t("arbitrum",42161,{ensNetwork:1}),t("arbitrum-goerli",421613,{}),t("arbitrum-sepolia",421614,{}),t("base",8453,{ensNetwork:1}),t("base-goerli",84531,{}),t("base-sepolia",84532,{}),t("bnb",56,{ensNetwork:1}),t("bnbt",97,{}),t("linea",59144,{ensNetwork:1}),t("linea-goerli",59140,{}),t("linea-sepolia",59141,{}),t("matic",137,{ensNetwork:1,plugins:[qR("https://gasstation.polygon.technology/v2")]}),t("matic-amoy",80002,{}),t("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[qR("https://gasstation-testnet.polygon.technology/v2")]}),t("optimism",10,{ensNetwork:1,plugins:[]}),t("optimism-goerli",420,{}),t("optimism-sepolia",11155420,{}),t("xdai",100,{ensNetwork:1})}function YC(t){return JSON.parse(JSON.stringify(t))}var si,ds,xa,fo,Td,My;class Gde{constructor(e){ce(this,Td);ce(this,si);ce(this,ds);ce(this,xa);ce(this,fo);G(this,si,e),G(this,ds,null),G(this,xa,4e3),G(this,fo,-2)}get pollingInterval(){return H(this,xa)}set pollingInterval(e){G(this,xa,e)}start(){H(this,ds)||(G(this,ds,H(this,si)._setTimeout(ke(this,Td,My).bind(this),H(this,xa))),ke(this,Td,My).call(this))}stop(){H(this,ds)&&(H(this,si)._clearTimeout(H(this,ds)),G(this,ds,null))}pause(e){this.stop(),e&&G(this,fo,-2)}resume(){this.start()}}si=new WeakMap,ds=new WeakMap,xa=new WeakMap,fo=new WeakMap,Td=new WeakSet,My=async function(){try{const e=await H(this,si).getBlockNumber();if(H(this,fo)===-2){G(this,fo,e);return}if(e!==H(this,fo)){for(let n=H(this,fo)+1;n<=e;n++){if(H(this,ds)==null)return;await H(this,si).emit("block",n)}G(this,fo,e)}}catch{}H(this,ds)!=null&&G(this,ds,H(this,si)._setTimeout(ke(this,Td,My).bind(this),H(this,xa)))};var rc,sc,Ca;class r_{constructor(e){ce(this,rc);ce(this,sc);ce(this,Ca);G(this,rc,e),G(this,Ca,!1),G(this,sc,n=>{this._poll(n,H(this,rc))})}async _poll(e,n){throw new Error("sub-classes must override this")}start(){H(this,Ca)||(G(this,Ca,!0),H(this,sc).call(this,-2),H(this,rc).on("block",H(this,sc)))}stop(){H(this,Ca)&&(G(this,Ca,!1),H(this,rc).off("block",H(this,sc)))}pause(e){this.stop()}resume(){this.start()}}rc=new WeakMap,sc=new WeakMap,Ca=new WeakMap;var Pd,oi;class Wde extends r_{constructor(n,r){super(n);ce(this,Pd);ce(this,oi);G(this,Pd,r),G(this,oi,-2)}pause(n){n&&G(this,oi,-2),super.pause(n)}async _poll(n,r){const s=await r.getBlock(H(this,Pd));s!=null&&(H(this,oi)===-2?G(this,oi,s.number):s.number>H(this,oi)&&(r.emit(H(this,Pd),s.number),G(this,oi,s.number)))}}Pd=new WeakMap,oi=new WeakMap;var sb;class Kde extends r_{constructor(n,r){super(n);ce(this,sb);G(this,sb,YC(r))}async _poll(n,r){throw new Error("@TODO")}}sb=new WeakMap;var kd;class qde extends r_{constructor(n,r){super(n);ce(this,kd);G(this,kd,r)}async _poll(n,r){const s=await r.getTransactionReceipt(H(this,kd));s&&r.emit(H(this,kd),s)}}kd=new WeakMap;var ii,Rd,Nd,Ea,hs,ob,K4;class s_{constructor(e,n){ce(this,ob);ce(this,ii);ce(this,Rd);ce(this,Nd);ce(this,Ea);ce(this,hs);G(this,ii,e),G(this,Rd,YC(n)),G(this,Nd,ke(this,ob,K4).bind(this)),G(this,Ea,!1),G(this,hs,-2)}start(){H(this,Ea)||(G(this,Ea,!0),H(this,hs)===-2&&H(this,ii).getBlockNumber().then(e=>{G(this,hs,e)}),H(this,ii).on("block",H(this,Nd)))}stop(){H(this,Ea)&&(G(this,Ea,!1),H(this,ii).off("block",H(this,Nd)))}pause(e){this.stop(),e&&G(this,hs,-2)}resume(){this.start()}}ii=new WeakMap,Rd=new WeakMap,Nd=new WeakMap,Ea=new WeakMap,hs=new WeakMap,ob=new WeakSet,K4=async function(e){if(H(this,hs)===-2)return;const n=YC(H(this,Rd));n.fromBlock=H(this,hs)+1,n.toBlock=e;const r=await H(this,ii).getLogs(n);if(r.length===0){H(this,hs)<e-60&&G(this,hs,e-60);return}for(const s of r)H(this,ii).emit(H(this,Rd),s),G(this,hs,s.blockNumber)};const Qde=BigInt(2),Yde=10;function ey(t){return t&&typeof t.then=="function"}function Oy(t,e){return t+":"+JSON.stringify(e,(n,r)=>{if(r==null)return"null";if(typeof r=="bigint")return`bigint:${r.toString()}`;if(typeof r=="string")return r.toLowerCase();if(typeof r=="object"&&!Array.isArray(r)){const s=Object.keys(r);return s.sort(),s.reduce((o,i)=>(o[i]=r[i],o),{})}return r})}class q4{constructor(e){oe(this,"name");Je(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function Jde(t){return JSON.parse(JSON.stringify(t))}function JC(t){return t=Array.from(new Set(t).values()),t.sort(),t}async function Jv(t,e){if(t==null)throw new Error("invalid event");if(Array.isArray(t)&&(t={topics:t}),typeof t=="string")switch(t){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:t,tag:t}}if(Ht(t,32)){const n=t.toLowerCase();return{type:"transaction",tag:Oy("tx",{hash:n}),hash:n}}if(t.orphan){const n=t;return{type:"orphan",tag:Oy("orphan",n),filter:Jde(n)}}if(t.address||t.topics){const n=t,r={topics:(n.topics||[]).map(s=>s==null?null:Array.isArray(s)?JC(s.map(o=>o.toLowerCase())):s.toLowerCase())};if(n.address){const s=[],o=[],i=a=>{Ht(a)?s.push(a):o.push((async()=>{s.push(await xr(a,e))})())};Array.isArray(n.address)?n.address.forEach(i):i(n.address),o.length&&await Promise.all(o),r.address=JC(s.map(a=>a.toLowerCase()))}return{filter:r,tag:Oy("event",r),type:"event"}}J(!1,"unknown ProviderEvent","event",t)}function Xv(){return new Date().getTime()}const Xde={cacheTimeout:250,pollingInterval:4e3};var rr,Ia,sr,Dd,Wr,oc,_a,ai,mp,fs,Md,Od,ut,Ur,XC,ZC,Wf,e1,Kf,Ly;class Zde{constructor(e,n){ce(this,ut);ce(this,rr);ce(this,Ia);ce(this,sr);ce(this,Dd);ce(this,Wr);ce(this,oc);ce(this,_a);ce(this,ai);ce(this,mp);ce(this,fs);ce(this,Md);ce(this,Od);if(G(this,Od,Object.assign({},Xde,n||{})),e==="any")G(this,oc,!0),G(this,Wr,null);else if(e){const r=_o.from(e);G(this,oc,!1),G(this,Wr,Promise.resolve(r)),setTimeout(()=>{this.emit("network",r,null)},0)}else G(this,oc,!1),G(this,Wr,null);G(this,ai,-1),G(this,_a,new Map),G(this,rr,new Map),G(this,Ia,new Map),G(this,sr,null),G(this,Dd,!1),G(this,mp,1),G(this,fs,new Map),G(this,Md,!1)}get pollingInterval(){return H(this,Od).pollingInterval}get provider(){return this}get plugins(){return Array.from(H(this,Ia).values())}attachPlugin(e){if(H(this,Ia).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return H(this,Ia).set(e.name,e.connect(this)),this}getPlugin(e){return H(this,Ia).get(e)||null}get disableCcipRead(){return H(this,Md)}set disableCcipRead(e){G(this,Md,!!e)}async ccipReadFetch(e,n,r){if(this.disableCcipRead||r.length===0||e.to==null)return null;const s=e.to.toLowerCase(),o=n.toLowerCase(),i=[];for(let a=0;a<r.length;a++){const l=r[a],c=l.replace("{sender}",s).replace("{data}",o),u=new Wa(c);l.indexOf("{data}")===-1&&(u.body={data:o,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:r});let h="unknown error",f;try{f=await u.send()}catch(g){i.push(g.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:g}});continue}try{const g=f.bodyJson;if(g.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:g}),g.data;g.message&&(h=g.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:g})}catch{}xe(f.statusCode<400||f.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:l,errorMessage:h}}),i.push(h)}xe(!1,`error encountered during CCIP fetch: ${i.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:r,errorMessages:i}})}_wrapBlock(e,n){return new wde(Fde(e),this)}_wrapLog(e,n){return new rg(Ode(e),this)}_wrapTransactionReceipt(e,n){return new D4(Ude(e),this)}_wrapTransactionResponse(e,n){return new np(W4(e),this)}_detectNetwork(){xe(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){xe(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=ht(await ke(this,ut,Ur).call(this,{method:"getBlockNumber"}),"%response");return H(this,ai)>=0&&G(this,ai,e),e}_getAddress(e){return xr(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Ht(e))return Ht(e,32)?e:Hs(e);if(typeof e=="bigint"&&(e=ht(e,"blockTag")),typeof e=="number")return e>=0?Hs(e):H(this,ai)>=0?Hs(H(this,ai)+e):this.getBlockNumber().then(n=>Hs(n+e));J(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const n=(e.topics||[]).map(l=>l==null?null:Array.isArray(l)?JC(l.map(c=>c.toLowerCase())):l.toLowerCase()),r="blockHash"in e?e.blockHash:void 0,s=(l,c,u)=>{let h;switch(l.length){case 0:break;case 1:h=l[0];break;default:l.sort(),h=l}if(r&&(c!=null||u!=null))throw new Error("invalid filter");const f={};return h&&(f.address=h),n.length&&(f.topics=n),c&&(f.fromBlock=c),u&&(f.toBlock=u),r&&(f.blockHash=r),f};let o=[];if(e.address)if(Array.isArray(e.address))for(const l of e.address)o.push(this._getAddress(l));else o.push(this._getAddress(e.address));let i;"fromBlock"in e&&(i=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),o.filter(l=>typeof l!="string").length||i!=null&&typeof i!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(o),i,a]).then(l=>s(l[0],l[1],l[2])):s(o,i,a)}_getTransactionRequest(e){const n=qw(e),r=[];if(["to","from"].forEach(s=>{if(n[s]==null)return;const o=xr(n[s],this);ey(o)?r.push((async function(){n[s]=await o})()):n[s]=o}),n.blockTag!=null){const s=this._getBlockTag(n.blockTag);ey(s)?r.push((async function(){n.blockTag=await s})()):n.blockTag=s}return r.length?(async function(){return await Promise.all(r),n})():n}async getNetwork(){if(H(this,Wr)==null){const s=(async()=>{try{const o=await this._detectNetwork();return this.emit("network",o,null),o}catch(o){throw H(this,Wr)===s&&G(this,Wr,null),o}})();return G(this,Wr,s),(await s).clone()}const e=H(this,Wr),[n,r]=await Promise.all([e,this._detectNetwork()]);return n.chainId!==r.chainId&&(H(this,oc)?(this.emit("network",r,n),H(this,Wr)===e&&G(this,Wr,Promise.resolve(r))):xe(!1,`network changed: ${n.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),n.clone()}async getFeeData(){const e=await this.getNetwork(),n=async()=>{const{_block:s,gasPrice:o,priorityFee:i}=await mr({_block:ke(this,ut,e1).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await ke(this,ut,Ur).call(this,{method:"getGasPrice"});return Ve(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await ke(this,ut,Ur).call(this,{method:"getPriorityFee"});return Ve(u,"%response")}catch{}return null})()});let a=null,l=null;const c=this._wrapBlock(s,e);return c&&c.baseFeePerGas&&(l=i??BigInt("1000000000"),a=c.baseFeePerGas*Qde+l),new HR(o,a,l)},r=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){const s=new Wa(r.url),o=await r.processFunc(n,this,s);return new HR(o.gasPrice,o.maxFeePerGas,o.maxPriorityFeePerGas)}return await n()}async estimateGas(e){let n=this._getTransactionRequest(e);return ey(n)&&(n=await n),Ve(await ke(this,ut,Ur).call(this,{method:"estimateGas",transaction:n}),"%response")}async call(e){const{tx:n,blockTag:r}=await mr({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await ke(this,ut,ZC).call(this,ke(this,ut,XC).call(this,n,r,e.enableCcipRead?0:-1))}async getBalance(e,n){return Ve(await ke(this,ut,Wf).call(this,{method:"getBalance"},e,n),"%response")}async getTransactionCount(e,n){return ht(await ke(this,ut,Wf).call(this,{method:"getTransactionCount"},e,n),"%response")}async getCode(e,n){return Ne(await ke(this,ut,Wf).call(this,{method:"getCode"},e,n))}async getStorage(e,n,r){const s=Ve(n,"position");return Ne(await ke(this,ut,Wf).call(this,{method:"getStorage",position:s},e,r))}async broadcastTransaction(e){const{blockNumber:n,hash:r,network:s}=await mr({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),o=Uw.from(e);if(o.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(o,s).replaceableTransaction(n)}async getBlock(e,n){const{network:r,params:s}=await mr({network:this.getNetwork(),params:ke(this,ut,e1).call(this,e,!!n)});return s==null?null:this._wrapBlock(s,r)}async getTransaction(e){const{network:n,params:r}=await mr({network:this.getNetwork(),params:ke(this,ut,Ur).call(this,{method:"getTransaction",hash:e})});return r==null?null:this._wrapTransactionResponse(r,n)}async getTransactionReceipt(e){const{network:n,params:r}=await mr({network:this.getNetwork(),params:ke(this,ut,Ur).call(this,{method:"getTransactionReceipt",hash:e})});if(r==null)return null;if(r.gasPrice==null&&r.effectiveGasPrice==null){const s=await ke(this,ut,Ur).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(r,n)}async getTransactionResult(e){const{result:n}=await mr({network:this.getNetwork(),result:ke(this,ut,Ur).call(this,{method:"getTransactionResult",hash:e})});return n==null?null:Ne(n)}async getLogs(e){let n=this._getFilter(e);ey(n)&&(n=await n);const{network:r,params:s}=await mr({network:this.getNetwork(),params:ke(this,ut,Ur).call(this,{method:"getLogs",filter:n})});return s.map(o=>this._wrapLog(o,r))}_getProvider(e){xe(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await Yw.fromName(this,e)}async getAvatar(e){const n=await this.getResolver(e);return n?await n.getAvatar():null}async resolveName(e){const n=await this.getResolver(e);return n?await n.getAddress():null}async lookupAddress(e){e=Pt(e);const n=zC(e.substring(2).toLowerCase()+".addr.reverse");try{const r=await Yw.getEnsAddress(this),o=await new gm(r,["function resolver(bytes32) view returns (address)"],this).resolver(n);if(o==null||o===qm)return null;const a=await new gm(o,["function name(bytes32) view returns (string)"],this).name(n);return await this.resolveName(a)!==e?null:a}catch(r){if(qn(r,"BAD_DATA")&&r.value==="0x"||qn(r,"CALL_EXCEPTION"))return null;throw r}return null}async waitForTransaction(e,n,r){const s=n??1;return s===0?this.getTransactionReceipt(e):new Promise(async(o,i)=>{let a=null;const l=(async c=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&c-u.blockNumber+1>=s){o(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",l)});r!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",l),i(qt("timeout","TIMEOUT",{reason:"timeout"})))},r)),l(await this.getBlockNumber())})}async waitForBlock(e){xe(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const n=H(this,fs).get(e);n&&(n.timer&&clearTimeout(n.timer),H(this,fs).delete(e))}_setTimeout(e,n){n==null&&(n=0);const r=rf(this,mp)._++,s=()=>{H(this,fs).delete(r),e()};if(this.paused)H(this,fs).set(r,{timer:null,func:s,time:n});else{const o=setTimeout(s,n);H(this,fs).set(r,{timer:o,func:s,time:Xv()})}return r}_forEachSubscriber(e){for(const n of H(this,rr).values())e(n.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new q4(e.type);case"block":{const n=new Gde(this);return n.pollingInterval=this.pollingInterval,n}case"safe":case"finalized":return new Wde(this,e.type);case"event":return new s_(this,e.filter);case"transaction":return new qde(this,e.hash);case"orphan":return new Kde(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,n){for(const r of H(this,rr).values())if(r.subscriber===e){r.started&&r.subscriber.stop(),r.subscriber=n,r.started&&n.start(),H(this,sr)!=null&&n.pause(H(this,sr));break}}async on(e,n){const r=await ke(this,ut,Ly).call(this,e);return r.listeners.push({listener:n,once:!1}),r.started||(r.subscriber.start(),r.started=!0,H(this,sr)!=null&&r.subscriber.pause(H(this,sr))),this}async once(e,n){const r=await ke(this,ut,Ly).call(this,e);return r.listeners.push({listener:n,once:!0}),r.started||(r.subscriber.start(),r.started=!0,H(this,sr)!=null&&r.subscriber.pause(H(this,sr))),this}async emit(e,...n){const r=await ke(this,ut,Kf).call(this,e,n);if(!r||r.listeners.length===0)return!1;const s=r.listeners.length;return r.listeners=r.listeners.filter(({listener:o,once:i})=>{const a=new cV(this,i?null:o,e);try{o.call(this,...n,a)}catch{}return!i}),r.listeners.length===0&&(r.started&&r.subscriber.stop(),H(this,rr).delete(r.tag)),s>0}async listenerCount(e){if(e){const r=await ke(this,ut,Kf).call(this,e);return r?r.listeners.length:0}let n=0;for(const{listeners:r}of H(this,rr).values())n+=r.length;return n}async listeners(e){if(e){const r=await ke(this,ut,Kf).call(this,e);return r?r.listeners.map(({listener:s})=>s):[]}let n=[];for(const{listeners:r}of H(this,rr).values())n=n.concat(r.map(({listener:s})=>s));return n}async off(e,n){const r=await ke(this,ut,Kf).call(this,e);if(!r)return this;if(n){const s=r.listeners.map(({listener:o})=>o).indexOf(n);s>=0&&r.listeners.splice(s,1)}return(!n||r.listeners.length===0)&&(r.started&&r.subscriber.stop(),H(this,rr).delete(r.tag)),this}async removeAllListeners(e){if(e){const{tag:n,started:r,subscriber:s}=await ke(this,ut,Ly).call(this,e);r&&s.stop(),H(this,rr).delete(n)}else for(const[n,{started:r,subscriber:s}]of H(this,rr))r&&s.stop(),H(this,rr).delete(n);return this}async addListener(e,n){return await this.on(e,n)}async removeListener(e,n){return this.off(e,n)}get destroyed(){return H(this,Dd)}destroy(){this.removeAllListeners();for(const e of H(this,fs).keys())this._clearTimeout(e);G(this,Dd,!0)}get paused(){return H(this,sr)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(G(this,ai,-1),H(this,sr)!=null){if(H(this,sr)==!!e)return;xe(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(n=>n.pause(e)),G(this,sr,!!e);for(const n of H(this,fs).values())n.timer&&clearTimeout(n.timer),n.time=Xv()-n.time}resume(){if(H(this,sr)!=null){this._forEachSubscriber(e=>e.resume()),G(this,sr,null);for(const e of H(this,fs).values()){let n=e.time;n<0&&(n=0),e.time=Xv(),setTimeout(e.func,n)}}}}rr=new WeakMap,Ia=new WeakMap,sr=new WeakMap,Dd=new WeakMap,Wr=new WeakMap,oc=new WeakMap,_a=new WeakMap,ai=new WeakMap,mp=new WeakMap,fs=new WeakMap,Md=new WeakMap,Od=new WeakMap,ut=new WeakSet,Ur=async function(e){const n=H(this,Od).cacheTimeout;if(n<0)return await this._perform(e);const r=Oy(e.method,e);let s=H(this,_a).get(r);return s||(s=this._perform(e),H(this,_a).set(r,s),setTimeout(()=>{H(this,_a).get(r)===s&&H(this,_a).delete(r)},n)),await s},XC=async function(e,n,r){xe(r<Yde,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:n,enableCcipRead:!0})});const s=qw(e);try{return Ne(await this._perform({method:"call",transaction:s,blockTag:n}))}catch(o){if(!this.disableCcipRead&&VI(o)&&o.data&&r>=0&&n==="latest"&&s.to!=null&&on(o.data,0,4)==="0x556f1830"){const i=o.data,a=await xr(s.to,this);let l;try{l=she(on(o.data,4))}catch(h){xe(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:i}})}xe(l.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:i,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:l.errorArgs}});const c=await this.ccipReadFetch(s,l.calldata,l.urls);xe(c!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:o.data,errorArgs:l.errorArgs}});const u={to:a,data:cn([l.selector,rhe([c,l.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const h=await ke(this,ut,XC).call(this,u,n,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:h}),h}}throw o}},ZC=async function(e){const{value:n}=await mr({network:this.getNetwork(),value:e});return n},Wf=async function(e,n,r){let s=this._getAddress(n),o=this._getBlockTag(r);return(typeof s!="string"||typeof o!="string")&&([s,o]=await Promise.all([s,o])),await ke(this,ut,ZC).call(this,ke(this,ut,Ur).call(this,Object.assign(e,{address:s,blockTag:o})))},e1=async function(e,n){if(Ht(e,32))return await ke(this,ut,Ur).call(this,{method:"getBlock",blockHash:e,includeTransactions:n});let r=this._getBlockTag(e);return typeof r!="string"&&(r=await r),await ke(this,ut,Ur).call(this,{method:"getBlock",blockTag:r,includeTransactions:n})},Kf=async function(e,n){let r=await Jv(e,this);return r.type==="event"&&n&&n.length>0&&n[0].removed===!0&&(r=await Jv({orphan:"drop-log",log:n[0]},this)),H(this,rr).get(r.tag)||null},Ly=async function(e){const n=await Jv(e,this),r=n.tag;let s=H(this,rr).get(r);return s||(s={subscriber:this._getSubscriber(n),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},H(this,rr).set(r,s)),s};function ehe(t,e){try{const n=t1(t,e);if(n)return Vw(n)}catch{}return null}function t1(t,e){if(t==="0x")return null;try{const n=ht(on(t,e,e+32)),r=ht(on(t,n,n+32));return on(t,n+32,n+32+r)}catch{}return null}function YR(t){const e=kn(t);if(e.length>32)throw new Error("internal; should not happen");const n=new Uint8Array(32);return n.set(e,32-e.length),n}function the(t){if(t.length%32===0)return t;const e=new Uint8Array(Math.ceil(t.length/32)*32);return e.set(t),e}const nhe=new Uint8Array([]);function rhe(t){const e=[];let n=0;for(let r=0;r<t.length;r++)e.push(nhe),n+=32;for(let r=0;r<t.length;r++){const s=dt(t[r]);e[r]=YR(n),e.push(YR(s.length)),e.push(the(s)),n+=32+Math.ceil(s.length/32)*32}return cn(e)}const JR="0x0000000000000000000000000000000000000000000000000000000000000000";function she(t){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};xe(Ju(t)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const n=on(t,0,32);xe(on(n,0,12)===on(JR,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=on(n,12);try{const r=[],s=ht(on(t,32,64)),o=ht(on(t,s,s+32)),i=on(t,s+32);for(let a=0;a<o;a++){const l=ehe(i,a*32);if(l==null)throw new Error("abort");r.push(l)}e.urls=r}catch{xe(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const r=t1(t,64);if(r==null)throw new Error("abort");e.calldata=r}catch{xe(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}xe(on(t,100,128)===on(JR,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=on(t,96,100);try{const r=t1(t,128);if(r==null)throw new Error("abort");e.extraData=r}catch{xe(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(r=>e[r]),e}function vl(t,e){if(t.provider)return t.provider;xe(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function XR(t,e){let n=qw(e);if(n.to!=null&&(n.to=xr(n.to,t)),n.from!=null){const r=n.from;n.from=Promise.all([t.getAddress(),xr(r,t)]).then(([s,o])=>(J(s.toLowerCase()===o.toLowerCase(),"transaction from mismatch","tx.from",o),s))}else n.from=t.getAddress();return await mr(n)}class ohe{constructor(e){oe(this,"provider");Je(this,{provider:e||null})}async getNonce(e){return vl(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await XR(this,e)}async populateTransaction(e){const n=vl(this,"populateTransaction"),r=await XR(this,e);r.nonce==null&&(r.nonce=await this.getNonce("pending")),r.gasLimit==null&&(r.gasLimit=await this.estimateGas(r));const s=await this.provider.getNetwork();if(r.chainId!=null){const i=Ve(r.chainId);J(i===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else r.chainId=s.chainId;const o=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||o)?J(!1,"eip-1559 transaction do not support gasPrice","tx",e):(r.type===0||r.type===1)&&o&&J(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1){const i=await n.getFeeData();xe(i.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),r.gasPrice==null&&(r.gasPrice=i.gasPrice)}else{const i=await n.getFeeData();if(r.type==null)if(i.maxFeePerGas!=null&&i.maxPriorityFeePerGas!=null)if(r.authorizationList&&r.authorizationList.length?r.type=4:r.type=2,r.gasPrice!=null){const a=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=a,r.maxPriorityFeePerGas=a}else r.maxFeePerGas==null&&(r.maxFeePerGas=i.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=i.maxPriorityFeePerGas);else i.gasPrice!=null?(xe(!o,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=i.gasPrice),r.type=0):xe(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(r.type===2||r.type===3||r.type===4)&&(r.maxFeePerGas==null&&(r.maxFeePerGas=i.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=i.maxPriorityFeePerGas))}return await mr(r)}async populateAuthorization(e){const n=Object.assign({},e);return n.chainId==null&&(n.chainId=(await vl(this,"getNetwork").getNetwork()).chainId),n.nonce==null&&(n.nonce=await this.getNonce()),n}async estimateGas(e){return vl(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return vl(this,"call").call(await this.populateCall(e))}async resolveName(e){return await vl(this,"resolveName").resolveName(e)}async sendTransaction(e){const n=vl(this,"sendTransaction"),r=await this.populateTransaction(e);delete r.from;const s=Uw.from(r);return await n.broadcastTransaction(await this.signTransaction(s))}authorize(e){xe(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function ihe(t){return JSON.parse(JSON.stringify(t))}var fr,mo,ic,Aa,ac,Ld,Ya,n1,r1;class Q4{constructor(e){ce(this,Ya);ce(this,fr);ce(this,mo);ce(this,ic);ce(this,Aa);ce(this,ac);ce(this,Ld);G(this,fr,e),G(this,mo,null),G(this,ic,ke(this,Ya,n1).bind(this)),G(this,Aa,!1),G(this,ac,null),G(this,Ld,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,n){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){H(this,Aa)||(G(this,Aa,!0),ke(this,Ya,n1).call(this,-2))}stop(){H(this,Aa)&&(G(this,Aa,!1),G(this,Ld,!0),ke(this,Ya,r1).call(this),H(this,fr).off("block",H(this,ic)))}pause(e){e&&ke(this,Ya,r1).call(this),H(this,fr).off("block",H(this,ic))}resume(){this.start()}}fr=new WeakMap,mo=new WeakMap,ic=new WeakMap,Aa=new WeakMap,ac=new WeakMap,Ld=new WeakMap,Ya=new WeakSet,n1=async function(e){try{H(this,mo)==null&&G(this,mo,this._subscribe(H(this,fr)));let n=null;try{n=await H(this,mo)}catch(o){if(!qn(o,"UNSUPPORTED_OPERATION")||o.operation!=="eth_newFilter")throw o}if(n==null){G(this,mo,null),H(this,fr)._recoverSubscriber(this,this._recover(H(this,fr)));return}const r=await H(this,fr).getNetwork();if(H(this,ac)||G(this,ac,r),H(this,ac).chainId!==r.chainId)throw new Error("chaid changed");if(H(this,Ld))return;const s=await H(this,fr).send("eth_getFilterChanges",[n]);await this._emitResults(H(this,fr),s)}catch(n){console.log("@TODO",n)}H(this,fr).once("block",H(this,ic))},r1=function(){const e=H(this,mo);e&&(G(this,mo,null),e.then(n=>{H(this,fr).destroyed||H(this,fr).send("eth_uninstallFilter",[n])}))};var lc;class ahe extends Q4{constructor(n,r){super(n);ce(this,lc);G(this,lc,ihe(r))}_recover(n){return new s_(n,H(this,lc))}async _subscribe(n){return await n.send("eth_newFilter",[H(this,lc)])}async _emitResults(n,r){for(const s of r)n.emit(H(this,lc),n._wrapLog(s,n._network))}}lc=new WeakMap;class lhe extends Q4{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,n){for(const r of n)e.emit("pending",r)}}const che="bigint,boolean,function,number,string,symbol".split(/,/g);function Fy(t){if(t==null||che.indexOf(typeof t)>=0||typeof t.getAddress=="function")return t;if(Array.isArray(t))return t.map(Fy);if(typeof t=="object")return Object.keys(t).reduce((e,n)=>(e[n]=t[n],e),{});throw new Error(`should not happen: ${t} (${typeof t})`)}function uhe(t){return new Promise(e=>{setTimeout(e,t)})}function vu(t){return t&&t.toLowerCase()}function ZR(t){return t&&typeof t.pollingInterval=="number"}const Y4={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class Zv extends ohe{constructor(n,r){super(n);oe(this,"address");r=Pt(r),Je(this,{address:r})}connect(n){xe(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(n){return await this.populateCall(n)}async sendUncheckedTransaction(n){const r=Fy(n),s=[];if(r.from){const i=r.from;s.push((async()=>{const a=await xr(i,this.provider);J(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",n),r.from=a})())}else r.from=this.address;if(r.gasLimit==null&&s.push((async()=>{r.gasLimit=await this.provider.estimateGas({...r,from:this.address})})()),r.to!=null){const i=r.to;s.push((async()=>{r.to=await xr(i,this.provider)})())}s.length&&await Promise.all(s);const o=this.provider.getRpcTransaction(r);return this.provider.send("eth_sendTransaction",[o])}async sendTransaction(n){const r=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(n);return await new Promise((o,i)=>{const a=[1e3,100];let l=0;const c=async()=>{try{const u=await this.provider.getTransaction(s);if(u!=null){o(u.replaceableTransaction(r));return}}catch(u){if(qn(u,"CANCELLED")||qn(u,"BAD_DATA")||qn(u,"NETWORK_ERROR")||qn(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=s,i(u);return}if(qn(u,"INVALID_ARGUMENT")&&(l++,u.info==null&&(u.info={}),u.info.sendTransactionHash=s,l>10)){i(u);return}this.provider.emit("error",qt("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{c()},a.pop()||4e3)};c()})}async signTransaction(n){const r=Fy(n);if(r.from){const o=await xr(r.from,this.provider);J(o!=null&&o.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",n),r.from=o}else r.from=this.address;const s=this.provider.getRpcTransaction(r);return await this.provider.send("eth_signTransaction",[s])}async signMessage(n){const r=typeof n=="string"?Lo(n):n;return await this.provider.send("personal_sign",[Ne(r),this.address.toLowerCase()])}async signTypedData(n,r,s){const o=Fy(s),i=await Kw.resolveNames(n,r,o,async a=>{const l=await xr(a);return J(l!=null,"TypedData does not support null address","value",a),l});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(Kw.getPayload(i.domain,r,i.value))])}async unlock(n){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),n,null])}async _legacySignMessage(n){const r=typeof n=="string"?Lo(n):n;return await this.provider.send("eth_sign",[this.address.toLowerCase(),Ne(r)])}}var cc,Fd,li,po,Vs,ms,Sr,pp,s1;class dhe extends Zde{constructor(n,r){super(n,r);ce(this,pp);ce(this,cc);ce(this,Fd);ce(this,li);ce(this,po);ce(this,Vs);ce(this,ms);ce(this,Sr);G(this,Fd,1),G(this,cc,Object.assign({},Y4,r||{})),G(this,li,[]),G(this,po,null),G(this,ms,null),G(this,Sr,null);{let o=null;const i=new Promise(a=>{o=a});G(this,Vs,{promise:i,resolve:o})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(J(!s||n!=="any","staticNetwork cannot be used on special network 'any'","options",r),s&&n!=null&&G(this,ms,_o.from(n))):s&&(J(n==null||s.matches(n),"staticNetwork MUST match network object","options",r),G(this,ms,s))}_getOption(n){return H(this,cc)[n]}get _network(){return xe(H(this,ms),"network is not available yet","NETWORK_ERROR"),H(this,ms)}async _perform(n){if(n.method==="call"||n.method==="estimateGas"){let s=n.transaction;if(s&&s.type!=null&&Ve(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const o=await this.getFeeData();o.maxFeePerGas==null&&o.maxPriorityFeePerGas==null&&(n=Object.assign({},n,{transaction:Object.assign({},s,{type:void 0})}))}}const r=this.getRpcRequest(n);return r!=null?await this.send(r.method,r.args):super._perform(n)}async _detectNetwork(){const n=this._getOption("staticNetwork");if(n)if(n===!0){if(H(this,ms))return H(this,ms)}else return n;return H(this,Sr)?await H(this,Sr):this.ready?(G(this,Sr,(async()=>{try{const r=_o.from(Ve(await this.send("eth_chainId",[])));return G(this,Sr,null),r}catch(r){throw G(this,Sr,null),r}})()),await H(this,Sr)):(G(this,Sr,(async()=>{const r={id:rf(this,Fd)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:r});let s;try{s=(await this._send(r))[0],G(this,Sr,null)}catch(o){throw G(this,Sr,null),this.emit("debug",{action:"receiveRpcError",error:o}),o}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return _o.from(Ve(s.result));throw this.getRpcError(r,s)})()),await H(this,Sr))}_start(){H(this,Vs)==null||H(this,Vs).resolve==null||(H(this,Vs).resolve(),G(this,Vs,null),(async()=>{for(;H(this,ms)==null&&!this.destroyed;)try{G(this,ms,await this._detectNetwork())}catch(n){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",qt("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:n}})),await uhe(1e3)}ke(this,pp,s1).call(this)})())}async _waitUntilReady(){if(H(this,Vs)!=null)return await H(this,Vs).promise}_getSubscriber(n){return n.type==="pending"?new lhe(this):n.type==="event"?this._getOption("polling")?new s_(this,n.filter):new ahe(this,n.filter):n.type==="orphan"&&n.filter.orphan==="drop-log"?new q4("orphan"):super._getSubscriber(n)}get ready(){return H(this,Vs)==null}getRpcTransaction(n){const r={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(n[s]==null)return;let o=s;s==="gasLimit"&&(o="gas"),r[o]=Hs(Ve(n[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{n[s]!=null&&(r[s]=Ne(n[s]))}),n.accessList&&(r.accessList=eu(n.accessList)),n.blobVersionedHashes&&(r.blobVersionedHashes=n.blobVersionedHashes.map(s=>s.toLowerCase())),n.authorizationList&&(r.authorizationList=n.authorizationList.map(s=>{const o=XV(s);return{address:o.address,nonce:Hs(o.nonce),chainId:Hs(o.chainId),yParity:Hs(o.signature.yParity),r:Hs(o.signature.r),s:Hs(o.signature.s)}})),r}getRpcRequest(n){switch(n.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[vu(n.address),n.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[vu(n.address),n.blockTag]};case"getCode":return{method:"eth_getCode",args:[vu(n.address),n.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[vu(n.address),"0x"+n.position.toString(16),n.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[n.signedTransaction]};case"getBlock":if("blockTag"in n)return{method:"eth_getBlockByNumber",args:[n.blockTag,!!n.includeTransactions]};if("blockHash"in n)return{method:"eth_getBlockByHash",args:[n.blockHash,!!n.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[n.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[n.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(n.transaction),n.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(n.transaction)]};case"getLogs":return n.filter&&n.filter.address!=null&&(Array.isArray(n.filter.address)?n.filter.address=n.filter.address.map(vu):n.filter.address=vu(n.filter.address)),{method:"eth_getLogs",args:[n.filter]}}return null}getRpcError(n,r){const{method:s}=n,{error:o}=r;if(s==="eth_estimateGas"&&o.message){const l=o.message;if(!l.match(/revert/i)&&l.match(/insufficient funds/i))return qt("insufficient funds","INSUFFICIENT_FUNDS",{transaction:n.params[0],info:{payload:n,error:o}});if(l.match(/nonce/i)&&l.match(/too low/i))return qt("nonce has already been used","NONCE_EXPIRED",{transaction:n.params[0],info:{payload:n,error:o}})}if(s==="eth_call"||s==="eth_estimateGas"){const l=o1(o),c=tp.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",n.params[0],l?l.data:null);return c.info={error:o,payload:n},c}const i=JSON.stringify(fhe(o));if(typeof o.message=="string"&&o.message.match(/user denied|ethers-user-denied/i))return qt("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:n,error:o}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const l=n.params[0];if(i.match(/insufficient funds|base fee exceeds gas limit/i))return qt("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:l,info:{error:o}});if(i.match(/nonce/i)&&i.match(/too low/i))return qt("nonce has already been used","NONCE_EXPIRED",{transaction:l,info:{error:o}});if(i.match(/replacement transaction/i)&&i.match(/underpriced/i))return qt("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:l,info:{error:o}});if(i.match(/only replay-protected/i))return qt("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:l,info:{error:o}}})}let a=!!i.match(/the method .* does not exist/i);return a||o&&o.details&&o.details.startsWith("Unauthorized method:")&&(a=!0),a?qt("unsupported operation","UNSUPPORTED_OPERATION",{operation:n.method,info:{error:o,payload:n}}):qt("could not coalesce error","UNKNOWN_ERROR",{error:o,payload:n})}send(n,r){if(this.destroyed)return Promise.reject(qt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:n}));const s=rf(this,Fd)._++,o=new Promise((i,a)=>{H(this,li).push({resolve:i,reject:a,payload:{method:n,params:r,id:s,jsonrpc:"2.0"}})});return ke(this,pp,s1).call(this),o}async getSigner(n){n==null&&(n=0);const r=this.send("eth_accounts",[]);if(typeof n=="number"){const o=await r;if(n>=o.length)throw new Error("no such account");return new Zv(this,o[n])}const{accounts:s}=await mr({network:this.getNetwork(),accounts:r});n=Pt(n);for(const o of s)if(Pt(o)===n)return new Zv(this,n);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(r=>new Zv(this,r))}destroy(){H(this,po)&&(clearTimeout(H(this,po)),G(this,po,null));for(const{payload:n,reject:r}of H(this,li))r(qt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:n.method}));G(this,li,[]),super.destroy()}}cc=new WeakMap,Fd=new WeakMap,li=new WeakMap,po=new WeakMap,Vs=new WeakMap,ms=new WeakMap,Sr=new WeakMap,pp=new WeakSet,s1=function(){if(H(this,po))return;const n=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");G(this,po,setTimeout(()=>{G(this,po,null);const r=H(this,li);for(G(this,li,[]);r.length;){const s=[r.shift()];for(;r.length&&s.length!==H(this,cc).batchMaxCount;)if(s.push(r.shift()),JSON.stringify(s.map(i=>i.payload)).length>H(this,cc).batchMaxSize){r.unshift(s.pop());break}(async()=>{const o=s.length===1?s[0].payload:s.map(i=>i.payload);this.emit("debug",{action:"sendRpcPayload",payload:o});try{const i=await this._send(o);this.emit("debug",{action:"receiveRpcResult",result:i});for(const{resolve:a,reject:l,payload:c}of s){if(this.destroyed){l(qt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:c.method}));continue}const u=i.filter(h=>h.id===c.id)[0];if(u==null){const h=qt("missing response for request","BAD_DATA",{value:i,info:{payload:c}});this.emit("error",h),l(h);continue}if("error"in u){l(this.getRpcError(c,u));continue}a(u.result)}}catch(i){this.emit("debug",{action:"receiveRpcError",error:i});for(const{reject:a}of s)a(i)}})()}},n))};var Sa;class hhe extends dhe{constructor(n,r){super(n,r);ce(this,Sa);let s=this._getOption("pollingInterval");s==null&&(s=Y4.pollingInterval),G(this,Sa,s)}_getSubscriber(n){const r=super._getSubscriber(n);return ZR(r)&&(r.pollingInterval=H(this,Sa)),r}get pollingInterval(){return H(this,Sa)}set pollingInterval(n){if(!Number.isInteger(n)||n<0)throw new Error("invalid interval");G(this,Sa,n),this._forEachSubscriber(r=>{ZR(r)&&(r.pollingInterval=H(this,Sa))})}}Sa=new WeakMap;function o1(t){if(t==null)return null;if(typeof t.message=="string"&&t.message.match(/revert/i)&&Ht(t.data))return{message:t.message,data:t.data};if(typeof t=="object"){for(const e in t){const n=o1(t[e]);if(n)return n}return null}if(typeof t=="string")try{return o1(JSON.parse(t))}catch{}return null}function i1(t,e){if(t!=null){if(typeof t.message=="string"&&e.push(t.message),typeof t=="object")for(const n in t)i1(t[n],e);if(typeof t=="string")try{return i1(JSON.parse(t),e)}catch{}}}function fhe(t){const e=[];return i1(t,e),e}var jd,Vd;const Fl=class Fl extends hhe{constructor(n,r,s){const o=Object.assign({},s??{},{batchMaxCount:1});J(n&&n.request,"invalid EIP-1193 provider","ethereum",n);super(r,o);ce(this,jd);ce(this,Vd);G(this,Vd,null),s&&s.providerInfo&&G(this,Vd,s.providerInfo),G(this,jd,async(i,a)=>{const l={method:i,params:a};this.emit("debug",{action:"sendEip1193Request",payload:l});try{const c=await n.request(l);return this.emit("debug",{action:"receiveEip1193Result",result:c}),c}catch(c){const u=new Error(c.message);throw u.code=c.code,u.data=c.data,u.payload=l,this.emit("debug",{action:"receiveEip1193Error",error:u}),u}})}get providerInfo(){return H(this,Vd)}async send(n,r){return await this._start(),await super.send(n,r)}async _send(n){J(!Array.isArray(n),"EIP-1193 does not support batch request","payload",n);try{const r=await H(this,jd).call(this,n.method,n.params||[]);return[{id:n.id,result:r}]}catch(r){return[{id:n.id,error:{code:r.code,data:r.data,message:r.message}}]}}getRpcError(n,r){switch(r=JSON.parse(JSON.stringify(r)),r.error.code||-1){case 4001:r.error.message=`ethers-user-denied: ${r.error.message}`;break;case 4200:r.error.message=`ethers-unsupported: ${r.error.message}`;break}return super.getRpcError(n,r)}async hasSigner(n){n==null&&(n=0);const r=await this.send("eth_accounts",[]);return typeof n=="number"?r.length>n:(n=n.toLowerCase(),r.filter(s=>s.toLowerCase()===n).length!==0)}async getSigner(n){if(n==null&&(n=0),!await this.hasSigner(n))try{await H(this,jd).call(this,"eth_requestAccounts",[])}catch(r){const s=r.payload;throw this.getRpcError(s,{id:s.id,error:r})}return await super.getSigner(n)}static async discover(n){if(n==null&&(n={}),n.provider)return new Fl(n.provider);const r=n.window?n.window:typeof window<"u"?window:null;if(r==null)return null;const s=n.anyProvider;if(s&&r.ethereum)return new Fl(r.ethereum);if(!("addEventListener"in r&&"dispatchEvent"in r&&"removeEventListener"in r))return null;const o=n.timeout?n.timeout:300;return o===0?null:await new Promise((i,a)=>{let l=[];const c=f=>{l.push(f.detail),s&&u()},u=()=>{if(clearTimeout(h),l.length)if(n&&n.filter){const f=n.filter(l.map(g=>Object.assign({},g.info)));if(f==null)i(null);else if(f instanceof Fl)i(f);else{let g=null;if(f.uuid&&(g=l.filter(w=>f.uuid===w.info.uuid)[0]),g){const{provider:y,info:w}=g;i(new Fl(y,void 0,{providerInfo:w}))}else a(qt("filter returned unknown info","UNSUPPORTED_OPERATION",{value:f}))}}else{const{provider:f,info:g}=l[0];i(new Fl(f,void 0,{providerInfo:g}))}else i(null);r.removeEventListener("eip6963:announceProvider",c)},h=setTimeout(()=>{u()},o);r.addEventListener("eip6963:announceProvider",c),r.dispatchEvent(new Event("eip6963:requestProvider"))})}};jd=new WeakMap,Vd=new WeakMap;let a1=Fl;var Sf={exports:{}},ex={},tx,e2;function mhe(){if(e2)return tx;e2=1;function t(e,n){typeof n=="boolean"&&(n={forever:n}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=n||{},this._maxRetryTime=n&&n.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return tx=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var n=new Date().getTime();if(e&&n-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},r),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,n){this._fn=e,n&&(n.timeout&&(this._operationTimeout=n.timeout),n.cb&&(this._operationTimeoutCb=n.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},n=null,r=0,s=0;s<this._errors.length;s++){var o=this._errors[s],i=o.message,a=(e[i]||0)+1;e[i]=a,a>=r&&(n=o,r=a)}return n},tx}var t2;function phe(){return t2||(t2=1,(function(t){var e=mhe();t.operation=function(n){var r=t.timeouts(n);return new e(r,{forever:n&&(n.forever||n.retries===1/0),unref:n&&n.unref,maxRetryTime:n&&n.maxRetryTime})},t.timeouts=function(n){if(n instanceof Array)return[].concat(n);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var s in n)r[s]=n[s];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var o=[],i=0;i<r.retries;i++)o.push(this.createTimeout(i,r));return n&&n.forever&&!o.length&&o.push(this.createTimeout(i,r)),o.sort(function(a,l){return a-l}),o},t.createTimeout=function(n,r){var s=r.randomize?Math.random()+1:1,o=Math.round(s*Math.max(r.minTimeout,1)*Math.pow(r.factor,n));return o=Math.min(o,r.maxTimeout),o},t.wrap=function(n,r,s){if(r instanceof Array&&(s=r,r=null),!s){s=[];for(var o in n)typeof n[o]=="function"&&s.push(o)}for(var i=0;i<s.length;i++){var a=s[i],l=n[a];n[a]=function(u){var h=t.operation(r),f=Array.prototype.slice.call(arguments,1),g=f.pop();f.push(function(y){h.retry(y)||(y&&(arguments[0]=h.mainError()),g.apply(this,arguments))}),h.attempt(function(){u.apply(n,f)})}.bind(n,l),n[a].options=r}}})(ex)),ex}var nx,n2;function ghe(){return n2||(n2=1,nx=phe()),nx}var r2;function yhe(){if(r2)return Sf.exports;r2=1;const t=ghe(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class n extends Error{constructor(a){super(),a instanceof Error?(this.originalError=a,{message:a}=a):(this.originalError=new Error(a),this.originalError.stack=this.stack),this.name="AbortError",this.message=a}}const r=(i,a,l)=>{const c=l.retries-(a-1);return i.attemptNumber=a,i.retriesLeft=c,i},s=i=>e.includes(i),o=(i,a)=>new Promise((l,c)=>{a={onFailedAttempt:()=>{},retries:10,...a};const u=t.operation(a);u.attempt(async h=>{try{l(await i(h))}catch(f){if(!(f instanceof Error)){c(new TypeError(`Non-error was thrown: "${f}". You should only throw errors.`));return}if(f instanceof n)u.stop(),c(f.originalError);else if(f instanceof TypeError&&!s(f.message))u.stop(),c(f);else{r(f,h,a);try{await a.onFailedAttempt(f)}catch(g){c(g);return}u.retry(f)||c(u.mainError())}}})});return Sf.exports=o,Sf.exports.default=o,Sf.exports.AbortError=n,Sf.exports}yhe();const whe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};function bhe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var o=t.charAt(s),i=o.charCodeAt(0);if(n[i]!==255)throw new TypeError(o+" is ambiguous");n[i]=s}var a=t.length,l=t.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var w=0,v=0,C=0,x=y.length;C!==x&&y[C]===0;)C++,w++;for(var A=(x-C)*u+1>>>0,N=new Uint8Array(A);C!==x;){for(var M=y[C],k=0,E=A-1;(M!==0||k<v)&&E!==-1;E--,k++)M+=256*N[E]>>>0,N[E]=M%a>>>0,M=M/a>>>0;if(M!==0)throw new Error("Non-zero carry");v=k,C++}for(var b=A-v;b!==A&&N[b]===0;)b++;for(var I=l.repeat(w);b<A;++b)I+=t.charAt(N[b]);return I}function f(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var w=0;if(y[w]!==" "){for(var v=0,C=0;y[w]===l;)v++,w++;for(var x=(y.length-w)*c+1>>>0,A=new Uint8Array(x);y[w];){var N=n[y.charCodeAt(w)];if(N===255)return;for(var M=0,k=x-1;(N!==0||M<C)&&k!==-1;k--,M++)N+=a*A[k]>>>0,A[k]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");C=M,w++}if(y[w]!==" "){for(var E=x-C;E!==x&&A[E]===0;)E++;for(var b=new Uint8Array(v+(x-E)),I=v;E!==x;)b[I++]=A[E++];return b}}}function g(y){var w=f(y);if(w)return w;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:g}}var vhe=bhe,xhe=vhe;class Che{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ehe{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return J4(this,e)}}class Ihe{constructor(e){this.decoders=e}or(e){return J4(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const J4=(t,e)=>new Ihe({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class _he{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new Che(e,n,r),this.decoder=new Ehe(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const X4=({name:t,prefix:e,encode:n,decode:r})=>new _he(t,e,n,r),Z4=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=xhe(n,e);return X4({prefix:t,name:e,encode:r,decode:o=>whe(s(o))})},Ahe=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let o=t.length;for(;t[o-1]==="=";)--o;const i=new Uint8Array(o*n/8|0);let a=0,l=0,c=0;for(let u=0;u<o;++u){const h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<n|h,a+=n,a>=8&&(a-=8,i[c++]=255&l>>a)}if(a>=n||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return i},She=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let o="",i=0,a=0;for(let l=0;l<t.length;++l)for(a=a<<8|t[l],i+=8;i>n;)i-=n,o+=e[s&a>>i];if(i&&(o+=e[s&a<<n-i]),r)for(;o.length*n&7;)o+="=";return o},Mi=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>X4({prefix:e,name:t,encode(s){return She(s,r,n)},decode(s){return Ahe(s,r,n,t)}});Z4({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});Z4({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Mi({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Mi({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Mi({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Mi({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Mi({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Mi({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Mi({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Mi({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});Mi({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const The=["string","number","bigint","symbol"],Phe=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function khe(t){if(t===null)return"null";if(t===void 0)return"undefined";if(t===!0||t===!1)return"boolean";const e=typeof t;if(The.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(t))return"Array";if(Rhe(t))return"Buffer";const n=Nhe(t);return n||"Object"}function Rhe(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}function Nhe(t){const e=Object.prototype.toString.call(t).slice(8,-1);if(Phe.includes(e))return e}class je{constructor(e,n,r){this.major=e,this.majorEncoded=e<<5,this.name=n,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}je.uint=new je(0,"uint",!0);je.negint=new je(1,"negint",!0);je.bytes=new je(2,"bytes",!0);je.string=new je(3,"string",!0);je.array=new je(4,"array",!1);je.map=new je(5,"map",!1);je.tag=new je(6,"tag",!1);je.float=new je(7,"float",!0);je.false=new je(7,"false",!0);je.true=new je(7,"true",!0);je.null=new je(7,"null",!0);je.undefined=new je(7,"undefined",!0);je.break=new je(7,"break",!0);class Jt{constructor(e,n,r){this.type=e,this.value=n,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const eB=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function";new TextDecoder;const Dhe=new TextEncoder;function s2(t){return eB&&globalThis.Buffer.isBuffer(t)}const Mhe=eB?t=>t.length>64?globalThis.Buffer.from(t):o2(t):t=>t.length>64?Dhe.encode(t):o2(t);function Ohe(t,e){if(s2(t)&&s2(e))return t.compare(e);for(let n=0;n<t.length;n++)if(t[n]!==e[n])return t[n]<e[n]?-1:1;return 0}function o2(t,e=1/0){let n;const r=t.length;let s=null;const o=[];for(let i=0;i<r;++i){if(n=t.charCodeAt(i),n>55295&&n<57344){if(!s){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(i+1===r){(e-=3)>-1&&o.push(239,191,189);continue}s=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),s=n;continue}n=(s-55296<<10|n-56320)+65536}else s&&(e-=3)>-1&&o.push(239,191,189);if(s=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,n&63|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,n&63|128)}else if(n<1114112){if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw new Error("Invalid code point")}return o}const v0="CBOR decode error:",tB="CBOR encode error:",Yr=[24,256,65536,4294967296,BigInt("18446744073709551616")];function nu(t,e){return Is(t,0,e.value)}function Is(t,e,n){if(n<Yr[0]){const r=Number(n);t.push([e|r])}else if(n<Yr[1]){const r=Number(n);t.push([e|24,r])}else if(n<Yr[2]){const r=Number(n);t.push([e|25,r>>>8,r&255])}else if(n<Yr[3]){const r=Number(n);t.push([e|26,r>>>24&255,r>>>16&255,r>>>8&255,r&255])}else{const r=BigInt(n);if(r<Yr[4]){const s=[e|27,0,0,0,0,0,0,0];let o=Number(r&BigInt(4294967295)),i=Number(r>>BigInt(32)&BigInt(4294967295));s[8]=o&255,o=o>>8,s[7]=o&255,o=o>>8,s[6]=o&255,o=o>>8,s[5]=o&255,s[4]=i&255,i=i>>8,s[3]=i&255,i=i>>8,s[2]=i&255,i=i>>8,s[1]=i&255,t.push(s)}else throw new Error(`${v0} encountered BigInt larger than allowable range`)}}nu.encodedSize=function(e){return Is.encodedSize(e.value)};Is.encodedSize=function(e){return e<Yr[0]?1:e<Yr[1]?2:e<Yr[2]?3:e<Yr[3]?5:9};nu.compareTokens=function(e,n){return e.value<n.value?-1:e.value>n.value?1:0};const nB=BigInt(-1),rB=BigInt(1);function o_(t,e){const n=e.value,r=typeof n=="bigint"?n*nB-rB:n*-1-1;Is(t,e.type.majorEncoded,r)}o_.encodedSize=function(e){const n=e.value,r=typeof n=="bigint"?n*nB-rB:n*-1-1;return r<Yr[0]?1:r<Yr[1]?2:r<Yr[2]?3:r<Yr[3]?5:9};o_.compareTokens=function(e,n){return e.value<n.value?1:e.value>n.value?-1:0};function Jw(t){return t.encodedBytes===void 0&&(t.encodedBytes=t.type===je.string?Mhe(t.value):t.value),t.encodedBytes}function x0(t,e){const n=Jw(e);Is(t,e.type.majorEncoded,n.length),t.push(n)}x0.encodedSize=function(e){const n=Jw(e);return Is.encodedSize(n.length)+n.length};x0.compareTokens=function(e,n){return Lhe(Jw(e),Jw(n))};function Lhe(t,e){return t.length<e.length?-1:t.length>e.length?1:Ohe(t,e)}const Fhe=x0;function i_(t,e){Is(t,je.array.majorEncoded,e.value)}i_.compareTokens=nu.compareTokens;i_.encodedSize=function(e){return Is.encodedSize(e.value)};function a_(t,e){Is(t,je.map.majorEncoded,e.value)}a_.compareTokens=nu.compareTokens;a_.encodedSize=function(e){return Is.encodedSize(e.value)};function l_(t,e){Is(t,je.tag.majorEncoded,e.value)}l_.compareTokens=nu.compareTokens;l_.encodedSize=function(e){return Is.encodedSize(e.value)};const jhe=20,Vhe=21,Bhe=22,Uhe=23;function c_(t,e,n){const r=e.value;if(r===!1)t.push([je.float.majorEncoded|jhe]);else if(r===!0)t.push([je.float.majorEncoded|Vhe]);else if(r===null)t.push([je.float.majorEncoded|Bhe]);else if(r===void 0)t.push([je.float.majorEncoded|Uhe]);else{let s,o=!1;(!n||n.float64!==!0)&&(oB(r),s=iB(Rs,1),r===s||Number.isNaN(r)?(Rs[0]=249,t.push(Rs.slice(0,3)),o=!0):(aB(r),s=lB(Rs,1),r===s&&(Rs[0]=250,t.push(Rs.slice(0,5)),o=!0))),o||(Hhe(r),s=$he(Rs,1),Rs[0]=251,t.push(Rs.slice(0,9)))}}c_.encodedSize=function(e,n){const r=e.value;if(r===!1||r===!0||r===null||r===void 0)return 1;if(!n||n.float64!==!0){oB(r);let s=iB(Rs,1);if(r===s||Number.isNaN(r))return 3;if(aB(r),s=lB(Rs,1),r===s)return 5}return 9};const sB=new ArrayBuffer(9),ls=new DataView(sB,1),Rs=new Uint8Array(sB,0);function oB(t){if(t===1/0)ls.setUint16(0,31744,!1);else if(t===-1/0)ls.setUint16(0,64512,!1);else if(Number.isNaN(t))ls.setUint16(0,32256,!1);else{ls.setFloat32(0,t);const e=ls.getUint32(0),n=(e&2139095040)>>23,r=e&8388607;if(n===255)ls.setUint16(0,31744,!1);else if(n===0)ls.setUint16(0,(t&2147483648)>>16|r>>13,!1);else{const s=n-127;s<-24?ls.setUint16(0,0):s<-14?ls.setUint16(0,(e&2147483648)>>16|1<<24+s,!1):ls.setUint16(0,(e&2147483648)>>16|s+15<<10|r>>13,!1)}}}function iB(t,e){if(t.length-e<2)throw new Error(`${v0} not enough data for float16`);const n=(t[e]<<8)+t[e+1];if(n===31744)return 1/0;if(n===64512)return-1/0;if(n===32256)return NaN;const r=n>>10&31,s=n&1023;let o;return r===0?o=s*2**-24:r!==31?o=(s+1024)*2**(r-25):o=s===0?1/0:NaN,n&32768?-o:o}function aB(t){ls.setFloat32(0,t,!1)}function lB(t,e){if(t.length-e<4)throw new Error(`${v0} not enough data for float32`);const n=(t.byteOffset||0)+e;return new DataView(t.buffer,n,4).getFloat32(0,!1)}function Hhe(t){ls.setFloat64(0,t,!1)}function $he(t,e){if(t.length-e<8)throw new Error(`${v0} not enough data for float64`);const n=(t.byteOffset||0)+e;return new DataView(t.buffer,n,8).getFloat64(0,!1)}c_.compareTokens=nu.compareTokens;function zhe(){const t=[];return t[je.uint.major]=nu,t[je.negint.major]=o_,t[je.bytes.major]=x0,t[je.string.major]=Fhe,t[je.array.major]=i_,t[je.map.major]=a_,t[je.tag.major]=l_,t[je.float.major]=c_,t}zhe();class Xw{constructor(e,n){this.obj=e,this.parent=n}includes(e){let n=this;do if(n.obj===e)return!0;while(n=n.parent);return!1}static createCheck(e,n){if(e&&e.includes(n))throw new Error(`${tB} object contains circular references`);return new Xw(n,e)}}const Xi={null:new Jt(je.null,null),undefined:new Jt(je.undefined,void 0),true:new Jt(je.true,!0),false:new Jt(je.false,!1),emptyArray:new Jt(je.array,0),emptyMap:new Jt(je.map,0)},qa={number(t,e,n,r){return!Number.isInteger(t)||!Number.isSafeInteger(t)?new Jt(je.float,t):t>=0?new Jt(je.uint,t):new Jt(je.negint,t)},bigint(t,e,n,r){return t>=BigInt(0)?new Jt(je.uint,t):new Jt(je.negint,t)},Uint8Array(t,e,n,r){return new Jt(je.bytes,t)},string(t,e,n,r){return new Jt(je.string,t)},boolean(t,e,n,r){return t?Xi.true:Xi.false},null(t,e,n,r){return Xi.null},undefined(t,e,n,r){return Xi.undefined},ArrayBuffer(t,e,n,r){return new Jt(je.bytes,new Uint8Array(t))},DataView(t,e,n,r){return new Jt(je.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength))},Array(t,e,n,r){if(!t.length)return n.addBreakTokens===!0?[Xi.emptyArray,new Jt(je.break)]:Xi.emptyArray;r=Xw.createCheck(r,t);const s=[];let o=0;for(const i of t)s[o++]=rx(i,n,r);return n.addBreakTokens?[new Jt(je.array,t.length),s,new Jt(je.break)]:[new Jt(je.array,t.length),s]},Object(t,e,n,r){const s=e!=="Object",o=s?t.keys():Object.keys(t),i=s?t.size:o.length;if(!i)return n.addBreakTokens===!0?[Xi.emptyMap,new Jt(je.break)]:Xi.emptyMap;r=Xw.createCheck(r,t);const a=[];let l=0;for(const c of o)a[l++]=[rx(c,n,r),rx(s?t.get(c):t[c],n,r)];return Ghe(a,n),n.addBreakTokens?[new Jt(je.map,i),a,new Jt(je.break)]:[new Jt(je.map,i),a]}};qa.Map=qa.Object;qa.Buffer=qa.Uint8Array;for(const t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))qa[`${t}Array`]=qa.DataView;function rx(t,e={},n){const r=khe(t),s=e&&e.typeEncoders&&e.typeEncoders[r]||qa[r];if(typeof s=="function"){const i=s(t,r,e,n);if(i!=null)return i}const o=qa[r];if(!o)throw new Error(`${tB} unsupported type: ${r}`);return o(t,r,e,n)}function Ghe(t,e){e.mapSorter&&t.sort(e.mapSorter)}new TextDecoder;new TextEncoder;new TextEncoder;new URL("https://dweb.link/");const Whe="";function cB(){return typeof window<"u"&&typeof window.ethereum<"u"}async function l1(t=!0){if(!cB())throw new Error("No crypto wallet detected");const e=new a1(window.ethereum);t&&await e.send("eth_requestAccounts",[]);const n=await e.getSigner(),r=await n.getAddress();return{provider:e,signer:n,address:r}}function uB(t){throw new Error("Contract address not configured")}async function Khe(t){throw new Error("NFT.Storage token not configured")}function dB(t,e,n){const r=`${e.id}|${n}|${e.reason}|${e.description}|${e.location?.name||""}|${e.location?.lat??""}|${e.location?.lng??""}|${t}|${new Date(e.timestamp).toISOString()}`;return pn(Lo(r))}async function qhe({id:t,reason:e,description:n,location:r,reporterUid:s,mediaUrl:o,audioUrl:i}){try{if(!cB()||!Whe)return console.info("[blockchain] Skipping on-chain registration (no wallet or contract configured)"),null;const{provider:a,signer:l,address:c}=await l1(!1).catch(async()=>l1(!0)),u={id:Number(t),reporter:c,reason:e,description:n,location:{name:r?.name||"",lat:r?.lat??null,lng:r?.lng??null},mediaUrl:o||"",audioUrl:i||"",timestamp:new Date().toISOString(),reporterUid:s||"",dapp:"MobilEASE",version:1},h=await Khe(u),f=dB(h,u,c.toLowerCase()),g=typeof r?.lat=="number"?Math.round(r.lat*1e6):0,y=typeof r?.lng=="number"?Math.round(r.lng*1e6):0,v=await uB(l).registerComplaint(Number(t),h,f,String(e||""),String(n||""),String(r?.name||""),BigInt(g),BigInt(y)),[C,x]=await Promise.all([v.wait(),a.getNetwork()]);return{txHash:C.hash,id:Number(t),ipfsCid:h,chainId:Number(x.chainId)}}catch(a){return console.warn("[blockchain] registerComplaintOnChain failed:",a?.message||a),null}}async function Qhe(t){try{const{provider:e}=await l1(!1).catch(()=>({}));if(!e)throw new Error("No wallet connected");const r=await uB(e).getComplaint(t.onChain.onChainId),s=dB({id:t.onChain.onChainId,reason:t.reason,description:t.description,location:t.location,reporterUid:t.reportedBy,mediaUrl:t.mediaUrl||"",audioUrl:t.audioUrl||"",timestamp:new Date(t.createdAt).getTime()/1e3}),o=`https://${t.onChain.ipfsCid}.ipfs.nftstorage.link/`,i=await fetch(o);if(!i.ok)throw new Error("IPFS data not found");const a=await i.json();return{isVerified:s===r.dataHash,onChainData:{dataHash:r.dataHash,ipfsCid:r.ipfsCid,timestamp:new Date(Number(r.timestamp)*1e3).toISOString()},computedHash:s,ipfsData:a}}catch(e){return console.warn("Verification failed:",e),{isVerified:!1,error:e.message}}}const Yhe="civicReportDB",Qa="pendingComplaints";let ty;const u_=()=>window.indexedDB?ty||(ty=new Promise((t,e)=>{const n=indexedDB.open(Yhe,1);n.onerror=r=>{console.error("Error opening IndexedDB:",r),e("Error opening database")},n.onsuccess=r=>{t(r.target.result)},n.onupgradeneeded=r=>{const s=r.target.result;s.objectStoreNames.contains(Qa)||s.createObjectStore(Qa,{keyPath:"id",autoIncrement:!0})}}),ty):(console.warn("IndexedDB is not supported in this browser"),Promise.reject("IndexedDB not supported")),i2=async t=>{try{const r=(await u_()).transaction(Qa,"readwrite").objectStore(Qa),s=`offline_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,o={...t,id:s,isOffline:!0,status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return await r.add(o),window.dispatchEvent(new Event("offlineComplaintAdded")),s}catch(e){throw console.error("Error saving offline complaint:",e),new Error("Failed to save complaint offline. Please try again.")}},hB=async()=>{try{const r=(await u_()).transaction(Qa,"readonly").objectStore(Qa).getAll();return new Promise(s=>{r.onsuccess=()=>{s(Array.isArray(r.result)?r.result:[])},r.onerror=o=>{console.error("Error in getPendingComplaints:",o),s([])}})}catch(t){return console.error("Error getting pending complaints:",t),[]}},Jhe=async t=>{try{await(await u_()).transaction(Qa,"readwrite").objectStore(Qa).delete(t)}catch(e){console.error("Error removing synced complaint:",e)}},Xhe=async()=>{if(!navigator.onLine)return{success:!1,message:"Device is offline"};try{const t=await hB(),e=[];if(!Array.isArray(t)||t.length===0)return console.log("No pending complaints to sync"),{success:!0,syncedCount:0};for(const n of t)try{const{id:r,isOffline:s,...o}=n;await RE(o),await Jhe(r),typeof window<"u"&&window.dispatchEvent(new Event("offlineComplaintSynced"))}catch(r){console.error(`Error syncing complaint ${n.id}:`,r),e.push({id:n.id,error:r.message})}return e.length>0&&(console.warn("Some complaints failed to sync:",e),typeof ge<"u"&&ge.error(`${e.length} complaints failed to sync. They will be retried later.`)),{success:e.length===0,syncedCount:t.length-e.length,total:t.length,errors:e}}catch(t){return console.error("Error during sync:",t),{success:!1,message:t.message||"Failed to sync complaints",error:t}}},jy=async()=>{try{if(!navigator.onLine)return{success:!1,message:"Device is offline"};const t=await Xhe();return t.success?(console.log(`Successfully synced ${t.syncedCount} complaints`),t.syncedCount>0&&typeof ge<"u"&&ge.success(`Successfully synced ${t.syncedCount} offline complaint${t.syncedCount>1?"s":""}`)):t.errors&&t.errors.length>0&&typeof ge<"u"&&(console.warn("Some complaints failed to sync:",t.errors),ge.warning(`Synced ${t.syncedCount} of ${t.total} complaints. Some failed to sync.`)),t}catch(t){return console.error("Error in checkOnlineStatus:",t),ge.error("Failed to sync offline complaints"),{success:!1,message:t.message||"Failed to sync offline complaints",error:t}}};typeof window<"u"&&(window.addEventListener("online",jy),window.addEventListener("offline",()=>{console.log("App is offline. Changes will be saved locally.")}));const C0={},a2=(C0?.VITE_AI_PROVIDER||"gemini").toLowerCase(),c1=C0?.VITE_OPENROUTER_API_KEY||"",l2=C0?.VITE_OPENROUTER_MODEL||"openai/gpt-4o-mini",sx=C0?.VITE_OPENROUTER_FALLBACK_MODEL||"deepseek/deepseek-v3.1";async function Zhe(){throw new Error("Missing VITE_GEMINI_API_KEY")}async function c2(t,e){const n=await new Promise((i,a)=>{try{const l=new FileReader;l.onload=()=>i(l.result),l.onerror=c=>a(c),l.readAsDataURL(t)}catch(l){a(l)}}),[r,s]=String(n).split(",",2),o=r.match(/^data:(.*?);base64$/)?.[1]||e||t.type||"image/jpeg";return{inlineData:{data:s,mimeType:o}}}async function efe({photos:t=[],videoSnapshot:e=null}){const r=(await Zhe()).getGenerativeModel({model:"gemini-1.5-flash",generationConfig:{temperature:.2,topP:.95,topK:40,maxOutputTokens:1024}}),s=["You are an AI assistant that analyzes images/videos of civic infrastructure issues.","You will be provided with one or more media items (photos or video snapshots) to analyze.","Each media item will be clearly marked with [PHOTO] or [VIDEO_SNAPSHOT] before it.","","For EACH media item, analyze it independently and provide a concise paragraph.","If multiple media are provided, keep paragraphs simple and separate them with a single blank line (\\n\\n).","","Return ONLY valid JSON with these fields:","{",'  "descriptionVideo": string,   // paragraph for video snapshot, or empty string if no video','  "descriptionPhotos": string,  // paragraph for photos, or empty string if no photos','  "issueType": string,          // most specific applicable type (see list below), or "other" if uncertain','  "mentionedLocation": string   // optional textual location if visible, else empty string',"}","","Guidance for the paragraphs:",'- Begin the video paragraph with "Video: " (only if video provided).','- Begin the photos paragraph with "Photos: " (only if photos provided).',"- Mention type/severity, approximate size, safety concerns, and visible location clues.","","When deciding issueType: If the video shows no civic issue but the photos do, choose the issue type from the photos.","Valid issue types include:","   - pothole: Holes or depressions in the road surface","   - garbage: Accumulated trash or illegal dumping","   - street_light: Malfunctioning or broken street lights","   - water_leakage: Leaking water pipes or flooding","   - road_damage: Cracks, broken pavement, or damaged road surface","   - drainage: Clogged or overflowing drains","   - illegal_dumping: Unauthorized waste disposal","","Return ONLY valid JSON, no other text or markdown."].join(`
`),o=[{text:s}],i=[];for(const a of t.slice(0,3))i.push({type:"photo",data:await c2(a)});e&&i.push({type:"video_snapshot",data:await c2(e)});for(const a of i)o.push({text:`[${a.type.toUpperCase()}]`}),o.push(a.data);try{if(console.log("Sending to AI model with",i.length,"media items"),a2==="openrouter")return await u1({photos:t,videoSnapshot:e,mediaContexts:i,systemPrompt:s});try{const l=(await r.generateContent({contents:[{role:"user",parts:o}],safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_NONE"}]})).response;if(!l)throw new Error("No response from AI model");const c=l.text().trim();return console.log("Raw AI response:",c),fB(c,i)}catch(a){if(((a?.message||"").includes("429")||(a?.name||"").includes("Quota")||a2==="fallback")&&c1)return console.warn("Gemini failed or quota exceeded. Falling back to OpenRouter..."),await u1({photos:t,videoSnapshot:e,mediaContexts:i,systemPrompt:s});throw a}}catch(a){return console.error("AI analysis error:",a),console.error("Error details:",{name:a?.name,message:a?.message,stack:a?.stack}),{description:"Could not analyze media. Please describe the issue manually.",issueType:"other",mentionedLocation:""}}}function fB(t,e){let n=String(t||"").replace(/^```(?:json)?/i,"").replace(/```$/i,"").trim();if(!(n.startsWith("{")&&n.endsWith("}"))){const s=n.match(/\{[\s\S]*\}/);s&&(n=s[0])}const r=JSON.parse(n);return tfe(r,e)}function tfe(t,e){const n=e?.some(u=>u.type==="video_snapshot"),r=e?.some(u=>u.type==="photo"),s=String(t.description||"").trim(),o=String(t.descriptionVideo||"").trim(),i=String(t.descriptionPhotos||"").trim();let a=[];n&&o&&a.push(o),r&&i&&a.push(i);let l=a.join(`

`).trim();l||(l=s||"Could not analyze media. Please describe the issue manually.");const c={description:l,issueType:String(t.issueType||"other").toLowerCase().trim(),mentionedLocation:String(t.mentionedLocation||"").trim()};return console.log("Processed AI response:",c),c}async function u1({photos:t,videoSnapshot:e,mediaContexts:n,systemPrompt:r},s=l2){if(!c1)throw new Error("OpenRouter API key not configured");const o="https://openrouter.ai/api/v1/chat/completions";console.log(`Using OpenRouter model: ${s}`);const i=[{type:"text",text:r}];for(const h of n){i.push({type:"text",text:`[${h.type.toUpperCase()}]`});let f;if(h.data?.inlineData?.data)f=`data:${h.data.inlineData.mimeType||"image/jpeg"};base64,${h.data.inlineData.data}`;else continue;i.push({type:"image_url",image_url:{url:f}})}const a={model:s,messages:[{role:"user",content:i}],temperature:.2},l=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c1}`,"HTTP-Referer":typeof window<"u"?window.location.origin:"http://localhost:5173","X-Title":"Civic Report"},body:JSON.stringify(a)});if(!l.ok){const h=await l.text();if(s===l2&&sx)return console.warn(`Primary model ${s} failed (${l.status}), trying fallback ${sx}...`),u1({photos:t,videoSnapshot:e,mediaContexts:n,systemPrompt:r},sx);throw new Error(`OpenRouter error ${l.status}: ${h}`)}const u=(await l.json())?.choices?.[0]?.message?.content||"";return console.log("Raw OpenRouter response:",u),fB(u,n)}async function u2(t){if(!(t instanceof Blob))throw new Error("Invalid video blob provided");const e=URL.createObjectURL(t),n=document.createElement("video"),r=(o,i,a,l)=>(i.drawImage(n,0,0,a,l),o),s=(o,i,a)=>{const u=document.createElement("canvas");u.width=64,u.height=36;const h=u.getContext("2d");h.drawImage(o.canvas,0,0,i,a,0,0,64,36);const{data:f}=h.getImageData(0,0,64,36);let g=0,y=0;for(let x=0;x<f.length;x+=4){const A=.299*f[x]+.587*f[x+1]+.114*f[x+2];g+=A,y+=A*A}const w=f.length/4,v=g/w,C=y/w-v*v;return v<8||C<30};try{n.src=e,n.crossOrigin="anonymous",n.muted=!0,n.playsInline=!0,n.preload="metadata",await new Promise((h,f)=>{const g=setTimeout(()=>{f(new Error("Video metadata loading timed out"))},1e4);n.onloadedmetadata=()=>{clearTimeout(g),h()},n.onerror=y=>{clearTimeout(g),console.error("Video error:",y),f(new Error(`Failed to load video: ${y.message||"Unknown error"}`))}});const o=Math.max(1,n.duration||1),i=[Math.min(.5,o*.1),o*.25,o*.5],a=n.videoWidth||640,l=n.videoHeight||360,c=document.createElement("canvas");c.width=a,c.height=l;const u=c.getContext("2d");if(!u)throw new Error("Could not get 2D context from canvas");for(const h of i)if(n.currentTime=Math.min(h,o-.01),await new Promise((f,g)=>{const y=setTimeout(()=>g(new Error("Video seek timed out")),5e3);n.onseeked=()=>{clearTimeout(y),f()},n.onerror=w=>{clearTimeout(y),g(w)}}),r(c,u,a,l),!s(u,a,l))break;return new Promise((h,f)=>{c.toBlob(g=>{if(!g)return f(new Error("Failed to create image blob from video frame"));h(g)},"image/jpeg",.85)})}catch(o){throw console.error("Error extracting video snapshot:",o),o}finally{n.pause(),n.removeAttribute("src"),n.load(),URL.revokeObjectURL(e)}}async function nfe(t){const e=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(t)}&limit=1&addressdetails=1`,n=await fetch(e,{headers:{"User-Agent":"CivicReport/1.0 (contact@example.com)"}});if(!n.ok)return null;const r=await n.json();if(!Array.isArray(r)||r.length===0)return null;const s=r[0];return{name:s.display_name,lat:parseFloat(s.lat),lng:parseFloat(s.lon)}}const rfe=()=>{const[t,e]=p.useState(!1),[n,r]=p.useState(navigator.onLine),[s,o]=p.useState(!1),[i,a]=p.useState([]),[l,c]=p.useState({name:"",lat:null,lng:null}),[u,h]=p.useState({reason:"",description:"",media:null,mediaPreview:"",mediaType:void 0,photos:[],photoPreviews:[],video:null,videoPreview:"",audio:null}),[f,g]=p.useState({}),y=p.useRef(null),w=p.useRef(null),v=p.useRef(null),C=p.useRef(null),x=ts(),{pendingVideo:A,pendingPhotos:N,clearAll:M}=NE(),k=p.useRef(!1),E=p.useRef(!1),[b,I]=p.useState({walletDetected:!1,contractConfigured:!1,ipfsConfigured:!1}),[P,S]=p.useState(null),[D,T]=p.useState(null),[j,R]=p.useState(""),[V,U]=p.useState("");p.useEffect(()=>{try{const Q=!!u.video&&(u.video instanceof File||u.video instanceof Blob),ee=!!u.videoPreview;!k.current&&(Q||ee)&&(console.log("[AI Trigger] Video detected. hasFile:",Q,"hasPreview:",ee),setTimeout(()=>we(),0))}catch(Q){console.warn("Auto AI trigger for video failed:",Q)}},[u.video,u.videoPreview]),p.useEffect(()=>{try{const Q=Array.isArray(u.photos)?u.photos.length:0;!k.current&&Q>0&&(console.log("[AI Trigger] Photos detected. count:",Q),setTimeout(()=>we(),0))}catch(Q){console.warn("Auto AI trigger for photos failed:",Q)}},[u.photos]),p.useEffect(()=>{const Q=typeof window<"u"&&!!window.ethereum;I({walletDetected:Q,contractConfigured:!1,ipfsConfigured:!1})},[]),p.useEffect(()=>{if(A&&A.blob||N&&N.length>0)try{h(Q=>{const ee={...Q};if(A?.blob){const de=URL.createObjectURL(A.blob);ee.video=new File([A.blob],"recording.webm",{type:A.mime||A.blob.type}),ee.videoPreview=de}if(N?.length){const de=N.map((pe,_e)=>new File([pe.blob],`photo_${Date.now()}_${_e}.jpg`,{type:pe.mime||pe.blob.type})),ye=N.map(pe=>URL.createObjectURL(pe.blob));ee.photos=[...Q.photos||[],...de],ee.photoPreviews=[...Q.photoPreviews||[],...ye]}return ee}),setTimeout(()=>we(),0)}finally{M()}},[A,N,M]);const F=Q=>{switch(Number(Q)){case 11155111:return"https://sepolia.etherscan.io";case 11155420:return"https://sepolia-optimism.etherscan.io";default:return""}},$=()=>{w.current?.click()},W=()=>{v.current?.click()},Z=Q=>{const ee=Array.from(Q.target.files||[]);if(!ee.length)return;const de=[],ye=[];for(const pe of ee){if(!pe.type.startsWith("image/")){console.warn("Skipping non-image file:",pe.name,pe.type);continue}if(pe.size>10*1024*1024){console.warn("Image too large:",pe.name,pe.size),g(_e=>({..._e,media:"Each image should be less than 10MB"}));continue}de.push(pe),ye.push(URL.createObjectURL(pe))}if(!de.length){console.log("No valid image files selected");return}console.log("Adding photos to form data:",de.length),h(pe=>{const _e=[...pe.photos||[],...de],qe=[...pe.photoPreviews||[],...ye],Ie={...pe,photos:_e,photoPreviews:qe};return console.log("Updated form data with photos:",Ie),setTimeout(()=>{console.log("Running AI analysis with photos:",_e.length),we()},0),Ie}),g(pe=>({...pe,media:""}))},Y=async Q=>{const ee=Q.target.files?.[0];if(!ee){console.log("No file selected for video");return}if(console.log("Video file selected:",ee.name,ee.type,ee.size),!ee.type.startsWith("video/")){console.warn("Invalid video file type:",ee.type),g(ye=>({...ye,media:"Please choose a valid video file (MP4, WebM, etc.)"}));return}if(ee.size>50*1024*1024){console.warn("Video file too large:",ee.size),g(ye=>({...ye,media:"Video size should be less than 50MB"}));return}const de=URL.createObjectURL(ee);console.log("Video URL created, updating form state...");try{await new Promise(ye=>{h(pe=>{const _e={...pe,video:ee,videoPreview:de,mediaType:ee.type,media:ee,mediaPreview:de,timestamp:Date.now()};return console.log("Form state updated with video:",_e),ye(_e),_e})}),g(ye=>({...ye,media:""})),await new Promise(ye=>setTimeout(ye,100)),console.log("Running AI analysis for video..."),await we()}catch(ye){console.error("Error processing video:",ye),ge.error("Failed to process video")}},le=Q=>{const ee=String(Q||"").toLowerCase().trim();console.log("Mapping issue type:",ee);const de={pothole:"Pothole",garbage:"Garbage",street_light:"Street Light",streetlight:"Street Light",water_leakage:"Water Leakage",waterleak:"Water Leakage",road_damage:"Road Damage",roaddamage:"Road Damage",drainage:"Drainage Issue",drain:"Drainage Issue",illegal_dumping:"Illegal Dumping",illegaldumping:"Illegal Dumping",traffic_violation:"Traffic Violation",vandalism:"Vandalism",encroachment:"Encroachment",waterlogging:"Water Logging",sewage:"Drainage Issue",sewer:"Drainage Issue","waste water":"Drainage Issue",wastewater:"Drainage Issue","open drain":"Drainage Issue","clogged drain":"Drainage Issue","drain clog":"Drainage Issue",overflow:"Drainage Issue",manhole:"Drainage Issue",stormwater:"Drainage Issue","stagnant water":"Drainage Issue","dirty water":"Drainage Issue"};if(de[ee])return de[ee];for(const[ye,pe]of Object.entries(de))if(ee.includes(ye))return pe;return console.warn("No mapping found for issue type:",ee),"Other"},fe=async(Q,ee)=>{if(!Q?.length&&!ee){console.log("No media provided for analysis");return}const de=ge.loading("Analyzing media...");console.log("Starting AI analysis with:",JSON.stringify({photos:Q?.length||0,hasVideo:!!ee,videoType:ee?.type||"none"}));try{const ye={photoCount:Q?.length||0,hasVideo:!!ee,videoSize:ee?.size||0};console.log("Calling analyzeMedia with:",JSON.stringify(ye));const pe=await efe({photos:Q||[],videoSnapshot:ee||null});if(console.log("AI analysis completed:",{hasResult:!!pe,descriptionLength:pe?.description?.length,issueType:pe?.issueType}),!pe)throw new Error("No result from AI analysis");const _e=u,qe={};let Ie=!1;const be=Array.isArray(Q)&&Q.length>0,Se=!!ee,De=(pe?.descriptionVideo||"").trim(),Ye=(pe?.descriptionPhotos||"").trim(),gt=(pe?.description||"").trim();Se&&!be&&R(De||gt),be&&!Se&&U(Ye||gt);const un=[(Se?De||gt:j).trim(),(be?Ye||gt:V).trim()].filter(Boolean).join(`

`).replace(/\n{3,}/g,`

`).trim();if(un&&(qe.description=un,Ie=!0),pe?.issueType){const Tt=le(pe.issueType);Tt&&Tt!=="Other"?(qe.reason=Tt,Ie=!0):_e.reason?.trim()||(qe.reason="Other",Ie=!0)}if(Ie?(console.log("Applying AI suggestions:",qe),h(Tt=>({...Tt,...qe})),ge.dismiss(de),ge.success("AI suggestions applied")):(console.log("No updates needed based on AI analysis"),ge.dismiss(de),ge.info("No new suggestions from AI")),pe?.mentionedLocation&&(!l.lat||!l.lng))try{console.log("Attempting to geocode location:",pe.mentionedLocation);const Tt=await nfe(pe.mentionedLocation);Tt?.lat&&Tt?.lng&&(console.log("Location geocoded successfully:",Tt),c({name:Tt.name||pe.mentionedLocation,lat:Tt.lat,lng:Tt.lng}),ge.success("Location inferred from media"))}catch(Tt){console.error("Error geocoding location:",Tt)}}catch(ye){console.error("Error in analyzeAndUpdateForm:",ye),ge.dismiss(de),ge.error("Failed to analyze media. Please try again.")}},we=async()=>{if(k.current){console.log("AI analysis already in progress; queueing a follow-up run"),E.current=!0;return}console.log("runAIAnalysis called");try{if(k.current=!0,!void 0){console.warn("No API key configured for Gemini AI");return}const ee={...u};console.log("Current form data in runAIAnalysis:",{hasPhotos:Array.isArray(ee.photos)&&ee.photos.length>0,photoCount:Array.isArray(ee.photos)?ee.photos.length:0,hasVideo:!!(ee.video||ee.media),hasVideoPreview:!!(ee.videoPreview||ee.mediaPreview),mediaType:ee.mediaType});let de=Array.isArray(ee.photos)?ee.photos.filter(Ie=>{if(Ie instanceof File||Ie instanceof Blob)return!0;try{return Ie&&typeof Ie.type=="string"&&Ie.type.startsWith("image/")&&typeof Ie.size=="number"&&Ie.size>0}catch{return!1}}):[];if(de.length===0&&Array.isArray(ee.photoPreviews)&&ee.photoPreviews.length>0)try{const Ie=ee.photoPreviews.slice(0,3);console.log("No File images found; fetching from previews:",Ie.length),de=(await Promise.all(Ie.map(async(Se,De)=>{try{const gt=await(await fetch(Se)).blob();return new File([gt],`photo_preview_${De}.jpg`,{type:gt.type||"image/jpeg"})}catch(Ye){return console.warn("Failed to fetch photo preview",Se,Ye),null}}))).filter(Boolean)}catch(Ie){console.warn("Photo previews fetch failed:",Ie)}const ye=ee.video||ee.media,pe=ee.videoPreview||ee.mediaPreview,_e=ee.mediaType?.startsWith("video/")?ee.mediaType:"video/mp4";console.log("Media check - photos:",de.length,"video:",!!ye,"videoPreview:",!!pe);let qe=null;if(ye&&(ye instanceof File||ye instanceof Blob)){console.log("Processing video file...");try{if(console.log("Extracting video snapshot..."),qe=await u2(ye),!qe)throw new Error("Failed to extract video snapshot");console.log("Video snapshot created.")}catch(Ie){console.error("Failed to process video:",Ie),ge.error("Failed to process video for analysis")}}else if(pe){console.log("Found video preview, attempting to fetch video...");try{console.log("Fetching video from preview URL:",pe.substring(0,100)+"...");const Ie=await fetch(pe);if(!Ie.ok)throw new Error(`HTTP error! status: ${Ie.status}`);const be=await Ie.blob();console.log("Fetched video blob, creating File object...");const Se=new File([be],"recorded-video.mp4",{type:_e});if(console.log("Extracting snapshot from fetched video..."),qe=await u2(Se),!qe)throw new Error("Failed to extract snapshot from fetched video");console.log("Video snapshot created from preview.")}catch(Ie){console.error("Failed to process video from preview:",Ie),ge.error("Failed to process recorded video")}}if(de.length===0&&!qe){console.log("No valid media available for analysis");return}try{console.log("Analyzing combined media:",{photos:de.length,hasVideo:!!qe}),await fe(de,qe)}catch(Ie){console.error("Error during combined media analysis:",Ie),ge.error("Failed to analyze media")}}catch(Q){console.error("Error in AI analysis flow:",Q),ge.error("Error analyzing media")}finally{k.current=!1,E.current&&(console.log("Running queued AI analysis now"),E.current=!1,setTimeout(()=>we(),0))}},Me=async()=>{try{const Q=await hB();a(Q||[])}catch(Q){console.error("Error loading pending complaints:",Q),ge.error("Failed to load pending complaints")}},Ee=async()=>{if(!navigator.onLine){ge.warning("You need to be online to sync complaints");return}o(!0);const Q=ge.loading("Syncing pending complaints...");try{const ee=await jy();if(ge.dismiss(Q),ee.success)ee.syncedCount>0?ge.success(`Successfully synced ${ee.syncedCount} complaint${ee.syncedCount!==1?"s":""}`):ge.info("No pending complaints to sync"),await Me();else{const de=ee.message||"Failed to sync some complaints. They will be retried later.";ge.error(de)}}catch(ee){console.error("Error syncing complaints:",ee),ge.dismiss(Q),ge.error("Failed to sync complaints: "+(ee.message||"Unknown error"))}finally{o(!1)}};p.useEffect(()=>{const Q=async()=>{r(!0);try{await jy()}catch(de){console.error("Error during online sync:",de)}},ee=()=>{r(!1)};return window.addEventListener("online",Q),window.addEventListener("offline",ee),window.addEventListener("offlineComplaintAdded",Me),window.addEventListener("offlineComplaintSynced",Me),r(navigator.onLine),Me(),navigator.onLine&&jy().catch(de=>console.warn("Initial sync failed:",de)),()=>{window.removeEventListener("online",Q),window.removeEventListener("offline",ee),window.removeEventListener("offlineComplaintAdded",Me),window.removeEventListener("offlineComplaintSynced",Me)}},[]),p.useEffect(()=>{const Q=it.onAuthStateChanged(async ee=>{if(!ee){x("/citizen-login");return}try{await Hp(ee.uid)&&x("/official-dashboard")}catch{}});return()=>Q()},[x]);const X=async()=>{if(!navigator.geolocation){const ye="Geolocation is not supported by your browser. Please try a different browser or enter the location manually.";ge.error(ye),g(pe=>({...pe,location:ye}));return}e(!0),g(ye=>({...ye,location:""}));const Q=async ye=>{try{const{latitude:pe,longitude:_e,accuracy:qe}=ye,Ie={name:"Current Location",lat:pe,lng:_e,accuracy:qe};qe>100&&ge.warning("Your location accuracy is low. For best results, try moving to an open area.");try{const be=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${pe}&lon=${_e}&zoom=18&addressdetails=1`,{headers:{"User-Agent":"CivicReport/1.0 (contact@example.com)"}});if(be.ok){const Se=await be.json();Se.display_name&&(Ie.name=Se.display_name||Se.address?.road||Se.address?.suburb||Se.address?.city||"Current Location")}}catch{}c(Ie),ge.success("Location detected successfully")}finally{e(!1)}};try{if(typeof window<"u"&&window.Capacitor?.isNativePlatform?.()){const pe=await Kb(()=>import("./index-D7IyB7uP.js"),__vite__mapDeps([6,1,3,2])),{Geolocation:_e}=pe;await _e.requestPermissions();const qe=await _e.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4});await Q(qe.coords);return}}catch(ye){console.warn("Native geolocation plugin failed or not installed, falling back to web geolocation.",ye)}const ee=setTimeout(()=>{const ye="Location detection is taking too long. Please check your internet connection and try again.";ge.error(ye),g(pe=>({...pe,location:ye})),e(!1)},1e4),de={enableHighAccuracy:!0,timeout:1e4,maximumAge:0};navigator.geolocation.getCurrentPosition(async ye=>{clearTimeout(ee);try{await Q(ye.coords)}catch(pe){console.error("Error processing location:",pe);const _e=pe.message||"Failed to process location. Please try again.";ge.error(_e),g(qe=>({...qe,location:_e}))}finally{e(!1)}},ye=>{clearTimeout(ee),console.error("Geolocation error:",ye);let pe="Failed to detect location",_e="";switch(ye.code){case ye.PERMISSION_DENIED:pe="Location access was denied",_e="Please allow location permission when prompted. If already blocked, enable it in your browser/app settings and try again.";break;case ye.POSITION_UNAVAILABLE:pe="Location unavailable",_e="Your location could not be determined. Please check your device location settings and try again.";break;case ye.TIMEOUT:pe="Location request timed out",_e="Please check your internet connection and try again.";break;default:pe="Location error",_e="An unknown error occurred while detecting your location."}ge.error(pe),g(qe=>({...qe,location:`${pe}. ${_e}`})),e(!1)},de)},ue=Q=>{h(ee=>({...ee,audio:Q}))},re=()=>{h(Q=>({...Q,audio:null}))},ie=async Q=>{Q.preventDefault();const ee={};if(u.reason.trim()||(ee.reason="Please select a reason"),!u.description.trim()&&!u.audio&&(ee.description="Please provide details or record a voice note"),(!l.lat||!l.lng)&&(ee.location="Please detect location"),Object.keys(ee).length>0){g(ee);const de=Object.keys(ee)[0];if(de){const ye=document.querySelector(`[name="${de}"]`);ye&&(ye.scrollIntoView({behavior:"smooth",block:"center"}),ye.focus({preventScroll:!0}))}ge.error("Please fill in all required fields");return}e(!0);try{const de={reason:u.reason.trim(),description:u.description.trim(),media:u.media,mediaType:u.mediaType,photos:u.photos||[],video:u.video||null,audio:u.audio,location:{...l,name:l.name||"Unknown Location"},status:Es.inProgress,timestamp:new Date().toISOString(),reportedBy:it.currentUser.uid},ye=(Ie,be=8e3)=>Promise.race([Ie,new Promise((Se,De)=>setTimeout(()=>De(new Error("Network timeout")),be))]),_e=await(async()=>{if(!navigator.onLine)return!1;try{const Ie=new AbortController,be=setTimeout(()=>Ie.abort(),2e3);return await fetch("https://www.gstatic.com/generate_204",{method:"GET",mode:"no-cors",cache:"no-store",signal:Ie.signal}),clearTimeout(be),!0}catch{return!1}})(),qe=ge.loading(_e?"Submitting your complaint...":"Saving complaint for later submission...");try{if(_e){const Ie=await ye(RE(de));ge.dismiss(qe),ge.success("Complaint submitted successfully!");try{const be=Math.floor(Date.now()/1e3),Se=Ie?.mediaUrl||"",De=Ie?.audioUrl||"";qhe({id:be,reason:de.reason,description:de.description,location:de.location,reporterUid:de.reportedBy,mediaUrl:Se,audioUrl:De})?.then(async Ye=>{if(!Ye)return;const{txHash:gt,ipfsCid:un,chainId:Tt}=Ye;try{await Ii(tt(Oe,"complaints",Ie.id),{onChain:{enabled:!0,txHash:gt,ipfsCid:un,onChainId:be,chainId:Tt,certifiedAt:new Date().toISOString()}}),ge.success("Complaint certified on-chain"),S({txHash:gt,ipfsCid:un,chainId:Tt,onChainId:be})}catch(_s){console.warn("Failed to persist on-chain info:",_s?.message||_s)}})}catch(be){console.warn("Blockchain registration skipped/failed:",be?.message||be)}}else await i2(de),ge.dismiss(qe),ge.success("Complaint saved for submission when you're back online!");h({reason:"",description:"",media:null,mediaPreview:"",mediaType:void 0,photos:[],photoPreviews:[],video:null,videoPreview:"",audio:null}),c({name:"",lat:null,lng:null}),g({}),x("/citizen-dashboard")}catch(Ie){console.warn("Online submission failed, attempting offline save:",Ie);try{await i2(de),ge.dismiss(),ge.success("Complaint saved for submission when you're back online!"),h({reason:"",description:"",media:null,mediaPreview:"",mediaType:void 0,photos:[],photoPreviews:[],video:null,videoPreview:"",audio:null}),c({name:"",lat:null,lng:null}),g({}),x("/citizen-dashboard")}catch(be){throw console.error("Failed to save complaint offline after submit error:",be),ge.dismiss(),ge.error("Failed to submit or save offline. Please try again."),be}}}catch(de){console.error("Error in form submission:",de)}finally{e(!1)}},Ce={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},K={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100,damping:15}}},me=Q=>{const ee={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(Q).toLocaleDateString(void 0,ee)};return d.jsxs("div",{className:"min-h-screen bg-gray-50",children:[d.jsx(qp,{visible:t}),d.jsxs(or.div,{className:"max-w-4xl mx-auto px-4 py-8",initial:"hidden",animate:"visible",variants:Ce,children:[i.length>0&&d.jsxs(or.div,{variants:K,className:"mb-6 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsxs("h3",{className:"text-sm font-medium text-yellow-800 flex items-center",children:[d.jsx(Ff,{className:"h-4 w-4 mr-2"}),"You have ",i.length," offline complaint",i.length!==1?"s":""," waiting to be synced"]}),d.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"These will be automatically submitted when you're back online."})]}),d.jsx(Vn,{variant:"outline",size:"sm",onClick:Ee,disabled:s||!n,className:"whitespace-nowrap",children:s?d.jsxs(d.Fragment,{children:[d.jsx(XG,{className:"h-3 w-3 mr-2 animate-spin"}),"Syncing..."]}):"Sync Now"})]}),d.jsx("div",{className:"mt-3 space-y-2 max-h-40 overflow-y-auto pr-2",children:i.map(Q=>d.jsx("div",{className:"flex items-start justify-between p-2 bg-white bg-opacity-50 rounded text-sm",children:d.jsxs("div",{className:"truncate flex-1",children:[d.jsx("p",{className:"font-medium text-yellow-900 truncate",children:Q.reason}),d.jsxs("p",{className:"text-yellow-700 text-xs truncate",children:[Q.description.substring(0,60),Q.description.length>60?"...":""]}),d.jsx("p",{className:"text-yellow-600 text-xs mt-1",children:me(Q.createdAt)})]})},Q.id))})]}),d.jsxs(or.div,{variants:K,className:"mb-8",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Report an Issue"}),d.jsx("p",{className:"text-gray-600",children:"Help us improve the city by reporting traffic violations, road damages, or other issues."})]}),d.jsx("div",{className:`flex items-center px-3 py-1 rounded-full text-sm font-medium ${n?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:n?d.jsxs(d.Fragment,{children:[d.jsx(x7,{className:"w-4 h-4 mr-1"}),d.jsx("span",{children:"Online"})]}):d.jsxs(d.Fragment,{children:[d.jsx(b7,{className:"w-4 h-4 mr-1"}),d.jsx("span",{children:"Offline - Saving Locally"})]})})]}),!n&&d.jsx("div",{className:"mt-3 p-3 bg-blue-50 text-blue-800 text-sm rounded-md",children:d.jsx("p",{children:"You are currently offline. Your complaint will be saved locally and submitted when you're back online."})})]}),d.jsx(or.div,{variants:K,className:"mb-8",children:d.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Blockchain Certification"}),d.jsx("span",{className:"text-xs text-gray-500",children:"Optional"})]}),d.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[d.jsxs("div",{className:`p-3 rounded-lg border ${b.walletDetected?"border-emerald-200 bg-emerald-50 text-emerald-800":"border-gray-200 bg-gray-50 text-gray-700"}`,children:[d.jsx("div",{className:"font-medium",children:"Wallet"}),d.jsx("div",{children:b.walletDetected?"Metamask detected":"No crypto wallet detected"})]}),d.jsxs("div",{className:`p-3 rounded-lg border ${b.contractConfigured?"border-emerald-200 bg-emerald-50 text-emerald-800":"border-gray-200 bg-gray-50 text-gray-700"}`,children:[d.jsx("div",{className:"font-medium",children:"Contract"}),d.jsx("div",{children:b.contractConfigured?"Contract address configured":"Set VITE_COMPLAINT_REGISTRY_ADDRESS"})]}),d.jsxs("div",{className:`p-3 rounded-lg border ${b.ipfsConfigured?"border-emerald-200 bg-emerald-50 text-emerald-800":"border-gray-200 bg-gray-50 text-gray-700"}`,children:[d.jsx("div",{className:"font-medium",children:"IPFS"}),d.jsx("div",{children:b.ipfsConfigured?"NFT.Storage token configured":"Set VITE_NFT_STORAGE_TOKEN or VITE_IPFS_API_KEY"})]})]}),P&&d.jsxs("div",{className:"mt-4 space-y-3",children:[d.jsxs("div",{className:"p-3 rounded-lg border border-emerald-200 bg-emerald-50 text-emerald-800 text-sm",children:[d.jsx("div",{className:"font-medium mb-1",children:"Certified on-chain"}),d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:gap-4 gap-2",children:[d.jsxs("div",{children:["On-chain ID: ",d.jsx("span",{className:"font-mono",children:P.onChainId})]}),d.jsxs("div",{children:["IPFS: ",P.ipfsCid?d.jsx("a",{className:"text-emerald-700 underline",target:"_blank",rel:"noreferrer",href:`https://${P.ipfsCid}.ipfs.nftstorage.link/`,children:P.ipfsCid}):""]}),d.jsxs("div",{children:["Tx: ",P.txHash?(()=>{const Q=F(P.chainId);return Q?d.jsxs("a",{className:"text-emerald-700 underline",target:"_blank",rel:"noreferrer",href:`${Q}/tx/${P.txHash}`,children:[P.txHash.slice(0,10),""]}):d.jsxs("span",{className:"font-mono",children:[P.txHash.slice(0,10),""]})})():""]})]})]}),d.jsxs("div",{className:"p-3 rounded-lg border border-blue-100 bg-blue-50",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Verify Integrity"}),d.jsx("button",{onClick:async()=>{try{T("verifying");const Q=await Qhe({...complaintData,onChain:P,reportedBy:it.currentUser?.uid,createdAt:new Date().toISOString()});Q.isVerified?(ge.success("Verification successful! Data matches on-chain records."),T("verified")):(ge.error("Verification failed: "+(Q.error||"Data mismatch detected")),T("failed"))}catch(Q){console.error("Verification error:",Q),ge.error("Verification error: "+(Q.message||"Check console for details")),T("error")}},disabled:D==="verifying",className:"text-xs px-3 py-1 bg-white border border-blue-200 rounded-md text-blue-700 hover:bg-blue-100 disabled:opacity-50 disabled:cursor-not-allowed",children:D==="verifying"?d.jsxs("span",{className:"flex items-center gap-1",children:[d.jsxs("svg",{className:"animate-spin h-3 w-3 mr-1",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying..."]}):D==="verified"?d.jsxs("span",{className:"text-green-600 flex items-center",children:[d.jsx("svg",{className:"h-3 w-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:d.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Verified"]}):D==="failed"?d.jsx("span",{className:"text-red-600",children:"Failed - Try Again"}):"Verify Now"})]}),d.jsx("p",{className:"text-xs text-blue-600",children:"Verify that this complaint's data matches what's stored on the blockchain."})]})]})]})}),d.jsxs(or.div,{variants:K,className:"mb-8",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Location Map"}),l.lat&&l.lng?d.jsxs("div",{className:"bg-white p-3 rounded-xl shadow-sm border border-gray-100",children:[d.jsx("div",{className:"aspect-video rounded-lg overflow-hidden",children:d.jsx("iframe",{title:"OpenStreetMap",src:`https://www.openstreetmap.org/export/embed.html?bbox=${encodeURIComponent((l.lng-.01).toFixed(6))}%2C${encodeURIComponent((l.lat-.01).toFixed(6))}%2C${encodeURIComponent((l.lng+.01).toFixed(6))}%2C${encodeURIComponent((l.lat+.01).toFixed(6))}&layer=mapnik&marker=${l.lat}%2C${l.lng}`,className:"w-full h-full border-0"},`${l.lat},${l.lng}`)}),d.jsx("div",{className:"mt-2 text-sm text-gray-600",children:d.jsx("a",{href:`https://www.openstreetmap.org/?mlat=${l.lat}&mlon=${l.lng}#map=5/${l.lat}/${l.lng}`,target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline",children:"Open in OpenStreetMap"})})]}):d.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 text-gray-600",children:"Detect your location to see it on the map."})]}),d.jsxs("form",{onSubmit:ie,className:"space-y-6 pb-4",children:[d.jsxs(or.div,{variants:K,className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[d.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[d.jsx(yw,{className:"w-5 h-5 mr-2 text-primary-600"}),"Location"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-3 sm:space-y-0",children:[d.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden p-3 border border-gray-200 rounded-lg bg-gray-50",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Detected Location"}),d.jsxs("p",{className:"font-medium text-gray-900 break-words whitespace-normal",children:[l.name||"Not detected",l.accuracy>100&&d.jsx("span",{className:"ml-2 text-xs text-yellow-600",children:"(Low accuracy)"})]})]}),d.jsxs(Vn,{type:"button",onClick:X,disabled:t,className:"whitespace-nowrap flex-shrink-0",variant:"outline",children:[d.jsx(yw,{className:"w-4 h-4 mr-2"}),t?"Detecting...":l.lat?"Update Location":"Detect Location"]})]}),f.location&&d.jsx("div",{className:"p-3 bg-red-50 border-l-4 border-red-500 rounded",children:d.jsxs("div",{className:"flex",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsx(Wx,{className:"h-5 w-5 text-red-500"})}),d.jsxs("div",{className:"ml-3",children:[d.jsx("p",{className:"text-sm text-red-700",children:f.location}),f.location.includes("denied")&&d.jsxs("div",{className:"mt-2 text-sm text-red-600",children:[d.jsx("p",{children:"To enable location access:"}),d.jsxs("ol",{className:"list-decimal list-inside mt-1 space-y-1",children:[d.jsx("li",{children:"Click the lock icon in your browser's address bar"}),d.jsx("li",{children:'Find "Site settings" or "Permissions"'}),d.jsx("li",{children:'Change "Location" to "Allow"'}),d.jsx("li",{children:"Refresh the page and try again"})]})]})]})]})}),d.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[d.jsx("p",{children:"Having trouble with location detection?"}),d.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[d.jsx("li",{children:"Ensure location services are enabled on your device"}),d.jsx("li",{children:"Try moving to an open area with better GPS signal"}),d.jsx("li",{children:"Check your browser's permission settings for this site"}),d.jsx("li",{children:"Try using a different browser if the issue persists"})]})]})]}),f.location&&d.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[d.jsx(Wx,{className:"w-4 h-4 mr-1"}),f.location]})]})]}),d.jsxs(or.div,{variants:K,className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Issue Details"}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Reason for Report ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("div",{className:"md:hidden",children:d.jsx(sV,{value:u.reason,onChange:Q=>h({...u,reason:Q}),placeholder:"Select a reason",className:`${f.reason?"border-red-500":"border-gray-300"}`,name:"reason",options:[{value:"",label:"Select a reason"},{value:"Pothole",label:"Pothole"},{value:"Garbage",label:"Garbage"},{value:"Street Light",label:"Street Light"},{value:"Water Leakage",label:"Water Leakage"},{value:"Road Damage",label:"Road Damage"},{value:"Drainage Issue",label:"Drainage Issue"},{value:"Illegal Dumping",label:"Illegal Dumping"},{value:"Other",label:"Other"}]})}),d.jsxs("div",{className:"relative hidden md:block",children:[d.jsxs("select",{name:"reason",value:u.reason,onChange:Q=>h({...u,reason:Q.target.value}),className:`w-full appearance-none pl-3 pr-10 h-12 text-base border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-300 focus:border-blue-400 transition ${f.reason?"border-red-500":"border-gray-300"}`,children:[d.jsx("option",{value:"",children:"Select a reason"}),d.jsx("option",{value:"Pothole",children:"Pothole"}),d.jsx("option",{value:"Garbage",children:"Garbage"}),d.jsx("option",{value:"Street Light",children:"Street Light"}),d.jsx("option",{value:"Water Leakage",children:"Water Leakage"}),d.jsx("option",{value:"Road Damage",children:"Road Damage"}),d.jsx("option",{value:"Drainage Issue",children:"Drainage Issue"}),d.jsx("option",{value:"Illegal Dumping",children:"Illegal Dumping"}),d.jsx("option",{value:"Other",children:"Other"})]}),d.jsx(MG,{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"})]}),f.reason&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.reason})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Description ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx(yI,{value:u.description,onChange:Q=>h({...u,description:Q.target.value}),placeholder:"Please provide details about the issue...",className:`min-h-[100px] ${f.description?"border-red-500":""}`}),d.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Or record a voice note below"}),f.description&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.description})]}),d.jsx("div",{className:"pt-2",children:d.jsx(Mae,{onRecordingComplete:ue,onClearRecording:re})})]})]}),d.jsxs(or.div,{variants:K,className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Add Photos (Optional)"}),d.jsxs("div",{className:"space-y-4",children:[u.photoPreviews?.length>0&&d.jsx("div",{className:"grid grid-cols-3 gap-2",children:u.photoPreviews.map((Q,ee)=>d.jsxs("div",{className:"relative",children:[d.jsx("img",{src:Q,alt:`Photo ${ee+1}`,className:"w-full h-24 object-cover rounded border"}),d.jsx("button",{type:"button",className:"absolute top-1 right-1 bg-black/60 text-white rounded-full p-1",onClick:()=>{h(de=>{const ye=[...de.photos],pe=[...de.photoPreviews];return ye.splice(ee,1),pe.splice(ee,1),{...de,photos:ye,photoPreviews:pe}})},children:d.jsx(Vc,{className:"w-3 h-3"})})]},ee))}),d.jsx("div",{onClick:()=>y.current?.click(),className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-primary-400 transition-colors",children:d.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[d.jsx("div",{className:"p-3 bg-primary-50 rounded-full",children:d.jsx(RG,{className:"w-6 h-6 text-primary-600"})}),d.jsxs("p",{className:"text-sm text-gray-600",children:[d.jsx("span",{className:"font-medium text-primary-600",children:"Click to upload photos"})," or drag and drop"]}),d.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG up to 10MB each"})]})}),d.jsx("input",{type:"file",ref:y,onChange:Z,accept:"image/*",multiple:!0,className:"hidden"}),d.jsx("input",{type:"file",ref:w,onChange:Z,accept:"image/*",capture:"environment",className:"hidden"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 pt-2",children:[d.jsx(Vn,{type:"button",variant:"outline",onClick:$,children:"Take Photo"}),d.jsx(Vn,{type:"button",variant:"outline",onClick:()=>y.current?.click(),children:"Choose from device"})]}),f.media&&d.jsx("p",{className:"text-sm text-red-600",children:f.media})]})]}),d.jsxs(or.div,{variants:K,className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Add Video (Optional)"}),u.videoPreview?d.jsxs("div",{className:"relative",children:[d.jsx("video",{src:u.videoPreview,controls:!0,className:"w-full rounded border"}),d.jsx("button",{type:"button",className:"absolute top-2 right-2 bg-black/60 text-white rounded-full p-1.5",onClick:()=>h(Q=>({...Q,video:null,videoPreview:""})),children:d.jsx(Vc,{className:"w-4 h-4"})})]}):d.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-primary-400 transition-colors",onClick:()=>v.current?.click(),children:[d.jsxs("p",{className:"text-sm text-gray-600",children:[d.jsx("span",{className:"font-medium text-primary-600",children:"Click to upload video"})," or record"]}),d.jsx("p",{className:"text-xs text-gray-500",children:"MP4/WebM up to 50MB"})]}),d.jsx("input",{type:"file",ref:v,onChange:Y,accept:"video/*",capture:"environment",className:"hidden"}),d.jsx("input",{type:"file",ref:C,onChange:Y,accept:"video/*",className:"hidden"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 pt-2",children:[d.jsx(Vn,{type:"button",variant:"outline",onClick:W,children:"Record Video"}),d.jsx(Vn,{type:"button",variant:"outline",onClick:()=>C.current?.click(),children:"Choose from device"})]})]})]}),d.jsx("div",{className:"mt-6",children:d.jsx(or.div,{variants:K,className:"w-full",children:d.jsx("button",{type:"button",onClick:ie,className:`w-full py-2.5 px-4 text-sm font-semibold rounded-lg text-white shadow-md ${t?"bg-red-500":"bg-blue-500 hover:bg-blue-600"} focus:outline-none focus:ring-2 focus:ring-blue-300 transition-colors`,disabled:t,children:t?"SUBMITTING...":"SUBMIT REPORT"})})})]})]})},sfe=is.icon({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});is.Marker.prototype.options.icon=sfe;const ofe=()=>{const[t,e]=p.useState([]),[n,r]=p.useState(!1),[s,o]=p.useState(null),[i,a]=p.useState(!0),l=p.useRef(null),c=p.useRef(null),u=p.useRef(null),h=p.useRef(!1),f=p.useRef(!1),g=p.useRef(0),y=5,w=()=>{console.group("Leaflet Environment Check"),console.log("Leaflet available:",!!is),is&&(console.log("Leaflet version:",is.version),console.log("L.map available:",typeof is.map=="function"),console.log("L.tileLayer available:",typeof is.tileLayer=="function")),console.groupEnd()};p.useEffect(()=>(h.current=!0,()=>{h.current=!1}),[]),p.useEffect(()=>{if(f.current)return;const M=()=>{if(!h.current||!l.current){console.log("Container not ready, retrying..."),setTimeout(M,100);return}if(f.current=!0,console.log("Initializing map..."),w(),!is){console.error("Leaflet not loaded!"),a(!1);return}S()};M();let k=!1,E=null,b=null,I=null;const P=()=>{try{I&&(I.off(),I.remove())}catch(D){console.error("Error removing map:",D)}finally{I=null,c.current=null}},S=()=>{try{if(g.current>=y){console.error("Max initialization attempts reached, giving up"),a(!1);return}if(g.current++,console.log(`Initialization attempt ${g.current}/${y}`),!l.current){console.error("Map container not found");return}if(c.current){console.log("Map already initialized");return}const D=l.current,T=window.getComputedStyle(D);if(!(D.offsetWidth>0&&D.offsetHeight>0&&T.display!=="none"&&T.visibility!=="hidden")){console.warn("Map container is not visible or has zero dimensions"),setTimeout(S,500);return}if(console.log("Container dimensions:",{width:D.offsetWidth,height:D.offsetHeight,display:T.display,visibility:T.visibility}),D.offsetWidth<=0||D.offsetHeight<=0){console.warn("Container has invalid dimensions, retrying..."),setTimeout(S,300);return}console.log("Creating map instance..."),I=is.map(l.current,{center:[20.5937,78.9629],zoom:5,zoomControl:!0,preferCanvas:!0,renderer:is.canvas(),tap:!1,zoomSnap:.5,zoomDelta:.5,attributionControl:!0}),c.current=I,console.log("Map instance created"),is.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',detectRetina:!0,crossOrigin:!0}).addTo(I),console.log("Tile layer added"),u.current=is.layerGroup().addTo(I),console.log("Markers layer initialized"),b=()=>{I&&(console.log("Handling window resize..."),I.invalidateSize({animate:!1}))};const V=()=>{I&&(console.log("Initializing map view..."),I.invalidateSize({animate:!1}),t.length===0&&I.setView([20.5937,78.9629],5),k=!0,a(!1),console.log("Map initialization complete"))};window.addEventListener("resize",b),E=setTimeout(()=>{try{V()}catch(U){console.error("Error in map view initialization:",U),a(!1)}},500)}catch(D){console.error("Error initializing map:",D),a(!1)}};return E=setTimeout(()=>{k||S()},300),()=>{if(console.log("Cleaning up map..."),E&&(clearTimeout(E),E=null),b&&(window.removeEventListener("resize",b),b=null),u.current)try{u.current.clearLayers(),u.current=null}catch(D){console.error("Error cleaning up markers layer:",D)}P(),k=!1,f.current=!1,g.current=0,console.log("Map cleanup complete")}},[]);const v=async(M,k)=>{try{a(!0);const E=doc(db,"complaints",M);await updateDoc(E,{status:k,updatedAt:new Date().toISOString()}),e(b=>b.map(I=>I.id===M?{...I,status:k,updatedAt:new Date().toISOString()}:I)),toast.success(`Status updated to ${k}`)}catch(E){console.error("Error updating status:",E),toast.error(`Failed to update status: ${E.message}`)}finally{a(!1)}};p.useEffect(()=>{if(!window.L||!c.current||!u.current)return;const M=window.L;try{u.current.clearLayers();const k=M.latLngBounds([]);let E=!1;t.forEach(b=>{const I=b?.location?.lat,P=b?.location?.lng;if(typeof I=="number"&&typeof P=="number"&&!isNaN(I)&&!isNaN(P))try{const S=b.status||"pending",D={pending:"#f59e0b",inProgress:"#3b82f6",solved:"#10b981",rejected:"#ef4444"}[S]||"#9ca3af",T=M.divIcon({className:"custom-marker",html:`
                <div style="
                  width: 24px; 
                  height: 24px; 
                  background: ${D};
                  border: 2px solid white;
                  border-radius: 50%;
                  position: relative;
                  cursor: pointer;
                ">
                  <div style="
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    color: white;
                    font-size: 10px;
                    font-weight: bold;
                    text-align: center;
                    text-shadow: 0 0 2px rgba(0,0,0,0.5);
                  ">
                    ${S.charAt(0).toUpperCase()}
                  </div>
                </div>
              `,iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]}),j=M.marker([I,P],{title:`Complaint #${b.id||"N/A"}`,icon:T}),R=`#${b.id||""} - ${b.reason||"Complaint"}`,V=b?.location?.name||"No address provided",U=S.charAt(0).toUpperCase()+S.slice(1);j.bindPopup(`
              <div style="min-width: 250px">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                  <strong style="font-size: 1.1em;">${R}</strong>
                  <span style="
                    background: ${D}20;
                    color: ${D};
                    padding: 2px 8px;
                    border-radius: 12px;
                    font-size: 0.8em;
                    font-weight: 500;
                    border: 1px solid ${D}40;
                  ">
                    ${U}
                  </span>
                </div>
                <div style="color: #4b5563; margin-bottom: 8px;">
                  <div style="display: flex; align-items: center; margin-bottom: 4px;">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 6px;">
                      <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                      <circle cx="12" cy="10" r="3"></circle>
                    </svg>
                    ${V}
                  </div>
                  <div style="display: flex; align-items: center; font-size: 0.9em; color: #6b7280;">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 6px;">
                      <circle cx="12" cy="12" r="10"></circle>
                      <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    ${new Date(b.timestamp).toLocaleString()}
                  </div>
                </div>
                <div style="margin-top: 12px; display: flex; gap: 8px;">
                  <button 
                    onclick="event.stopPropagation(); window.parent.postMessage({type: 'OPEN_COMPLAINT', id: '${b.id}'}, '*');"
                    style="
                      background: #3b82f6;
                      color: white;
                      border: none;
                      padding: 4px 12px;
                      border-radius: 4px;
                      cursor: pointer;
                      font-size: 0.85em;
                      display: flex;
                      align-items: center;
                      gap: 4px;
                    "
                  >
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px;">
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    View Details
                  </button>
                </div>
              </div>
            `),j.on("click",F=>{const $=t.find(W=>W.location?.lat===F.latlng.lat&&W.location?.lng===F.latlng.lng);$&&(o($),r(!0))}),j.addTo(u.current),k.extend([I,P]),E=!0}catch(S){console.error("Error creating marker:",S)}}),E&&k.isValid()?setTimeout(()=>{c.current&&(t.length>1?c.current.fitBounds(k.pad(.2)):t.length===1&&c.current.setView(k.getCenter(),15),c.current.invalidateSize({animate:!1}))},100):c.current&&c.current.setView([20.5937,78.9629],5)}catch(k){console.error("Error updating markers:",k)}},[t]),p.useEffect(()=>{const M=pI((k=[])=>{try{const E=Array.isArray(k)?k:[];e(E)}catch(E){console.error("Error updating complaints state:",E),e([])}finally{a(!1)}},"citizen");return()=>{typeof M=="function"&&M()}},[]);const C={pending:"bg-yellow-100 text-yellow-800",inProgress:"bg-blue-100 text-blue-800",solved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},x={pending:"Pending",inProgress:"In Progress",solved:"Solved",rejected:"Rejected"},A=[{field:"id",headerName:"ID",width:70},{field:"reason",headerName:"Complaint",width:200},{field:"status",headerName:"Status",width:130,renderCell:M=>d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${C[M.value]||"bg-gray-100 text-gray-800"}`,children:x[M.value]||M.value})},{field:"timestamp",headerName:"Date",width:200,valueFormatter:M=>new Date(M.value).toLocaleString()}],N=M=>{o(M.row),r(!0)};return i?d.jsx(qp,{visible:!0}):d.jsxs("div",{className:"p-4",children:[d.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Track Complaints"}),d.jsx("div",{className:"relative w-full h-[600px] mb-6 rounded-lg overflow-hidden shadow-lg",children:d.jsx("div",{id:"map-container",ref:l,className:"absolute inset-0 w-full h-full",style:{minHeight:"400px",zIndex:1,backgroundColor:"#f0f0f0"},children:i&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-80 z-10",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-500 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-700 font-medium",children:"Loading map..."})]})})})}),d.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:d.jsx(Qj,{rows:t,columns:A,pageSize:10,onRowClick:N,className:"border-0",disableSelectionOnClick:!0,autoHeight:!0})}),s&&d.jsx(Wb,{open:n,onClose:()=>{r(!1),o(null)},complaint:s,onStatusUpdate:v})]})};async function ife({hostUid:t,title:e="Live"}){const n=`${t}_${Date.now()}`,r=tt(Oe,"liveSessions",n);return await Xn(r,{hostUid:t,title:e,status:"live",startedAt:qs(),endedAt:null,viewerCount:0}),{sessionId:n,sessionRef:r}}async function afe(t){const e=tt(Oe,"liveSessions",t);await Ii(e,{status:"ended",endedAt:qs()})}async function lfe({sessionId:t,hostUid:e,title:n,hostName:r}){const s=tt(Oe,"liveFeed",t);await Xn(s,{sessionId:t,hostUid:e,title:n||"Live",hostName:r,status:"live",startedAt:qs(),endedAt:null},{merge:!0})}async function cfe(t,e){const n=tt(Oe,"liveFeed",t);await Xn(n,{status:e,endedAt:qs()},{merge:!0})}function ufe(t){const e=wn(Oe,"liveFeed"),n=Ha(e,Oa("status","==","live"));return Ir(n,r=>{const s=[];r.forEach(o=>s.push({id:o.id,...o.data()})),s.sort((o,i)=>{const a=o?.startedAt?.toMillis?o.startedAt.toMillis():o.startedAt||0;return(i?.startedAt?.toMillis?i.startedAt.toMillis():i.startedAt||0)-a}),t(s)})}function dfe(t,e){const n=wn(Oe,"liveSessions",t,"viewers");return Ir(n,r=>e(r.size))}async function hfe(t,e){const n=tt(Oe,"liveSessions",t,"viewers",e.uid);return await Xn(n,{uid:e.uid,displayName:e.displayName||"Viewer",joinedAt:qs(),lastSeenAt:qs()},{merge:!0}),n}async function ffe(t,e){const n=tt(Oe,"liveSessions",t,"viewers",e);await gE(n).catch(()=>{})}function mB(t,e){const n=wn(Oe,"liveSessions",t,"comments"),r=Ha(n,EM("createdAt","asc"));return Ir(r,s=>{const o=[];s.forEach(i=>o.push({id:i.id,...i.data()})),e(o)})}async function pB(t,{uid:e,displayName:n,text:r}){const s=wn(Oe,"liveSessions",t,"comments");await Lb(s,{uid:e,displayName:n||"User",text:String(r||"").slice(0,500),createdAt:qs()})}function ig(t,e){return tt(Oe,"liveSessions",t,"peers",e)}async function mfe({sessionId:t,peerId:e,candidate:n}){const r=ig(t,e),s=await Nn(r),o=s.exists()?s.data().candidatesHost||[]:[];await Xn(r,{candidatesHost:[...o,n]},{merge:!0})}async function pfe({sessionId:t,peerId:e,answer:n}){const r=ig(t,e);await Xn(r,{answer:n},{merge:!0})}function gfe({sessionId:t,peerId:e,onOffer:n}){const r=ig(t,e);return Ir(r,s=>{const o=s.data();o?.offer&&n(o.offer)})}async function yfe({sessionId:t,peerId:e,candidate:n}){const r=ig(t,e),s=await Nn(r),o=s.exists()?s.data().candidatesViewer||[]:[];await Xn(r,{candidatesViewer:[...o,n]},{merge:!0})}function wfe({sessionId:t,peerId:e,onCandidate:n}){const r=ig(t,e);return Ir(r,s=>{(s.data()?.candidatesHost||[]).forEach(i=>n(i))})}const d2=t=>{if(!t)return"";const e=typeof t=="string"?new Date(t).getTime():t;if(!e)return"";const n=Date.now()-e,r=Math.floor(n/1e3);if(r<60)return`${r}s ago`;const s=Math.floor(r/60);if(s<60)return`${s}m ago`;const o=Math.floor(s/60);return o<24?`${o}h ago`:`${Math.floor(o/24)}d ago`},bfe=({status:t})=>{const e={pending:"Pending",inProgress:"In Progress",solved:"Solved",rejected:"Rejected"}[t]||t,n=Object.keys(Es).find(r=>Es[r]===t);return d.jsx("span",{className:`px-2.5 py-1 text-xs font-medium rounded-full ${pr[n]||"bg-gray-100 text-gray-800"}`,children:e})},vfe=t=>{switch(Number(t)){case 1:return"etherscan.io";case 5:return"goerli.etherscan.io";case 11155111:return"sepolia.etherscan.io";case 10:return"optimistic.etherscan.io";case 11155420:return"sepolia-optimism.etherscan.io";default:return"etherscan.io"}},xfe=({item:t,currentUid:e,following:n,onFollow:r,onUnfollow:s,onLocalLikeChange:o})=>{const[i,a]=p.useState(!1),[l,c]=p.useState([]),[u,h]=p.useState(""),[f,g]=p.useState({}),[y,w]=p.useState(!1),[v,C]=p.useState(!1),[x,A]=p.useState(t.reportCount||0),[N,M]=p.useState(t.likesCount||0),[k,E]=p.useState(!1);p.useEffect(()=>{if(!i||!t.id)return;const R=wn(Oe,"complaints",t.id,"comments"),V=Ir(R,async U=>{try{console.log("Comments snapshot received, docs count:",U.docs.length);const F=[];for(const $ of U.docs){const W=$.data();if(console.log("Raw comment data:",W),!!W)try{const Z={id:$.id,text:W.text||W.comment||"",timestamp:W.timestamp?.toDate?.()?.getTime()||W.timestamp||Date.now(),userId:W.userId||W.author||"",userName:W.userName||""};if(console.log("Processed comment:",Z),!Z.userName&&Z.userId)try{const Y=await Ew(Z.userId);Z.userName=Y?.name||"Anonymous",console.log("Fetched user data for comment:",Z.userId,Y)}catch(Y){console.error("Error fetching user data:",Y),Z.userName="Anonymous"}else Z.userName||(Z.userName="Anonymous");Z.text&&Z.timestamp?F.push(Z):console.warn("Skipping invalid comment:",Z)}catch(Z){console.error("Error processing comment:",Z,W);continue}}F.sort(($,W)=>($.timestamp||0)-(W.timestamp||0)),console.log("Final comments array:",F),c(F)}catch(F){console.error("Error in comments listener:",F)}});return()=>V()},[i,t.id]),p.useEffect(()=>{let R=!0;return(async()=>{if(e)try{const V=await uY(t.id,e);R&&w(V)}catch{}})(),()=>{R=!1}},[e,t.id]);const b=n.has(t.authorId),I=e&&t.authorId&&e!==t.authorId;p.useEffect(()=>{let R=!0;return(async()=>{if(e)try{const V=await fY(t.id,e);R&&C(V)}catch{}})(),()=>{R=!1}},[e,t.id]),p.useEffect(()=>{A(t.reportCount||0)},[t.reportCount]);const P=async()=>{if(!e||k)return;E(!0);const R=v,V=x;try{R?(C(!1),A(Math.max(0,V-1)),await hY(t.id,e)):(C(!0),A(V+1),await dY(t.id,e))}catch(U){console.error("Error toggling report:",U),C(R),A(V)}finally{E(!1)}},S=async R=>{R.preventDefault();const V=u.trim();if(!(!V||!e))try{const U=await Ew(e),F={text:V,timestamp:Date.now(),userId:e,userName:U?.name||"Anonymous",comment:V,author:e};console.log("Submitting comment:",F),await iY(t.id,F),h("")}catch(U){console.error("Error adding comment:",U)}},[D,T]=p.useState(!1),j=async()=>{if(!e||D)return;T(!0);const R=y,V=N;try{w(!R);const U=R?Math.max(0,N-1):N+1;M(U),o?.(t.id,R?-1:1),R?await cY(t.id):await lY(t.id)}catch(U){console.error("Error toggling like:",U),w(R),M(V),o?.(t.id,0)}finally{T(!1)}};return d.jsxs("article",{className:"bg-white/90 ring-1 ring-gray-200 rounded-xl shadow-sm overflow-hidden",children:[d.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[d.jsxs("div",{className:"min-w-0",children:[d.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate cursor-pointer",onClick:()=>window.location.assign(`/profile?uid=${t.authorId}`),children:t.authorName}),d.jsxs("p",{className:"text-xs text-gray-500",children:[d2(t.timestamp),"  ",t.location?.name||"Unknown"]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(bfe,{status:t.status}),t.onChain?.enabled&&d.jsxs("a",{href:`https://${vfe(t.onChain.chainId)}/tx/${t.onChain.txHash}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800 border border-emerald-200 hover:bg-emerald-200 transition-colors",onClick:R=>R.stopPropagation(),children:[d.jsx(ME,{className:"w-3 h-3 mr-1"}),d.jsx("span",{className:"hidden sm:inline",children:"Certified"}),d.jsx(gw,{className:"w-2.5 h-2.5 ml-1 opacity-70"})]}),x>=15&&d.jsx("span",{className:"text-xs text-yellow-600 bg-yellow-100 px-2 py-0.5 rounded-full",children:"Multiple reports - content may be inaccurate"}),d.jsxs("div",{className:"flex items-center space-x-2 ml-auto",children:[e&&e!==t.authorId&&d.jsx("button",{onClick:P,disabled:k,className:`text-xs px-2 py-0.5 rounded-full transition-colors ${v?"bg-red-200 text-red-700 hover:bg-red-300":"bg-red-100 text-red-600 hover:bg-red-200"}`,children:v?"Unreport":"Report"}),I&&d.jsx("button",{onClick:()=>b?s(t.authorId):r(t.authorId),className:"text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200",children:b?"Following":"Follow"})]})]})]}),d.jsxs("div",{className:"px-4 pb-3",children:[d.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:t.reason}),t.audioUrl&&d.jsxs("div",{className:"mt-3",children:[d.jsx("div",{className:"flex items-center space-x-3 bg-gray-50 p-3 rounded-lg",children:d.jsx("audio",{src:t.audioUrl,controls:!0,className:"h-8 w-full",controlsList:"nodownload"})}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Voice note"})]}),t.mediaPath&&d.jsx("div",{className:"bg-gray-50",children:d.jsx("img",{src:t.mediaPath,alt:"attachment",className:"w-full max-h-[28rem] object-cover"})})]}),d.jsxs("div",{className:"px-4 py-2 flex items-center gap-4 text-sm text-gray-600",children:[d.jsxs("button",{className:`flex items-center gap-1 ${y?"text-emerald-700":"hover:text-emerald-700"}`,onClick:j,children:[d.jsx("span",{children:y?"":""}),d.jsx("span",{children:N})]}),d.jsxs("button",{className:"hover:text-emerald-700",onClick:()=>a(R=>!R),children:[i?"Hide":"View"," comments"]})]}),i&&d.jsxs("div",{className:"px-4 pb-4",children:[d.jsxs("ul",{className:"space-y-2",children:[Array.isArray(l)&&l.map(R=>{try{if(!R||typeof R!="object")return console.warn("Invalid comment format:",R),null;const V=R.id||`comment-${Math.random().toString(36).substr(2,9)}`,U=typeof R.userName=="string"?R.userName:"Anonymous",F=typeof R.timestamp=="number"?R.timestamp:0;let $="";try{let W=R.text||R.comment;if(typeof W=="string")try{W=W.trim().startsWith("{")?JSON.parse(W):W}catch{$=W}typeof W=="object"&&W!==null?$=W.text||W.comment||"":typeof W=="string"&&($=W),$=$.trim()}catch(W){console.error("Error processing comment text:",W,R),$=""}return $?d.jsxs("li",{className:"text-sm",children:[d.jsx("span",{className:"font-medium text-gray-900",children:U}),d.jsxs("span",{className:"text-gray-500",children:["  ",d2(F)]}),d.jsx("div",{className:"text-gray-800 whitespace-pre-wrap",children:$})]},V):(console.warn("Comment has no text:",R),null)}catch(V){return console.error("Error rendering comment:",V,R),null}}),(!Array.isArray(l)||l.length===0)&&d.jsx("li",{className:"text-sm text-gray-500 italic",children:"No comments yet"})]}),d.jsxs("form",{onSubmit:S,className:"mt-3 flex items-center gap-2",children:[d.jsx("input",{className:"flex-1 rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500",placeholder:"Add a comment...",value:u,onChange:R=>h(R.target.value)}),d.jsx("button",{type:"submit",className:"rounded-md bg-emerald-600 px-3 py-2 text-xs font-semibold text-white hover:bg-emerald-700",children:"Post"})]})]})]})},Cfe=()=>{const[t,e]=p.useState(null),[n,r]=p.useState([]),[s,o]=p.useState([]),[i,a]=p.useState(new Set),[l,c]=p.useState(!1),[u,h]=p.useState(""),[f,g]=p.useState("trending"),y=ts();p.useEffect(()=>{const x=it.onAuthStateChanged(async A=>{if(!A){y("/citizen-login");return}e(A);const N=await fm(A.uid);a(new Set(N));const M=aY(A.uid,r);return()=>M()});return()=>x&&x()},[]),p.useEffect(()=>{const x=ufe(A=>{o(Array.isArray(A)?A:[])});return()=>{try{x&&x()}catch{}}},[]);const w=p.useMemo(()=>{let x=n;if(l&&(x=x.filter(A=>i.has(A.authorId))),u.trim()){const A=u.trim().toLowerCase();x=x.filter(N=>(N.location?.name||"").toLowerCase().includes(A))}return x=x.filter(A=>(A.reportCount||0)<30||A.authorId===t?.uid),f==="old"?x=[...x].sort((A,N)=>(A.timestamp||0)-(N.timestamp||0)):f==="trending"?x=[...x].sort((A,N)=>{const M=typeof A.timestamp=="string"?new Date(A.timestamp).getTime():A.timestamp||0,k=typeof N.timestamp=="string"?new Date(N.timestamp).getTime():N.timestamp||0,E=Math.max(1/60,(Date.now()-M)/36e5),b=Math.max(1/60,(Date.now()-k)/36e5),I=(A.likesCount||0)/E;return(N.likesCount||0)/b-I}):x=[...x].sort((A,N)=>(N.timestamp||0)-(A.timestamp||0)),x},[n,l,u,f,i]),v=async x=>{if(!t)return;await bF(t.uid,x);const A=await fm(t.uid);a(new Set(A))},C=async x=>{if(!t)return;await vF(t.uid,x);const A=await fm(t.uid);a(new Set(A))};return d.jsx("div",{className:"min-h-screen bg-[radial-gradient(ellipse_at_top_left,_var(--tw-gradient-stops))] from-emerald-50 via-white to-slate-50",children:d.jsxs("main",{className:"mx-auto max-w-2xl px-4 pt-4 pb-24 sm:px-6 lg:px-8",children:[s.length>0&&d.jsxs("section",{className:"mb-4",children:[d.jsx("h2",{className:"text-sm font-semibold text-emerald-700 mb-2",children:"Live now"}),d.jsx("div",{className:"space-y-2",children:s.map(x=>d.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2",children:[d.jsxs("div",{className:"min-w-0",children:[d.jsxs("div",{className:"text-sm font-medium text-emerald-900 truncate",children:[x.title||"Live","  ",x.hostName||"Host"]}),d.jsx("div",{className:"text-xs text-emerald-700 truncate",children:"Tap to watch"})]}),d.jsx("button",{onClick:()=>y(`/live/${x.sessionId}`),className:"text-xs px-3 py-1 rounded-full bg-emerald-600 text-white hover:bg-emerald-700",children:"Join Live"})]},x.sessionId))})]}),d.jsxs("section",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{className:"rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500",placeholder:"Filter by area or locality",value:u,onChange:x=>h(x.target.value)}),d.jsxs("select",{className:"rounded-md border border-gray-300 bg-white px-2 py-2 text-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500",value:f,onChange:x=>g(x.target.value),children:[d.jsx("option",{value:"new",children:"Newest"}),d.jsx("option",{value:"old",children:"Oldest"}),d.jsx("option",{value:"trending",children:"Trending"})]})]}),d.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-gray-700 select-none",children:[d.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:l,onChange:x=>c(x.target.checked)}),"Following only"]})]}),d.jsxs("section",{className:"space-y-4",children:[w.map(x=>d.jsx(xfe,{item:x,currentUid:t?.uid,following:i,onFollow:v,onUnfollow:C,onLocalLikeChange:(A,N)=>{r(M=>M.map(k=>k.id===A?{...k,likesCount:Math.max(0,(k.likesCount||0)+N)}:k))}},x.id)),w.length===0&&d.jsx("div",{className:"text-center text-sm text-gray-600 py-10",children:"No posts yet matching your filters."})]})]})})};async function Efe(t){try{const{uploadToCloudinary:e}=await Kb(async()=>{const{uploadToCloudinary:r}=await Promise.resolve().then(()=>xG);return{uploadToCloudinary:r}},void 0);return await e(t,"avatars","image")}catch(e){throw console.error("Error uploading avatar:",e),new Error("Failed to upload image. Please try again.")}}const ox=({label:t,value:e})=>d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-base font-semibold text-gray-900",children:e}),d.jsx("div",{className:"text-xs text-gray-500",children:t})]}),Ife=({url:t,name:e})=>{const n=p.useMemo(()=>(e||"?").trim().split(/\s+/).slice(0,2).map(s=>s[0]?.toUpperCase()||"").join("")||"?",[e]);return t?d.jsx("img",{src:t,alt:e||"avatar",className:"h-24 w-24 rounded-full object-cover ring-2 ring-white shadow"}):d.jsx("div",{className:"h-24 w-24 rounded-full bg-gradient-to-br from-emerald-500 to-lime-400 grid place-items-center text-white font-bold text-xl ring-2 ring-white shadow",children:n})},_fe=({percent:t=0,size:e=88,stroke:n=8,color:r="#059669"})=>{const s=(e-n)/2,o=2*Math.PI*s,i=Math.min(100,Math.max(0,t)),a=o-i/100*o;return d.jsxs("svg",{width:e,height:e,className:"block",children:[d.jsx("circle",{cx:e/2,cy:e/2,r:s,stroke:"#e5e7eb",strokeWidth:n,fill:"none"}),d.jsx("circle",{cx:e/2,cy:e/2,r:s,stroke:r,strokeWidth:n,fill:"none",strokeDasharray:o,strokeDashoffset:a,strokeLinecap:"round",transform:`rotate(-90 ${e/2} ${e/2})`}),d.jsxs("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-emerald-700 font-bold",style:{fontSize:14},children:[i,"%"]})]})},Afe=()=>{const t=ts(),[e]=v2(),[n,r]=p.useState(null),[s,o]=p.useState(null),[i,a]=p.useState(null),[l,c]=p.useState([]),[u,h]=p.useState("all"),[f,g]=p.useState("newest"),[y,w]=p.useState(new Set),[v,C]=p.useState(!0),[x,A]=p.useState(!1),[N,M]=p.useState({name:"",bio:"",avatarUrl:""}),k=p.useRef(null),E=K=>{const me=K.issueType||K.category||K.type;if(me&&String(me).trim())return String(me).trim();const Q=`${K.reason||""} ${K.description||""}`.toLowerCase(),ee=[{name:"Garbage",kws:["garbage","trash","waste","dump","litter"]},{name:"Roads & Potholes",kws:["pothole","road","street","asphalt"]},{name:"Water Supply",kws:["water leak","water supply","pipe","pipeline","tap"]},{name:"Sewage/Drainage",kws:["sewage","drain","overflow","manhole"]},{name:"Street Lights",kws:["streetlight","street light","lamp","light not working"]},{name:"Electricity",kws:["electric","power","transformer","wire","shock"]},{name:"Traffic/Signals",kws:["traffic","signal","jam","congestion"]},{name:"Public Safety",kws:["accident","crime","safety","harassment","fire","flood"]},{name:"Health & Sanitation",kws:["sanitation","cleanliness","mosquito","dengue"]}];for(const de of ee)if(de.kws.some(ye=>Q.includes(ye)))return de.name;return"Other"},b=K=>{const me=String(K.priority||"").toLowerCase(),Q=E(K);return/water/i.test(Q)?1:/sewage|drain/i.test(Q)||/garbage/i.test(Q)?2:/roads|pothole/i.test(Q)?7:/street/i.test(Q)?5:me.includes("high")?2:me.includes("medium")?5:me.includes("low")?10:5},I=K=>{const me=X(K.timestamp),Q=b(K);if(isNaN(me))return null;const ee=new Date(me);return ee.setDate(ee.getDate()+Q),ee},P=K=>{if((K.status||"").toLowerCase()==="solved")return!1;const me=I(K);return me?new Date>me:!1},S=K=>{try{return K?.toLocaleDateString?.(void 0,{month:"short",day:"numeric"})||""}catch{return""}},D=K=>{const me=E(K),Q=encodeURIComponent(`[Escalation] ${me} - ${K.reason||"Complaint"} (#${K.id})`),ee=encodeURIComponent(`Hello Team,

This complaint appears overdue based on SLA.

Details:
- ID: ${K.id}
- Issue: ${me}
- Priority: ${K.priority||"N/A"}
- Status: ${K.status||"N/A"}
- Reported: ${X(K.timestamp)?.toLocaleString?.()||"N/A"}
- Due By: ${S(I(K))}
- Location: ${K.location?.name||K.location?.address||"N/A"}

Please review and escalate as needed.

Thanks.`),de=`mailto:?subject=${Q}&body=${ee}`;try{window.open(de,"_blank")}catch{}};p.useEffect(()=>{const K=it.onAuthStateChanged(async me=>{if(!me)return t("/citizen-login");r(me);const Q=e.get("uid")||me.uid;o(Q);const ee=await fm(me.uid);w(new Set(ee))});return()=>K&&K()},[]),p.useEffect(()=>{if(!s)return;let K=()=>{};return(async()=>{C(!0);try{const Q=await Ew(s)||{name:"Unknown user",bio:"",following:[],followers:[],avatarUrl:""};a({uid:s,...Q}),M({name:Q.name||"",bio:Q.bio||"",avatarUrl:Q.avatarUrl||""})}finally{C(!1)}})(),K=wF(s,me=>c(me||[])),()=>K&&K()},[s]);const T=n&&s&&n.uid===s,j=p.useMemo(()=>!T&&s?y.has(s):!1,[y,T,s]),R=async()=>{if(!n||!s||T)return;j?await vF(n.uid,s):await bF(n.uid,s);const K=await fm(n.uid);w(new Set(K));const me=await Ew(s);a(Q=>({...Q,...me}))},V=async()=>{if(!n||!T)return;const K={name:N.name||"",bio:N.bio||"",avatarUrl:N.avatarUrl||""},me=tt(Oe,"users",n.uid);await Xn(me,K,{merge:!0});const Q=await Nn(me);a({uid:n.uid,...Q.exists()?Q.data():K}),A(!1)},U=async()=>{try{await it.signOut(),t("/")}catch(K){console.error("Error signing out:",K)}},F=()=>k.current?.click(),$=async K=>{const me=K.target.files?.[0];if(!(!me||!n?.uid)){C(!0);try{const Q=await Efe(me);M(de=>({...de,avatarUrl:Q}));const ee=tt(Oe,"users",n.uid);await Ii(ee,{avatarUrl:Q}),a(de=>({...de,avatarUrl:Q})),ge.success("Profile picture updated successfully")}catch(Q){console.error("Error updating avatar:",Q),ge.error("Failed to update profile picture. Please try again.")}finally{C(!1)}}},[W,Z]=p.useState(0),Y=l?.length||0,le=p.useMemo(()=>(l||[]).filter(K=>(K.status||"").toLowerCase()==="solved").length,[l]),fe=p.useMemo(()=>Y?Math.min(100,Math.max(0,Math.round(le/Y*100))):0,[Y,le]),we=p.useMemo(()=>{const K=fe;return K>=90?{name:"Platinum",color:"bg-indigo-600",text:"text-indigo-50"}:K>=70?{name:"Gold",color:"bg-yellow-500",text:"text-yellow-50"}:K>=40?{name:"Silver",color:"bg-gray-400",text:"text-white"}:{name:"Bronze",color:"bg-amber-700",text:"text-amber-50"}},[fe]);p.useEffect(()=>{Z(Y)},[Y]);const Me=i?.followers?.length||0,Ee=i?.following?.length||0;p.useEffect(()=>{(async()=>{if(i?.uid){const me=await mY(i.uid);Z(me)}})()},[i?.uid]);const X=K=>{try{return K?.toDate?K.toDate():new Date(K)}catch{return new Date(NaN)}},ue=p.useMemo(()=>{let K=[...l||[]];return u!=="all"&&(K=K.filter(me=>(me.status||"").toLowerCase()===u.toLowerCase())),K.sort((me,Q)=>f==="newest"?X(Q.timestamp)-X(me.timestamp):f==="oldest"?X(me.timestamp)-X(Q.timestamp):f==="status"?(me.status||"").localeCompare(Q.status||""):f==="media"?(Q.mediaPath?1:0)-(me.mediaPath?1:0):0),K},[l,u,f]),{weeklyCount:re,currentStreakDays:ie,xpPoints:Ce}=p.useMemo(()=>{const K=new Date,me=new Date(K);me.setDate(K.getDate()-6);const Q=new Set;let ee=0;(l||[]).forEach(pe=>{const _e=X(pe.timestamp);if(!isNaN(_e)){const qe=_e.toISOString().slice(0,10);Q.add(qe),_e>=me&&_e<=K&&(ee+=1)}});let de=0;for(let pe=0;pe<30;pe++){const _e=new Date(K);_e.setDate(K.getDate()-pe);const qe=_e.toISOString().slice(0,10);if(Q.has(qe))de+=1;else break}const ye=le*10+Y*2;return{weeklyCount:ee,currentStreakDays:de,xpPoints:ye}},[l,le,Y]);return d.jsxs("div",{className:"min-h-screen bg-white",children:[d.jsx(qp,{visible:v,label:"Loading profile..."}),d.jsxs("main",{className:"mx-auto max-w-3xl px-4 pt-6 pb-24",children:[d.jsxs("section",{className:"flex items-start gap-6",children:[d.jsx(Ife,{url:N.avatarUrl||i?.avatarUrl,name:i?.name}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d.jsx("h1",{className:"text-xl font-semibold text-gray-900 truncate",children:i?.name||"User"}),T?d.jsx(d.Fragment,{children:d.jsx("button",{onClick:()=>A(K=>!K),className:"rounded-md border border-gray-300 px-3 py-1.5 text-sm font-medium text-gray-700 hover:border-emerald-600 hover:text-emerald-700",children:x?"Cancel":"Edit Profile"})}):d.jsx("button",{onClick:R,className:`rounded-md px-3 py-1.5 text-sm font-medium border ${j?"border-gray-300 text-gray-700":"border-emerald-600 text-emerald-700 hover:bg-emerald-50"}`,children:j?"Following":"Follow"}),T&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:F,className:"rounded-md border border-gray-300 px-3 py-1.5 text-sm font-medium text-gray-700 hover:border-emerald-600 hover:text-emerald-700",children:"Change Avatar"}),d.jsx("button",{onClick:U,className:"rounded-md border border-red-300 text-red-600 px-3 py-1.5 text-sm font-medium hover:border-red-500 hover:text-red-700",children:"Sign Out"})]}),d.jsx("input",{ref:k,type:"file",accept:"image/*",className:"hidden",onChange:$})]}),d.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-4 max-w-md",children:[d.jsx(ox,{label:"Posts",value:Y}),d.jsx(ox,{label:"Followers",value:Me}),d.jsx(ox,{label:"Following",value:Ee})]}),d.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-br from-emerald-50 to-white rounded-xl border border-emerald-100 shadow-sm",children:[d.jsx("div",{className:"flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx("h3",{className:"text-sm font-medium text-emerald-800",children:"Your Activity"}),d.jsx("p",{className:"text-xs text-emerald-600 mt-0.5",children:"Your posts and contributions"})]})}),d.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-3",children:[d.jsxs("div",{className:"p-3 bg-white rounded-lg border border-emerald-100 text-center",children:[d.jsx("div",{className:"text-xs text-gray-600",children:"Total Posts"}),d.jsx("div",{className:"text-2xl font-bold text-emerald-700",children:Y})]}),d.jsxs("div",{className:"p-3 bg-white rounded-lg border border-emerald-100 text-center",children:[d.jsx("div",{className:"text-xs text-gray-600",children:"Posts Solved"}),d.jsx("div",{className:`text-2xl font-bold ${le>0?"text-emerald-700":"text-gray-700"}`,children:le})]}),d.jsxs("div",{className:"p-3 bg-white rounded-lg border border-emerald-100 text-center",children:[d.jsx("div",{className:"text-xs text-gray-600",children:"Resolution Rate"}),d.jsxs("div",{className:"text-2xl font-bold text-emerald-700",children:[fe,"%"]})]})]}),d.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-3",children:[d.jsxs("div",{className:"p-3 bg-white rounded-lg border border-emerald-100 text-center",children:[d.jsx("div",{className:"text-xs text-gray-600",children:"Weekly Posts"}),d.jsx("div",{className:"text-xl font-bold text-emerald-700",children:re})]}),d.jsxs("div",{className:"p-3 bg-white rounded-lg border border-emerald-100 text-center",children:[d.jsx("div",{className:"text-xs text-gray-600",children:"Current Streak"}),d.jsxs("div",{className:"text-xl font-bold text-emerald-700",children:[ie,"d"]})]}),d.jsxs("div",{className:"p-3 bg-white rounded-lg border border-emerald-100 text-center",children:[d.jsx("div",{className:"text-xs text-gray-600",children:"XP"}),d.jsx("div",{className:"text-xl font-bold text-emerald-700",children:Ce})]})]}),d.jsxs("div",{className:"mt-4 flex items-center justify-center gap-4",children:[d.jsx("div",{className:"shrink-0",children:d.jsx(_fe,{percent:fe})}),d.jsxs("div",{children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Performance Tier"}),d.jsx("div",{className:`inline-flex items-center gap-2 px-2.5 py-1 mt-1 rounded-full text-xs font-semibold ${we.color} ${we.text}`,children:we.name}),d.jsxs("div",{className:"mt-3 w-56 max-w-full",children:[d.jsx("div",{className:"h-2 w-full rounded-full bg-gray-200 overflow-hidden",children:d.jsx("div",{className:"h-full bg-emerald-600 transition-all duration-500",style:{width:`${fe}%`},"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":fe})}),d.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Resolution progress"})]})]})]}),d.jsxs("div",{className:"mt-4 text-center",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900 mb-2",children:"Achievements"}),d.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[d.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-semibold border ${le>=1?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-gray-50 text-gray-500 border-gray-200"}`,children:"Bronze Solver  1+"}),d.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-semibold border ${le>=5?"bg-sky-50 text-sky-700 border-sky-200":"bg-gray-50 text-gray-500 border-gray-200"}`,children:"Active Solver  5+"}),d.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-semibold border ${le>=10?"bg-yellow-50 text-yellow-700 border-yellow-200":"bg-gray-50 text-gray-500 border-gray-200"}`,children:"Impact Solver  10+"}),d.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-semibold border ${le>=25?"bg-purple-50 text-purple-700 border-purple-200":"bg-gray-50 text-gray-500 border-gray-200"}`,children:"Community Hero  25+"})]})]}),d.jsx("p",{className:"mt-3 text-xs text-emerald-700 text-center",children:Y>0?`Great work! ${le} of your ${Y} posts are marked as solved.`:"Start by making your first post!"})]}),d.jsx("div",{className:"mt-3 text-sm text-gray-800 whitespace-pre-wrap",children:x?d.jsx("textarea",{className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500",rows:3,value:N.bio,onChange:K=>M(me=>({...me,bio:K.target.value})),placeholder:"Write a short bio"}):i?.bio||""}),x&&d.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[d.jsx("input",{className:"rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500",value:N.name,onChange:K=>M(me=>({...me,name:K.target.value})),placeholder:"Display name"}),d.jsx("button",{onClick:V,className:"rounded-md bg-emerald-600 px-3 py-2 text-sm font-semibold text-white hover:bg-emerald-700",children:"Save"})]})]})]}),d.jsxs("section",{className:"mt-8",children:[d.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[d.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[d.jsx("span",{className:"text-gray-600",children:"Filter:"}),["all","solved","inProgress","pending","rejected"].map(K=>d.jsx("button",{onClick:()=>h(K),className:`px-2.5 py-1 rounded-full border text-xs ${u===K?"bg-emerald-600 text-white border-emerald-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:K==="all"?"All":K},K))]}),d.jsxs("div",{className:"flex items-center gap-1 text-sm ml-auto",children:[d.jsx("span",{className:"text-gray-600",children:"Sort:"}),[{k:"newest",label:"Newest"},{k:"oldest",label:"Oldest"},{k:"status",label:"Status"},{k:"media",label:"Has Media"}].map(K=>d.jsx("button",{onClick:()=>g(K.k),className:`px-2.5 py-1 rounded-full border text-xs ${f===K.k?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:K.label},K.k))]})]}),d.jsx("div",{className:"grid grid-cols-3 gap-1 sm:gap-2",children:ue.map(K=>(K.mediaType||"").startsWith("video")?d.jsx("div",{className:"relative aspect-square bg-gray-100",children:d.jsx("video",{src:K.mediaPath,className:"absolute inset-0 h-full w-full object-cover",muted:!0,playsInline:!0})},K.id):d.jsxs("div",{className:"relative aspect-square bg-gray-100",children:[K.mediaPath?d.jsx("img",{src:K.mediaPath,alt:"post",className:"absolute inset-0 h-full w-full object-cover"}):d.jsx("div",{className:"absolute inset-0 grid place-items-center text-xs text-gray-500 p-2 text-center",children:K.reason||"Complaint"}),K.status&&d.jsx("div",{className:"absolute top-1 left-1 text-[10px] px-1.5 py-0.5 rounded-full bg-white/80 border border-gray-200",children:K.status}),(K.status||"").toLowerCase()!=="solved"&&d.jsxs("div",{className:"absolute bottom-1 left-1 right-1 flex items-center justify-between gap-2",children:[d.jsxs("div",{className:`text-[10px] px-1.5 py-0.5 rounded-full border ${P(K)?"bg-red-50 text-red-700 border-red-200":"bg-amber-50 text-amber-700 border-amber-200"}`,children:["Due: ",S(I(K))]}),d.jsx("button",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-white/80 border border-gray-200 hover:bg-gray-50",onClick:()=>D(K),children:"Escalate"})]})]},K.id))}),l.length===0&&d.jsx("div",{className:"py-16 text-center text-sm text-gray-600",children:"No posts yet."})]})]})]})};function h2(){const t=ts(),e=gp(),{currentUser:n,isOfficial:r}=$p();p.useEffect(()=>{console.log("[Unauthorized] Render",{currentUser:!!n,isOfficial:r,from:e.state?.from})},[n,r,e.state]);const s=()=>{t(-1)},o=()=>{t(r?"/official-dashboard":"/feed")};return d.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center px-4",children:d.jsx("div",{className:"max-w-md w-full space-y-8 text-center",children:d.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md",children:[d.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100",children:d.jsx("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),d.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Access Denied"}),d.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"You don't have permission to access this page."}),d.jsxs("div",{className:"mt-6 flex flex-col space-y-3",children:[d.jsx("button",{onClick:s,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:"Go back to previous page"}),d.jsxs("button",{onClick:o,className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:["Go to ",r?"Official":"Citizen"," Dashboard"]})]})]})})})}const Sfe=()=>{const[t,e]=p.useState([]),[n,r]=p.useState(!0),[s,o]=p.useState(null),[i,a]=p.useState(!1),[l,c]=p.useState({open:!1,message:"",severity:"success"}),[u,h]=p.useState(!1),[f,g]=p.useState(!1),{currentUser:y}=$p(),w=ts();p.useEffect(()=>{(async()=>{try{const E=wn(Oe,"complaints"),b=Ha(E,Oa("reportCount",">",0),EM("reportCount","desc")),I=await Mp(b),P=[],S=[],D=[],T=[];I.forEach(U=>{const F=U.data();if(T.push({id:U.id,...F}),F.reportedBy&&(Array.isArray(F.reportedBy)?F.reportedBy:[F.reportedBy]).forEach(W=>{W&&!S.includes(W)&&S.push(W)}),F.reportedBy){if(typeof F.reportedBy=="string")D.includes(F.reportedBy)||D.push(F.reportedBy);else if(Array.isArray(F.reportedBy)&&F.reportedBy.length>0){const $=F.reportedBy[0];$&&!D.includes($)&&D.push($)}}});const j=new Map;S.length>0&&await Promise.all(S.map(async U=>{try{const F=await Nn(tt(Oe,"users",U));if(F.exists()){const $=F.data();j.set(U,{name:$.name||"Unknown User",avatar:$.profilePhoto||$.avatarUrl||""})}else j.set(U,{name:"Unknown User",avatar:""})}catch{j.set(U,{name:"Unknown User",avatar:""})}}));const R=new Map;D.length>0&&await Promise.all(D.map(async U=>{try{const F=await Nn(tt(Oe,"users",U));if(F.exists()){const $=F.data();R.set(U,{name:$.name||"Unknown User",avatar:$.profilePhoto||$.avatarUrl||""})}else R.set(U,{name:"Unknown User",avatar:""})}catch{R.set(U,{name:"Unknown User",avatar:""})}}));const V=T.map(U=>{const F=[];U.reportedBy&&(Array.isArray(U.reportedBy)?U.reportedBy:[U.reportedBy]).forEach(Y=>{if(Y){const le=j.get(Y)||{name:"Unknown User",avatar:""};F.some(fe=>fe.id===Y)||F.push({id:Y,...le})}});const $=typeof U.reportedBy=="string"?U.reportedBy:Array.isArray(U.reportedBy)?U.reportedBy[0]:null,W=$?R.get($)||{name:"Unknown User",avatar:""}:{name:"Unknown User",avatar:""};return{...U,reporters:F,userName:W.name,userAvatar:W.avatar,formattedDate:U.timestamp||U.createdAt?M(U.timestamp||U.createdAt):"Unknown date"}});e(V)}catch(E){console.error("Error fetching reported posts:",E),c({open:!0,message:"Failed to load reported posts",severity:"error"})}finally{r(!1)}})()},[]);const v=k=>{o(k),a(!0)},C=()=>{a(!1),o(null)},x=async()=>{if(s)try{g(!0);const k=tt(Oe,"complaints",s.id);await Ii(k,{reportCount:0,reportedBy:[]}),e(E=>E.filter(b=>b.id!==s.id)),c({open:!0,message:"Report dismissed successfully",severity:"success"}),C()}catch(k){console.error("Error dismissing report:",k),c({open:!0,message:"Failed to dismiss report",severity:"error"})}finally{g(!1)}},A=async()=>{if(s)try{h(!0);const k=tt(Oe,"complaints",s.id);await gE(k),e(E=>E.filter(b=>b.id!==s.id)),c({open:!0,message:"Post deleted successfully",severity:"success"}),C()}catch(k){console.error("Error deleting post:",k),c({open:!0,message:"Failed to delete post",severity:"error"})}finally{h(!1)}},N=()=>{c(k=>({...k,open:!1}))},M=k=>{if(!k)return"Unknown date";try{return k?.toDate?ks(k.toDate(),"MMM d, yyyy h:mm a"):typeof k=="string"?ks(Zie(k),"MMM d, yyyy h:mm a"):"Unknown date"}catch(E){return console.error("Error formatting date:",E),"Unknown date"}};return n?d.jsx(We,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:d.jsx(vh,{})}):d.jsxs(N2,{maxWidth:"lg",sx:{py:4},children:[d.jsxs(We,{display:"flex",alignItems:"center",mb:4,children:[d.jsx(Bd,{onClick:()=>w(-1),sx:{mr:2},children:d.jsx(Doe,{})}),d.jsx(wt,{variant:"h4",component:"h1",fontWeight:"bold",children:"Suspicious Reports"}),d.jsx(Ic,{label:`${t.length} ${t.length===1?"Report":"Reports"}`,color:"error",icon:d.jsx(Boe,{}),sx:{ml:2,px:1}})]}),t.length===0?d.jsxs(We,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",children:[d.jsx(TC,{color:"success",sx:{fontSize:64,mb:2}}),d.jsx(wt,{variant:"h6",color:"textSecondary",children:"No reported issues found"}),d.jsx(wt,{variant:"body1",color:"textSecondary",sx:{mt:1},children:"All posts are currently clean and free from reports."})]}):d.jsx(Bt,{container:!0,spacing:3,children:t.map(k=>d.jsx(Bt,{item:!0,xs:12,sm:6,md:4,children:d.jsxs(ab,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-4px)",boxShadow:3}},children:[k.imageUrl&&d.jsx(i5,{component:"img",height:"180",image:k.imageUrl,alt:"Reported post",sx:{objectFit:"cover"}}),d.jsxs(lb,{sx:{flexGrow:1},children:[d.jsxs(We,{display:"flex",alignItems:"center",mb:1,children:[d.jsx(rA,{src:k.userPhotoURL,alt:k.userName,sx:{width:32,height:32,mr:1}}),d.jsx(wt,{variant:"subtitle2",noWrap:!0,children:k.userName||"Anonymous"})]}),d.jsx(wt,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",mb:1},children:k.description}),d.jsxs(We,{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,children:[d.jsx(Ic,{label:`${k.reportCount} ${k.reportCount===1?"Report":"Reports"}`,color:"error",size:"small",icon:d.jsx(Ay,{fontSize:"small"})}),d.jsx(wt,{variant:"body2",color:"text.secondary",children:k.formattedDate||M(k.createdAt)})]})]}),d.jsx(M2,{sx:{p:2,pt:0},children:d.jsx(Tn,{size:"small",color:"primary",onClick:()=>v(k),fullWidth:!0,children:"Review"})})]})},k.id))}),d.jsxs(b2,{open:i,onClose:C,maxWidth:"md",fullWidth:!0,children:[d.jsxs(a5,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs(We,{display:"flex",alignItems:"center",children:[d.jsx(Ay,{color:"error",sx:{mr:1}}),d.jsx("span",{children:"Reported Post Details"})]}),d.jsx(Bd,{onClick:C,size:"small",children:d.jsx(Ooe,{})})]}),d.jsx(l5,{dividers:!0,children:s&&d.jsxs(Bt,{container:!0,spacing:3,children:[d.jsxs(Bt,{item:!0,xs:12,md:s.imageUrl?6:12,children:[d.jsxs(We,{mb:2,children:[d.jsx(wt,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Posted by"}),d.jsxs(We,{display:"flex",alignItems:"center",mb:2,children:[d.jsx(rA,{src:s.userPhotoURL,alt:s.userName,sx:{width:40,height:40,mr:1.5}}),d.jsxs(We,{children:[d.jsx(wt,{variant:"subtitle1",fontWeight:"medium",children:s.userName||"Anonymous"}),d.jsx(wt,{variant:"body2",color:"text.secondary",children:M(s.timestamp||s.createdAt)})]})]})]}),d.jsxs(We,{mb:3,children:[d.jsx(wt,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Description"}),d.jsx(wt,{variant:"body1",paragraph:!0,children:s.description})]}),d.jsxs(We,{mb:3,children:[d.jsxs(We,{display:"flex",alignItems:"center",gap:1,mb:1,children:[d.jsxs(wt,{variant:"body2",color:"error",fontWeight:"medium",children:[s.reportCount," ",s.reportCount===1?"Report":"Reports"]}),s.reporters&&s.reporters.length>0&&d.jsxs(wt,{variant:"body2",color:"text.secondary",children:[" Reported by: ",s.reporters[0].name,s.reporters.length>1&&` +${s.reporters.length-1} others`]})]}),d.jsxs(We,{p:2,bgcolor:"error.light",borderRadius:1,display:"flex",alignItems:"center",children:[d.jsx(Ay,{color:"error",sx:{mr:1}}),d.jsxs(wt,{variant:"body2",children:["This post has been reported ",d.jsxs("strong",{children:[s.reportCount," ",s.reportCount===1?"time":"times"]})," by community members."]})]})]})]}),s.imageUrl&&d.jsx(Bt,{item:!0,xs:12,md:6,children:d.jsx(We,{sx:{height:"100%",borderRadius:1,overflow:"hidden",border:"1px solid",borderColor:"divider",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"background.paper",p:1},children:d.jsx("img",{src:s.imageUrl,alt:"Reported content",style:{maxWidth:"100%",maxHeight:"400px",objectFit:"contain",borderRadius:"4px"}})})})]})}),d.jsxs(c5,{sx:{p:2,justifyContent:"space-between"},children:[d.jsx(Tn,{onClick:x,disabled:f,startIcon:d.jsx(TC,{}),color:"success",children:f?"Dismissing...":"Dismiss Report"}),d.jsxs(We,{children:[d.jsx(Tn,{onClick:C,sx:{mr:1},children:"Close"}),d.jsx(Tn,{onClick:A,disabled:u,startIcon:d.jsx(Loe,{}),color:"error",variant:"contained",children:u?"Deleting...":"Delete Post"})]})]})]}),d.jsx(u5,{open:l.open,autoHideDuration:6e3,onClose:N,anchorOrigin:{vertical:"top",horizontal:"center"},children:d.jsx(D2,{onClose:N,severity:l.severity,sx:{width:"100%"},children:l.message})})]})},Tfe=()=>{const t=ts(),{setVideo:e}=NE(),[n,r]=p.useState(""),[s,o]=p.useState(0),[i,a]=p.useState([]),[l,c]=p.useState(""),[u,h]=p.useState(!1),f=p.useRef(null),g=p.useRef(null),y=p.useRef(null),w=p.useRef([]),v=p.useRef(new Map),C=p.useRef([]),x=p.useMemo(()=>n?`${window.location.origin}/live/${n}`:"",[n]),A=()=>[{urls:"stun:stun.l.google.com:19302"}];p.useEffect(()=>{if(!it.currentUser?.uid){ge.error("Please login to go live"),t("/citizen-login");return}},[t]);const N=()=>{try{const S=new MediaRecorder(g.current,{mimeType:"video/webm;codecs=vp8,opus"});y.current=S,w.current=[],S.ondataavailable=D=>{D.data&&D.data.size>0&&w.current.push(D.data)},S.start(2e3)}catch(S){console.warn("Recording not supported:",S)}},M=async()=>{try{const S=y.current;S&&S.state!=="inactive"&&await new Promise(T=>{S.onstop=T,S.stop()});const D=new Blob(w.current,{type:"video/webm"});D.size>0&&(e(D,"video/webm"),t("/report"))}catch(S){console.warn("Failed to create recording:",S)}},k=()=>{v.current.forEach(({pc:S,unsubAnswer:D,unsubViewerCandidates:T})=>{try{S.close()}catch{}D&&D(),T&&T()}),v.current.clear(),C.current.forEach(S=>{try{S()}catch{}}),C.current=[]},E=async()=>{try{h(!1),n&&(await afe(n),await cfe(n,"ended")),g.current&&g.current.getTracks().forEach(S=>S.stop()),k(),await M(),ge.success("Live ended. Video sent to report.")}catch(S){console.error(S),ge.error("Failed to stop live")}},b=async S=>{const D=S.id;if(v.current.has(D))return;const T=new RTCPeerConnection({iceServers:A()});g.current.getTracks().forEach(U=>T.addTrack(U,g.current)),T.onicecandidate=async U=>{if(U.candidate)try{await mfe({sessionId:n,peerId:D,candidate:U.candidate.toJSON()})}catch(F){console.warn("Failed to add host ICE candidate",F)}},T.onconnectionstatechange=()=>{console.log("[Host PC] connectionState:",T.connectionState)};const j=tt(Oe,"liveSessions",n,"peers",D),R=Ir(j,U=>{const F=U.data();(F?.candidatesViewer||[]).forEach(async $=>{try{await T.addIceCandidate(new RTCIceCandidate($))}catch{}}),F?.answer&&!T.currentRemoteDescription&&T.setRemoteDescription(new RTCSessionDescription(F.answer)).catch(()=>{})}),V=await T.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});await T.setLocalDescription(V),await Xn(j,{offer:V.toJSON?V.toJSON():V,createdAt:new Date().toISOString()},{merge:!0}),v.current.set(D,{pc:T,unsubViewerCandidates:R})},I=async()=>{try{const S=it.currentUser?.uid;if(!S)return ge.error("Please login");try{const R=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"environment"},audio:!0});if(g.current=R,f.current){f.current.srcObject=R,f.current.muted=!0,f.current.playsInline=!0;try{await f.current.play()}catch(V){throw console.error("Video play failed:",V),new Error("Could not start camera. Please ensure camera permissions are granted.")}}}catch(R){throw console.error("Failed to get camera/mic access:",R),ge.error("Cannot access camera/mic. Please grant permissions and try again."),R}const{sessionId:D}=await ife({hostUid:S,title:"Live from "+(it.currentUser?.displayName||"User")});r(D);try{await lfe({sessionId:D,hostUid:S,title:"Live from "+(it.currentUser?.displayName||"User"),hostName:it.currentUser?.displayName||"Host"})}catch(R){console.warn("Failed to publish live feed item",R)}N(),C.current.push(dfe(D,o)),C.current.push(mB(D,a));const T=wn(Oe,"liveSessions",D,"peers"),j=Ir(T,R=>{R.docChanges().forEach(V=>{if(V.type==="added"){const U=V.doc;U.data().offer||b(U)}})});C.current.push(j),h(!0),ge.success("You are live! Share your link.")}catch(S){console.error("Failed to go live:",S),ge.error("Failed to start live")}},P=async()=>{const S=l.trim();S&&(await pB(n,{uid:it.currentUser?.uid||"anon",displayName:it.currentUser?.displayName||"Host",text:S}),c(""))};return p.useEffect(()=>()=>{try{g.current&&g.current.getTracks().forEach(S=>S.stop())}catch{}k()},[]),d.jsxs("div",{className:"max-w-3xl mx-auto p-4",children:[d.jsx("h1",{className:"text-2xl font-bold mb-4 text-center",children:"Go Live"}),d.jsxs("div",{className:"relative aspect-video bg-black rounded-xl overflow-hidden mb-4 border-2 border-emerald-500",children:[d.jsx("video",{ref:f,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover",style:{transform:"scaleX(-1)"}}),!u&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:d.jsxs("div",{className:"text-center p-4",children:[d.jsx("div",{className:"w-16 h-16 rounded-full bg-emerald-500 flex items-center justify-center mx-auto mb-3",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),d.jsx("p",{className:"text-white font-medium",children:"Camera is ready"}),d.jsx("p",{className:"text-sm text-gray-300",children:"Start your live stream when ready"})]})})]}),d.jsx("div",{className:"flex flex-col gap-3 mb-4",children:u?d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center justify-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500 animate-pulse"}),d.jsx("span",{className:"font-medium text-red-600",children:"Live Now"}),d.jsxs("span",{className:"text-sm bg-red-100 text-red-800 px-2 py-0.5 rounded-full",children:[s," ",s===1?"viewer":"viewers"]})]}),d.jsxs(Vn,{variant:"destructive",onClick:E,className:"w-full py-3 font-bold",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1zm4 0a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),"End Live Stream"]})]}):d.jsxs(Vn,{onClick:I,className:"bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transform hover:scale-105 transition-all",size:"lg",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),"Go Live Now"]})}),n&&d.jsxs("div",{className:"mb-3",children:[d.jsx("div",{className:"text-sm text-gray-700",children:"Share link with viewers:"}),d.jsx("div",{className:"p-2 bg-gray-100 rounded text-xs break-all",children:x})]}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h2",{className:"font-medium mb-2",children:"Live Comments"}),d.jsx("div",{className:"h-48 overflow-y-auto border rounded p-2 bg-white",children:i.map(S=>d.jsxs("div",{className:"text-sm mb-1",children:[d.jsxs("span",{className:"font-semibold",children:[S.displayName||"User",":"]})," ",S.text]},S.id))}),d.jsxs("div",{className:"flex gap-2 mt-2",children:[d.jsx("input",{className:"flex-1 border rounded px-2 py-1 text-sm",value:l,onChange:S=>c(S.target.value),placeholder:"Say something..."}),d.jsx(Vn,{size:"sm",onClick:P,children:"Send"})]})]})]})},Pfe=()=>{const{sessionId:t}=d5(),[e,n]=p.useState(0),[r,s]=p.useState([]),[o,i]=p.useState(""),[a,l]=p.useState(!1),c=p.useRef(null),u=p.useRef(null),h=p.useRef(null),f=p.useRef([]),g=()=>[{urls:"stun:stun.l.google.com:19302"}];p.useEffect(()=>{if(!t)return;const C=tt(Oe,"liveSessions",t),x=Ir(C,N=>{const M=N.data();M&&M.status==="ended"&&ge.info("Live has ended")});f.current.push(x);const A=Ir(tt(Oe,"liveSessions",t),()=>{});return f.current.push(A),f.current.push(mB(t,s)),()=>{f.current.forEach(N=>{try{N()}catch{}}),f.current=[]}},[t]);const y=async()=>{try{const C=it.currentUser?.uid||`guest_${Math.random().toString(36).slice(2,8)}`,x=it.currentUser?.displayName||"Viewer",A=await hfe(t,{uid:C,displayName:x});h.current=setInterval(()=>{A&&Xn(A,{lastSeenAt:new Date},{merge:!0})},2e4);const N=new RTCPeerConnection({iceServers:g()});u.current=N,N.ontrack=E=>{const[b]=E.streams;c.current&&b&&(c.current.srcObject=b,c.current.play?.().catch(()=>{}))},N.onconnectionstatechange=()=>{console.log("[Viewer PC] connectionState:",N.connectionState)};const M=C;N.onicecandidate=async E=>{E.candidate&&await yfe({sessionId:t,peerId:M,candidate:E.candidate.toJSON()})};const k=tt(Oe,"liveSessions",t,"peers",M);await Xn(k,{role:"viewer",createdAt:new Date().toISOString()},{merge:!0}),f.current.push(wfe({sessionId:t,peerId:M,onCandidate:async E=>{try{await N.addIceCandidate(new RTCIceCandidate(E))}catch{}}})),f.current.push(gfe({sessionId:t,peerId:M,onOffer:async E=>{try{await N.setRemoteDescription(new RTCSessionDescription(E));const b=await N.createAnswer();await N.setLocalDescription(b),await pfe({sessionId:t,peerId:M,answer:b.toJSON?b.toJSON():b}),l(!0)}catch(b){console.error("Failed to answer offer:",b),ge.error("Failed to join live")}}})),ge.success("Joined live")}catch(C){console.error("Connect error:",C),ge.error("Failed to connect to live")}},w=async()=>{try{const C=it.currentUser?.uid||"";C&&await ffe(t,C),h.current&&clearInterval(h.current),h.current=null,u.current&&u.current.close(),u.current=null,l(!1)}catch{}},v=async()=>{const C=o.trim();C&&(await pB(t,{uid:it.currentUser?.uid||"anon",displayName:it.currentUser?.displayName||"User",text:C}),i(""))};return p.useEffect(()=>()=>{h.current&&clearInterval(h.current),u.current&&u.current.close()},[]),d.jsxs("div",{className:"max-w-3xl mx-auto p-4",children:[d.jsx("h1",{className:"text-xl font-semibold mb-3",children:"Live"}),d.jsx("div",{className:"aspect-video bg-black rounded overflow-hidden mb-3",children:d.jsx("video",{ref:c,autoPlay:!0,playsInline:!0,controls:!0,className:"w-full h-full object-cover"})}),d.jsx("div",{className:"flex items-center gap-2 mb-3",children:a?d.jsx(Vn,{variant:"outline",onClick:w,children:"Leave"}):d.jsx(Vn,{onClick:y,children:"Join"})}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h2",{className:"font-medium mb-2",children:"Live Comments"}),d.jsx("div",{className:"h-48 overflow-y-auto border rounded p-2 bg-white",children:r.map(C=>d.jsxs("div",{className:"text-sm mb-1",children:[d.jsxs("span",{className:"font-semibold",children:[C.displayName||"User",":"]})," ",C.text]},C.id))}),d.jsxs("div",{className:"flex gap-2 mt-2",children:[d.jsx("input",{className:"flex-1 border rounded px-2 py-1 text-sm",value:o,onChange:C=>i(C.target.value),placeholder:"Say something..."}),d.jsx(Vn,{size:"sm",onClick:v,children:"Send"})]})]})]})},f2=[{code:"en",label:"English"},{code:"hi",label:"Hindi ()"},{code:"bn",label:"Bengali ()"},{code:"ta",label:"Tamil ()"},{code:"te",label:"Telugu ()"},{code:"mr",label:"Marathi ()"},{code:"gu",label:"Gujarati ()"},{code:"kn",label:"Kannada ()"},{code:"ml",label:"Malayalam ()"},{code:"pa",label:"Punjabi ()"},{code:"or",label:"Odia ()"},{code:"ur",label:"Urdu ()"},{code:"as",label:"Assamese ()"},{code:"ne",label:"Nepali ()"},{code:"sd",label:"Sindhi ()"},{code:"si",label:"Sinhala ()"},{code:"sa",label:"Sanskrit ()"},{code:"bho",label:"Bhojpuri ()"},{code:"gom",label:"Konkani ()"},{code:"mai",label:"Maithili ()"},{code:"fr",label:"French (Franais)"},{code:"de",label:"German (Deutsch)"},{code:"es",label:"Spanish (Espaol)"},{code:"pt",label:"Portuguese (Portugus)"},{code:"it",label:"Italian (Italiano)"},{code:"tr",label:"Turkish (Trke)"},{code:"vi",label:"Vietnamese (Ting Vit)"},{code:"id",label:"Indonesian (Bahasa Indonesia)"},{code:"ms",label:"Malay (Bahasa Melayu)"},{code:"th",label:"Thai ()"},{code:"nl",label:"Dutch (Nederlands)"},{code:"pl",label:"Polish (Polski)"},{code:"sv",label:"Swedish (Svenska)"},{code:"da",label:"Danish (Dansk)"},{code:"no",label:"Norwegian (Norsk)"},{code:"cs",label:"Czech (etina)"},{code:"el",label:"Greek ()"},{code:"he",label:"Hebrew ()"},{code:"hu",label:"Hungarian (Magyar)"},{code:"ro",label:"Romanian (Romn)"},{code:"uk",label:"Ukrainian ()"},{code:"tl",label:"Filipino (Tagalog)"},{code:"bg",label:"Bulgarian ()"},{code:"hr",label:"Croatian (Hrvatski)"},{code:"sr",label:"Serbian ()"},{code:"sk",label:"Slovak (Slovenina)"},{code:"sl",label:"Slovenian (Slovenina)"},{code:"fi",label:"Finnish (Suomi)"},{code:"et",label:"Estonian (Eesti)"},{code:"lt",label:"Lithuanian (Lietuvi)"},{code:"lv",label:"Latvian (Latvieu)"},{code:"am",label:"Amharic ()"},{code:"sw",label:"Swahili (Kiswahili)"},{code:"af",label:"Afrikaans"},{code:"yo",label:"Yoruba (Yrb)"},{code:"zu",label:"Zulu (isiZulu)"},{code:"km",label:"Khmer ()"},{code:"lo",label:"Lao ()"},{code:"my",label:"Burmese ()"},{code:"ru",label:"Russian ()"},{code:"ja",label:"Japanese ()"},{code:"ko",label:"Korean ()"},{code:"zh-CN",label:"Chinese ()"},{code:"zh-TW",label:"Chinese ()"}],kfe=()=>{try{const t=document.cookie.match(/(?:^|; )googtrans=([^;]*)/);if(!t)return"en";const n=decodeURIComponent(t[1]).split("/");return n[n.length-1]||"en"}catch{return"en"}},m2=t=>{try{const e=`/auto/${t}`,n=window.location.hostname;document.cookie=`googtrans=${e}; path=/;`,document.cookie=`googtrans=${e}; path=/; domain=.${n}`,localStorage.setItem("preferred_lang",t),window.location.reload()}catch(e){console.error("Failed to set translation language",e)}},gB=({onClick:t})=>d.jsxs(Wn,{to:"/",onClick:t,className:"flex items-center gap-2 group transition-all duration-200 hover:opacity-90 active:opacity-80","aria-label":"mobilEASE - Home",children:[d.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-emerald-700 flex items-center justify-center group-hover:shadow-md transition-all",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",className:"w-5 h-5","aria-hidden":"true",children:d.jsx("path",{d:"M12 2a10 10 0 100 20 10 10 0 000-20zm1 5a1 1 0 10-2 0v5a1 1 0 00.553.894l4 2a1 1 0 10.894-1.788L13 10.618V7z"})})}),d.jsx("span",{className:"font-bold text-xl bg-gradient-to-r from-emerald-600 to-emerald-800 bg-clip-text text-transparent",children:"Civic Mitra"})]}),Ut=({to:t,onClick:e,children:n,isActive:r=!1,variant:s="default",icon:o,className:i=""})=>{const a="flex items-center px-4 py-2 text-sm font-medium rounded-md transition-colors",l={default:"text-gray-700 hover:bg-gray-100",outline:"border border-gray-300 text-gray-700 hover:bg-gray-50",primary:"bg-emerald-600 text-white hover:bg-emerald-700"},c=d.jsxs(d.Fragment,{children:[o&&d.jsx(o,{className:"mr-3 h-5 w-5 flex-shrink-0"}),n]});return e?d.jsx("button",{onClick:e,className:`${a} ${l[s]} ${r?"!bg-emerald-50 !text-emerald-700":""} ${i}`,children:c}):t?d.jsx(Wn,{to:t,onClick:e,className:`${a} ${l[s]} ${r?"!bg-emerald-50 !text-emerald-700":""} ${i}`,children:c}):d.jsx("button",{onClick:e,className:`${a} ${l[s]} ${r?"!bg-emerald-50 !text-emerald-700":""} ${i}`,children:c})},Rfe=({isOpen:t,onClose:e,user:n,official:r,handleLogout:s,location:o,onNavigate:i,children:a})=>{p.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[t]);const l={open:{opacity:1,x:0,transition:{type:"spring",stiffness:300,damping:30}},closed:{opacity:0,x:"100%",transition:{type:"spring",stiffness:300,damping:30}}},c={open:{opacity:1,transition:{duration:.3}},closed:{opacity:0,transition:{duration:.3,delay:.2}}};return d.jsx(RL,{children:t&&d.jsxs(d.Fragment,{children:[d.jsx(or.div,{initial:"closed",animate:"open",exit:"closed",variants:c,className:"fixed inset-0 bg-black/50 z-40",onClick:e,"aria-hidden":"true"}),d.jsxs(or.div,{initial:"closed",animate:"open",exit:"closed",variants:l,className:"fixed top-0 right-0 h-full w-64 bg-white shadow-xl z-50 p-4",role:"dialog","aria-modal":"true",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx(gB,{onClick:e}),d.jsx("button",{onClick:e,className:"p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none","aria-label":"Close menu",children:d.jsx(Vc,{className:"h-6 w-6"})})]}),d.jsx("nav",{className:"flex flex-col space-y-2",children:n&&n.uid?d.jsxs(d.Fragment,{children:[!r&&d.jsxs(d.Fragment,{children:[d.jsx(Ut,{to:"/feed",onClick:()=>i("/feed"),icon:LO,isActive:o.pathname==="/feed",children:"Home"}),d.jsx(Ut,{to:"/citizen-dashboard",onClick:()=>i("/citizen-dashboard"),icon:qu,isActive:o.pathname==="/citizen-dashboard",children:"Citizen Dashboard"}),d.jsx(Ut,{to:"/report",onClick:()=>i("/report"),icon:OO,isActive:o.pathname==="/report",children:"Report Issue"})]}),r?d.jsx(Ut,{to:"/official-dashboard",onClick:()=>i("/official-dashboard"),icon:qu,isActive:o.pathname==="/official-dashboard",children:"Dashboard"}):d.jsx(Ut,{to:"/track-complaints",onClick:()=>i("/track-complaints"),icon:qu,isActive:o.pathname==="/track-complaints",children:"Track"}),d.jsx(Ut,{to:"/profile",onClick:()=>{e(),i("/profile")},icon:jO,isActive:o.pathname==="/profile",children:"Profile"}),r&&d.jsxs(d.Fragment,{children:[d.jsx(Ut,{to:"/official-priority",onClick:()=>i("/official-priority"),icon:pw,isActive:o.pathname==="/official-priority",children:"Priority"}),d.jsx(Ut,{to:"/analytics",onClick:()=>i("/analytics"),icon:pw,isActive:o.pathname==="/analytics",children:"Analytics"})]}),d.jsx("div",{className:"border-t border-gray-200 my-2"}),d.jsx(Ut,{onClick:()=>{e(),s()},icon:DE,className:"text-red-600 hover:bg-red-50",children:"Sign Out"})]}):d.jsxs(d.Fragment,{children:[d.jsx(Ut,{to:"/",onClick:()=>i("/"),isActive:o.pathname==="/",className:"justify-start",children:"Home"}),d.jsx(Ut,{to:"/citizen-login",onClick:()=>i("/citizen-login"),variant:"outline",isActive:o.pathname==="/citizen-login",children:"Citizen Login"}),d.jsx(Ut,{to:"/official-login",onClick:()=>i("/official-login"),variant:"outline",isActive:o.pathname==="/official-login",children:"Official Login"}),d.jsx(Ut,{to:"/register",onClick:()=>i("/register"),variant:"primary",isActive:o.pathname==="/register",className:"justify-center",children:"Sign Up Free"})]})}),a?d.jsx("div",{className:"mt-4",children:a}):null]})]})})},Nfe=()=>{const[t,e]=p.useState(!1),[n,r]=p.useState(!1),[s,o]=p.useState(!1),i=gp(),a=ts(),{currentUser:l,isOfficial:c,loading:u}=$p(),[h,f]=p.useState("citizen"),[g,y]=p.useState("en");p.useEffect(()=>{f(l?c?"official":"citizen":"guest")},[l,c]),p.useEffect(()=>{const A=localStorage.getItem("preferred_lang")||kfe();y(A)},[]);const w=x=>{y(x),m2(x)};if(p.useEffect(()=>{const x=()=>{const A=window.innerWidth<768;o(A),A||e(!1)};return window.addEventListener("resize",x),x(),()=>window.removeEventListener("resize",x)},[]),u)return d.jsx("div",{className:"h-16 bg-white border-b border-gray-200",children:d.jsx("div",{className:"h-full flex items-center justify-center",children:d.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-emerald-500"})})});const v=async()=>{try{await it.signOut(),e(!1),a("/"),ge.success("Successfully signed out")}catch(x){console.error("Error signing out:",x),ge.error("Error signing out. Please try again.")}},C=x=>{if(x==="/official-dashboard"&&!c){a("/unauthorized");return}a(x),e(!1),window.scrollTo(0,0)};return d.jsxs("nav",{className:"bg-white border-b border-gray-200 fixed w-full z-50",children:[d.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:d.jsxs("div",{className:"flex justify-between h-16",children:[d.jsx("div",{className:"flex items-center",children:d.jsx(gB,{onClick:()=>{e(!1),C("/")}})}),d.jsx("div",{className:"hidden md:flex items-center space-x-4",children:l?d.jsxs(d.Fragment,{children:[!c&&d.jsxs(d.Fragment,{children:[d.jsx(Ut,{to:"/feed",icon:LO,isActive:i.pathname==="/feed",onClick:()=>C("/feed"),children:"Home"}),d.jsx(Ut,{to:"/citizen-dashboard",icon:qu,isActive:i.pathname==="/citizen-dashboard",onClick:()=>C("/citizen-dashboard"),children:"Citizen Dashboard"}),d.jsx(Ut,{to:"/report",icon:OO,isActive:i.pathname==="/report",onClick:()=>C("/report"),children:"Report Issue"})]}),c?d.jsx(Ut,{to:"/official-dashboard",icon:qu,isActive:i.pathname==="/official-dashboard",onClick:()=>C("/official-dashboard"),children:"Dashboard"}):d.jsx(Ut,{to:"/track-complaints",icon:qu,isActive:i.pathname==="/track-complaints",onClick:()=>C("/track-complaints"),children:"Track"}),c&&d.jsxs(d.Fragment,{children:[d.jsx(Ut,{to:"/official-priority",icon:pw,isActive:i.pathname==="/official-priority",onClick:()=>C("/official-priority"),children:"Priority"}),d.jsx(Ut,{to:"/analytics",icon:pw,isActive:i.pathname==="/analytics",onClick:()=>C("/analytics"),children:"Analytics"})]}),d.jsx(Ut,{to:"/profile",icon:jO,isActive:i.pathname==="/profile",onClick:()=>C("/profile"),children:"Profile"}),d.jsx(Ut,{onClick:v,icon:DE,className:"text-red-600 hover:bg-red-50",children:"Sign Out"}),d.jsx("div",{className:"ml-1",children:d.jsx("select",{"aria-label":"Select language",className:"border border-gray-300 rounded-md px-1 py-[2px] text-xs max-w-[9rem] truncate",value:g,onChange:x=>{const A=x.target.value;y(A),m2(A)},children:f2.map(x=>d.jsx("option",{value:x.code,children:(x.label||"").split(" (")[0]},x.code))})})]}):d.jsxs(d.Fragment,{children:[d.jsx(Ut,{to:"/",isActive:i.pathname==="/",onClick:()=>C("/"),children:"Home"}),d.jsx(Ut,{to:"/citizen-login",variant:"outline",isActive:i.pathname==="/citizen-login",onClick:()=>C("/citizen-login"),children:"Citizen Login"}),d.jsx(Ut,{to:"/official-login",variant:"outline",isActive:i.pathname==="/official-login",onClick:()=>C("/official-login"),children:"Official Login"}),d.jsx(Ut,{to:"/register",variant:"primary",isActive:i.pathname==="/register",onClick:()=>C("/register"),children:"Sign Up Free"})]})}),d.jsx("div",{className:"md:hidden flex items-center",children:d.jsxs("button",{onClick:()=>e(!t),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-gray-900 hover:bg-gray-100 focus:outline-none","aria-expanded":"false",children:[d.jsx("span",{className:"sr-only",children:"Open main menu"}),t?d.jsx(Vc,{className:"h-6 w-6"}):d.jsx(FO,{className:"h-6 w-6"})]})})]})}),d.jsx(Rfe,{isOpen:t,onClose:()=>e(!1),user:l,official:c,handleLogout:v,location:i,onNavigate:C,children:d.jsx("div",{className:"py-2",children:d.jsx(sV,{value:g,onChange:x=>w(x),placeholder:"Select language",className:"border-gray-300",options:f2.map(x=>({value:x.code,label:x.label}))})})})]})},p2=async()=>{try{const t=await mw(),e=t.reduce((u,h)=>(u[h.status]=(u[h.status]||0)+1,u),{}),n=Object.entries(Es).map(([u,h])=>({name:h,value:e[u]||0,key:u})),r=t.reduce((u,h)=>{const f=h.issueType||"Other";return u[f]=(u[f]||0)+1,u},{}),s=Object.entries(r).sort((u,h)=>h[1]-u[1]).map(([u,h])=>({name:u,count:h,percentage:Math.round(h/t.length*100)||0})),o=e.solved||0,i=t.length-(e.pending||0),a=i>0?Math.round(o/i*100):0,l=u=>{try{if(!u)return null;if(u instanceof Date)return u;if(u?.toDate)return u.toDate();if(typeof u=="number")return new Date(u);if(typeof u=="string")return new Date(u)}catch{}return null},c=[...t].map(u=>({...u,_ts:l(u.timestamp)})).filter(u=>u._ts&&!isNaN(u._ts.getTime())).sort((u,h)=>h._ts-u._ts).slice(0,5).map(u=>({id:u.id,title:u.title||"Untitled Complaint",status:Es[u.status]||u.status,issueType:u.issueType||"Other",timestamp:u._ts.toLocaleDateString()}));return{totalComplaints:t.length,statusDistribution:n,topIssues:s.slice(0,5),resolutionRate:a,recentComplaints:c,lastUpdated:new Date().toISOString()}}catch(t){throw console.error("Error fetching analytics data:",t),new Error("Failed to load analytics data")}},g2=t=>{if(!t)return"No analytics data available";const{totalComplaints:e,statusDistribution:n,topIssues:r,resolutionRate:s,recentComplaints:o}=t;let i=` *Civic Issue Analytics*

`;return i+=` Total complaints: *${e}*
`,i+=`
*Status Distribution:*
`,n.forEach(a=>{if(a.value>0){const l=Math.round(a.value/e*100);i+=`- ${a.name}: ${a.value} (${l}%)
`}}),i+=`
*Top Issue Types:*
`,r.forEach(a=>{i+=`- ${a.name}: ${a.count} (${a.percentage}%)
`}),i+=`
*Resolution Rate:* ${s}%
`,o.length>0&&(i+=`
*Recent Complaints:*
`,o.forEach(a=>{i+=`- [${a.status}] ${a.title} (${a.issueType}) - ${a.timestamp}
`})),i},Dfe=[{label:"English",code:"en"},{label:" (Hindi)",code:"hi"},{label:" (Tamil)",code:"ta"},{label:" (Telugu)",code:"te"},{label:" (Bengali)",code:"bn"},{label:" (Marathi)",code:"mr"}],Mfe=()=>{const[t,e]=p.useState(!1),[n,r]=p.useState(""),[s,o]=p.useState(!1),[i,a]=p.useState([]),[l,c]=p.useState(""),[u,h]=p.useState(!1),f=p.useRef(null),g="https://models.inference.ai.azure.com/chat/completions",y="gpt-4o-mini",w=void 0,v=`You are an in-app assistant chatbot for a crowdsourced civic issue reporting mobile application.
Your role is to guide citizens in submitting, tracking, and resolving civic issues. You also have access to analytics data about reported issues.

Civic Issue Categories:
1. Sanitation & Health
2. Water & Sewerage
3. Roads & Transport
4. Street Lighting
5. Parks & Horticulture
6. Town Planning
7. Revenue
8. Education
9. Public Works (PWD local)
10. Fire Services

Analytics Data Access:
- You can provide insights about complaint statistics, status distribution, and trends.
- Use the [ANALYTICS] tool to fetch the latest data when needed.

Guidelines:
- Provide concise, step-by-step guidance relevant to the department.
- Help users attach media and provide accurate location.
- Explain validation and notifications.
- Encourage participation with points/badges when relevant.
- Never ask for sensitive info.
- If out of scope, politely redirect to appropriate in-app help or department contact.`,C=I=>{if(!I)return!1;const P=I.toLowerCase();return P.includes("analytics")||P.includes("statistics")||P.includes("how many")||P.includes("report")||P.includes("status")||P.includes("trend")||P.includes("dashboard")||P.includes("summary")||P.includes("overview")},x=async I=>{try{const P=await p2(),S=g2(P);return await new Promise(D=>setTimeout(D,1e3)),`Here's the latest analytics summary:

${S}

You can ask me specific questions about the data, such as:
- What's the most common issue type?
- How many complaints are pending?
- What's the current resolution rate?`}catch(P){return console.error("Error handling analytics query:",P),"I'm having trouble fetching the analytics data right now. Please try again later."}};async function A(I,P){const S=I[I.length-1]?.content;if(C(S))return await x();const T=[{role:"system",content:v+`

Current date: ${new Date().toLocaleDateString()}
Respond in language code: ${P||"en"}.`},...I.map(R=>({role:R.role==="assistant"?"assistant":"user",content:R.role==="assistant"&&R.content.includes("[ANALYTICS]")?"I have access to analytics data. You can ask me about complaint statistics, status distribution, or trends.":R.content}))],j=I.map(R=>R.content).join(" ").toLowerCase();if(C(j))try{const R=await p2();T[0].content+=`

[ANALYTICS CONTEXT]
${g2(R)}`}catch(R){console.error("Error adding analytics context:",R)}try{const R=await fetch(g,{method:"POST",headers:{Authorization:`Bearer ${w}`,"Content-Type":"application/json"},body:JSON.stringify({model:y,messages:T,temperature:.7,max_tokens:500})});if(!R.ok){const F=await R.text();throw new Error(`Direct API error ${R.status}: ${F}`)}const V=await R.json();let U=V?.choices?.[0]?.message?.content;return U||(Array.isArray(U)?U=U.map(F=>typeof F=="string"?F:F?.text||"").join(""):V?.choices?.[0]?.message?.content?.text?U=V.choices[0].message.content.text:U=JSON.stringify(V)),U}catch(R){throw console.error("Error in callDirectAPI:",R),R}}p.useEffect(()=>{f.current&&(f.current.scrollTop=f.current.scrollHeight)},[i,t]);const N=()=>{e(!1),r(""),o(!1),a([]),c(""),h(!1)},M=()=>{r(""),o(!0),a([]),c(""),h(!1),e(!0)},k=I=>{r(I),o(!1),a([{role:"assistant",content:"Hello! How can I help you report or track a civic issue today?"}])},E=async()=>{const I=l.trim();if(!I||u)return;const P=[...i,{role:"user",content:I}];a(P),c(""),h(!0);try{const S=await fetch("/.netlify/functions/gh-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetLanguage:n||"en",messages:P})});if(S.ok){const T=(await S.json()).reply||"Sorry, something went wrong.";a(j=>[...j,{role:"assistant",content:T}])}else{const D=await A(P,n||"en");a(T=>[...T,{role:"assistant",content:D}])}}catch{try{const D=await A(P,n||"en");a(T=>[...T,{role:"assistant",content:D}])}catch(D){a(T=>[...T,{role:"assistant",content:`There was an error reaching the assistant. ${String(D)}`}])}}finally{h(!1)}},b=I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),E())};return d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:M,className:"fixed bottom-4 right-4 z-50 h-14 w-14 rounded-full bg-emerald-600 hover:bg-emerald-700 shadow-lg flex items-center justify-center text-white","aria-label":"Open chatbot",children:d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 10h8M8 14h5"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12c0 4.418-4.03 8-9 8-1.21 0-2.36-.19-3.41-.54L3 20l1.54-5.59C4.19 12.36 4 11.21 4 10c0-4.418 4.03-8 9-8s9 3.582 9 8z"})]})}),t&&d.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center sm:justify-end",children:[d.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:N}),d.jsxs("div",{className:"relative m-4 w-full sm:max-w-sm bg-white rounded-xl shadow-2xl border border-gray-200 overflow-hidden",children:[d.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gray-50",children:[d.jsx("div",{className:"font-semibold text-gray-900",children:"Civic Assistant"}),d.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:N,"aria-label":"Close",children:""})]}),!n||s?d.jsxs("div",{className:"p-4",children:[d.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"Please select your language:"}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:Dfe.map(I=>d.jsx("button",{onClick:()=>k(I.code),className:`px-3 py-2 rounded-md border text-sm ${n===I.code?"border-emerald-600 text-emerald-700":"border-gray-300 text-gray-700 hover:border-emerald-500"}`,children:I.label},I.code))})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{ref:f,className:"h-80 overflow-y-auto p-3 space-y-3 bg-white",children:[i.map((I,P)=>d.jsx("div",{className:`${I.role==="user"?"justify-end":"justify-start"} flex`,children:d.jsx("div",{className:`${I.role==="user"?"bg-emerald-600 text-white":"bg-gray-100 text-gray-900"} px-3 py-2 rounded-lg max-w-[80%] whitespace-pre-wrap break-words`,children:I.content})},P)),u&&d.jsx("div",{className:"flex justify-start",children:d.jsx("div",{className:"bg-gray-100 text-gray-700 px-3 py-2 rounded-lg",children:"Thinking"})})]}),d.jsx("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:d.jsxs("div",{className:"flex items-end gap-2",children:[d.jsx("textarea",{value:l,onChange:I=>c(I.target.value),onKeyDown:b,placeholder:"Type your message",className:"flex-1 min-h-[44px] max-h-32 rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500"}),d.jsx("button",{onClick:E,disabled:u,className:"h-10 px-4 rounded-md bg-emerald-600 text-white text-sm font-medium hover:bg-emerald-700 disabled:opacity-50",children:"Send"})]})})]})]})]})]})},y2=[{code:"en",label:"English"},{code:"hi",label:"Hindi ()"},{code:"bn",label:"Bengali ()"},{code:"ta",label:"Tamil ()"},{code:"te",label:"Telugu ()"},{code:"mr",label:"Marathi ()"},{code:"gu",label:"Gujarati ()"},{code:"kn",label:"Kannada ()"},{code:"ml",label:"Malayalam ()"},{code:"pa",label:"Punjabi ()"},{code:"or",label:"Odia ()"},{code:"ur",label:"Urdu ()"},{code:"as",label:"Assamese ()"},{code:"ne",label:"Nepali ()"},{code:"sd",label:"Sindhi ()"},{code:"si",label:"Sinhala ()"},{code:"sa",label:"Sanskrit ()"},{code:"bho",label:"Bhojpuri ()"},{code:"gom",label:"Konkani ()"},{code:"mai",label:"Maithili ()"},{code:"fr",label:"French (Franais)"},{code:"de",label:"German (Deutsch)"},{code:"es",label:"Spanish (Espaol)"},{code:"pt",label:"Portuguese (Portugus)"},{code:"it",label:"Italian (Italiano)"},{code:"tr",label:"Turkish (Trke)"},{code:"vi",label:"Vietnamese (Ting Vit)"},{code:"id",label:"Indonesian (Bahasa Indonesia)"},{code:"ms",label:"Malay (Bahasa Melayu)"},{code:"th",label:"Thai ()"},{code:"nl",label:"Dutch (Nederlands)"},{code:"pl",label:"Polish (Polski)"},{code:"sv",label:"Swedish (Svenska)"},{code:"da",label:"Danish (Dansk)"},{code:"no",label:"Norwegian (Norsk)"},{code:"cs",label:"Czech (etina)"},{code:"el",label:"Greek ()"},{code:"he",label:"Hebrew ()"},{code:"hu",label:"Hungarian (Magyar)"},{code:"ro",label:"Romanian (Romn)"},{code:"uk",label:"Ukrainian ()"},{code:"tl",label:"Filipino (Tagalog)"},{code:"bg",label:"Bulgarian ()"},{code:"hr",label:"Croatian (Hrvatski)"},{code:"sr",label:"Serbian ()"},{code:"sk",label:"Slovak (Slovenina)"},{code:"sl",label:"Slovenian (Slovenina)"},{code:"fi",label:"Finnish (Suomi)"},{code:"et",label:"Estonian (Eesti)"},{code:"lt",label:"Lithuanian (Lietuvi)"},{code:"lv",label:"Latvian (Latvieu)"},{code:"am",label:"Amharic ()"},{code:"sw",label:"Swahili (Kiswahili)"},{code:"af",label:"Afrikaans"},{code:"yo",label:"Yoruba (Yrb)"},{code:"zu",label:"Zulu (isiZulu)"},{code:"km",label:"Khmer ()"},{code:"lo",label:"Lao ()"},{code:"my",label:"Burmese ()"},{code:"ru",label:"Russian ()"},{code:"ja",label:"Japanese ()"},{code:"ko",label:"Korean ()"},{code:"zh-CN",label:"Chinese ()"},{code:"zh-TW",label:"Chinese ()"}],Ofe=()=>{try{const t=document.cookie.match(/(?:^|; )googtrans=([^;]*)/);if(!t)return"en";const n=decodeURIComponent(t[1]).split("/");return n[n.length-1]||"en"}catch{return"en"}},Lfe=t=>{try{const e=`/auto/${t}`,n=window.location.hostname;document.cookie=`googtrans=${e}; path=/;`,document.cookie=`googtrans=${e}; path=/; domain=.${n}`,localStorage.setItem("preferred_lang",t),window.location.reload()}catch(e){console.error("Failed to set translation language",e)}},Ffe=()=>{const[t,e]=p.useState(!1),[n,r]=p.useState("en");p.useEffect(()=>{const a=localStorage.getItem("preferred_lang")||Ofe();r(a)},[]);const s=i=>{r(i),Lfe(i)},o=["en","hi","ta","te","bn","ml","kn","mr","gu","pa"];return d.jsxs("div",{className:"fixed z-[60] md:hidden",style:{bottom:88,left:16},children:[d.jsx("button",{onClick:()=>e(!t),"aria-label":"Change language",className:"w-12 h-12 rounded-full bg-emerald-600 shadow-lg text-white flex items-center justify-center focus:outline-none active:scale-95 transition",children:d.jsx(UG,{className:"w-6 h-6"})}),t&&d.jsxs("div",{className:"mt-2 p-3 bg-white rounded-2xl shadow-2xl w-80 max-w-[90vw] border border-gray-100",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("div",{className:"text-sm font-semibold text-gray-800",children:"Choose Language"}),d.jsx("div",{className:"text-xs text-gray-400",children:"Google Translate"})]}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:y2.filter(i=>o.includes(i.code)).map(i=>d.jsx("button",{onClick:()=>s(i.code),className:`px-3 py-1.5 rounded-full text-xs border transition ${n===i.code?"bg-emerald-600 text-white border-emerald-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:i.label.split(" (")[0]},i.code))}),d.jsx("div",{className:"max-h-56 overflow-y-auto pr-1 custom-scroll",children:d.jsx("div",{className:"grid grid-cols-2 gap-2",children:y2.map(i=>d.jsx("button",{onClick:()=>s(i.code),className:`text-left px-3 py-2 rounded-lg text-sm border transition ${n===i.code?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"}`,children:i.label},i.code))})})]})]})},jfe=()=>{const t=ts(),{setVideo:e,addPhoto:n,pendingPhotos:r}=NE(),[s,o]=p.useState(!1),[i,a]=p.useState(!1),[l,c]=p.useState(null),[u,h]=p.useState(null),f=p.useRef([]),g=p.useRef(null);p.useEffect(()=>{const x=()=>o(!0);return window.addEventListener("openGoLive",x),()=>window.removeEventListener("openGoLive",x)},[]),p.useEffect(()=>{s&&!l&&(async()=>{try{const x=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});c(x),g.current&&(g.current.srcObject=x)}catch(x){console.warn("Camera/mic permission denied:",x)}})(),!s&&l&&(l.getTracks().forEach(x=>x.stop()),c(null))},[s]);const y=async()=>{if(!l)try{const A=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});c(A),g.current&&(g.current.srcObject=A)}catch{alert("Unable to access camera/microphone.");return}const x=new MediaRecorder(l||g.current?.srcObject,{mimeType:"video/webm;codecs=vp8,opus"});f.current=[],x.ondataavailable=A=>{A.data&&A.data.size>0&&f.current.push(A.data)},x.onstop=async()=>{const A=new Blob(f.current,{type:"video/webm"});e(A,"video/webm"),o(!1),a(!1),t("/report")},x.start(),h(x),a(!0)},w=()=>{u&&i&&u.stop()},v=async()=>{try{const x=g.current;if(!x)return;const A=document.createElement("canvas"),N=x.videoWidth||1280,M=x.videoHeight||720;A.width=N,A.height=M,A.getContext("2d").drawImage(x,0,0,N,M);const E=await new Promise(b=>A.toBlob(b,"image/jpeg",.9));E&&n(E,"image/jpeg")}catch(x){console.warn("Snapshot failed:",x)}},C=()=>{i&&w(),o(!1)};return d.jsxs(d.Fragment,{children:[d.jsx("button",{type:"button",onClick:()=>o(!0),className:"fixed bottom-20 right-4 z-50 rounded-full bg-red-600 text-white shadow-lg px-4 py-3 font-semibold hover:bg-red-700 active:scale-95","aria-label":"Go Live",children:"Go Live"}),s&&d.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[d.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:C}),d.jsxs("div",{className:"relative z-10 bg-white rounded-xl w-[92vw] max-w-md p-4 shadow-xl",children:[d.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Go Live - Record Video"}),d.jsx("div",{className:"aspect-video bg-black rounded overflow-hidden",children:d.jsx("video",{ref:g,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"})}),d.jsxs("div",{className:"mt-4 flex items-center justify-between gap-3",children:[i?d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:v,className:"flex-1 py-2 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700",children:"Take Photo"}),d.jsx("button",{onClick:w,className:"flex-1 py-2 rounded-lg bg-emerald-600 text-white font-medium hover:bg-emerald-700",children:"Stop & Use"})]}):d.jsx("button",{onClick:y,className:"flex-1 py-2 rounded-lg bg-red-600 text-white font-medium hover:bg-red-700",children:"Start"}),d.jsx("button",{onClick:C,className:"px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200",children:"Close"})]}),d.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Photos captured: ",r?.length||0]}),d.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"After stopping, you'll be redirected to the Report page with the recorded video attached. You can add other details before submitting."})]})]})]})},Vfe=({children:t,showBottomNav:e=!0})=>d.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50",children:[d.jsx(Nfe,{}),d.jsx("main",{className:"flex-1 overflow-auto pt-16",children:d.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t})}),d.jsx(Ffe,{}),d.jsx(Mfe,{}),d.jsx(jfe,{})]}),Bfe=()=>{const[t,e]=p.useState(!1),n=gp(),r=[{name:"Home",path:"/"},{name:"Register",path:"/register"}],s=o=>n.pathname===o?"text-emerald-600":"text-gray-700";return d.jsxs("nav",{className:"bg-white shadow-sm",children:[d.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:d.jsxs("div",{className:"flex justify-between h-16",children:[d.jsx("div",{className:"flex-shrink-0 flex items-center",children:d.jsxs(Wn,{to:"/",className:"flex items-center gap-2 group transition-all duration-200",children:[d.jsx("div",{className:"w-9 h-9 rounded-xl bg-gradient-to-br from-emerald-500 to-emerald-600 flex items-center justify-center",children:d.jsxs("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[d.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z",fill:"currentColor"}),d.jsx("path",{d:"M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm0 10c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z",fill:"currentColor"})]})}),d.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-emerald-600 to-emerald-800 bg-clip-text text-transparent",children:"Civic Mitra"})]})}),d.jsxs("div",{className:"hidden sm:ml-6 sm:flex sm:items-center sm:space-x-8",children:[r.map(o=>d.jsx(Wn,{to:o.path,className:`${s(o.path)} hover:text-emerald-500 px-3 py-2 text-sm font-medium transition-colors duration-200`,children:o.name},o.name)),d.jsxs("div",{className:"relative group",children:[d.jsxs("button",{className:"flex items-center text-gray-700 hover:text-emerald-600 px-3 py-2 text-sm font-medium transition-colors duration-200 whitespace-nowrap",onMouseEnter:o=>o.currentTarget.parentElement.classList.add("hover-active"),onMouseLeave:o=>o.currentTarget.parentElement.classList.remove("hover-active"),children:[d.jsx("span",{children:"Login"}),d.jsx("svg",{className:"ml-1 h-4 w-4 flex-shrink-0 transition-transform duration-200 group-hover:rotate-180",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:d.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),d.jsx("div",{className:"absolute left-0 mt-2 w-48 rounded-lg shadow-lg bg-white ring-1 ring-black ring-opacity-5 opacity-0 invisible group-hover:opacity-100 group-hover:visible group-[.hover-active]:opacity-100 group-[.hover-active]:visible transition-all duration-200 transform -translate-x-1/2 z-50",style:{top:"100%",left:"50%"},onMouseEnter:o=>o.stopPropagation(),children:d.jsxs("div",{className:"py-1",children:[d.jsx(Wn,{to:"/citizen-login",className:"block px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-150",children:"Citizen Login"}),d.jsx(Wn,{to:"/official-login",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Official Login"})]})})]})]}),d.jsx("div",{className:"-mr-2 flex items-center sm:hidden",children:d.jsxs("button",{onClick:()=>e(!t),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-emerald-500","aria-expanded":"false",children:[d.jsx("span",{className:"sr-only",children:"Open main menu"}),t?d.jsx(Vc,{className:"block h-6 w-6","aria-hidden":"true"}):d.jsx(FO,{className:"block h-6 w-6","aria-hidden":"true"})]})})]})}),d.jsx("div",{className:`${t?"block":"hidden"} sm:hidden`,children:d.jsxs("div",{className:"pt-2 pb-3 space-y-1 bg-white",children:[r.map(o=>d.jsx(Wn,{to:o.path,onClick:()=>e(!1),className:`${s(o.path)?"bg-emerald-50 text-emerald-600":"text-gray-700 hover:bg-gray-50"} block px-4 py-3 text-base font-medium border-b border-gray-100`,children:o.name},`mobile-${o.name}`)),d.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[d.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Login As"}),d.jsx(Wn,{to:"/citizen-login",onClick:()=>e(!1),className:"block py-2 pl-4 pr-2 text-base font-medium text-gray-700 hover:text-emerald-600 hover:bg-gray-50 rounded-md transition-colors duration-150",children:"Citizen"}),d.jsx(Wn,{to:"/official-login",onClick:()=>e(!1),className:"block py-2 pl-4 pr-2 text-base font-medium text-gray-700 hover:text-emerald-600 hover:bg-gray-50 rounded-md transition-colors duration-150",children:"Official"})]})]})})]})},xl=(t,e={})=>{console.log(`[ProtectedRoute] ${t}`,e)};function os({children:t,requiredRole:e}){const{currentUser:n,isOfficial:r,loading:s,initialized:o}=$p(),i=gp(),[a,l]=p.useState(!0);if(p.useEffect(()=>{xl("Component mounted",{path:i.pathname,requiredRole:e,currentUser:!!n,isOfficial:r,loading:s,initialized:o})},[]),p.useEffect(()=>{xl("Auth state changed",{loading:s,initialized:o,currentUser:!!n,isOfficial:r});const c=setTimeout(()=>{const u=s||!o;xl("Updating isCheckingAuth",{shouldCheck:u,loading:s,initialized:o}),l(u)},100);return()=>{clearTimeout(c)}},[s,o,n,r]),a)return xl("Showing loading state",{loading:s,initialized:o}),d.jsx("div",{className:"flex items-center justify-center min-h-screen",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-emerald-500"})});if(!n){const c=i.pathname.startsWith("/official"),u=c?"/official-login":"/citizen-login";return xl("User not authenticated, redirecting to login",{isOfficialRoute:c,loginPath:u,from:i.pathname}),d.jsx(Tf,{to:u,state:{from:i},replace:!0})}if(e==="official"&&!r)return xl("Route requires official access",{currentUser:n.uid,isOfficial:r,requiredRole:e}),d.jsx(Tf,{to:"/unauthorized",state:{from:i},replace:!0});if((i.pathname==="/citizen-login"||i.pathname==="/official-login")&&n){const c=r?"/official-dashboard":"/feed";return xl("Already logged in, redirecting to dashboard",{isOfficial:r,redirectPath:c}),d.jsx(Tf,{to:c,replace:!0})}if(console.log("[ProtectedRoute] Render",{currentUser:!!n,isOfficial:r,requiredRole:e,pathname:i.pathname,search:i.search}),i.pathname==="/unauthorized")return t;if(r&&e!=="official"){const c=["/profile","/track-complaints"];if(!(i.pathname.startsWith("/official-")||i.pathname==="/official-dashboard"||i.pathname==="/analytics"||c.includes(i.pathname)))return console.log("[ProtectedRoute] Official on citizen route, redirecting to dashboard",{currentPath:i.pathname,isOfficial:r,requiredRole:e}),d.jsx(Tf,{to:"/official-dashboard",replace:!0})}return t}console.log("Leaflet available:",typeof L<"u"?"Yes":"No");typeof L<"u"&&console.log("Leaflet version:",L.version);const Hn=(t,e={})=>{const r=["/","/register","/citizen-login","/official-login"].includes(window.location.pathname),o=!["/feed","/reported-issues","/analytics"].includes(window.location.pathname);return r?d.jsxs("div",{className:"min-h-screen bg-gray-50",children:[d.jsx(Bfe,{}),d.jsx("main",{children:d.jsx(t,{})})]}):d.jsx(Vfe,{showBottomNav:e.showBottomNav!==void 0?e.showBottomNav:o,children:d.jsx(t,{})})},Ufe=h5([{path:"/",element:Hn(E7)},{path:"/register",element:Hn(_7)},{path:"/citizen-login",element:Hn($P)},{path:"/official-login",element:Hn($P)},{path:"/unauthorized",element:Hn(h2)},{path:"/citizen-dashboard",element:d.jsx(os,{children:Hn(EJ)})},{path:"/report",element:d.jsx(os,{children:Hn(rfe)})},{path:"/feed",element:d.jsx(os,{children:Hn(Cfe)})},{path:"/profile",element:d.jsx(os,{allowBoth:!0,children:Hn(Afe)})},{path:"/track-complaints",element:d.jsx(os,{children:Hn(ofe)})},{path:"/official-dashboard",element:d.jsx(os,{requiredRole:"official",children:Hn(zoe)})},{path:"/reported-issues",element:d.jsx(os,{requiredRole:"official",children:Hn(Sfe,{showBottomNav:!1})})},{path:"/official-priority",element:d.jsx(os,{requiredRole:"official",children:Hn(Dae,{showBottomNav:!1})})},{path:"/live/host",element:d.jsx(os,{children:Hn(Tfe,{showBottomNav:!1})})},{path:"/live/:sessionId",element:d.jsx(os,{allowBoth:!0,children:Hn(Pfe,{showBottomNav:!1})})},{path:"/analytics",element:d.jsx(os,{requiredRole:"official",children:Hn(Nae,{showBottomNav:!1})})},{path:"/official/*",element:d.jsx(os,{requireOfficial:!0,children:Hn(h2)})},{path:"*",element:d.jsx(Tf,{to:"/",replace:!0})}]);I5.createRoot(document.getElementById("root")).render(d.jsx(Ft.StrictMode,{children:d.jsx(CG,{children:d.jsx(EG,{children:d.jsxs(IG,{children:[d.jsx(f5,{router:Ufe,future:{v7_startTransition:!0}}),d.jsx(Vy,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})})})}));export{Kb as _};
